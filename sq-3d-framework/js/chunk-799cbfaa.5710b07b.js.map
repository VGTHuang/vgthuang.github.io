{"version":3,"sources":["webpack:///./src/views/ThreeBackgroundTest.vue?4ceb","webpack:///./node_modules/@tweenjs/tween.js/dist/tween.esm.js","webpack:///./src/scripts/Three/Utils.ts","webpack:///./node_modules/node-libs-browser/mock/process.js","webpack:///./node_modules/three/examples/jsm/controls/OrbitControls.js","webpack:///./src/views/ThreeBackgroundTest.vue?0acb","webpack:///./node_modules/three/examples/jsm/libs/fflate.module.js","webpack:///./node_modules/three/examples/jsm/curves/NURBSUtils.js","webpack:///./node_modules/three/examples/jsm/curves/NURBSCurve.js","webpack:///./node_modules/three/examples/jsm/loaders/FBXLoader.js","webpack:///./node_modules/three/examples/jsm/utils/SceneUtils.js","webpack:///./src/scripts/Three/ParticleEngine.ts","webpack:///./src/scripts/Background1.0/index.ts","webpack:///./src/views/ThreeBackgroundTest.vue","webpack:///./src/views/ThreeBackgroundTest.vue?c381","webpack:///./src/views/ThreeBackgroundTest.vue?8fd4","webpack:///./node_modules/path-browserify/index.js","webpack:///./src/scripts/AnimUtils/TweenUtils.ts"],"names":["now","Easing","Linear","None","amount","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","Math","cos","PI","sin","Exponential","pow","Circular","sqrt","Elastic","Back","s","Bounce","self","process","hrtime","time","undefined","performance","bind","Date","getTime","now$1","Group","this","_tweens","_tweensAddedDuringUpdate","prototype","getAll","_this","Object","keys","map","tweenId","removeAll","add","tween","getId","remove","update","preserve","tweenIds","length","i","autoStart","Interpolation","v","k","m","f","floor","fn","Utils","Bezier","b","n","pw","bn","Bernstein","CatmullRom","p0","p1","t","fc","Factorial","a","p2","p3","v0","v1","t2","t3","Sequence","nextId","_nextId","mainGroup","Tween","_object","_group","_isPaused","_pauseStart","_valuesStart","_valuesEnd","_valuesStartRepeat","_duration","_initialRepeat","_repeat","_yoyo","_isPlaying","_reversed","_delayTime","_startTime","_easingFunction","_interpolationFunction","_chainedTweens","_onStartCallbackFired","_id","_isChainStopped","_goToEnd","isPlaying","isPaused","to","properties","duration","create","d","start","property","_swapEndStartRepeatValues","parseFloat","_setupProperties","startValue","startValueIsArray","Array","isArray","propType","isInterpolationList","endValues","_handleRelativeValue","concat","slice","reverse","prop","stop","stopChainedTweens","_onStopCallback","end","Infinity","pause","resume","numChainedTweens","group","delay","repeat","times","repeatDelay","_repeatDelayTime","yoyo","easing","easingFunction","interpolation","interpolationFunction","chain","tweens","_i","arguments","onStart","callback","_onStartCallback","onUpdate","_onUpdateCallback","onRepeat","_onRepeatCallback","onComplete","_onCompleteCallback","onStop","elapsed","endTime","value","_updateProperties","isFinite","startIsArray","endIsArray","charAt","tmp","endValue","TWEEN","DampingObjectController","object","damp","attract","velocity","childObjects","push","target","multiplyScalar","currentPath","sub","position","forEach","obj","copy","rotation","DampingVector3Controller","currentVec3","randn_bm","u","random","log","exports","nextTick","args","call","shift","setTimeout","apply","platform","arch","execPath","title","pid","browser","env","argv","binding","name","Error","path","cwd","chdir","dir","resolve","exit","kill","umask","dlopen","uptime","memoryUsage","uvCounters","features","_changeEvent","type","_startEvent","_endEvent","OrbitControls","domElement","super","console","warn","document","error","style","touchAction","enabled","minDistance","maxDistance","minZoom","maxZoom","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ROTATE","MIDDLE","DOLLY","PAN","touches","ONE","TWO","DOLLY_PAN","target0","clone","position0","zoom0","zoom","_domElementKeyEvents","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","getDistance","distanceTo","listenToKeyEvents","addEventListener","onKeyDown","saveState","scope","reset","updateProjectionMatrix","dispatchEvent","state","STATE","NONE","offset","quat","setFromUnitVectors","up","quatInverse","invert","lastPosition","lastQuaternion","twoPI","applyQuaternion","setFromVector3","rotateLeft","getAutoRotationAngle","sphericalDelta","min","max","makeSafe","radius","scale","addScaledVector","panOffset","setFromSpherical","lookAt","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onPointerDown","onPointerCancel","onMouseWheel","onPointerMove","onPointerUp","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","pointers","pointerPositions","getZoomScale","angle","rotateUp","panLeft","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","matrix","isOrthographicCamera","right","left","clientWidth","top","bottom","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","event","clientX","clientY","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","subVectors","x","y","handleMouseMoveDolly","handleMouseMovePan","handleMouseWheel","handleKeyDown","needsUpdate","code","preventDefault","handleTouchStartRotate","pageX","pageY","handleTouchStartPan","handleTouchStartDolly","dx","dy","handleTouchStartDollyPan","handleTouchStartDollyRotate","handleTouchMoveRotate","getSecondPointerPosition","handleTouchMovePan","handleTouchMoveDolly","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","setPointerCapture","pointerId","addPointer","pointerType","onTouchStart","onMouseDown","onTouchMove","onMouseMove","removePointer","releasePointerCapture","mouseAction","button","ctrlKey","metaKey","shiftKey","trackPointer","DOLLY_ROTATE","splice","pointer","passive","render","_vm","_h","$createElement","_c","_self","ref","attrs","staticClass","class","loadingStat","isLoaded","noLoadingStat","width","loaded","total","_v","_s","round","staticRenderFns","ch2","durl","c","URL","createObjectURL","Blob","cwk","Worker","revokeObjectURL","e","encodeURI","wk","id","msg","transfer","cb","w","onerror","onmessage","data","postMessage","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","r","j","_a","fl","revfl","_b","fd","revfd","rev","hMap","cd","mb","l","co","le","rvb","sv","r_1","flt","fdt","flm","flrm","fdm","fdrm","bits","p","o","bits16","shft","slc","subarray","inflt","dat","buf","st","sl","noBuf","noSt","cbuf","bl","nbuf","final","pos","bt","lm","dm","lbt","dbt","tbts","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","dsym","wbits","wbits16","hTree","et","sort","i0","i1","i2","maxSym","tr","mbt","ln","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","clen","cf","wfblk","out","wblk","syms","lf","df","li","bs","dlt","mlb","ddt","mdb","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","ll","dl","flen","ftlen","dtlen","llm","lcts","it","clct","len","dst","deo","dflt","lvl","plvl","pre","post","lst","ceil","opt","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","maxd","ml","nl","mmd","md","ti","pti","lin","din","crct","crc","cr","adler","dopt","level","mem","mrg","wcln","fnStr","td","toString","ks","indexOf","lastIndexOf","replace","split","st_1","spInd","ch","cbfs","constructor","buffer","wrkr","fns","init","td_1","bInflt","inflateSync","pbf","gu8","bDflt","deflateSync","gze","gzh","gzhl","wbytes","guze","gzs","gzl","zle","zlh","zule","zlv","size","cbify","opts","err","terminate","consume","astrm","strm","ondata","ev","astrmify","b2","b4","b8","filename","mtime","charCodeAt","flg","zs","lv","AsyncCmpStrm","Deflate","chunk","AsyncDeflate","deflate","Inflate","bts","AsyncInflate","inflate","Gzip","raw","AsyncGzip","gzip","gzipSync","Gunzip","AsyncGunzip","gunzip","gunzipSync","Zlib","AsyncZlib","zlib","zlibSync","Unzlib","AsyncUnzlib","unzlib","unzlibSync","Decompress","G","I","Z","_this_1","AsyncDecompress","decompress","decompressSync","fltn","val","te","TextEncoder","TextDecoder","tds","decode","stream","dutf8","String","fromCharCode","DecodeUTF8","np","EncodeUTF8","strToU8","str","latin1","ar_1","encode","ar","ai","strFromU8","ext","dbf","slzh","zh","z","fnl","es","z64e","sc","su","off","exfl","ex","wzh","ce","extra","col","exl","os","flag","compression","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","exf","wzf","ZipPassThrough","ZipDeflate","AsyncZipDeflate","Zip","file","com","comment","hl","header","chks","pAll","chks_1","chk","ind","uf","nxt","dd","zip","tot","slft","files","term","tAll","cbf","oe","cdl","badd","loc","_loop_1","ms","cbl","zipSync","UnzipPassThrough","UnzipInflate","AsyncUnzipInflate","_","sz","Unzip","onfile","0","toAdd","is","oc","_loop_2","sig","this_1","bf","cmp_1","chks_2","unshift","d_1","sc_1","su_1","fn_1","file_1","ctr","chks_3","originalSize","state_1","register","decoder","unzip","_loop_3","c_1","no","infl","unzipSync","c_2","findSpan","U","low","high","mid","calcBasisFunctions","span","N","saved","rv","temp","calcBSplinePoint","P","C","point","Nj","wNj","calcBasisFunctionDerivatives","zeroArr","ders","ndu","s1","s2","rk","pk","j1","j2","calcBSplineDerivatives","nd","du","CK","nders","Pw","calcKoverI","nom","denom","calcRationalCurveDerivatives","Pders","Aders","wders","divideScalar","calcNURBSDerivatives","degree","knots","controlPoints","startKnot","endKnot","optionalTarget","hpoint","tangent","normalize","fbxTree","connections","sceneGraph","manager","url","onLoad","onProgress","onError","extractUrlBase","loader","setPath","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","load","parse","itemError","FBXBuffer","isFbxFormatBinary","FBXText","convertArrayBufferToString","isFbxFormatASCII","getFbxVersion","TextParser","textureLoader","resourcePath","setCrossOrigin","crossOrigin","parseConnections","images","parseImages","textures","parseTextures","materials","parseMaterials","deformers","parseDeformers","geometryMap","parseScene","connectionMap","Map","rawConnections","Connections","rawConnection","fromID","toID","relationship","has","parents","children","parentRelationship","ID","get","childRelationship","blobs","Objects","videoNodes","Video","nodeID","videoNode","parseInt","RelativeFilename","Filename","arrayBufferContent","Content","ArrayBuffer","byteLength","base64Content","image","parseImage","pop","content","fileName","extension","toLowerCase","getHandler","array","window","textureMap","textureNodes","Texture","texture","parseTexture","textureNode","loadTexture","attrName","wrapModeU","WrapModeU","wrapModeV","WrapModeV","valueU","valueV","wrapS","wrapT","values","Scaling","FileName","materialMap","materialNodes","Material","material","parseMaterial","materialNode","ShadingModel","parameters","parseParameters","setValues","BumpFactor","bumpScale","Diffuse","color","fromArray","DiffuseColor","DisplacementFactor","displacementScale","Emissive","emissive","EmissiveColor","EmissiveFactor","emissiveIntensity","Opacity","opacity","transparent","ReflectionFactor","reflectivity","Shininess","shininess","Specular","specular","SpecularColor","child","bumpMap","getTexture","aoMap","encoding","displacementMap","emissiveMap","normalMap","envMap","mapping","specularMap","alphaMap","LayeredTexture","skeletons","morphTargets","DeformerNodes","Deformer","deformerNode","relationships","attrType","skeleton","parseSkeleton","geometryID","morphTarget","rawTargets","parseMorphTargets","deformerNodes","rawBones","boneNode","rawBone","indices","weights","transformLink","TransformLink","Indexes","Weights","bones","rawMorphTargets","morphTargetNode","rawMorphTarget","initialWeight","DeformPercent","fullWeights","FullWeights","geoID","filter","modelMap","parseModels","modelNodes","Model","model","modelNode","setLookAtProperties","parentConnections","connection","parent","bindSkeleton","createAmbientLight","traverse","node","userData","transformData","parentMatrix","parentMatrixWorld","matrixWorld","transform","generateTransform","applyMatrix4","updateWorldMatrix","animations","isGroup","buildSkeleton","createCamera","createLight","createMesh","createCurve","sanitizeNodeName","getTransformData","bone","subBone","cameraAttribute","attr","NodeAttribute","CameraProjectionType","nearClippingPlane","NearPlane","farClippingPlane","FarPlane","innerWidth","height","innerHeight","AspectWidth","AspectHeight","aspect","FieldOfView","focalLength","FocalLength","setFocalLength","lightAttribute","LightType","Color","intensity","Intensity","CastLightOnObject","FarAttenuationEnd","EnableFarAttenuation","decay","InnerAngle","degToRad","penumbra","OuterAngle","CastShadows","castShadow","geometry","attributes","vertexColors","FBX_Deformer","normalizeSkinWeights","reduce","geo","linewidth","inheritType","InheritType","eulerOrder","getEulerOrder","RotationOrder","translation","Lcl_Translation","preRotation","PreRotation","Lcl_Rotation","postRotation","PostRotation","Lcl_Scaling","scalingOffset","ScalingOffset","scalingPivot","ScalingPivot","rotationOffset","RotationOffset","rotationPivot","RotationPivot","lookAtTarget","bindMatrices","parsePoseNodes","geoRelationships","geoConnParent","BindPoseNode","Pose","NbPoseNodes","poseNodes","PoseNode","poseNode","Node","Matrix","GlobalSettings","ambientColor","AmbientColor","g","geoNodes","Geometry","parseGeometry","geoNode","parseMeshGeometry","parseNurbsGeometry","GeometricTranslation","GeometricRotation","GeometricScaling","genGeometry","preTransform","geoInfo","parseGeoNode","buffers","genBuffers","positionAttribute","vertex","setAttribute","colors","weightsIndices","vertexWeights","normal","normalMatrix","getNormalMatrix","normalAttribute","applyNormalMatrix","uvs","uvBuffer","mappingType","prevMaterialIndex","materialIndex","startIndex","currentIndex","addGroup","groups","lastGroup","lastIndex","count","addMorphTargets","vertexPositions","Vertices","vertexIndices","PolygonVertexIndex","LayerElementColor","parseVertexColors","LayerElementMaterial","parseMaterialIndices","LayerElementNormal","parseNormals","LayerElementUV","uv","UV","parseUVs","weightTable","index","weight","polygonIndex","faceLength","displayedWeightsWarning","facePositionIndexes","faceNormals","faceColors","faceUVs","faceWeights","faceWeightIndices","vertexIndex","polygonVertexIndex","endOfFace","weightIndices","getData","wt","wIndex","Weight","weightIndex","currentWeight","comparedWeight","comparedWeightIndex","comparedWeightArray","genFace","parentGeo","parentGeoNode","morphTargetsRelative","morphAttributes","rawTarget","morphGeoNode","genMorphGeometry","morphPositionsSparse","morphPositions","Float32Array","morphIndex","morphGeoInfo","morphBuffers","NormalNode","MappingInformationType","referenceType","ReferenceInformationType","Normals","indexBuffer","NormalIndex","NormalsIndex","dataSize","UVNode","UVIndex","ColorNode","Colors","ColorIndex","MaterialNode","materialIndexBuffer","Materials","materialIndices","order","Order","isNaN","KnotVector","pointsValues","Points","Form","curve","points","getPoints","setFromPoints","animationClips","rawClips","parseClips","key","rawClip","clip","addClip","AnimationCurve","curveNodesMap","parseAnimationCurveNodes","parseAnimationCurves","layersMap","parseAnimationLayers","parseAnimStacks","rawCurveNodes","AnimationCurveNode","rawCurveNode","match","curveNode","curves","rawCurves","animationCurve","KeyTime","convertFBXTimeToSeconds","KeyValueFloat","animationCurveID","animationCurveRelationship","rawLayers","AnimationLayer","layerCurveNodes","modelID","rawModel","modelName","initialPosition","initialRotation","initialScale","morph","deformerID","morpherID","morphName","rawStacks","AnimationStack","layer","tracks","rawTracks","generateTracks","decompose","toArray","setFromQuaternion","T","positionTrack","generateVectorTrack","R","rotationTrack","generateRotationTrack","S","scaleTrack","morphTrack","generateMorphTrack","initialValue","getTimesForAllAxes","getKeyframeTrackValues","interpolateRotations","setFromEuler","euler","quaternionValues","premultiply","multiply","morphNum","getObjectByName","morphTargetDictionary","targetIndex","lastValue","currentValue","prevValue","xIndex","yIndex","zIndex","xValue","yValue","zValue","valuesSpan","absoluteSpan","abs","numSubIntervals","step","nextValue","initialTime","timeSpan","interval","nextTime","interpolatedTimes","interpolatedValues","inject","nodeStack","currentIndent","currentProp","currentPropName","text","allNodes","FBXTree","line","matchComment","matchEmpty","matchBeginning","matchProperty","matchEnd","parseNodeBegin","parseNodeProperty","popStack","parseNodePropertyContinued","nodeName","trim","nodeAttrs","parseNodeAttr","currentNode","getCurrentNode","pushStack","contentLine","propName","propValue","parentName","connProps","from","rest","elem","append","setCurrentProp","parseNumberArray","parseNodeSpecialProperty","props","innerPropName","innerPropType1","innerPropType2","innerPropFlag","innerPropValue","getPrevNode","reader","skip","version","getUint32","endOfContent","parseNode","getOffset","endOffset","getUint64","numProperties","nameLen","getUint8","getString","propertyList","parseProperty","singleProperty","subNode","parseSubNode","getBoolean","getFloat64","getFloat32","getInt32","getInt64","getArrayBuffer","getInt16","arrayLength","compressedLength","getBooleanArray","getFloat64Array","getFloat32Array","getInt32Array","getInt64Array","reader2","littleEndian","dv","DataView","nullByte","decodeText","CORRECT","cursor","read","result","num","versionRegExp","dataArray","infoObject","tempEuler","tempVec","lTranslationM","lPreRotationM","lRotationM","lPostRotationM","lScalingM","lScalingPivotM","lScalingOffsetM","lRotationOffsetM","lRotationPivotM","lParentGX","lParentLX","lGlobalT","setPosition","makeRotationFromEuler","lLRM","lParentGRM","extractRotation","lParentTM","copyPosition","lParentGRSM","lParentGSM","lLSM","lGlobalRS","lParentLSM","setFromMatrixScale","lParentLSM_inv","lParentGSM_noLocal","lRotationPivotM_inv","lScalingPivotM_inv","lTransform","lLocalTWithAllPivotAndOffsetInfo","lGlobalTranslation","enums","a1","a2","createMultiMaterialObject","instanceIndex","birthTime","deathTime","dummy","mesh","updateMatrix","setMatrixAt","setColorAt","particleCount","instanceMatrix","setUsage","setInitPosition","setInitRotation","setInitScale","setInitColor","particleControllers","initPosition","initRotation","initScale","initColor","tempParticleController","resetGeom","_container","requestAnimationFrame","animate","stats","controls","container","camera","renderer","alpha","outputEncoding","toneMappingExposure","setClearColor","setPixelRatio","devicePixelRatio","setSize","appendChild","scene","loadingManager","png_urls","urls","getCubemapUrls","textureCube1","environment","textureCube2","background","light","light1","light2","sinPeriods","sinAmplitude","sinRadius1","sinRadius2","ps","spline","samples","getLength","splineLength","sphereRadius","sphereCount","spherePositions","getPointAt","geometrySpline","dashSize","gapSize","particleGeometry","particleMaterial","clearcoat","clearcoatRoughness","metalness","roughness","sheen","sheenColor","particleEngine1","ao1Map","texMap","normMap","normalScale","metalnessMap","clearcoatMap","side","kao1Map","kao2Map","loader2","frontbackMaterials","frontBackMesh","fao1Map","fao2Map","loader3","logoColorMap","logoReflectMap","logoMaterial","logoCardGeometry","logoCardEngine","getRandomLogoPosition","mousePosX","mousePosY","onWindowResize","onClick","radiusNew","randomOffset","extend","fpm","mounted","$refs","HTMLElement","component","normalizeArray","parts","allowAboveRoot","last","basename","matchedSlash","xs","res","resolvedPath","resolvedAbsolute","TypeError","join","isAbsolute","trailingSlash","substr","paths","relative","arr","fromParts","toParts","samePartsLength","outputParts","sep","delimiter","dirname","hasRoot","extname","startDot","startPart","preDotState","TweenAnimController","requestId","loopAnim","cancelAnimationFrame","animationObjectCount","startAnim","stopAnim","fromValue","toValue","onUpdateFunc","onCompleteFunc","addTweenAnimObject","removeTweenAnimObject","v2","controller"],"mappings":"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","file":"js/chunk-799cbfaa.5710b07b.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeBackgroundTest.vue?vue&type=style&index=0&id=17a177c4&scoped=true&lang=css&\"","/**\n * The Ease class provides a collection of easing functions for use with tween.js.\n */\nvar Easing = {\n    Linear: {\n        None: function (amount) {\n            return amount;\n        },\n    },\n    Quadratic: {\n        In: function (amount) {\n            return amount * amount;\n        },\n        Out: function (amount) {\n            return amount * (2 - amount);\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount;\n            }\n            return -0.5 * (--amount * (amount - 2) - 1);\n        },\n    },\n    Cubic: {\n        In: function (amount) {\n            return amount * amount * amount;\n        },\n        Out: function (amount) {\n            return --amount * amount * amount + 1;\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount * amount;\n            }\n            return 0.5 * ((amount -= 2) * amount * amount + 2);\n        },\n    },\n    Quartic: {\n        In: function (amount) {\n            return amount * amount * amount * amount;\n        },\n        Out: function (amount) {\n            return 1 - --amount * amount * amount * amount;\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount * amount * amount;\n            }\n            return -0.5 * ((amount -= 2) * amount * amount * amount - 2);\n        },\n    },\n    Quintic: {\n        In: function (amount) {\n            return amount * amount * amount * amount * amount;\n        },\n        Out: function (amount) {\n            return --amount * amount * amount * amount * amount + 1;\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount * amount * amount * amount;\n            }\n            return 0.5 * ((amount -= 2) * amount * amount * amount * amount + 2);\n        },\n    },\n    Sinusoidal: {\n        In: function (amount) {\n            return 1 - Math.cos((amount * Math.PI) / 2);\n        },\n        Out: function (amount) {\n            return Math.sin((amount * Math.PI) / 2);\n        },\n        InOut: function (amount) {\n            return 0.5 * (1 - Math.cos(Math.PI * amount));\n        },\n    },\n    Exponential: {\n        In: function (amount) {\n            return amount === 0 ? 0 : Math.pow(1024, amount - 1);\n        },\n        Out: function (amount) {\n            return amount === 1 ? 1 : 1 - Math.pow(2, -10 * amount);\n        },\n        InOut: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            if ((amount *= 2) < 1) {\n                return 0.5 * Math.pow(1024, amount - 1);\n            }\n            return 0.5 * (-Math.pow(2, -10 * (amount - 1)) + 2);\n        },\n    },\n    Circular: {\n        In: function (amount) {\n            return 1 - Math.sqrt(1 - amount * amount);\n        },\n        Out: function (amount) {\n            return Math.sqrt(1 - --amount * amount);\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return -0.5 * (Math.sqrt(1 - amount * amount) - 1);\n            }\n            return 0.5 * (Math.sqrt(1 - (amount -= 2) * amount) + 1);\n        },\n    },\n    Elastic: {\n        In: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            return -Math.pow(2, 10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI);\n        },\n        Out: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            return Math.pow(2, -10 * amount) * Math.sin((amount - 0.1) * 5 * Math.PI) + 1;\n        },\n        InOut: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            amount *= 2;\n            if (amount < 1) {\n                return -0.5 * Math.pow(2, 10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI);\n            }\n            return 0.5 * Math.pow(2, -10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI) + 1;\n        },\n    },\n    Back: {\n        In: function (amount) {\n            var s = 1.70158;\n            return amount * amount * ((s + 1) * amount - s);\n        },\n        Out: function (amount) {\n            var s = 1.70158;\n            return --amount * amount * ((s + 1) * amount + s) + 1;\n        },\n        InOut: function (amount) {\n            var s = 1.70158 * 1.525;\n            if ((amount *= 2) < 1) {\n                return 0.5 * (amount * amount * ((s + 1) * amount - s));\n            }\n            return 0.5 * ((amount -= 2) * amount * ((s + 1) * amount + s) + 2);\n        },\n    },\n    Bounce: {\n        In: function (amount) {\n            return 1 - Easing.Bounce.Out(1 - amount);\n        },\n        Out: function (amount) {\n            if (amount < 1 / 2.75) {\n                return 7.5625 * amount * amount;\n            }\n            else if (amount < 2 / 2.75) {\n                return 7.5625 * (amount -= 1.5 / 2.75) * amount + 0.75;\n            }\n            else if (amount < 2.5 / 2.75) {\n                return 7.5625 * (amount -= 2.25 / 2.75) * amount + 0.9375;\n            }\n            else {\n                return 7.5625 * (amount -= 2.625 / 2.75) * amount + 0.984375;\n            }\n        },\n        InOut: function (amount) {\n            if (amount < 0.5) {\n                return Easing.Bounce.In(amount * 2) * 0.5;\n            }\n            return Easing.Bounce.Out(amount * 2 - 1) * 0.5 + 0.5;\n        },\n    },\n};\n\nvar now;\n// Include a performance.now polyfill.\n// In node.js, use process.hrtime.\n// eslint-disable-next-line\n// @ts-ignore\nif (typeof self === 'undefined' && typeof process !== 'undefined' && process.hrtime) {\n    now = function () {\n        // eslint-disable-next-line\n        // @ts-ignore\n        var time = process.hrtime();\n        // Convert [seconds, nanoseconds] to milliseconds.\n        return time[0] * 1000 + time[1] / 1000000;\n    };\n}\n// In a browser, use self.performance.now if it is available.\nelse if (typeof self !== 'undefined' && self.performance !== undefined && self.performance.now !== undefined) {\n    // This must be bound, because directly assigning this function\n    // leads to an invocation exception in Chrome.\n    now = self.performance.now.bind(self.performance);\n}\n// Use Date.now if it is available.\nelse if (Date.now !== undefined) {\n    now = Date.now;\n}\n// Otherwise, use 'new Date().getTime()'.\nelse {\n    now = function () {\n        return new Date().getTime();\n    };\n}\nvar now$1 = now;\n\n/**\n * Controlling groups of tweens\n *\n * Using the TWEEN singleton to manage your tweens can cause issues in large apps with many components.\n * In these cases, you may want to create your own smaller groups of tween\n */\nvar Group = /** @class */ (function () {\n    function Group() {\n        this._tweens = {};\n        this._tweensAddedDuringUpdate = {};\n    }\n    Group.prototype.getAll = function () {\n        var _this = this;\n        return Object.keys(this._tweens).map(function (tweenId) {\n            return _this._tweens[tweenId];\n        });\n    };\n    Group.prototype.removeAll = function () {\n        this._tweens = {};\n    };\n    Group.prototype.add = function (tween) {\n        this._tweens[tween.getId()] = tween;\n        this._tweensAddedDuringUpdate[tween.getId()] = tween;\n    };\n    Group.prototype.remove = function (tween) {\n        delete this._tweens[tween.getId()];\n        delete this._tweensAddedDuringUpdate[tween.getId()];\n    };\n    Group.prototype.update = function (time, preserve) {\n        if (time === void 0) { time = now$1(); }\n        if (preserve === void 0) { preserve = false; }\n        var tweenIds = Object.keys(this._tweens);\n        if (tweenIds.length === 0) {\n            return false;\n        }\n        // Tweens are updated in \"batches\". If you add a new tween during an\n        // update, then the new tween will be updated in the next batch.\n        // If you remove a tween during an update, it may or may not be updated.\n        // However, if the removed tween was added during the current batch,\n        // then it will not be updated.\n        while (tweenIds.length > 0) {\n            this._tweensAddedDuringUpdate = {};\n            for (var i = 0; i < tweenIds.length; i++) {\n                var tween = this._tweens[tweenIds[i]];\n                var autoStart = !preserve;\n                if (tween && tween.update(time, autoStart) === false && !preserve) {\n                    delete this._tweens[tweenIds[i]];\n                }\n            }\n            tweenIds = Object.keys(this._tweensAddedDuringUpdate);\n        }\n        return true;\n    };\n    return Group;\n}());\n\n/**\n *\n */\nvar Interpolation = {\n    Linear: function (v, k) {\n        var m = v.length - 1;\n        var f = m * k;\n        var i = Math.floor(f);\n        var fn = Interpolation.Utils.Linear;\n        if (k < 0) {\n            return fn(v[0], v[1], f);\n        }\n        if (k > 1) {\n            return fn(v[m], v[m - 1], m - f);\n        }\n        return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\n    },\n    Bezier: function (v, k) {\n        var b = 0;\n        var n = v.length - 1;\n        var pw = Math.pow;\n        var bn = Interpolation.Utils.Bernstein;\n        for (var i = 0; i <= n; i++) {\n            b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\n        }\n        return b;\n    },\n    CatmullRom: function (v, k) {\n        var m = v.length - 1;\n        var f = m * k;\n        var i = Math.floor(f);\n        var fn = Interpolation.Utils.CatmullRom;\n        if (v[0] === v[m]) {\n            if (k < 0) {\n                i = Math.floor((f = m * (1 + k)));\n            }\n            return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\n        }\n        else {\n            if (k < 0) {\n                return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\n            }\n            if (k > 1) {\n                return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\n            }\n            return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\n        }\n    },\n    Utils: {\n        Linear: function (p0, p1, t) {\n            return (p1 - p0) * t + p0;\n        },\n        Bernstein: function (n, i) {\n            var fc = Interpolation.Utils.Factorial;\n            return fc(n) / fc(i) / fc(n - i);\n        },\n        Factorial: (function () {\n            var a = [1];\n            return function (n) {\n                var s = 1;\n                if (a[n]) {\n                    return a[n];\n                }\n                for (var i = n; i > 1; i--) {\n                    s *= i;\n                }\n                a[n] = s;\n                return s;\n            };\n        })(),\n        CatmullRom: function (p0, p1, p2, p3, t) {\n            var v0 = (p2 - p0) * 0.5;\n            var v1 = (p3 - p1) * 0.5;\n            var t2 = t * t;\n            var t3 = t * t2;\n            return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\n        },\n    },\n};\n\n/**\n * Utils\n */\nvar Sequence = /** @class */ (function () {\n    function Sequence() {\n    }\n    Sequence.nextId = function () {\n        return Sequence._nextId++;\n    };\n    Sequence._nextId = 0;\n    return Sequence;\n}());\n\nvar mainGroup = new Group();\n\n/**\n * Tween.js - Licensed under the MIT license\n * https://github.com/tweenjs/tween.js\n * ----------------------------------------------\n *\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\n * Thank you all, you're awesome!\n */\nvar Tween = /** @class */ (function () {\n    function Tween(_object, _group) {\n        if (_group === void 0) { _group = mainGroup; }\n        this._object = _object;\n        this._group = _group;\n        this._isPaused = false;\n        this._pauseStart = 0;\n        this._valuesStart = {};\n        this._valuesEnd = {};\n        this._valuesStartRepeat = {};\n        this._duration = 1000;\n        this._initialRepeat = 0;\n        this._repeat = 0;\n        this._yoyo = false;\n        this._isPlaying = false;\n        this._reversed = false;\n        this._delayTime = 0;\n        this._startTime = 0;\n        this._easingFunction = Easing.Linear.None;\n        this._interpolationFunction = Interpolation.Linear;\n        this._chainedTweens = [];\n        this._onStartCallbackFired = false;\n        this._id = Sequence.nextId();\n        this._isChainStopped = false;\n        this._goToEnd = false;\n    }\n    Tween.prototype.getId = function () {\n        return this._id;\n    };\n    Tween.prototype.isPlaying = function () {\n        return this._isPlaying;\n    };\n    Tween.prototype.isPaused = function () {\n        return this._isPaused;\n    };\n    Tween.prototype.to = function (properties, duration) {\n        // TODO? restore this, then update the 07_dynamic_to example to set fox\n        // tween's to on each update. That way the behavior is opt-in (there's\n        // currently no opt-out).\n        // for (const prop in properties) this._valuesEnd[prop] = properties[prop]\n        this._valuesEnd = Object.create(properties);\n        if (duration !== undefined) {\n            this._duration = duration;\n        }\n        return this;\n    };\n    Tween.prototype.duration = function (d) {\n        this._duration = d;\n        return this;\n    };\n    Tween.prototype.start = function (time) {\n        if (this._isPlaying) {\n            return this;\n        }\n        // eslint-disable-next-line\n        this._group && this._group.add(this);\n        this._repeat = this._initialRepeat;\n        if (this._reversed) {\n            // If we were reversed (f.e. using the yoyo feature) then we need to\n            // flip the tween direction back to forward.\n            this._reversed = false;\n            for (var property in this._valuesStartRepeat) {\n                this._swapEndStartRepeatValues(property);\n                this._valuesStart[property] = this._valuesStartRepeat[property];\n            }\n        }\n        this._isPlaying = true;\n        this._isPaused = false;\n        this._onStartCallbackFired = false;\n        this._isChainStopped = false;\n        this._startTime = time !== undefined ? (typeof time === 'string' ? now$1() + parseFloat(time) : time) : now$1();\n        this._startTime += this._delayTime;\n        this._setupProperties(this._object, this._valuesStart, this._valuesEnd, this._valuesStartRepeat);\n        return this;\n    };\n    Tween.prototype._setupProperties = function (_object, _valuesStart, _valuesEnd, _valuesStartRepeat) {\n        for (var property in _valuesEnd) {\n            var startValue = _object[property];\n            var startValueIsArray = Array.isArray(startValue);\n            var propType = startValueIsArray ? 'array' : typeof startValue;\n            var isInterpolationList = !startValueIsArray && Array.isArray(_valuesEnd[property]);\n            // If `to()` specifies a property that doesn't exist in the source object,\n            // we should not set that property in the object\n            if (propType === 'undefined' || propType === 'function') {\n                continue;\n            }\n            // Check if an Array was provided as property value\n            if (isInterpolationList) {\n                var endValues = _valuesEnd[property];\n                if (endValues.length === 0) {\n                    continue;\n                }\n                // handle an array of relative values\n                endValues = endValues.map(this._handleRelativeValue.bind(this, startValue));\n                // Create a local copy of the Array with the start value at the front\n                _valuesEnd[property] = [startValue].concat(endValues);\n            }\n            // handle the deepness of the values\n            if ((propType === 'object' || startValueIsArray) && startValue && !isInterpolationList) {\n                _valuesStart[property] = startValueIsArray ? [] : {};\n                // eslint-disable-next-line\n                for (var prop in startValue) {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _valuesStart[property][prop] = startValue[prop];\n                }\n                _valuesStartRepeat[property] = startValueIsArray ? [] : {}; // TODO? repeat nested values? And yoyo? And array values?\n                // eslint-disable-next-line\n                // @ts-ignore FIXME?\n                this._setupProperties(startValue, _valuesStart[property], _valuesEnd[property], _valuesStartRepeat[property]);\n            }\n            else {\n                // Save the starting value, but only once.\n                if (typeof _valuesStart[property] === 'undefined') {\n                    _valuesStart[property] = startValue;\n                }\n                if (!startValueIsArray) {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings\n                }\n                if (isInterpolationList) {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _valuesStartRepeat[property] = _valuesEnd[property].slice().reverse();\n                }\n                else {\n                    _valuesStartRepeat[property] = _valuesStart[property] || 0;\n                }\n            }\n        }\n    };\n    Tween.prototype.stop = function () {\n        if (!this._isChainStopped) {\n            this._isChainStopped = true;\n            this.stopChainedTweens();\n        }\n        if (!this._isPlaying) {\n            return this;\n        }\n        // eslint-disable-next-line\n        this._group && this._group.remove(this);\n        this._isPlaying = false;\n        this._isPaused = false;\n        if (this._onStopCallback) {\n            this._onStopCallback(this._object);\n        }\n        return this;\n    };\n    Tween.prototype.end = function () {\n        this._goToEnd = true;\n        this.update(Infinity);\n        return this;\n    };\n    Tween.prototype.pause = function (time) {\n        if (time === void 0) { time = now$1(); }\n        if (this._isPaused || !this._isPlaying) {\n            return this;\n        }\n        this._isPaused = true;\n        this._pauseStart = time;\n        // eslint-disable-next-line\n        this._group && this._group.remove(this);\n        return this;\n    };\n    Tween.prototype.resume = function (time) {\n        if (time === void 0) { time = now$1(); }\n        if (!this._isPaused || !this._isPlaying) {\n            return this;\n        }\n        this._isPaused = false;\n        this._startTime += time - this._pauseStart;\n        this._pauseStart = 0;\n        // eslint-disable-next-line\n        this._group && this._group.add(this);\n        return this;\n    };\n    Tween.prototype.stopChainedTweens = function () {\n        for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {\n            this._chainedTweens[i].stop();\n        }\n        return this;\n    };\n    Tween.prototype.group = function (group) {\n        this._group = group;\n        return this;\n    };\n    Tween.prototype.delay = function (amount) {\n        this._delayTime = amount;\n        return this;\n    };\n    Tween.prototype.repeat = function (times) {\n        this._initialRepeat = times;\n        this._repeat = times;\n        return this;\n    };\n    Tween.prototype.repeatDelay = function (amount) {\n        this._repeatDelayTime = amount;\n        return this;\n    };\n    Tween.prototype.yoyo = function (yoyo) {\n        this._yoyo = yoyo;\n        return this;\n    };\n    Tween.prototype.easing = function (easingFunction) {\n        this._easingFunction = easingFunction;\n        return this;\n    };\n    Tween.prototype.interpolation = function (interpolationFunction) {\n        this._interpolationFunction = interpolationFunction;\n        return this;\n    };\n    Tween.prototype.chain = function () {\n        var tweens = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            tweens[_i] = arguments[_i];\n        }\n        this._chainedTweens = tweens;\n        return this;\n    };\n    Tween.prototype.onStart = function (callback) {\n        this._onStartCallback = callback;\n        return this;\n    };\n    Tween.prototype.onUpdate = function (callback) {\n        this._onUpdateCallback = callback;\n        return this;\n    };\n    Tween.prototype.onRepeat = function (callback) {\n        this._onRepeatCallback = callback;\n        return this;\n    };\n    Tween.prototype.onComplete = function (callback) {\n        this._onCompleteCallback = callback;\n        return this;\n    };\n    Tween.prototype.onStop = function (callback) {\n        this._onStopCallback = callback;\n        return this;\n    };\n    /**\n     * @returns true if the tween is still playing after the update, false\n     * otherwise (calling update on a paused tween still returns true because\n     * it is still playing, just paused).\n     */\n    Tween.prototype.update = function (time, autoStart) {\n        if (time === void 0) { time = now$1(); }\n        if (autoStart === void 0) { autoStart = true; }\n        if (this._isPaused)\n            return true;\n        var property;\n        var elapsed;\n        var endTime = this._startTime + this._duration;\n        if (!this._goToEnd && !this._isPlaying) {\n            if (time > endTime)\n                return false;\n            if (autoStart)\n                this.start(time);\n        }\n        this._goToEnd = false;\n        if (time < this._startTime) {\n            return true;\n        }\n        if (this._onStartCallbackFired === false) {\n            if (this._onStartCallback) {\n                this._onStartCallback(this._object);\n            }\n            this._onStartCallbackFired = true;\n        }\n        elapsed = (time - this._startTime) / this._duration;\n        elapsed = this._duration === 0 || elapsed > 1 ? 1 : elapsed;\n        var value = this._easingFunction(elapsed);\n        // properties transformations\n        this._updateProperties(this._object, this._valuesStart, this._valuesEnd, value);\n        if (this._onUpdateCallback) {\n            this._onUpdateCallback(this._object, elapsed);\n        }\n        if (elapsed === 1) {\n            if (this._repeat > 0) {\n                if (isFinite(this._repeat)) {\n                    this._repeat--;\n                }\n                // Reassign starting values, restart by making startTime = now\n                for (property in this._valuesStartRepeat) {\n                    if (!this._yoyo && typeof this._valuesEnd[property] === 'string') {\n                        this._valuesStartRepeat[property] =\n                            // eslint-disable-next-line\n                            // @ts-ignore FIXME?\n                            this._valuesStartRepeat[property] + parseFloat(this._valuesEnd[property]);\n                    }\n                    if (this._yoyo) {\n                        this._swapEndStartRepeatValues(property);\n                    }\n                    this._valuesStart[property] = this._valuesStartRepeat[property];\n                }\n                if (this._yoyo) {\n                    this._reversed = !this._reversed;\n                }\n                if (this._repeatDelayTime !== undefined) {\n                    this._startTime = time + this._repeatDelayTime;\n                }\n                else {\n                    this._startTime = time + this._delayTime;\n                }\n                if (this._onRepeatCallback) {\n                    this._onRepeatCallback(this._object);\n                }\n                return true;\n            }\n            else {\n                if (this._onCompleteCallback) {\n                    this._onCompleteCallback(this._object);\n                }\n                for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {\n                    // Make the chained tweens start exactly at the time they should,\n                    // even if the `update()` method was called way past the duration of the tween\n                    this._chainedTweens[i].start(this._startTime + this._duration);\n                }\n                this._isPlaying = false;\n                return false;\n            }\n        }\n        return true;\n    };\n    Tween.prototype._updateProperties = function (_object, _valuesStart, _valuesEnd, value) {\n        for (var property in _valuesEnd) {\n            // Don't update properties that do not exist in the source object\n            if (_valuesStart[property] === undefined) {\n                continue;\n            }\n            var start = _valuesStart[property] || 0;\n            var end = _valuesEnd[property];\n            var startIsArray = Array.isArray(_object[property]);\n            var endIsArray = Array.isArray(end);\n            var isInterpolationList = !startIsArray && endIsArray;\n            if (isInterpolationList) {\n                _object[property] = this._interpolationFunction(end, value);\n            }\n            else if (typeof end === 'object' && end) {\n                // eslint-disable-next-line\n                // @ts-ignore FIXME?\n                this._updateProperties(_object[property], start, end, value);\n            }\n            else {\n                // Parses relative end values with start as base (e.g.: +10, -3)\n                end = this._handleRelativeValue(start, end);\n                // Protect against non numeric properties.\n                if (typeof end === 'number') {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _object[property] = start + (end - start) * value;\n                }\n            }\n        }\n    };\n    Tween.prototype._handleRelativeValue = function (start, end) {\n        if (typeof end !== 'string') {\n            return end;\n        }\n        if (end.charAt(0) === '+' || end.charAt(0) === '-') {\n            return start + parseFloat(end);\n        }\n        else {\n            return parseFloat(end);\n        }\n    };\n    Tween.prototype._swapEndStartRepeatValues = function (property) {\n        var tmp = this._valuesStartRepeat[property];\n        var endValue = this._valuesEnd[property];\n        if (typeof endValue === 'string') {\n            this._valuesStartRepeat[property] = this._valuesStartRepeat[property] + parseFloat(endValue);\n        }\n        else {\n            this._valuesStartRepeat[property] = this._valuesEnd[property];\n        }\n        this._valuesEnd[property] = tmp;\n    };\n    return Tween;\n}());\n\nvar VERSION = '18.6.4';\n\n/**\n * Tween.js - Licensed under the MIT license\n * https://github.com/tweenjs/tween.js\n * ----------------------------------------------\n *\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\n * Thank you all, you're awesome!\n */\nvar nextId = Sequence.nextId;\n/**\n * Controlling groups of tweens\n *\n * Using the TWEEN singleton to manage your tweens can cause issues in large apps with many components.\n * In these cases, you may want to create your own smaller groups of tweens.\n */\nvar TWEEN = mainGroup;\n// This is the best way to export things in a way that's compatible with both ES\n// Modules and CommonJS, without build hacks, and so as not to break the\n// existing API.\n// https://github.com/rollup/rollup/issues/1961#issuecomment-423037881\nvar getAll = TWEEN.getAll.bind(TWEEN);\nvar removeAll = TWEEN.removeAll.bind(TWEEN);\nvar add = TWEEN.add.bind(TWEEN);\nvar remove = TWEEN.remove.bind(TWEEN);\nvar update = TWEEN.update.bind(TWEEN);\nvar exports = {\n    Easing: Easing,\n    Group: Group,\n    Interpolation: Interpolation,\n    now: now$1,\n    Sequence: Sequence,\n    nextId: nextId,\n    Tween: Tween,\n    VERSION: VERSION,\n    getAll: getAll,\n    removeAll: removeAll,\n    add: add,\n    remove: remove,\n    update: update,\n};\n\nexport default exports;\nexport { Easing, Group, Interpolation, Sequence, Tween, VERSION, add, getAll, nextId, now$1 as now, remove, removeAll, update };\n","import { Vector3, Object3D } from 'three'\r\n\r\nexport class DampingObjectController {\r\n    damp: number\r\n    attract: number\r\n    object: Object3D\r\n    velocity: Vector3\r\n    childObjects: Array<Object3D>\r\n    constructor(object: Object3D, damp: number = 0.5, attract: number = 0.5) {\r\n        this.damp = damp\r\n        this.attract = attract\r\n        this.object = object\r\n        this.velocity = new Vector3()\r\n        this.childObjects = []\r\n    }\r\n    addChildObj(object: Object3D) {\r\n        this.childObjects.push(object)\r\n    }\r\n    update(target: Vector3) {\r\n        this.velocity.multiplyScalar(this.damp)\r\n        let currentPath = target.sub(this.object.position)\r\n        this.velocity.add(currentPath.multiplyScalar(this.attract))\r\n        this.object.position.add(this.velocity)\r\n        this.childObjects.forEach(obj => {\r\n            obj.position.copy(this.object.position)\r\n            obj.rotation.copy(this.object.rotation)\r\n        })\r\n    }\r\n}\r\n\r\nexport class DampingVector3Controller {\r\n    damp: number\r\n    attract: number\r\n    velocity: Vector3\r\n    currentVec3: Vector3\r\n    constructor(currentVec3: Vector3, damp: number = 0.5, attract: number = 0.5) {\r\n        this.damp = damp\r\n        this.attract = attract\r\n        this.velocity = new Vector3()\r\n        this.currentVec3 = currentVec3\r\n    }\r\n    update(target: Vector3) {\r\n        this.velocity.multiplyScalar(this.damp)\r\n        let currentPath = new Vector3().copy(target).sub(this.currentVec3)\r\n        this.velocity.add(currentPath.multiplyScalar(this.attract))\r\n        this.currentVec3.add(this.velocity)\r\n    }\r\n}\r\n\r\nexport function randn_bm(): number {\r\n    var u = 0, v = 0;\r\n    while(u === 0) u = Math.random(); //Converting [0,1) to (0,1)\r\n    while(v === 0) v = Math.random();\r\n    return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );\r\n}","exports.nextTick = function nextTick(fn) {\n    var args = Array.prototype.slice.call(arguments);\n    args.shift();\n    setTimeout(function () {\n        fn.apply(null, args);\n    }, 0);\n};\n\nexports.platform = exports.arch = \nexports.execPath = exports.title = 'browser';\nexports.pid = 1;\nexports.browser = true;\nexports.env = {};\nexports.argv = [];\n\nexports.binding = function (name) {\n\tthrow new Error('No such module. (Possibly not yet loaded)')\n};\n\n(function () {\n    var cwd = '/';\n    var path;\n    exports.cwd = function () { return cwd };\n    exports.chdir = function (dir) {\n        if (!path) path = require('path');\n        cwd = path.resolve(dir, cwd);\n    };\n})();\n\nexports.exit = exports.kill = \nexports.umask = exports.dlopen = \nexports.uptime = exports.memoryUsage = \nexports.uvCounters = function() {};\nexports.features = {};\n","import {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3\n} from 'three';\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nconst _changeEvent = { type: 'change' };\nconst _startEvent = { type: 'start' };\nconst _endEvent = { type: 'end' };\n\nclass OrbitControls extends EventDispatcher {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new Vector3();\n\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\t\tthis.minAzimuthAngle = - Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.05;\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.panSpeed = 1.0;\n\t\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\n\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 'ArrowLeft', UP: 'ArrowUp', RIGHT: 'ArrowRight', BOTTOM: 'ArrowDown' };\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t\t// Touch fingers\n\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t// the target DOM element for key events\n\t\tthis._domElementKeyEvents = null;\n\n\t\t//\n\t\t// public methods\n\t\t//\n\n\t\tthis.getPolarAngle = function () {\n\n\t\t\treturn spherical.phi;\n\n\t\t};\n\n\t\tthis.getAzimuthalAngle = function () {\n\n\t\t\treturn spherical.theta;\n\n\t\t};\n\n\t\tthis.getDistance = function () {\n\n\t\t\treturn this.object.position.distanceTo( this.target );\n\n\t\t};\n\n\t\tthis.listenToKeyEvents = function ( domElement ) {\n\n\t\t\tdomElement.addEventListener( 'keydown', onKeyDown );\n\t\t\tthis._domElementKeyEvents = domElement;\n\n\t\t};\n\n\t\tthis.saveState = function () {\n\n\t\t\tscope.target0.copy( scope.target );\n\t\t\tscope.position0.copy( scope.object.position );\n\t\t\tscope.zoom0 = scope.object.zoom;\n\n\t\t};\n\n\t\tthis.reset = function () {\n\n\t\t\tscope.target.copy( scope.target0 );\n\t\t\tscope.object.position.copy( scope.position0 );\n\t\t\tscope.object.zoom = scope.zoom0;\n\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\tscope.update();\n\n\t\t\tstate = STATE.NONE;\n\n\t\t};\n\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\n\t\tthis.update = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\t// so camera.up is the orbit axis\n\t\t\tconst quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\t\tconst quatInverse = quat.clone().invert();\n\n\t\t\tconst lastPosition = new Vector3();\n\t\t\tconst lastQuaternion = new Quaternion();\n\n\t\t\tconst twoPI = 2 * Math.PI;\n\n\t\t\treturn function update() {\n\n\t\t\t\tconst position = scope.object.position;\n\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t\t// angle from z-axis around y-axis\n\t\t\t\tspherical.setFromVector3( offset );\n\n\t\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t\t}\n\n\t\t\t\t// restrict theta to be between desired limits\n\n\t\t\t\tlet min = scope.minAzimuthAngle;\n\t\t\t\tlet max = scope.maxAzimuthAngle;\n\n\t\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\n\n\t\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\n\n\t\t\t\t\tif ( min <= max ) {\n\n\t\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\t\t\tMath.max( min, spherical.theta ) :\n\t\t\t\t\t\t\tMath.min( max, spherical.theta );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// restrict phi to be between desired limits\n\t\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\t\tspherical.makeSafe();\n\n\n\t\t\t\tspherical.radius *= scale;\n\n\t\t\t\t// restrict radius to be between desired limits\n\t\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t\t// move target to panned location\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t\t}\n\n\t\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t\tscale = 1;\n\n\t\t\t\t// update condition is:\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\t\tif ( zoomChanged ||\n\t\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\t\tzoomChanged = false;\n\n\t\t\t\t\treturn true;\n\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.dispose = function () {\n\n\t\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\n\n\t\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\tscope.domElement.removeEventListener( 'pointercancel', onPointerCancel );\n\t\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\n\n\t\t\tscope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\n\t\t\tif ( scope._domElementKeyEvents !== null ) {\n\n\t\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\n\n\t\t\t}\n\n\t\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t\t};\n\n\t\t//\n\t\t// internals\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tconst STATE = {\n\t\t\tNONE: - 1,\n\t\t\tROTATE: 0,\n\t\t\tDOLLY: 1,\n\t\t\tPAN: 2,\n\t\t\tTOUCH_ROTATE: 3,\n\t\t\tTOUCH_PAN: 4,\n\t\t\tTOUCH_DOLLY_PAN: 5,\n\t\t\tTOUCH_DOLLY_ROTATE: 6\n\t\t};\n\n\t\tlet state = STATE.NONE;\n\n\t\tconst EPS = 0.000001;\n\n\t\t// current position in spherical coordinates\n\t\tconst spherical = new Spherical();\n\t\tconst sphericalDelta = new Spherical();\n\n\t\tlet scale = 1;\n\t\tconst panOffset = new Vector3();\n\t\tlet zoomChanged = false;\n\n\t\tconst rotateStart = new Vector2();\n\t\tconst rotateEnd = new Vector2();\n\t\tconst rotateDelta = new Vector2();\n\n\t\tconst panStart = new Vector2();\n\t\tconst panEnd = new Vector2();\n\t\tconst panDelta = new Vector2();\n\n\t\tconst dollyStart = new Vector2();\n\t\tconst dollyEnd = new Vector2();\n\t\tconst dollyDelta = new Vector2();\n\n\t\tconst pointers = [];\n\t\tconst pointerPositions = {};\n\n\t\tfunction getAutoRotationAngle() {\n\n\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t\t}\n\n\t\tfunction getZoomScale() {\n\n\t\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t\t}\n\n\t\tfunction rotateLeft( angle ) {\n\n\t\t\tsphericalDelta.theta -= angle;\n\n\t\t}\n\n\t\tfunction rotateUp( angle ) {\n\n\t\t\tsphericalDelta.phi -= angle;\n\n\t\t}\n\n\t\tconst panLeft = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\t\tv.multiplyScalar( - distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tconst panUp = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t\t}\n\n\t\t\t\tv.multiplyScalar( distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\t// deltaX and deltaY are in pixels; right and down are positive\n\t\tconst pan = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\t\tconst element = scope.domElement;\n\n\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t// perspective\n\t\t\t\t\tconst position = scope.object.position;\n\t\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\t\tlet targetDistance = offset.length();\n\n\t\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\t// orthographic\n\t\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\t\tscope.enablePan = false;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}();\n\n\t\tfunction dollyOut( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale /= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction dollyIn( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale *= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\t\t// event callbacks - update the object state\n\t\t//\n\n\t\tfunction handleMouseDownRotate( event ) {\n\n\t\t\trotateStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownDolly( event ) {\n\n\t\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownPan( event ) {\n\n\t\t\tpanStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseMoveRotate( event ) {\n\n\t\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMoveDolly( event ) {\n\n\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMovePan( event ) {\n\n\t\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseWheel( event ) {\n\n\t\t\tif ( event.deltaY < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleKeyDown( event ) {\n\n\t\t\tlet needsUpdate = false;\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase scope.keys.UP:\n\t\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.LEFT:\n\t\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.RIGHT:\n\t\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( needsUpdate ) {\n\n\t\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tscope.update();\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tfunction handleTouchStartRotate() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\trotateStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\trotateStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartPan() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\tpanStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartDolly() {\n\n\t\t\tconst dx = pointers[ 0 ].pageX - pointers[ 1 ].pageX;\n\t\t\tconst dy = pointers[ 0 ].pageY - pointers[ 1 ].pageY;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyStart.set( 0, distance );\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyPan() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enablePan ) handleTouchStartPan();\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyRotate() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enableRotate ) handleTouchStartRotate();\n\n\t\t}\n\n\t\tfunction handleTouchMoveRotate( event ) {\n\n\t\t\tif ( pointers.length == 1 ) {\n\n\t\t\t\trotateEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\trotateEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMovePan( event ) {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\tpanEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDolly( event ) {\n\n\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\tconst dx = event.pageX - position.x;\n\t\t\tconst dy = event.pageY - position.y;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyEnd.set( 0, distance );\n\n\t\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\t\tdollyOut( dollyDelta.y );\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t\t}\n\n\t\t//\n\t\t// event handlers - FSM: listen for events and reset state\n\t\t//\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( pointers.length === 0 ) {\n\n\t\t\t\tscope.domElement.setPointerCapture( event.pointerId );\n\n\t\t\t\tscope.domElement.addEventListener( 'pointermove', onPointerMove );\n\t\t\t\tscope.domElement.addEventListener( 'pointerup', onPointerUp );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\taddPointer( event );\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchStart( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseDown( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchMove( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseMove( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerUp( event ) {\n\n\t\t    removePointer( event );\n\n\t\t    if ( pointers.length === 0 ) {\n\n\t\t        scope.domElement.releasePointerCapture( event.pointerId );\n\n\t\t        scope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t        scope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\t\t    }\n\n\t\t    scope.dispatchEvent( _endEvent );\n\n\t\t    state = STATE.NONE;\n\n\t\t}\n\n\t\tfunction onPointerCancel( event ) {\n\n\t\t\tremovePointer( event );\n\n\t\t}\n\n\t\tfunction onMouseDown( event ) {\n\n\t\t\tlet mouseAction;\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tmouseAction = - 1;\n\n\t\t\t}\n\n\t\t\tswitch ( mouseAction ) {\n\n\t\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseWheel( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\thandleMouseWheel( event );\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t}\n\n\t\tfunction onKeyDown( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\n\n\t\t\thandleKeyDown( event );\n\n\t\t}\n\n\t\tfunction onTouchStart( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( pointers.length ) {\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onTouchMove( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onContextMenu( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t}\n\n\t\tfunction addPointer( event ) {\n\n\t\t\tpointers.push( event );\n\n\t\t}\n\n\t\tfunction removePointer( event ) {\n\n\t\t\tdelete pointerPositions[ event.pointerId ];\n\n\t\t\tfor ( let i = 0; i < pointers.length; i ++ ) {\n\n\t\t\t\tif ( pointers[ i ].pointerId == event.pointerId ) {\n\n\t\t\t\t\tpointers.splice( i, 1 );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction trackPointer( event ) {\n\n\t\t\tlet position = pointerPositions[ event.pointerId ];\n\n\t\t\tif ( position === undefined ) {\n\n\t\t\t\tposition = new Vector2();\n\t\t\t\tpointerPositions[ event.pointerId ] = position;\n\n\t\t\t}\n\n\t\t\tposition.set( event.pageX, event.pageY );\n\n\t\t}\n\n\t\tfunction getSecondPointerPosition( event ) {\n\n\t\t\tconst pointer = ( event.pointerId === pointers[ 0 ].pointerId ) ? pointers[ 1 ] : pointers[ 0 ];\n\n\t\t\treturn pointerPositions[ pointer.pointerId ];\n\n\t\t}\n\n\t\t//\n\n\t\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\n\n\t\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\tscope.domElement.addEventListener( 'pointercancel', onPointerCancel );\n\t\tscope.domElement.addEventListener( 'wheel', onMouseWheel, { passive: false } );\n\n\t\t// force an update at start\n\n\t\tthis.update();\n\n\t}\n\n}\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nclass MapControls extends OrbitControls {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper( object, domElement );\n\n\t\tthis.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\n\n\t\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\t\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\t\tthis.touches.ONE = TOUCH.PAN;\n\t\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n\t}\n\n}\n\nexport { OrbitControls, MapControls };\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{ref:\"canvas-container\",attrs:{\"id\":\"canvas-container\"}},[_c('div',{staticClass:\"loading-container\",class:{\n            'loading-container--hidden': _vm.loadingStat.isLoaded,\n            'loading-container--none': _vm.loadingStat.noLoadingStat\n        }},[_c('div',{staticClass:\"load-stat\"},[_c('div',{staticClass:\"load-pgbar\",style:({\n                    width: 100 * _vm.loadingStat.loaded / _vm.loadingStat.total + '%'\n                })}),_c('div',{staticClass:\"load-text\"},[_vm._v(_vm._s(Math.round(100 * _vm.loadingStat.loaded / _vm.loadingStat.total))+\" %\")])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*!\nfflate - fast JavaScript compression/decompression\n<https://101arrowz.github.io/fflate>\nLicensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE\nversion 0.6.9\n*/\n\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar durl = function (c) { return URL.createObjectURL(new Blob([c], { type: 'text/javascript' })); };\nvar cwk = function (u) { return new Worker(u); };\ntry {\n    URL.revokeObjectURL(durl(''));\n}\ncatch (e) {\n    // We're in Deno or a very old browser\n    durl = function (c) { return 'data:application/javascript;charset=UTF-8,' + encodeURI(c); };\n    // If Deno, this is necessary; if not, this changes nothing\n    cwk = function (u) { return new Worker(u, { type: 'module' }); };\n}\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = cwk(ch2[id] || (ch2[id] = durl(c)));\n    w.onerror = function (e) { return cb(e.error, null); };\n    w.onmessage = function (e) { return cb(null, e.data); };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p / 8) | 0) + (p & 7 && 1); };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && !st.l && sl < 5))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            st.f = final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                throw 'invalid block type';\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n            if (!c)\n                throw 'invalid length/literal';\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    throw 'invalid distance';\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new u32(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && 0xEDB88320) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, hMap, max, bits, bits16, shft, slc, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (t)\n            throw 'stream finished';\n        if (!strm.ondata)\n            throw 'no stream handler';\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        throw 'invalid gzip data';\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        throw 'invalid zlib data';\n    if (d[1] & 32)\n        throw 'invalid zlib data: preset dictionaries not supported';\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                throw 'invalid gzip stream';\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                throw 'invalid zlib stream';\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no stream handler';\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    throw 'invalid utf-8 data';\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            throw 'stream finished';\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                throw 'invalid utf-8 data';\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        if (this.d)\n            throw 'stream finished';\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            throw 'invalid utf-8 data';\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                throw 'extra field too long';\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        throw 'date not in range 1980-2099';\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != null) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback - add to ZIP archive before pushing';\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (this.d & 2)\n            throw 'stream finished';\n        var f = strToU8(file.filename), fl = f.length;\n        var com = file.comment, o = com && strToU8(com);\n        var u = fl != file.filename.length || (o && (com.length != o.length));\n        var hl = fl + exfl(file.extra) + 30;\n        if (fl > 65535)\n            throw 'filename too long';\n        var header = new u8(hl);\n        wzh(header, 0, file, f, u);\n        var chks = [header];\n        var pAll = function () {\n            for (var _i = 0, chks_1 = chks; _i < chks_1.length; _i++) {\n                var chk = chks_1[_i];\n                _this_1.ondata(null, chk, false);\n            }\n            chks = [];\n        };\n        var tr = this.d;\n        this.d = 0;\n        var ind = this.u.length;\n        var uf = mrg(file, {\n            f: f,\n            u: u,\n            o: o,\n            t: function () {\n                if (file.terminate)\n                    file.terminate();\n            },\n            r: function () {\n                pAll();\n                if (tr) {\n                    var nxt = _this_1.u[ind + 1];\n                    if (nxt)\n                        nxt.r();\n                    else\n                        _this_1.d = 1;\n                }\n                tr = 1;\n            }\n        });\n        var cl = 0;\n        file.ondata = function (err, dat, final) {\n            if (err) {\n                _this_1.ondata(err, dat, final);\n                _this_1.terminate();\n            }\n            else {\n                cl += dat.length;\n                chks.push(dat);\n                if (final) {\n                    var dd = new u8(16);\n                    wbytes(dd, 0, 0x8074B50);\n                    wbytes(dd, 4, file.crc);\n                    wbytes(dd, 8, cl);\n                    wbytes(dd, 12, file.size);\n                    chks.push(dd);\n                    uf.c = cl, uf.b = hl + cl + 16, uf.crc = file.crc, uf.size = file.size;\n                    if (tr)\n                        uf.r();\n                    tr = 1;\n                }\n                else if (tr)\n                    pAll();\n            }\n        };\n        this.u.push(uf);\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            if (this.d & 1)\n                throw 'stream finishing';\n            throw 'stream finished';\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cb(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cb(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl('filename too long', null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            throw 'filename too long';\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, data, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            throw 'no callback';\n        if (!this.p)\n            throw 'stream finished';\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_2 = [];\n                        this_1.k.unshift(chks_2);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    throw 'no callback';\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        throw 'unknown compression type ' + cmp_1;\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_3 = chks_2; _i < chks_3.length; _i++) {\n                                        var dat = chks_3[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_2 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                throw 'invalid zip file';\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data, cb) {\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cb('invalid zip file', null);\n            return;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (!lft)\n        cb(null, {});\n    var c = lft;\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50) {\n            cb('invalid zip file', null);\n            return;\n        }\n        c = lft = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var _loop_3 = function (i) {\n        var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                files[fn] = d;\n                if (!--lft)\n                    cb(null, files);\n            }\n        };\n        if (!c_1)\n            cbl(null, slc(data, b, b + sc));\n        else if (c_1 == 8) {\n            var infl = data.subarray(b, b + sc);\n            if (sc < 320000) {\n                try {\n                    cbl(null, inflateSync(infl, new u8(su)));\n                }\n                catch (e) {\n                    cbl(e, null);\n                }\n            }\n            else\n                term.push(inflate(infl, { size: su }, cbl));\n        }\n        else\n            cbl('unknown compression type ' + c_1, null);\n    };\n    for (var i = 0; i < c; ++i) {\n        _loop_3(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            throw 'invalid zip file';\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!c_2)\n            files[fn] = slc(data, b, b + sc);\n        else if (c_2 == 8)\n            files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n        else\n            throw 'unknown compression type ' + c_2;\n    }\n    return files;\n}\n","import {\n\tVector3,\n\tVector4\n} from 'three';\n\n/**\n * NURBS utils\n *\n * See NURBSCurve and NURBSSurface.\n **/\n\n\n/**************************************************************\n *\tNURBS Utils\n **************************************************************/\n\n/*\nFinds knot vector span.\n\np : degree\nu : parametric value\nU : knot vector\n\nreturns the span\n*/\nfunction findSpan( p, u, U ) {\n\n\tconst n = U.length - p - 1;\n\n\tif ( u >= U[ n ] ) {\n\n\t\treturn n - 1;\n\n\t}\n\n\tif ( u <= U[ p ] ) {\n\n\t\treturn p;\n\n\t}\n\n\tlet low = p;\n\tlet high = n;\n\tlet mid = Math.floor( ( low + high ) / 2 );\n\n\twhile ( u < U[ mid ] || u >= U[ mid + 1 ] ) {\n\n\t\tif ( u < U[ mid ] ) {\n\n\t\t\thigh = mid;\n\n\t\t} else {\n\n\t\t\tlow = mid;\n\n\t\t}\n\n\t\tmid = Math.floor( ( low + high ) / 2 );\n\n\t}\n\n\treturn mid;\n\n}\n\n\n/*\nCalculate basis functions. See The NURBS Book, page 70, algorithm A2.2\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nU    : knot vector\n\nreturns array[p+1] with basis functions values.\n*/\nfunction calcBasisFunctions( span, u, p, U ) {\n\n\tconst N = [];\n\tconst left = [];\n\tconst right = [];\n\tN[ 0 ] = 1.0;\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tconst temp = N[ r ] / ( rv + lv );\n\t\t\tN[ r ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tN[ j ] = saved;\n\n\t}\n\n\treturn N;\n\n}\n\n\n/*\nCalculate B-Spline curve points. See The NURBS Book, page 82, algorithm A3.1.\n\np : degree of B-Spline\nU : knot vector\nP : control points (x, y, z, w)\nu : parametric point\n\nreturns point for given u\n*/\nfunction calcBSplinePoint( p, U, P, u ) {\n\n\tconst span = findSpan( p, u, U );\n\tconst N = calcBasisFunctions( span, u, p, U );\n\tconst C = new Vector4( 0, 0, 0, 0 );\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tconst point = P[ span - p + j ];\n\t\tconst Nj = N[ j ];\n\t\tconst wNj = point.w * Nj;\n\t\tC.x += point.x * wNj;\n\t\tC.y += point.y * wNj;\n\t\tC.z += point.z * wNj;\n\t\tC.w += point.w * Nj;\n\n\t}\n\n\treturn C;\n\n}\n\n\n/*\nCalculate basis functions derivatives. See The NURBS Book, page 72, algorithm A2.3.\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nn    : number of derivatives to calculate\nU    : knot vector\n\nreturns array[n+1][p+1] with basis functions derivatives\n*/\nfunction calcBasisFunctionDerivatives( span, u, p, n, U ) {\n\n\tconst zeroArr = [];\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tzeroArr[ i ] = 0.0;\n\n\tconst ders = [];\n\n\tfor ( let i = 0; i <= n; ++ i )\n\t\tders[ i ] = zeroArr.slice( 0 );\n\n\tconst ndu = [];\n\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tndu[ i ] = zeroArr.slice( 0 );\n\n\tndu[ 0 ][ 0 ] = 1.0;\n\n\tconst left = zeroArr.slice( 0 );\n\tconst right = zeroArr.slice( 0 );\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tndu[ j ][ r ] = rv + lv;\n\n\t\t\tconst temp = ndu[ r ][ j - 1 ] / ndu[ j ][ r ];\n\t\t\tndu[ r ][ j ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tndu[ j ][ j ] = saved;\n\n\t}\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tders[ 0 ][ j ] = ndu[ j ][ p ];\n\n\t}\n\n\tfor ( let r = 0; r <= p; ++ r ) {\n\n\t\tlet s1 = 0;\n\t\tlet s2 = 1;\n\n\t\tconst a = [];\n\t\tfor ( let i = 0; i <= p; ++ i ) {\n\n\t\t\ta[ i ] = zeroArr.slice( 0 );\n\n\t\t}\n\n\t\ta[ 0 ][ 0 ] = 1.0;\n\n\t\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\t\tlet d = 0.0;\n\t\t\tconst rk = r - k;\n\t\t\tconst pk = p - k;\n\n\t\t\tif ( r >= k ) {\n\n\t\t\t\ta[ s2 ][ 0 ] = a[ s1 ][ 0 ] / ndu[ pk + 1 ][ rk ];\n\t\t\t\td = a[ s2 ][ 0 ] * ndu[ rk ][ pk ];\n\n\t\t\t}\n\n\t\t\tconst j1 = ( rk >= - 1 ) ? 1 : - rk;\n\t\t\tconst j2 = ( r - 1 <= pk ) ? k - 1 : p - r;\n\n\t\t\tfor ( let j = j1; j <= j2; ++ j ) {\n\n\t\t\t\ta[ s2 ][ j ] = ( a[ s1 ][ j ] - a[ s1 ][ j - 1 ] ) / ndu[ pk + 1 ][ rk + j ];\n\t\t\t\td += a[ s2 ][ j ] * ndu[ rk + j ][ pk ];\n\n\t\t\t}\n\n\t\t\tif ( r <= pk ) {\n\n\t\t\t\ta[ s2 ][ k ] = - a[ s1 ][ k - 1 ] / ndu[ pk + 1 ][ r ];\n\t\t\t\td += a[ s2 ][ k ] * ndu[ r ][ pk ];\n\n\t\t\t}\n\n\t\t\tders[ k ][ r ] = d;\n\n\t\t\tconst j = s1;\n\t\t\ts1 = s2;\n\t\t\ts2 = j;\n\n\t\t}\n\n\t}\n\n\tlet r = p;\n\n\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\t\tders[ k ][ j ] *= r;\n\n\t\t}\n\n\t\tr *= p - k;\n\n\t}\n\n\treturn ders;\n\n}\n\n\n/*\n\tCalculate derivatives of a B-Spline. See The NURBS Book, page 93, algorithm A3.2.\n\n\tp  : degree\n\tU  : knot vector\n\tP  : control points\n\tu  : Parametric points\n\tnd : number of derivatives\n\n\treturns array[d+1] with derivatives\n\t*/\nfunction calcBSplineDerivatives( p, U, P, u, nd ) {\n\n\tconst du = nd < p ? nd : p;\n\tconst CK = [];\n\tconst span = findSpan( p, u, U );\n\tconst nders = calcBasisFunctionDerivatives( span, u, p, du, U );\n\tconst Pw = [];\n\n\tfor ( let i = 0; i < P.length; ++ i ) {\n\n\t\tconst point = P[ i ].clone();\n\t\tconst w = point.w;\n\n\t\tpoint.x *= w;\n\t\tpoint.y *= w;\n\t\tpoint.z *= w;\n\n\t\tPw[ i ] = point;\n\n\t}\n\n\tfor ( let k = 0; k <= du; ++ k ) {\n\n\t\tconst point = Pw[ span - p ].clone().multiplyScalar( nders[ k ][ 0 ] );\n\n\t\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\t\tpoint.add( Pw[ span - p + j ].clone().multiplyScalar( nders[ k ][ j ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = point;\n\n\t}\n\n\tfor ( let k = du + 1; k <= nd + 1; ++ k ) {\n\n\t\tCK[ k ] = new Vector4( 0, 0, 0 );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate \"K over I\"\n\nreturns k!/(i!(k-i)!)\n*/\nfunction calcKoverI( k, i ) {\n\n\tlet nom = 1;\n\n\tfor ( let j = 2; j <= k; ++ j ) {\n\n\t\tnom *= j;\n\n\t}\n\n\tlet denom = 1;\n\n\tfor ( let j = 2; j <= i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\tfor ( let j = 2; j <= k - i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\treturn nom / denom;\n\n}\n\n\n/*\nCalculate derivatives (0-nd) of rational curve. See The NURBS Book, page 127, algorithm A4.2.\n\nPders : result of function calcBSplineDerivatives\n\nreturns array with derivatives for rational curve.\n*/\nfunction calcRationalCurveDerivatives( Pders ) {\n\n\tconst nd = Pders.length;\n\tconst Aders = [];\n\tconst wders = [];\n\n\tfor ( let i = 0; i < nd; ++ i ) {\n\n\t\tconst point = Pders[ i ];\n\t\tAders[ i ] = new Vector3( point.x, point.y, point.z );\n\t\twders[ i ] = point.w;\n\n\t}\n\n\tconst CK = [];\n\n\tfor ( let k = 0; k < nd; ++ k ) {\n\n\t\tconst v = Aders[ k ].clone();\n\n\t\tfor ( let i = 1; i <= k; ++ i ) {\n\n\t\t\tv.sub( CK[ k - i ].clone().multiplyScalar( calcKoverI( k, i ) * wders[ i ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = v.divideScalar( wders[ 0 ] );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate NURBS curve derivatives. See The NURBS Book, page 127, algorithm A4.2.\n\np  : degree\nU  : knot vector\nP  : control points in homogeneous space\nu  : parametric points\nnd : number of derivatives\n\nreturns array with derivatives.\n*/\nfunction calcNURBSDerivatives( p, U, P, u, nd ) {\n\n\tconst Pders = calcBSplineDerivatives( p, U, P, u, nd );\n\treturn calcRationalCurveDerivatives( Pders );\n\n}\n\n\n/*\nCalculate rational B-Spline surface point. See The NURBS Book, page 134, algorithm A4.3.\n\np1, p2 : degrees of B-Spline surface\nU1, U2 : knot vectors\nP      : control points (x, y, z, w)\nu, v   : parametric values\n\nreturns point for given (u, v)\n*/\nfunction calcSurfacePoint( p, q, U, V, P, u, v, target ) {\n\n\tconst uspan = findSpan( p, u, U );\n\tconst vspan = findSpan( q, v, V );\n\tconst Nu = calcBasisFunctions( uspan, u, p, U );\n\tconst Nv = calcBasisFunctions( vspan, v, q, V );\n\tconst temp = [];\n\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\ttemp[ l ] = new Vector4( 0, 0, 0, 0 );\n\t\tfor ( let k = 0; k <= p; ++ k ) {\n\n\t\t\tconst point = P[ uspan - p + k ][ vspan - q + l ].clone();\n\t\t\tconst w = point.w;\n\t\t\tpoint.x *= w;\n\t\t\tpoint.y *= w;\n\t\t\tpoint.z *= w;\n\t\t\ttemp[ l ].add( point.multiplyScalar( Nu[ k ] ) );\n\n\t\t}\n\n\t}\n\n\tconst Sw = new Vector4( 0, 0, 0, 0 );\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\tSw.add( temp[ l ].multiplyScalar( Nv[ l ] ) );\n\n\t}\n\n\tSw.divideScalar( Sw.w );\n\ttarget.set( Sw.x, Sw.y, Sw.z );\n\n}\n\n\n\nexport {\n\tfindSpan,\n\tcalcBasisFunctions,\n\tcalcBSplinePoint,\n\tcalcBasisFunctionDerivatives,\n\tcalcBSplineDerivatives,\n\tcalcKoverI,\n\tcalcRationalCurveDerivatives,\n\tcalcNURBSDerivatives,\n\tcalcSurfacePoint,\n};\n","import {\n\tCurve,\n\tVector3,\n\tVector4\n} from 'three';\nimport * as NURBSUtils from '../curves/NURBSUtils.js';\n\n/**\n * NURBS curve object\n *\n * Derives from Curve, overriding getPoint and getTangent.\n *\n * Implementation is based on (x, y [, z=0 [, w=1]]) control points with w=weight.\n *\n **/\n\nclass NURBSCurve extends Curve {\n\n\tconstructor(\n\t\tdegree,\n\t\tknots /* array of reals */,\n\t\tcontrolPoints /* array of Vector(2|3|4) */,\n\t\tstartKnot /* index in knots */,\n\t\tendKnot /* index in knots */\n\t) {\n\n\t\tsuper();\n\n\t\tthis.degree = degree;\n\t\tthis.knots = knots;\n\t\tthis.controlPoints = [];\n\t\t// Used by periodic NURBS to remove hidden spans\n\t\tthis.startKnot = startKnot || 0;\n\t\tthis.endKnot = endKnot || ( this.knots.length - 1 );\n\n\t\tfor ( let i = 0; i < controlPoints.length; ++ i ) {\n\n\t\t\t// ensure Vector4 for control points\n\t\t\tconst point = controlPoints[ i ];\n\t\t\tthis.controlPoints[ i ] = new Vector4( point.x, point.y, point.z, point.w );\n\n\t\t}\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst u = this.knots[ this.startKnot ] + t * ( this.knots[ this.endKnot ] - this.knots[ this.startKnot ] ); // linear mapping t->u\n\n\t\t// following results in (wx, wy, wz, w) homogeneous point\n\t\tconst hpoint = NURBSUtils.calcBSplinePoint( this.degree, this.knots, this.controlPoints, u );\n\n\t\tif ( hpoint.w !== 1.0 ) {\n\n\t\t\t// project to 3D space: (wx, wy, wz, w) -> (x, y, z, 1)\n\t\t\thpoint.divideScalar( hpoint.w );\n\n\t\t}\n\n\t\treturn point.set( hpoint.x, hpoint.y, hpoint.z );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector3() ) {\n\n\t\tconst tangent = optionalTarget;\n\n\t\tconst u = this.knots[ 0 ] + t * ( this.knots[ this.knots.length - 1 ] - this.knots[ 0 ] );\n\t\tconst ders = NURBSUtils.calcNURBSDerivatives( this.degree, this.knots, this.controlPoints, u, 1 );\n\t\ttangent.copy( ders[ 1 ] ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n}\n\nexport { NURBSCurve };\n","import {\n\tAmbientLight,\n\tAnimationClip,\n\tBone,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tEquirectangularReflectionMapping,\n\tEuler,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLine,\n\tLineBasicMaterial,\n\tLoader,\n\tLoaderUtils,\n\tMathUtils,\n\tMatrix3,\n\tMatrix4,\n\tMesh,\n\tMeshLambertMaterial,\n\tMeshPhongMaterial,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tUint16BufferAttribute,\n\tVector3,\n\tVector4,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\nimport * as fflate from '../libs/fflate.module.js';\nimport { NURBSCurve } from '../curves/NURBSCurve.js';\n\n/**\n * Loader loads FBX file and generates Group representing FBX scene.\n * Requires FBX file to be >= 7.0 and in ASCII or >= 6400 in Binary format\n * Versions lower than this may load but will probably have errors\n *\n * Needs Support:\n *  Morph normals / blend shape normals\n *\n * FBX format references:\n * \thttps://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_index_html (C++ SDK reference)\n *\n * Binary format specification:\n *\thttps://code.blender.org/2013/08/fbx-binary-file-format-specification/\n */\n\n\nlet fbxTree;\nlet connections;\nlet sceneGraph;\n\nclass FBXLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( scope.path === '' ) ? LoaderUtils.extractUrlBase( url ) : scope.path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( buffer, path ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( FBXBuffer, path ) {\n\n\t\tif ( isFbxFormatBinary( FBXBuffer ) ) {\n\n\t\t\tfbxTree = new BinaryParser().parse( FBXBuffer );\n\n\t\t} else {\n\n\t\t\tconst FBXText = convertArrayBufferToString( FBXBuffer );\n\n\t\t\tif ( ! isFbxFormatASCII( FBXText ) ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown format.' );\n\n\t\t\t}\n\n\t\t\tif ( getFbxVersion( FBXText ) < 7000 ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + getFbxVersion( FBXText ) );\n\n\t\t\t}\n\n\t\t\tfbxTree = new TextParser().parse( FBXText );\n\n\t\t}\n\n\t\t// console.log( fbxTree );\n\n\t\tconst textureLoader = new TextureLoader( this.manager ).setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n\t\treturn new FBXTreeParser( textureLoader, this.manager ).parse( fbxTree );\n\n\t}\n\n}\n\n// Parse the FBXTree object returned by the BinaryParser or TextParser and return a Group\nclass FBXTreeParser {\n\n\tconstructor( textureLoader, manager ) {\n\n\t\tthis.textureLoader = textureLoader;\n\t\tthis.manager = manager;\n\n\t}\n\n\tparse() {\n\n\t\tconnections = this.parseConnections();\n\n\t\tconst images = this.parseImages();\n\t\tconst textures = this.parseTextures( images );\n\t\tconst materials = this.parseMaterials( textures );\n\t\tconst deformers = this.parseDeformers();\n\t\tconst geometryMap = new GeometryParser().parse( deformers );\n\n\t\tthis.parseScene( deformers, geometryMap, materials );\n\n\t\treturn sceneGraph;\n\n\t}\n\n\t// Parses FBXTree.Connections which holds parent-child connections between objects (e.g. material -> texture, model->geometry )\n\t// and details the connection type\n\tparseConnections() {\n\n\t\tconst connectionMap = new Map();\n\n\t\tif ( 'Connections' in fbxTree ) {\n\n\t\t\tconst rawConnections = fbxTree.Connections.connections;\n\n\t\t\trawConnections.forEach( function ( rawConnection ) {\n\n\t\t\t\tconst fromID = rawConnection[ 0 ];\n\t\t\t\tconst toID = rawConnection[ 1 ];\n\t\t\t\tconst relationship = rawConnection[ 2 ];\n\n\t\t\t\tif ( ! connectionMap.has( fromID ) ) {\n\n\t\t\t\t\tconnectionMap.set( fromID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst parentRelationship = { ID: toID, relationship: relationship };\n\t\t\t\tconnectionMap.get( fromID ).parents.push( parentRelationship );\n\n\t\t\t\tif ( ! connectionMap.has( toID ) ) {\n\n\t\t\t\t\tconnectionMap.set( toID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst childRelationship = { ID: fromID, relationship: relationship };\n\t\t\t\tconnectionMap.get( toID ).children.push( childRelationship );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn connectionMap;\n\n\t}\n\n\t// Parse FBXTree.Objects.Video for embedded image data\n\t// These images are connected to textures in FBXTree.Objects.Textures\n\t// via FBXTree.Connections.\n\tparseImages() {\n\n\t\tconst images = {};\n\t\tconst blobs = {};\n\n\t\tif ( 'Video' in fbxTree.Objects ) {\n\n\t\t\tconst videoNodes = fbxTree.Objects.Video;\n\n\t\t\tfor ( const nodeID in videoNodes ) {\n\n\t\t\t\tconst videoNode = videoNodes[ nodeID ];\n\n\t\t\t\tconst id = parseInt( nodeID );\n\n\t\t\t\timages[ id ] = videoNode.RelativeFilename || videoNode.Filename;\n\n\t\t\t\t// raw image data is in videoNode.Content\n\t\t\t\tif ( 'Content' in videoNode ) {\n\n\t\t\t\t\tconst arrayBufferContent = ( videoNode.Content instanceof ArrayBuffer ) && ( videoNode.Content.byteLength > 0 );\n\t\t\t\t\tconst base64Content = ( typeof videoNode.Content === 'string' ) && ( videoNode.Content !== '' );\n\n\t\t\t\t\tif ( arrayBufferContent || base64Content ) {\n\n\t\t\t\t\t\tconst image = this.parseImage( videoNodes[ nodeID ] );\n\n\t\t\t\t\t\tblobs[ videoNode.RelativeFilename || videoNode.Filename ] = image;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const id in images ) {\n\n\t\t\tconst filename = images[ id ];\n\n\t\t\tif ( blobs[ filename ] !== undefined ) images[ id ] = blobs[ filename ];\n\t\t\telse images[ id ] = images[ id ].split( '\\\\' ).pop();\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\t// Parse embedded image data in FBXTree.Video.Content\n\tparseImage( videoNode ) {\n\n\t\tconst content = videoNode.Content;\n\t\tconst fileName = videoNode.RelativeFilename || videoNode.Filename;\n\t\tconst extension = fileName.slice( fileName.lastIndexOf( '.' ) + 1 ).toLowerCase();\n\n\t\tlet type;\n\n\t\tswitch ( extension ) {\n\n\t\t\tcase 'bmp':\n\n\t\t\t\ttype = 'image/bmp';\n\t\t\t\tbreak;\n\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\n\t\t\t\ttype = 'image/jpeg';\n\t\t\t\tbreak;\n\n\t\t\tcase 'png':\n\n\t\t\t\ttype = 'image/png';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tif':\n\n\t\t\t\ttype = 'image/tiff';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tga':\n\n\t\t\t\tif ( this.manager.getHandler( '.tga' ) === null ) {\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, skipping ', fileName );\n\n\t\t\t\t}\n\n\t\t\t\ttype = 'image/tga';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'FBXLoader: Image type \"' + extension + '\" is not supported.' );\n\t\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof content === 'string' ) { // ASCII format\n\n\t\t\treturn 'data:' + type + ';base64,' + content;\n\n\t\t} else { // Binary Format\n\n\t\t\tconst array = new Uint8Array( content );\n\t\t\treturn window.URL.createObjectURL( new Blob( [ array ], { type: type } ) );\n\n\t\t}\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Texture\n\t// These contain details such as UV scaling, cropping, rotation etc and are connected\n\t// to images in FBXTree.Objects.Video\n\tparseTextures( images ) {\n\n\t\tconst textureMap = new Map();\n\n\t\tif ( 'Texture' in fbxTree.Objects ) {\n\n\t\t\tconst textureNodes = fbxTree.Objects.Texture;\n\t\t\tfor ( const nodeID in textureNodes ) {\n\n\t\t\t\tconst texture = this.parseTexture( textureNodes[ nodeID ], images );\n\t\t\t\ttextureMap.set( parseInt( nodeID ), texture );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textureMap;\n\n\t}\n\n\t// Parse individual node in FBXTree.Objects.Texture\n\tparseTexture( textureNode, images ) {\n\n\t\tconst texture = this.loadTexture( textureNode, images );\n\n\t\ttexture.ID = textureNode.id;\n\n\t\ttexture.name = textureNode.attrName;\n\n\t\tconst wrapModeU = textureNode.WrapModeU;\n\t\tconst wrapModeV = textureNode.WrapModeV;\n\n\t\tconst valueU = wrapModeU !== undefined ? wrapModeU.value : 0;\n\t\tconst valueV = wrapModeV !== undefined ? wrapModeV.value : 0;\n\n\t\t// http://download.autodesk.com/us/fbx/SDKdocs/FBX_SDK_Help/files/fbxsdkref/class_k_fbx_texture.html#889640e63e2e681259ea81061b85143a\n\t\t// 0: repeat(default), 1: clamp\n\n\t\ttexture.wrapS = valueU === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\t\ttexture.wrapT = valueV === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\n\t\tif ( 'Scaling' in textureNode ) {\n\n\t\t\tconst values = textureNode.Scaling.value;\n\n\t\t\ttexture.repeat.x = values[ 0 ];\n\t\t\ttexture.repeat.y = values[ 1 ];\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\t// load a texture specified as a blob or data URI, or via an external URL using TextureLoader\n\tloadTexture( textureNode, images ) {\n\n\t\tlet fileName;\n\n\t\tconst currentPath = this.textureLoader.path;\n\n\t\tconst children = connections.get( textureNode.id ).children;\n\n\t\tif ( children !== undefined && children.length > 0 && images[ children[ 0 ].ID ] !== undefined ) {\n\n\t\t\tfileName = images[ children[ 0 ].ID ];\n\n\t\t\tif ( fileName.indexOf( 'blob:' ) === 0 || fileName.indexOf( 'data:' ) === 0 ) {\n\n\t\t\t\tthis.textureLoader.setPath( undefined );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet texture;\n\n\t\tconst extension = textureNode.FileName.slice( - 3 ).toLowerCase();\n\n\t\tif ( extension === 'tga' ) {\n\n\t\t\tconst loader = this.manager.getHandler( '.tga' );\n\n\t\t\tif ( loader === null ) {\n\n\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\t\ttexture = new Texture();\n\n\t\t\t} else {\n\n\t\t\t\tloader.setPath( this.textureLoader.path );\n\t\t\t\ttexture = loader.load( fileName );\n\n\t\t\t}\n\n\t\t} else if ( extension === 'psd' ) {\n\n\t\t\tconsole.warn( 'FBXLoader: PSD textures are not supported, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\ttexture = new Texture();\n\n\t\t} else {\n\n\t\t\ttexture = this.textureLoader.load( fileName );\n\n\t\t}\n\n\t\tthis.textureLoader.setPath( currentPath );\n\n\t\treturn texture;\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Material\n\tparseMaterials( textureMap ) {\n\n\t\tconst materialMap = new Map();\n\n\t\tif ( 'Material' in fbxTree.Objects ) {\n\n\t\t\tconst materialNodes = fbxTree.Objects.Material;\n\n\t\t\tfor ( const nodeID in materialNodes ) {\n\n\t\t\t\tconst material = this.parseMaterial( materialNodes[ nodeID ], textureMap );\n\n\t\t\t\tif ( material !== null ) materialMap.set( parseInt( nodeID ), material );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materialMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Material\n\t// Materials are connected to texture maps in FBXTree.Objects.Textures\n\t// FBX format currently only supports Lambert and Phong shading models\n\tparseMaterial( materialNode, textureMap ) {\n\n\t\tconst ID = materialNode.id;\n\t\tconst name = materialNode.attrName;\n\t\tlet type = materialNode.ShadingModel;\n\n\t\t// Case where FBX wraps shading model in property object.\n\t\tif ( typeof type === 'object' ) {\n\n\t\t\ttype = type.value;\n\n\t\t}\n\n\t\t// Ignore unused materials which don't have any connections.\n\t\tif ( ! connections.has( ID ) ) return null;\n\n\t\tconst parameters = this.parseParameters( materialNode, textureMap, ID );\n\n\t\tlet material;\n\n\t\tswitch ( type.toLowerCase() ) {\n\n\t\t\tcase 'phong':\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\t\t\tcase 'lambert':\n\t\t\t\tmaterial = new MeshLambertMaterial();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: unknown material type \"%s\". Defaulting to MeshPhongMaterial.', type );\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tmaterial.setValues( parameters );\n\t\tmaterial.name = name;\n\n\t\treturn material;\n\n\t}\n\n\t// Parse FBX material and return parameters suitable for a three.js material\n\t// Also parse the texture map and return any textures associated with the material\n\tparseParameters( materialNode, textureMap, ID ) {\n\n\t\tconst parameters = {};\n\n\t\tif ( materialNode.BumpFactor ) {\n\n\t\t\tparameters.bumpScale = materialNode.BumpFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Diffuse ) {\n\n\t\t\tparameters.color = new Color().fromArray( materialNode.Diffuse.value );\n\n\t\t} else if ( materialNode.DiffuseColor && ( materialNode.DiffuseColor.type === 'Color' || materialNode.DiffuseColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports diffuse here instead of in materialNode.Diffuse\n\t\t\tparameters.color = new Color().fromArray( materialNode.DiffuseColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.DisplacementFactor ) {\n\n\t\t\tparameters.displacementScale = materialNode.DisplacementFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Emissive ) {\n\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.Emissive.value );\n\n\t\t} else if ( materialNode.EmissiveColor && ( materialNode.EmissiveColor.type === 'Color' || materialNode.EmissiveColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports emissive color here instead of in materialNode.Emissive\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.EmissiveColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.EmissiveFactor ) {\n\n\t\t\tparameters.emissiveIntensity = parseFloat( materialNode.EmissiveFactor.value );\n\n\t\t}\n\n\t\tif ( materialNode.Opacity ) {\n\n\t\t\tparameters.opacity = parseFloat( materialNode.Opacity.value );\n\n\t\t}\n\n\t\tif ( parameters.opacity < 1.0 ) {\n\n\t\t\tparameters.transparent = true;\n\n\t\t}\n\n\t\tif ( materialNode.ReflectionFactor ) {\n\n\t\t\tparameters.reflectivity = materialNode.ReflectionFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Shininess ) {\n\n\t\t\tparameters.shininess = materialNode.Shininess.value;\n\n\t\t}\n\n\t\tif ( materialNode.Specular ) {\n\n\t\t\tparameters.specular = new Color().fromArray( materialNode.Specular.value );\n\n\t\t} else if ( materialNode.SpecularColor && materialNode.SpecularColor.type === 'Color' ) {\n\n\t\t\t// The blender exporter exports specular color here instead of in materialNode.Specular\n\t\t\tparameters.specular = new Color().fromArray( materialNode.SpecularColor.value );\n\n\t\t}\n\n\t\tconst scope = this;\n\t\tconnections.get( ID ).children.forEach( function ( child ) {\n\n\t\t\tconst type = child.relationship;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'Bump':\n\t\t\t\t\tparameters.bumpMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Maya|TEX_ao_map':\n\t\t\t\t\tparameters.aoMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DiffuseColor':\n\t\t\t\tcase 'Maya|TEX_color_map':\n\t\t\t\t\tparameters.map = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.map !== undefined ) {\n\n\t\t\t\t\t\tparameters.map.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DisplacementColor':\n\t\t\t\t\tparameters.displacementMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'EmissiveColor':\n\t\t\t\t\tparameters.emissiveMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.emissiveMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'NormalMap':\n\t\t\t\tcase 'Maya|TEX_normal_map':\n\t\t\t\t\tparameters.normalMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ReflectionColor':\n\t\t\t\t\tparameters.envMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.envMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.envMap.mapping = EquirectangularReflectionMapping;\n\t\t\t\t\t\tparameters.envMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpecularColor':\n\t\t\t\t\tparameters.specularMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.specularMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.specularMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'TransparentColor':\n\t\t\t\tcase 'TransparencyFactor':\n\t\t\t\t\tparameters.alphaMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.transparent = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'AmbientColor':\n\t\t\t\tcase 'ShininessExponent': // AKA glossiness map\n\t\t\t\tcase 'SpecularFactor': // AKA specularLevel\n\t\t\t\tcase 'VectorDisplacementColor': // NOTE: Seems to be a copy of DisplacementColor\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: %s map is not supported in three.js, skipping texture.', type );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn parameters;\n\n\t}\n\n\t// get a texture from the textureMap for use by a material.\n\tgetTexture( textureMap, id ) {\n\n\t\t// if the texture is a layered texture, just use the first layer and issue a warning\n\t\tif ( 'LayeredTexture' in fbxTree.Objects && id in fbxTree.Objects.LayeredTexture ) {\n\n\t\t\tconsole.warn( 'THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.' );\n\t\t\tid = connections.get( id ).children[ 0 ].ID;\n\n\t\t}\n\n\t\treturn textureMap.get( id );\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Deformer\n\t// Deformer node can contain skinning or Vertex Cache animation data, however only skinning is supported here\n\t// Generates map of Skeleton-like objects for use later when generating and binding skeletons.\n\tparseDeformers() {\n\n\t\tconst skeletons = {};\n\t\tconst morphTargets = {};\n\n\t\tif ( 'Deformer' in fbxTree.Objects ) {\n\n\t\t\tconst DeformerNodes = fbxTree.Objects.Deformer;\n\n\t\t\tfor ( const nodeID in DeformerNodes ) {\n\n\t\t\t\tconst deformerNode = DeformerNodes[ nodeID ];\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\n\t\t\t\tif ( deformerNode.attrType === 'Skin' ) {\n\n\t\t\t\t\tconst skeleton = this.parseSkeleton( relationships, DeformerNodes );\n\t\t\t\t\tskeleton.ID = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: skeleton attached to more than one geometry is not supported.' );\n\t\t\t\t\tskeleton.geometryID = relationships.parents[ 0 ].ID;\n\n\t\t\t\t\tskeletons[ nodeID ] = skeleton;\n\n\t\t\t\t} else if ( deformerNode.attrType === 'BlendShape' ) {\n\n\t\t\t\t\tconst morphTarget = {\n\t\t\t\t\t\tid: nodeID,\n\t\t\t\t\t};\n\n\t\t\t\t\tmorphTarget.rawTargets = this.parseMorphTargets( relationships, DeformerNodes );\n\t\t\t\t\tmorphTarget.id = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: morph target attached to more than one geometry is not supported.' );\n\n\t\t\t\t\tmorphTargets[ nodeID ] = morphTarget;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tskeletons: skeletons,\n\t\t\tmorphTargets: morphTargets,\n\n\t\t};\n\n\t}\n\n\t// Parse single nodes in FBXTree.Objects.Deformer\n\t// The top level skeleton node has type 'Skin' and sub nodes have type 'Cluster'\n\t// Each skin node represents a skeleton and each cluster node represents a bone\n\tparseSkeleton( relationships, deformerNodes ) {\n\n\t\tconst rawBones = [];\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst boneNode = deformerNodes[ child.ID ];\n\n\t\t\tif ( boneNode.attrType !== 'Cluster' ) return;\n\n\t\t\tconst rawBone = {\n\n\t\t\t\tID: child.ID,\n\t\t\t\tindices: [],\n\t\t\t\tweights: [],\n\t\t\t\ttransformLink: new Matrix4().fromArray( boneNode.TransformLink.a ),\n\t\t\t\t// transform: new Matrix4().fromArray( boneNode.Transform.a ),\n\t\t\t\t// linkMode: boneNode.Mode,\n\n\t\t\t};\n\n\t\t\tif ( 'Indexes' in boneNode ) {\n\n\t\t\t\trawBone.indices = boneNode.Indexes.a;\n\t\t\t\trawBone.weights = boneNode.Weights.a;\n\n\t\t\t}\n\n\t\t\trawBones.push( rawBone );\n\n\t\t} );\n\n\t\treturn {\n\n\t\t\trawBones: rawBones,\n\t\t\tbones: []\n\n\t\t};\n\n\t}\n\n\t// The top level morph deformer node has type \"BlendShape\" and sub nodes have type \"BlendShapeChannel\"\n\tparseMorphTargets( relationships, deformerNodes ) {\n\n\t\tconst rawMorphTargets = [];\n\n\t\tfor ( let i = 0; i < relationships.children.length; i ++ ) {\n\n\t\t\tconst child = relationships.children[ i ];\n\n\t\t\tconst morphTargetNode = deformerNodes[ child.ID ];\n\n\t\t\tconst rawMorphTarget = {\n\n\t\t\t\tname: morphTargetNode.attrName,\n\t\t\t\tinitialWeight: morphTargetNode.DeformPercent,\n\t\t\t\tid: morphTargetNode.id,\n\t\t\t\tfullWeights: morphTargetNode.FullWeights.a\n\n\t\t\t};\n\n\t\t\tif ( morphTargetNode.attrType !== 'BlendShapeChannel' ) return;\n\n\t\t\trawMorphTarget.geoID = connections.get( parseInt( child.ID ) ).children.filter( function ( child ) {\n\n\t\t\t\treturn child.relationship === undefined;\n\n\t\t\t} )[ 0 ].ID;\n\n\t\t\trawMorphTargets.push( rawMorphTarget );\n\n\t\t}\n\n\t\treturn rawMorphTargets;\n\n\t}\n\n\t// create the main Group() to be returned by the loader\n\tparseScene( deformers, geometryMap, materialMap ) {\n\n\t\tsceneGraph = new Group();\n\n\t\tconst modelMap = this.parseModels( deformers.skeletons, geometryMap, materialMap );\n\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tconst scope = this;\n\t\tmodelMap.forEach( function ( model ) {\n\n\t\t\tconst modelNode = modelNodes[ model.ID ];\n\t\t\tscope.setLookAtProperties( model, modelNode );\n\n\t\t\tconst parentConnections = connections.get( model.ID ).parents;\n\n\t\t\tparentConnections.forEach( function ( connection ) {\n\n\t\t\t\tconst parent = modelMap.get( connection.ID );\n\t\t\t\tif ( parent !== undefined ) parent.add( model );\n\n\t\t\t} );\n\n\t\t\tif ( model.parent === null ) {\n\n\t\t\t\tsceneGraph.add( model );\n\n\t\t\t}\n\n\n\t\t} );\n\n\t\tthis.bindSkeleton( deformers.skeletons, geometryMap, modelMap );\n\n\t\tthis.createAmbientLight();\n\n\t\tsceneGraph.traverse( function ( node ) {\n\n\t\t\tif ( node.userData.transformData ) {\n\n\t\t\t\tif ( node.parent ) {\n\n\t\t\t\t\tnode.userData.transformData.parentMatrix = node.parent.matrix;\n\t\t\t\t\tnode.userData.transformData.parentMatrixWorld = node.parent.matrixWorld;\n\n\t\t\t\t}\n\n\t\t\t\tconst transform = generateTransform( node.userData.transformData );\n\n\t\t\t\tnode.applyMatrix4( transform );\n\t\t\t\tnode.updateWorldMatrix();\n\n\t\t\t}\n\n\t\t} );\n\n\t\tconst animations = new AnimationParser().parse();\n\n\t\t// if all the models where already combined in a single group, just return that\n\t\tif ( sceneGraph.children.length === 1 && sceneGraph.children[ 0 ].isGroup ) {\n\n\t\t\tsceneGraph.children[ 0 ].animations = animations;\n\t\t\tsceneGraph = sceneGraph.children[ 0 ];\n\n\t\t}\n\n\t\tsceneGraph.animations = animations;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.Model\n\tparseModels( skeletons, geometryMap, materialMap ) {\n\n\t\tconst modelMap = new Map();\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tfor ( const nodeID in modelNodes ) {\n\n\t\t\tconst id = parseInt( nodeID );\n\t\t\tconst node = modelNodes[ nodeID ];\n\t\t\tconst relationships = connections.get( id );\n\n\t\t\tlet model = this.buildSkeleton( relationships, skeletons, id, node.attrName );\n\n\t\t\tif ( ! model ) {\n\n\t\t\t\tswitch ( node.attrType ) {\n\n\t\t\t\t\tcase 'Camera':\n\t\t\t\t\t\tmodel = this.createCamera( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Light':\n\t\t\t\t\t\tmodel = this.createLight( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Mesh':\n\t\t\t\t\t\tmodel = this.createMesh( relationships, geometryMap, materialMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'NurbsCurve':\n\t\t\t\t\t\tmodel = this.createCurve( relationships, geometryMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'LimbNode':\n\t\t\t\t\tcase 'Root':\n\t\t\t\t\t\tmodel = new Bone();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Null':\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmodel = new Group();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tmodel.name = node.attrName ? PropertyBinding.sanitizeNodeName( node.attrName ) : '';\n\n\t\t\t\tmodel.ID = id;\n\n\t\t\t}\n\n\t\t\tthis.getTransformData( model, node );\n\t\t\tmodelMap.set( id, model );\n\n\t\t}\n\n\t\treturn modelMap;\n\n\t}\n\n\tbuildSkeleton( relationships, skeletons, id, name ) {\n\n\t\tlet bone = null;\n\n\t\trelationships.parents.forEach( function ( parent ) {\n\n\t\t\tfor ( const ID in skeletons ) {\n\n\t\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t\tif ( rawBone.ID === parent.ID ) {\n\n\t\t\t\t\t\tconst subBone = bone;\n\t\t\t\t\t\tbone = new Bone();\n\n\t\t\t\t\t\tbone.matrixWorld.copy( rawBone.transformLink );\n\n\t\t\t\t\t\t// set name and id here - otherwise in cases where \"subBone\" is created it will not have a name / id\n\n\t\t\t\t\t\tbone.name = name ? PropertyBinding.sanitizeNodeName( name ) : '';\n\t\t\t\t\t\tbone.ID = id;\n\n\t\t\t\t\t\tskeleton.bones[ i ] = bone;\n\n\t\t\t\t\t\t// In cases where a bone is shared between multiple meshes\n\t\t\t\t\t\t// duplicate the bone here and and it as a child of the first bone\n\t\t\t\t\t\tif ( subBone !== null ) {\n\n\t\t\t\t\t\t\tbone.add( subBone );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn bone;\n\n\t}\n\n\t// create a PerspectiveCamera or OrthographicCamera\n\tcreateCamera( relationships ) {\n\n\t\tlet model;\n\t\tlet cameraAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tcameraAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( cameraAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type = 0;\n\t\t\tif ( cameraAttribute.CameraProjectionType !== undefined && cameraAttribute.CameraProjectionType.value === 1 ) {\n\n\t\t\t\ttype = 1;\n\n\t\t\t}\n\n\t\t\tlet nearClippingPlane = 1;\n\t\t\tif ( cameraAttribute.NearPlane !== undefined ) {\n\n\t\t\t\tnearClippingPlane = cameraAttribute.NearPlane.value / 1000;\n\n\t\t\t}\n\n\t\t\tlet farClippingPlane = 1000;\n\t\t\tif ( cameraAttribute.FarPlane !== undefined ) {\n\n\t\t\t\tfarClippingPlane = cameraAttribute.FarPlane.value / 1000;\n\n\t\t\t}\n\n\n\t\t\tlet width = window.innerWidth;\n\t\t\tlet height = window.innerHeight;\n\n\t\t\tif ( cameraAttribute.AspectWidth !== undefined && cameraAttribute.AspectHeight !== undefined ) {\n\n\t\t\t\twidth = cameraAttribute.AspectWidth.value;\n\t\t\t\theight = cameraAttribute.AspectHeight.value;\n\n\t\t\t}\n\n\t\t\tconst aspect = width / height;\n\n\t\t\tlet fov = 45;\n\t\t\tif ( cameraAttribute.FieldOfView !== undefined ) {\n\n\t\t\t\tfov = cameraAttribute.FieldOfView.value;\n\n\t\t\t}\n\n\t\t\tconst focalLength = cameraAttribute.FocalLength ? cameraAttribute.FocalLength.value : null;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Perspective\n\t\t\t\t\tmodel = new PerspectiveCamera( fov, aspect, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tif ( focalLength !== null ) model.setFocalLength( focalLength );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Orthographic\n\t\t\t\t\tmodel = new OrthographicCamera( - width / 2, width / 2, height / 2, - height / 2, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown camera type ' + type + '.' );\n\t\t\t\t\tmodel = new Object3D();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\t// Create a DirectionalLight, PointLight or SpotLight\n\tcreateLight( relationships ) {\n\n\t\tlet model;\n\t\tlet lightAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tlightAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( lightAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type;\n\n\t\t\t// LightType can be undefined for Point lights\n\t\t\tif ( lightAttribute.LightType === undefined ) {\n\n\t\t\t\ttype = 0;\n\n\t\t\t} else {\n\n\t\t\t\ttype = lightAttribute.LightType.value;\n\n\t\t\t}\n\n\t\t\tlet color = 0xffffff;\n\n\t\t\tif ( lightAttribute.Color !== undefined ) {\n\n\t\t\t\tcolor = new Color().fromArray( lightAttribute.Color.value );\n\n\t\t\t}\n\n\t\t\tlet intensity = ( lightAttribute.Intensity === undefined ) ? 1 : lightAttribute.Intensity.value / 100;\n\n\t\t\t// light disabled\n\t\t\tif ( lightAttribute.CastLightOnObject !== undefined && lightAttribute.CastLightOnObject.value === 0 ) {\n\n\t\t\t\tintensity = 0;\n\n\t\t\t}\n\n\t\t\tlet distance = 0;\n\t\t\tif ( lightAttribute.FarAttenuationEnd !== undefined ) {\n\n\t\t\t\tif ( lightAttribute.EnableFarAttenuation !== undefined && lightAttribute.EnableFarAttenuation.value === 0 ) {\n\n\t\t\t\t\tdistance = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdistance = lightAttribute.FarAttenuationEnd.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// TODO: could this be calculated linearly from FarAttenuationStart to FarAttenuationEnd?\n\t\t\tconst decay = 1;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Point\n\t\t\t\t\tmodel = new PointLight( color, intensity, distance, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Directional\n\t\t\t\t\tmodel = new DirectionalLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2: // Spot\n\t\t\t\t\tlet angle = Math.PI / 3;\n\n\t\t\t\t\tif ( lightAttribute.InnerAngle !== undefined ) {\n\n\t\t\t\t\t\tangle = MathUtils.degToRad( lightAttribute.InnerAngle.value );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet penumbra = 0;\n\t\t\t\t\tif ( lightAttribute.OuterAngle !== undefined ) {\n\n\t\t\t\t\t\t// TODO: this is not correct - FBX calculates outer and inner angle in degrees\n\t\t\t\t\t\t// with OuterAngle > InnerAngle && OuterAngle <= Math.PI\n\t\t\t\t\t\t// while three.js uses a penumbra between (0, 1) to attenuate the inner angle\n\t\t\t\t\t\tpenumbra = MathUtils.degToRad( lightAttribute.OuterAngle.value );\n\t\t\t\t\t\tpenumbra = Math.max( penumbra, 1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmodel = new SpotLight( color, intensity, distance, angle, penumbra, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown light type ' + lightAttribute.LightType.value + ', defaulting to a PointLight.' );\n\t\t\t\t\tmodel = new PointLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( lightAttribute.CastShadows !== undefined && lightAttribute.CastShadows.value === 1 ) {\n\n\t\t\t\tmodel.castShadow = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateMesh( relationships, geometryMap, materialMap ) {\n\n\t\tlet model;\n\t\tlet geometry = null;\n\t\tlet material = null;\n\t\tconst materials = [];\n\n\t\t// get geometry and materials(s) from connections\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) {\n\n\t\t\t\tgeometry = geometryMap.get( child.ID );\n\n\t\t\t}\n\n\t\t\tif ( materialMap.has( child.ID ) ) {\n\n\t\t\t\tmaterials.push( materialMap.get( child.ID ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( materials.length > 1 ) {\n\n\t\t\tmaterial = materials;\n\n\t\t} else if ( materials.length > 0 ) {\n\n\t\t\tmaterial = materials[ 0 ];\n\n\t\t} else {\n\n\t\t\tmaterial = new MeshPhongMaterial( { color: 0xcccccc } );\n\t\t\tmaterials.push( material );\n\n\t\t}\n\n\t\tif ( 'color' in geometry.attributes ) {\n\n\t\t\tmaterials.forEach( function ( material ) {\n\n\t\t\t\tmaterial.vertexColors = true;\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( geometry.FBX_Deformer ) {\n\n\t\t\tmodel = new SkinnedMesh( geometry, material );\n\t\t\tmodel.normalizeSkinWeights();\n\n\t\t} else {\n\n\t\t\tmodel = new Mesh( geometry, material );\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateCurve( relationships, geometryMap ) {\n\n\t\tconst geometry = relationships.children.reduce( function ( geo, child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) geo = geometryMap.get( child.ID );\n\n\t\t\treturn geo;\n\n\t\t}, null );\n\n\t\t// FBX does not list materials for Nurbs lines, so we'll just put our own in here.\n\t\tconst material = new LineBasicMaterial( { color: 0x3300ff, linewidth: 1 } );\n\t\treturn new Line( geometry, material );\n\n\t}\n\n\t// parse the model node for transform data\n\tgetTransformData( model, modelNode ) {\n\n\t\tconst transformData = {};\n\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\telse transformData.eulerOrder = 'ZYX';\n\n\t\tif ( 'Lcl_Translation' in modelNode ) transformData.translation = modelNode.Lcl_Translation.value;\n\n\t\tif ( 'PreRotation' in modelNode ) transformData.preRotation = modelNode.PreRotation.value;\n\t\tif ( 'Lcl_Rotation' in modelNode ) transformData.rotation = modelNode.Lcl_Rotation.value;\n\t\tif ( 'PostRotation' in modelNode ) transformData.postRotation = modelNode.PostRotation.value;\n\n\t\tif ( 'Lcl_Scaling' in modelNode ) transformData.scale = modelNode.Lcl_Scaling.value;\n\n\t\tif ( 'ScalingOffset' in modelNode ) transformData.scalingOffset = modelNode.ScalingOffset.value;\n\t\tif ( 'ScalingPivot' in modelNode ) transformData.scalingPivot = modelNode.ScalingPivot.value;\n\n\t\tif ( 'RotationOffset' in modelNode ) transformData.rotationOffset = modelNode.RotationOffset.value;\n\t\tif ( 'RotationPivot' in modelNode ) transformData.rotationPivot = modelNode.RotationPivot.value;\n\n\t\tmodel.userData.transformData = transformData;\n\n\t}\n\n\tsetLookAtProperties( model, modelNode ) {\n\n\t\tif ( 'LookAtProperty' in modelNode ) {\n\n\t\t\tconst children = connections.get( model.ID ).children;\n\n\t\t\tchildren.forEach( function ( child ) {\n\n\t\t\t\tif ( child.relationship === 'LookAtProperty' ) {\n\n\t\t\t\t\tconst lookAtTarget = fbxTree.Objects.Model[ child.ID ];\n\n\t\t\t\t\tif ( 'Lcl_Translation' in lookAtTarget ) {\n\n\t\t\t\t\t\tconst pos = lookAtTarget.Lcl_Translation.value;\n\n\t\t\t\t\t\t// DirectionalLight, SpotLight\n\t\t\t\t\t\tif ( model.target !== undefined ) {\n\n\t\t\t\t\t\t\tmodel.target.position.fromArray( pos );\n\t\t\t\t\t\t\tsceneGraph.add( model.target );\n\n\t\t\t\t\t\t} else { // Cameras and other Object3Ds\n\n\t\t\t\t\t\t\tmodel.lookAt( new Vector3().fromArray( pos ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tbindSkeleton( skeletons, geometryMap, modelMap ) {\n\n\t\tconst bindMatrices = this.parsePoseNodes();\n\n\t\tfor ( const ID in skeletons ) {\n\n\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\tconst parents = connections.get( parseInt( skeleton.ID ) ).parents;\n\n\t\t\tparents.forEach( function ( parent ) {\n\n\t\t\t\tif ( geometryMap.has( parent.ID ) ) {\n\n\t\t\t\t\tconst geoID = parent.ID;\n\t\t\t\t\tconst geoRelationships = connections.get( geoID );\n\n\t\t\t\t\tgeoRelationships.parents.forEach( function ( geoConnParent ) {\n\n\t\t\t\t\t\tif ( modelMap.has( geoConnParent.ID ) ) {\n\n\t\t\t\t\t\t\tconst model = modelMap.get( geoConnParent.ID );\n\n\t\t\t\t\t\t\tmodel.bind( new Skeleton( skeleton.bones ), bindMatrices[ geoConnParent.ID ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tparsePoseNodes() {\n\n\t\tconst bindMatrices = {};\n\n\t\tif ( 'Pose' in fbxTree.Objects ) {\n\n\t\t\tconst BindPoseNode = fbxTree.Objects.Pose;\n\n\t\t\tfor ( const nodeID in BindPoseNode ) {\n\n\t\t\t\tif ( BindPoseNode[ nodeID ].attrType === 'BindPose' && BindPoseNode[ nodeID ].NbPoseNodes > 0 ) {\n\n\t\t\t\t\tconst poseNodes = BindPoseNode[ nodeID ].PoseNode;\n\n\t\t\t\t\tif ( Array.isArray( poseNodes ) ) {\n\n\t\t\t\t\t\tposeNodes.forEach( function ( poseNode ) {\n\n\t\t\t\t\t\t\tbindMatrices[ poseNode.Node ] = new Matrix4().fromArray( poseNode.Matrix.a );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbindMatrices[ poseNodes.Node ] = new Matrix4().fromArray( poseNodes.Matrix.a );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindMatrices;\n\n\t}\n\n\t// Parse ambient color in FBXTree.GlobalSettings - if it's not set to black (default), create an ambient light\n\tcreateAmbientLight() {\n\n\t\tif ( 'GlobalSettings' in fbxTree && 'AmbientColor' in fbxTree.GlobalSettings ) {\n\n\t\t\tconst ambientColor = fbxTree.GlobalSettings.AmbientColor.value;\n\t\t\tconst r = ambientColor[ 0 ];\n\t\t\tconst g = ambientColor[ 1 ];\n\t\t\tconst b = ambientColor[ 2 ];\n\n\t\t\tif ( r !== 0 || g !== 0 || b !== 0 ) {\n\n\t\t\t\tconst color = new Color( r, g, b );\n\t\t\t\tsceneGraph.add( new AmbientLight( color, 1 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse Geometry data from FBXTree and return map of BufferGeometries\nclass GeometryParser {\n\n\t// Parse nodes in FBXTree.Objects.Geometry\n\tparse( deformers ) {\n\n\t\tconst geometryMap = new Map();\n\n\t\tif ( 'Geometry' in fbxTree.Objects ) {\n\n\t\t\tconst geoNodes = fbxTree.Objects.Geometry;\n\n\t\t\tfor ( const nodeID in geoNodes ) {\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\t\t\t\tconst geo = this.parseGeometry( relationships, geoNodes[ nodeID ], deformers );\n\n\t\t\t\tgeometryMap.set( parseInt( nodeID ), geo );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometryMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Geometry\n\tparseGeometry( relationships, geoNode, deformers ) {\n\n\t\tswitch ( geoNode.attrType ) {\n\n\t\t\tcase 'Mesh':\n\t\t\t\treturn this.parseMeshGeometry( relationships, geoNode, deformers );\n\t\t\t\tbreak;\n\n\t\t\tcase 'NurbsCurve':\n\t\t\t\treturn this.parseNurbsGeometry( geoNode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\t// Parse single node mesh geometry in FBXTree.Objects.Geometry\n\tparseMeshGeometry( relationships, geoNode, deformers ) {\n\n\t\tconst skeletons = deformers.skeletons;\n\t\tconst morphTargets = [];\n\n\t\tconst modelNodes = relationships.parents.map( function ( parent ) {\n\n\t\t\treturn fbxTree.Objects.Model[ parent.ID ];\n\n\t\t} );\n\n\t\t// don't create geometry if it is not associated with any models\n\t\tif ( modelNodes.length === 0 ) return;\n\n\t\tconst skeleton = relationships.children.reduce( function ( skeleton, child ) {\n\n\t\t\tif ( skeletons[ child.ID ] !== undefined ) skeleton = skeletons[ child.ID ];\n\n\t\t\treturn skeleton;\n\n\t\t}, null );\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( deformers.morphTargets[ child.ID ] !== undefined ) {\n\n\t\t\t\tmorphTargets.push( deformers.morphTargets[ child.ID ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\t// Assume one model and get the preRotation from that\n\t\t// if there is more than one model associated with the geometry this may cause problems\n\t\tconst modelNode = modelNodes[ 0 ];\n\n\t\tconst transformData = {};\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'GeometricTranslation' in modelNode ) transformData.translation = modelNode.GeometricTranslation.value;\n\t\tif ( 'GeometricRotation' in modelNode ) transformData.rotation = modelNode.GeometricRotation.value;\n\t\tif ( 'GeometricScaling' in modelNode ) transformData.scale = modelNode.GeometricScaling.value;\n\n\t\tconst transform = generateTransform( transformData );\n\n\t\treturn this.genGeometry( geoNode, skeleton, morphTargets, transform );\n\n\t}\n\n\t// Generate a BufferGeometry from a node in FBXTree.Objects.Geometry\n\tgenGeometry( geoNode, skeleton, morphTargets, preTransform ) {\n\n\t\tconst geo = new BufferGeometry();\n\t\tif ( geoNode.attrName ) geo.name = geoNode.attrName;\n\n\t\tconst geoInfo = this.parseGeoNode( geoNode, skeleton );\n\t\tconst buffers = this.genBuffers( geoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( buffers.vertex, 3 );\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tgeo.setAttribute( 'position', positionAttribute );\n\n\t\tif ( buffers.colors.length > 0 ) {\n\n\t\t\tgeo.setAttribute( 'color', new Float32BufferAttribute( buffers.colors, 3 ) );\n\n\t\t}\n\n\t\tif ( skeleton ) {\n\n\t\t\tgeo.setAttribute( 'skinIndex', new Uint16BufferAttribute( buffers.weightsIndices, 4 ) );\n\n\t\t\tgeo.setAttribute( 'skinWeight', new Float32BufferAttribute( buffers.vertexWeights, 4 ) );\n\n\t\t\t// used later to bind the skeleton to the model\n\t\t\tgeo.FBX_Deformer = skeleton;\n\n\t\t}\n\n\t\tif ( buffers.normal.length > 0 ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( preTransform );\n\n\t\t\tconst normalAttribute = new Float32BufferAttribute( buffers.normal, 3 );\n\t\t\tnormalAttribute.applyNormalMatrix( normalMatrix );\n\n\t\t\tgeo.setAttribute( 'normal', normalAttribute );\n\n\t\t}\n\n\t\tbuffers.uvs.forEach( function ( uvBuffer, i ) {\n\n\t\t\t// subsequent uv buffers are called 'uv1', 'uv2', ...\n\t\t\tlet name = 'uv' + ( i + 1 ).toString();\n\n\t\t\t// the first uv buffer is just called 'uv'\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tname = 'uv';\n\n\t\t\t}\n\n\t\t\tgeo.setAttribute( name, new Float32BufferAttribute( buffers.uvs[ i ], 2 ) );\n\n\t\t} );\n\n\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t// Convert the material indices of each vertex into rendering groups on the geometry.\n\t\t\tlet prevMaterialIndex = buffers.materialIndex[ 0 ];\n\t\t\tlet startIndex = 0;\n\n\t\t\tbuffers.materialIndex.forEach( function ( currentIndex, i ) {\n\n\t\t\t\tif ( currentIndex !== prevMaterialIndex ) {\n\n\t\t\t\t\tgeo.addGroup( startIndex, i - startIndex, prevMaterialIndex );\n\n\t\t\t\t\tprevMaterialIndex = currentIndex;\n\t\t\t\t\tstartIndex = i;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t// the loop above doesn't add the last group, do that here.\n\t\t\tif ( geo.groups.length > 0 ) {\n\n\t\t\t\tconst lastGroup = geo.groups[ geo.groups.length - 1 ];\n\t\t\t\tconst lastIndex = lastGroup.start + lastGroup.count;\n\n\t\t\t\tif ( lastIndex !== buffers.materialIndex.length ) {\n\n\t\t\t\t\tgeo.addGroup( lastIndex, buffers.materialIndex.length - lastIndex, prevMaterialIndex );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// case where there are multiple materials but the whole geometry is only\n\t\t\t// using one of them\n\t\t\tif ( geo.groups.length === 0 ) {\n\n\t\t\t\tgeo.addGroup( 0, buffers.materialIndex.length, buffers.materialIndex[ 0 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.addMorphTargets( geo, geoNode, morphTargets, preTransform );\n\n\t\treturn geo;\n\n\t}\n\n\tparseGeoNode( geoNode, skeleton ) {\n\n\t\tconst geoInfo = {};\n\n\t\tgeoInfo.vertexPositions = ( geoNode.Vertices !== undefined ) ? geoNode.Vertices.a : [];\n\t\tgeoInfo.vertexIndices = ( geoNode.PolygonVertexIndex !== undefined ) ? geoNode.PolygonVertexIndex.a : [];\n\n\t\tif ( geoNode.LayerElementColor ) {\n\n\t\t\tgeoInfo.color = this.parseVertexColors( geoNode.LayerElementColor[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementMaterial ) {\n\n\t\t\tgeoInfo.material = this.parseMaterialIndices( geoNode.LayerElementMaterial[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementNormal ) {\n\n\t\t\tgeoInfo.normal = this.parseNormals( geoNode.LayerElementNormal[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementUV ) {\n\n\t\t\tgeoInfo.uv = [];\n\n\t\t\tlet i = 0;\n\t\t\twhile ( geoNode.LayerElementUV[ i ] ) {\n\n\t\t\t\tif ( geoNode.LayerElementUV[ i ].UV ) {\n\n\t\t\t\t\tgeoInfo.uv.push( this.parseUVs( geoNode.LayerElementUV[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeoInfo.weightTable = {};\n\n\t\tif ( skeleton !== null ) {\n\n\t\t\tgeoInfo.skeleton = skeleton;\n\n\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t// loop over the bone's vertex indices and weights\n\t\t\t\trawBone.indices.forEach( function ( index, j ) {\n\n\t\t\t\t\tif ( geoInfo.weightTable[ index ] === undefined ) geoInfo.weightTable[ index ] = [];\n\n\t\t\t\t\tgeoInfo.weightTable[ index ].push( {\n\n\t\t\t\t\t\tid: i,\n\t\t\t\t\t\tweight: rawBone.weights[ j ],\n\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn geoInfo;\n\n\t}\n\n\tgenBuffers( geoInfo ) {\n\n\t\tconst buffers = {\n\t\t\tvertex: [],\n\t\t\tnormal: [],\n\t\t\tcolors: [],\n\t\t\tuvs: [],\n\t\t\tmaterialIndex: [],\n\t\t\tvertexWeights: [],\n\t\t\tweightsIndices: [],\n\t\t};\n\n\t\tlet polygonIndex = 0;\n\t\tlet faceLength = 0;\n\t\tlet displayedWeightsWarning = false;\n\n\t\t// these will hold data for a single face\n\t\tlet facePositionIndexes = [];\n\t\tlet faceNormals = [];\n\t\tlet faceColors = [];\n\t\tlet faceUVs = [];\n\t\tlet faceWeights = [];\n\t\tlet faceWeightIndices = [];\n\n\t\tconst scope = this;\n\t\tgeoInfo.vertexIndices.forEach( function ( vertexIndex, polygonVertexIndex ) {\n\n\t\t\tlet materialIndex;\n\t\t\tlet endOfFace = false;\n\n\t\t\t// Face index and vertex index arrays are combined in a single array\n\t\t\t// A cube with quad faces looks like this:\n\t\t\t// PolygonVertexIndex: *24 {\n\t\t\t//  a: 0, 1, 3, -3, 2, 3, 5, -5, 4, 5, 7, -7, 6, 7, 1, -1, 1, 7, 5, -4, 6, 0, 2, -5\n\t\t\t//  }\n\t\t\t// Negative numbers mark the end of a face - first face here is 0, 1, 3, -3\n\t\t\t// to find index of last vertex bit shift the index: ^ - 1\n\t\t\tif ( vertexIndex < 0 ) {\n\n\t\t\t\tvertexIndex = vertexIndex ^ - 1; // equivalent to ( x * -1 ) - 1\n\t\t\t\tendOfFace = true;\n\n\t\t\t}\n\n\t\t\tlet weightIndices = [];\n\t\t\tlet weights = [];\n\n\t\t\tfacePositionIndexes.push( vertexIndex * 3, vertexIndex * 3 + 1, vertexIndex * 3 + 2 );\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.color );\n\n\t\t\t\tfaceColors.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tif ( geoInfo.weightTable[ vertexIndex ] !== undefined ) {\n\n\t\t\t\t\tgeoInfo.weightTable[ vertexIndex ].forEach( function ( wt ) {\n\n\t\t\t\t\t\tweights.push( wt.weight );\n\t\t\t\t\t\tweightIndices.push( wt.id );\n\n\t\t\t\t\t} );\n\n\n\t\t\t\t}\n\n\t\t\t\tif ( weights.length > 4 ) {\n\n\t\t\t\t\tif ( ! displayedWeightsWarning ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.' );\n\t\t\t\t\t\tdisplayedWeightsWarning = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst wIndex = [ 0, 0, 0, 0 ];\n\t\t\t\t\tconst Weight = [ 0, 0, 0, 0 ];\n\n\t\t\t\t\tweights.forEach( function ( weight, weightIndex ) {\n\n\t\t\t\t\t\tlet currentWeight = weight;\n\t\t\t\t\t\tlet currentIndex = weightIndices[ weightIndex ];\n\n\t\t\t\t\t\tWeight.forEach( function ( comparedWeight, comparedWeightIndex, comparedWeightArray ) {\n\n\t\t\t\t\t\t\tif ( currentWeight > comparedWeight ) {\n\n\t\t\t\t\t\t\t\tcomparedWeightArray[ comparedWeightIndex ] = currentWeight;\n\t\t\t\t\t\t\t\tcurrentWeight = comparedWeight;\n\n\t\t\t\t\t\t\t\tconst tmp = wIndex[ comparedWeightIndex ];\n\t\t\t\t\t\t\t\twIndex[ comparedWeightIndex ] = currentIndex;\n\t\t\t\t\t\t\t\tcurrentIndex = tmp;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tweightIndices = wIndex;\n\t\t\t\t\tweights = Weight;\n\n\t\t\t\t}\n\n\t\t\t\t// if the weight array is shorter than 4 pad with 0s\n\t\t\t\twhile ( weights.length < 4 ) {\n\n\t\t\t\t\tweights.push( 0 );\n\t\t\t\t\tweightIndices.push( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < 4; ++ i ) {\n\n\t\t\t\t\tfaceWeights.push( weights[ i ] );\n\t\t\t\t\tfaceWeightIndices.push( weightIndices[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.normal );\n\n\t\t\t\tfaceNormals.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tmaterialIndex = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.material )[ 0 ];\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, i ) {\n\n\t\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, uv );\n\n\t\t\t\t\tif ( faceUVs[ i ] === undefined ) {\n\n\t\t\t\t\t\tfaceUVs[ i ] = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfaceUVs[ i ].push( data[ 0 ] );\n\t\t\t\t\tfaceUVs[ i ].push( data[ 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfaceLength ++;\n\n\t\t\tif ( endOfFace ) {\n\n\t\t\t\tscope.genFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength );\n\n\t\t\t\tpolygonIndex ++;\n\t\t\t\tfaceLength = 0;\n\n\t\t\t\t// reset arrays for the next face\n\t\t\t\tfacePositionIndexes = [];\n\t\t\t\tfaceNormals = [];\n\t\t\t\tfaceColors = [];\n\t\t\t\tfaceUVs = [];\n\t\t\t\tfaceWeights = [];\n\t\t\t\tfaceWeightIndices = [];\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn buffers;\n\n\t}\n\n\t// Generate data for a single face in a geometry. If the face is a quad then split it into 2 tris\n\tgenFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength ) {\n\n\t\tfor ( let i = 2; i < faceLength; i ++ ) {\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 0 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 2 ] ] );\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 0 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 0 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 3 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tbuffers.colors.push( faceColors[ 0 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tbuffers.normal.push( faceNormals[ 0 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, j ) {\n\n\t\t\t\t\tif ( buffers.uvs[ j ] === undefined ) buffers.uvs[ j ] = [];\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 0 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 + 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 + 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\taddMorphTargets( parentGeo, parentGeoNode, morphTargets, preTransform ) {\n\n\t\tif ( morphTargets.length === 0 ) return;\n\n\t\tparentGeo.morphTargetsRelative = true;\n\n\t\tparentGeo.morphAttributes.position = [];\n\t\t// parentGeo.morphAttributes.normal = []; // not implemented\n\n\t\tconst scope = this;\n\t\tmorphTargets.forEach( function ( morphTarget ) {\n\n\t\t\tmorphTarget.rawTargets.forEach( function ( rawTarget ) {\n\n\t\t\t\tconst morphGeoNode = fbxTree.Objects.Geometry[ rawTarget.geoID ];\n\n\t\t\t\tif ( morphGeoNode !== undefined ) {\n\n\t\t\t\t\tscope.genMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, rawTarget.name );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t// a morph geometry node is similar to a standard  node, and the node is also contained\n\t// in FBXTree.Objects.Geometry, however it can only have attributes for position, normal\n\t// and a special attribute Index defining which vertices of the original geometry are affected\n\t// Normal and position attributes only have data for the vertices that are affected by the morph\n\tgenMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, name ) {\n\n\t\tconst vertexIndices = ( parentGeoNode.PolygonVertexIndex !== undefined ) ? parentGeoNode.PolygonVertexIndex.a : [];\n\n\t\tconst morphPositionsSparse = ( morphGeoNode.Vertices !== undefined ) ? morphGeoNode.Vertices.a : [];\n\t\tconst indices = ( morphGeoNode.Indexes !== undefined ) ? morphGeoNode.Indexes.a : [];\n\n\t\tconst length = parentGeo.attributes.position.count * 3;\n\t\tconst morphPositions = new Float32Array( length );\n\n\t\tfor ( let i = 0; i < indices.length; i ++ ) {\n\n\t\t\tconst morphIndex = indices[ i ] * 3;\n\n\t\t\tmorphPositions[ morphIndex ] = morphPositionsSparse[ i * 3 ];\n\t\t\tmorphPositions[ morphIndex + 1 ] = morphPositionsSparse[ i * 3 + 1 ];\n\t\t\tmorphPositions[ morphIndex + 2 ] = morphPositionsSparse[ i * 3 + 2 ];\n\n\t\t}\n\n\t\t// TODO: add morph normal support\n\t\tconst morphGeoInfo = {\n\t\t\tvertexIndices: vertexIndices,\n\t\t\tvertexPositions: morphPositions,\n\n\t\t};\n\n\t\tconst morphBuffers = this.genBuffers( morphGeoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( morphBuffers.vertex, 3 );\n\t\tpositionAttribute.name = name || morphGeoNode.attrName;\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tparentGeo.morphAttributes.position.push( positionAttribute );\n\n\t}\n\n\t// Parse normal from FBXTree.Objects.Geometry.LayerElementNormal if it exists\n\tparseNormals( NormalNode ) {\n\n\t\tconst mappingType = NormalNode.MappingInformationType;\n\t\tconst referenceType = NormalNode.ReferenceInformationType;\n\t\tconst buffer = NormalNode.Normals.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tif ( 'NormalIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalIndex.a;\n\n\t\t\t} else if ( 'NormalsIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalsIndex.a;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 3,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse UVs from FBXTree.Objects.Geometry.LayerElementUV if it exists\n\tparseUVs( UVNode ) {\n\n\t\tconst mappingType = UVNode.MappingInformationType;\n\t\tconst referenceType = UVNode.ReferenceInformationType;\n\t\tconst buffer = UVNode.UV.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = UVNode.UVIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 2,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse Vertex Colors from FBXTree.Objects.Geometry.LayerElementColor if it exists\n\tparseVertexColors( ColorNode ) {\n\n\t\tconst mappingType = ColorNode.MappingInformationType;\n\t\tconst referenceType = ColorNode.ReferenceInformationType;\n\t\tconst buffer = ColorNode.Colors.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = ColorNode.ColorIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 4,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse mapping and material data in FBXTree.Objects.Geometry.LayerElementMaterial if it exists\n\tparseMaterialIndices( MaterialNode ) {\n\n\t\tconst mappingType = MaterialNode.MappingInformationType;\n\t\tconst referenceType = MaterialNode.ReferenceInformationType;\n\n\t\tif ( mappingType === 'NoMappingInformation' ) {\n\n\t\t\treturn {\n\t\t\t\tdataSize: 1,\n\t\t\t\tbuffer: [ 0 ],\n\t\t\t\tindices: [ 0 ],\n\t\t\t\tmappingType: 'AllSame',\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t}\n\n\t\tconst materialIndexBuffer = MaterialNode.Materials.a;\n\n\t\t// Since materials are stored as indices, there's a bit of a mismatch between FBX and what\n\t\t// we expect.So we create an intermediate buffer that points to the index in the buffer,\n\t\t// for conforming with the other functions we've written for other data.\n\t\tconst materialIndices = [];\n\n\t\tfor ( let i = 0; i < materialIndexBuffer.length; ++ i ) {\n\n\t\t\tmaterialIndices.push( i );\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 1,\n\t\t\tbuffer: materialIndexBuffer,\n\t\t\tindices: materialIndices,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Generate a NurbGeometry from a node in FBXTree.Objects.Geometry\n\tparseNurbsGeometry( geoNode ) {\n\n\t\tif ( NURBSCurve === undefined ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry.' );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst order = parseInt( geoNode.Order );\n\n\t\tif ( isNaN( order ) ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: Invalid Order %s given for geometry ID: %s', geoNode.Order, geoNode.id );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst degree = order - 1;\n\n\t\tconst knots = geoNode.KnotVector.a;\n\t\tconst controlPoints = [];\n\t\tconst pointsValues = geoNode.Points.a;\n\n\t\tfor ( let i = 0, l = pointsValues.length; i < l; i += 4 ) {\n\n\t\t\tcontrolPoints.push( new Vector4().fromArray( pointsValues, i ) );\n\n\t\t}\n\n\t\tlet startKnot, endKnot;\n\n\t\tif ( geoNode.Form === 'Closed' ) {\n\n\t\t\tcontrolPoints.push( controlPoints[ 0 ] );\n\n\t\t} else if ( geoNode.Form === 'Periodic' ) {\n\n\t\t\tstartKnot = degree;\n\t\t\tendKnot = knots.length - 1 - startKnot;\n\n\t\t\tfor ( let i = 0; i < degree; ++ i ) {\n\n\t\t\t\tcontrolPoints.push( controlPoints[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst curve = new NURBSCurve( degree, knots, controlPoints, startKnot, endKnot );\n\t\tconst points = curve.getPoints( controlPoints.length * 12 );\n\n\t\treturn new BufferGeometry().setFromPoints( points );\n\n\t}\n\n}\n\n// parse animation data from FBXTree\nclass AnimationParser {\n\n\t// take raw animation clips and turn them into three.js animation clips\n\tparse() {\n\n\t\tconst animationClips = [];\n\n\t\tconst rawClips = this.parseClips();\n\n\t\tif ( rawClips !== undefined ) {\n\n\t\t\tfor ( const key in rawClips ) {\n\n\t\t\t\tconst rawClip = rawClips[ key ];\n\n\t\t\t\tconst clip = this.addClip( rawClip );\n\n\t\t\t\tanimationClips.push( clip );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animationClips;\n\n\t}\n\n\tparseClips() {\n\n\t\t// since the actual transformation data is stored in FBXTree.Objects.AnimationCurve,\n\t\t// if this is undefined we can safely assume there are no animations\n\t\tif ( fbxTree.Objects.AnimationCurve === undefined ) return undefined;\n\n\t\tconst curveNodesMap = this.parseAnimationCurveNodes();\n\n\t\tthis.parseAnimationCurves( curveNodesMap );\n\n\t\tconst layersMap = this.parseAnimationLayers( curveNodesMap );\n\t\tconst rawClips = this.parseAnimStacks( layersMap );\n\n\t\treturn rawClips;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurveNode\n\t// each AnimationCurveNode holds data for an animation transform for a model (e.g. left arm rotation )\n\t// and is referenced by an AnimationLayer\n\tparseAnimationCurveNodes() {\n\n\t\tconst rawCurveNodes = fbxTree.Objects.AnimationCurveNode;\n\n\t\tconst curveNodesMap = new Map();\n\n\t\tfor ( const nodeID in rawCurveNodes ) {\n\n\t\t\tconst rawCurveNode = rawCurveNodes[ nodeID ];\n\n\t\t\tif ( rawCurveNode.attrName.match( /S|R|T|DeformPercent/ ) !== null ) {\n\n\t\t\t\tconst curveNode = {\n\n\t\t\t\t\tid: rawCurveNode.id,\n\t\t\t\t\tattr: rawCurveNode.attrName,\n\t\t\t\t\tcurves: {},\n\n\t\t\t\t};\n\n\t\t\t\tcurveNodesMap.set( curveNode.id, curveNode );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn curveNodesMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurve and connect them up to\n\t// previously parsed AnimationCurveNodes. Each AnimationCurve holds data for a single animated\n\t// axis ( e.g. times and values of x rotation)\n\tparseAnimationCurves( curveNodesMap ) {\n\n\t\tconst rawCurves = fbxTree.Objects.AnimationCurve;\n\n\t\t// TODO: Many values are identical up to roundoff error, but won't be optimised\n\t\t// e.g. position times: [0, 0.4, 0. 8]\n\t\t// position values: [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.235384487103147e-7, 93.67520904541016, -0.9982695579528809]\n\t\t// clearly, this should be optimised to\n\t\t// times: [0], positions [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809]\n\t\t// this shows up in nearly every FBX file, and generally time array is length > 100\n\n\t\tfor ( const nodeID in rawCurves ) {\n\n\t\t\tconst animationCurve = {\n\n\t\t\t\tid: rawCurves[ nodeID ].id,\n\t\t\t\ttimes: rawCurves[ nodeID ].KeyTime.a.map( convertFBXTimeToSeconds ),\n\t\t\t\tvalues: rawCurves[ nodeID ].KeyValueFloat.a,\n\n\t\t\t};\n\n\t\t\tconst relationships = connections.get( animationCurve.id );\n\n\t\t\tif ( relationships !== undefined ) {\n\n\t\t\t\tconst animationCurveID = relationships.parents[ 0 ].ID;\n\t\t\t\tconst animationCurveRelationship = relationships.parents[ 0 ].relationship;\n\n\t\t\t\tif ( animationCurveRelationship.match( /X/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'x' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Y/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'y' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Z/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'z' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /d|DeformPercent/ ) && curveNodesMap.has( animationCurveID ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'morph' ] = animationCurve;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationLayer. Each layers holds references\n\t// to various AnimationCurveNodes and is referenced by an AnimationStack node\n\t// note: theoretically a stack can have multiple layers, however in practice there always seems to be one per stack\n\tparseAnimationLayers( curveNodesMap ) {\n\n\t\tconst rawLayers = fbxTree.Objects.AnimationLayer;\n\n\t\tconst layersMap = new Map();\n\n\t\tfor ( const nodeID in rawLayers ) {\n\n\t\t\tconst layerCurveNodes = [];\n\n\t\t\tconst connection = connections.get( parseInt( nodeID ) );\n\n\t\t\tif ( connection !== undefined ) {\n\n\t\t\t\t// all the animationCurveNodes used in the layer\n\t\t\t\tconst children = connection.children;\n\n\t\t\t\tchildren.forEach( function ( child, i ) {\n\n\t\t\t\t\tif ( curveNodesMap.has( child.ID ) ) {\n\n\t\t\t\t\t\tconst curveNode = curveNodesMap.get( child.ID );\n\n\t\t\t\t\t\t// check that the curves are defined for at least one axis, otherwise ignore the curveNode\n\t\t\t\t\t\tif ( curveNode.curves.x !== undefined || curveNode.curves.y !== undefined || curveNode.curves.z !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst modelID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tif ( modelID !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID.toString() ];\n\n\t\t\t\t\t\t\t\t\tif ( rawModel === undefined ) {\n\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered a unused curve.', child );\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\t\tID: rawModel.id,\n\t\t\t\t\t\t\t\t\t\tinitialPosition: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialRotation: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialScale: [ 1, 1, 1 ],\n\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( child.ID === rawModel.id ) {\n\n\t\t\t\t\t\t\t\t\t\t\tnode.transform = child.matrix;\n\n\t\t\t\t\t\t\t\t\t\t\tif ( child.userData.transformData ) node.eulerOrder = child.userData.transformData.eulerOrder;\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\tif ( ! node.transform ) node.transform = new Matrix4();\n\n\t\t\t\t\t\t\t\t\t// if the animated model is pre rotated, we'll have to apply the pre rotations to every\n\t\t\t\t\t\t\t\t\t// animation value as well\n\t\t\t\t\t\t\t\t\tif ( 'PreRotation' in rawModel ) node.preRotation = rawModel.PreRotation.value;\n\t\t\t\t\t\t\t\t\tif ( 'PostRotation' in rawModel ) node.postRotation = rawModel.PostRotation.value;\n\n\t\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] ) layerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t} else if ( curveNode.curves.morph !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst deformerID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst morpherID = connections.get( deformerID ).parents[ 0 ].ID;\n\t\t\t\t\t\t\t\tconst geoID = connections.get( morpherID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\t// assuming geometry is not used in more than one model\n\t\t\t\t\t\t\t\tconst modelID = connections.get( geoID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID ];\n\n\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\tmorphName: fbxTree.Objects.Deformer[ deformerID ].attrName,\n\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlayerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tlayersMap.set( parseInt( nodeID ), layerCurveNodes );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn layersMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationStack. These are the top level node in the animation\n\t// hierarchy. Each Stack node will be used to create a AnimationClip\n\tparseAnimStacks( layersMap ) {\n\n\t\tconst rawStacks = fbxTree.Objects.AnimationStack;\n\n\t\t// connect the stacks (clips) up to the layers\n\t\tconst rawClips = {};\n\n\t\tfor ( const nodeID in rawStacks ) {\n\n\t\t\tconst children = connections.get( parseInt( nodeID ) ).children;\n\n\t\t\tif ( children.length > 1 ) {\n\n\t\t\t\t// it seems like stacks will always be associated with a single layer. But just in case there are files\n\t\t\t\t// where there are multiple layers per stack, we'll display a warning\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.' );\n\n\t\t\t}\n\n\t\t\tconst layer = layersMap.get( children[ 0 ].ID );\n\n\t\t\trawClips[ nodeID ] = {\n\n\t\t\t\tname: rawStacks[ nodeID ].attrName,\n\t\t\t\tlayer: layer,\n\n\t\t\t};\n\n\t\t}\n\n\t\treturn rawClips;\n\n\t}\n\n\taddClip( rawClip ) {\n\n\t\tlet tracks = [];\n\n\t\tconst scope = this;\n\t\trawClip.layer.forEach( function ( rawTracks ) {\n\n\t\t\ttracks = tracks.concat( scope.generateTracks( rawTracks ) );\n\n\t\t} );\n\n\t\treturn new AnimationClip( rawClip.name, - 1, tracks );\n\n\t}\n\n\tgenerateTracks( rawTracks ) {\n\n\t\tconst tracks = [];\n\n\t\tlet initialPosition = new Vector3();\n\t\tlet initialRotation = new Quaternion();\n\t\tlet initialScale = new Vector3();\n\n\t\tif ( rawTracks.transform ) rawTracks.transform.decompose( initialPosition, initialRotation, initialScale );\n\n\t\tinitialPosition = initialPosition.toArray();\n\t\tinitialRotation = new Euler().setFromQuaternion( initialRotation, rawTracks.eulerOrder ).toArray();\n\t\tinitialScale = initialScale.toArray();\n\n\t\tif ( rawTracks.T !== undefined && Object.keys( rawTracks.T.curves ).length > 0 ) {\n\n\t\t\tconst positionTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.T.curves, initialPosition, 'position' );\n\t\t\tif ( positionTrack !== undefined ) tracks.push( positionTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.R !== undefined && Object.keys( rawTracks.R.curves ).length > 0 ) {\n\n\t\t\tconst rotationTrack = this.generateRotationTrack( rawTracks.modelName, rawTracks.R.curves, initialRotation, rawTracks.preRotation, rawTracks.postRotation, rawTracks.eulerOrder );\n\t\t\tif ( rotationTrack !== undefined ) tracks.push( rotationTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.S !== undefined && Object.keys( rawTracks.S.curves ).length > 0 ) {\n\n\t\t\tconst scaleTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.S.curves, initialScale, 'scale' );\n\t\t\tif ( scaleTrack !== undefined ) tracks.push( scaleTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.DeformPercent !== undefined ) {\n\n\t\t\tconst morphTrack = this.generateMorphTrack( rawTracks );\n\t\t\tif ( morphTrack !== undefined ) tracks.push( morphTrack );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\tgenerateVectorTrack( modelName, curves, initialValue, type ) {\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\treturn new VectorKeyframeTrack( modelName + '.' + type, times, values );\n\n\t}\n\n\tgenerateRotationTrack( modelName, curves, initialValue, preRotation, postRotation, eulerOrder ) {\n\n\t\tif ( curves.x !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.x );\n\t\t\tcurves.x.values = curves.x.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.y !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.y );\n\t\t\tcurves.y.values = curves.y.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.z !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.z );\n\t\t\tcurves.z.values = curves.z.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\tif ( preRotation !== undefined ) {\n\n\t\t\tpreRotation = preRotation.map( MathUtils.degToRad );\n\t\t\tpreRotation.push( eulerOrder );\n\n\t\t\tpreRotation = new Euler().fromArray( preRotation );\n\t\t\tpreRotation = new Quaternion().setFromEuler( preRotation );\n\n\t\t}\n\n\t\tif ( postRotation !== undefined ) {\n\n\t\t\tpostRotation = postRotation.map( MathUtils.degToRad );\n\t\t\tpostRotation.push( eulerOrder );\n\n\t\t\tpostRotation = new Euler().fromArray( postRotation );\n\t\t\tpostRotation = new Quaternion().setFromEuler( postRotation ).invert();\n\n\t\t}\n\n\t\tconst quaternion = new Quaternion();\n\t\tconst euler = new Euler();\n\n\t\tconst quaternionValues = [];\n\n\t\tfor ( let i = 0; i < values.length; i += 3 ) {\n\n\t\t\teuler.set( values[ i ], values[ i + 1 ], values[ i + 2 ], eulerOrder );\n\n\t\t\tquaternion.setFromEuler( euler );\n\n\t\t\tif ( preRotation !== undefined ) quaternion.premultiply( preRotation );\n\t\t\tif ( postRotation !== undefined ) quaternion.multiply( postRotation );\n\n\t\t\tquaternion.toArray( quaternionValues, ( i / 3 ) * 4 );\n\n\t\t}\n\n\t\treturn new QuaternionKeyframeTrack( modelName + '.quaternion', times, quaternionValues );\n\n\t}\n\n\tgenerateMorphTrack( rawTracks ) {\n\n\t\tconst curves = rawTracks.DeformPercent.curves.morph;\n\t\tconst values = curves.values.map( function ( val ) {\n\n\t\t\treturn val / 100;\n\n\t\t} );\n\n\t\tconst morphNum = sceneGraph.getObjectByName( rawTracks.modelName ).morphTargetDictionary[ rawTracks.morphName ];\n\n\t\treturn new NumberKeyframeTrack( rawTracks.modelName + '.morphTargetInfluences[' + morphNum + ']', curves.times, values );\n\n\t}\n\n\t// For all animated objects, times are defined separately for each axis\n\t// Here we'll combine the times into one sorted array without duplicates\n\tgetTimesForAllAxes( curves ) {\n\n\t\tlet times = [];\n\n\t\t// first join together the times for each axis, if defined\n\t\tif ( curves.x !== undefined ) times = times.concat( curves.x.times );\n\t\tif ( curves.y !== undefined ) times = times.concat( curves.y.times );\n\t\tif ( curves.z !== undefined ) times = times.concat( curves.z.times );\n\n\t\t// then sort them\n\t\ttimes = times.sort( function ( a, b ) {\n\n\t\t\treturn a - b;\n\n\t\t} );\n\n\t\t// and remove duplicates\n\t\tif ( times.length > 1 ) {\n\n\t\t\tlet targetIndex = 1;\n\t\t\tlet lastValue = times[ 0 ];\n\t\t\tfor ( let i = 1; i < times.length; i ++ ) {\n\n\t\t\t\tconst currentValue = times[ i ];\n\t\t\t\tif ( currentValue !== lastValue ) {\n\n\t\t\t\t\ttimes[ targetIndex ] = currentValue;\n\t\t\t\t\tlastValue = currentValue;\n\t\t\t\t\ttargetIndex ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttimes = times.slice( 0, targetIndex );\n\n\t\t}\n\n\t\treturn times;\n\n\t}\n\n\tgetKeyframeTrackValues( times, curves, initialValue ) {\n\n\t\tconst prevValue = initialValue;\n\n\t\tconst values = [];\n\n\t\tlet xIndex = - 1;\n\t\tlet yIndex = - 1;\n\t\tlet zIndex = - 1;\n\n\t\ttimes.forEach( function ( time ) {\n\n\t\t\tif ( curves.x ) xIndex = curves.x.times.indexOf( time );\n\t\t\tif ( curves.y ) yIndex = curves.y.times.indexOf( time );\n\t\t\tif ( curves.z ) zIndex = curves.z.times.indexOf( time );\n\n\t\t\t// if there is an x value defined for this frame, use that\n\t\t\tif ( xIndex !== - 1 ) {\n\n\t\t\t\tconst xValue = curves.x.values[ xIndex ];\n\t\t\t\tvalues.push( xValue );\n\t\t\t\tprevValue[ 0 ] = xValue;\n\n\t\t\t} else {\n\n\t\t\t\t// otherwise use the x value from the previous frame\n\t\t\t\tvalues.push( prevValue[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( yIndex !== - 1 ) {\n\n\t\t\t\tconst yValue = curves.y.values[ yIndex ];\n\t\t\t\tvalues.push( yValue );\n\t\t\t\tprevValue[ 1 ] = yValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 1 ] );\n\n\t\t\t}\n\n\t\t\tif ( zIndex !== - 1 ) {\n\n\t\t\t\tconst zValue = curves.z.values[ zIndex ];\n\t\t\t\tvalues.push( zValue );\n\t\t\t\tprevValue[ 2 ] = zValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 2 ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn values;\n\n\t}\n\n\t// Rotations are defined as Euler angles which can have values  of any size\n\t// These will be converted to quaternions which don't support values greater than\n\t// PI, so we'll interpolate large rotations\n\tinterpolateRotations( curve ) {\n\n\t\tfor ( let i = 1; i < curve.values.length; i ++ ) {\n\n\t\t\tconst initialValue = curve.values[ i - 1 ];\n\t\t\tconst valuesSpan = curve.values[ i ] - initialValue;\n\n\t\t\tconst absoluteSpan = Math.abs( valuesSpan );\n\n\t\t\tif ( absoluteSpan >= 180 ) {\n\n\t\t\t\tconst numSubIntervals = absoluteSpan / 180;\n\n\t\t\t\tconst step = valuesSpan / numSubIntervals;\n\t\t\t\tlet nextValue = initialValue + step;\n\n\t\t\t\tconst initialTime = curve.times[ i - 1 ];\n\t\t\t\tconst timeSpan = curve.times[ i ] - initialTime;\n\t\t\t\tconst interval = timeSpan / numSubIntervals;\n\t\t\t\tlet nextTime = initialTime + interval;\n\n\t\t\t\tconst interpolatedTimes = [];\n\t\t\t\tconst interpolatedValues = [];\n\n\t\t\t\twhile ( nextTime < curve.times[ i ] ) {\n\n\t\t\t\t\tinterpolatedTimes.push( nextTime );\n\t\t\t\t\tnextTime += interval;\n\n\t\t\t\t\tinterpolatedValues.push( nextValue );\n\t\t\t\t\tnextValue += step;\n\n\t\t\t\t}\n\n\t\t\t\tcurve.times = inject( curve.times, i, interpolatedTimes );\n\t\t\t\tcurve.values = inject( curve.values, i, interpolatedValues );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse an FBX file in ASCII format\nclass TextParser {\n\n\tgetPrevNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 2 ];\n\n\t}\n\n\tgetCurrentNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 1 ];\n\n\t}\n\n\tgetCurrentProp() {\n\n\t\treturn this.currentProp;\n\n\t}\n\n\tpushStack( node ) {\n\n\t\tthis.nodeStack.push( node );\n\t\tthis.currentIndent += 1;\n\n\t}\n\n\tpopStack() {\n\n\t\tthis.nodeStack.pop();\n\t\tthis.currentIndent -= 1;\n\n\t}\n\n\tsetCurrentProp( val, name ) {\n\n\t\tthis.currentProp = val;\n\t\tthis.currentPropName = name;\n\n\t}\n\n\tparse( text ) {\n\n\t\tthis.currentIndent = 0;\n\n\t\tthis.allNodes = new FBXTree();\n\t\tthis.nodeStack = [];\n\t\tthis.currentProp = [];\n\t\tthis.currentPropName = '';\n\n\t\tconst scope = this;\n\n\t\tconst split = text.split( /[\\r\\n]+/ );\n\n\t\tsplit.forEach( function ( line, i ) {\n\n\t\t\tconst matchComment = line.match( /^[\\s\\t]*;/ );\n\t\t\tconst matchEmpty = line.match( /^[\\s\\t]*$/ );\n\n\t\t\tif ( matchComment || matchEmpty ) return;\n\n\t\t\tconst matchBeginning = line.match( '^\\\\t{' + scope.currentIndent + '}(\\\\w+):(.*){', '' );\n\t\t\tconst matchProperty = line.match( '^\\\\t{' + ( scope.currentIndent ) + '}(\\\\w+):[\\\\s\\\\t\\\\r\\\\n](.*)' );\n\t\t\tconst matchEnd = line.match( '^\\\\t{' + ( scope.currentIndent - 1 ) + '}}' );\n\n\t\t\tif ( matchBeginning ) {\n\n\t\t\t\tscope.parseNodeBegin( line, matchBeginning );\n\n\t\t\t} else if ( matchProperty ) {\n\n\t\t\t\tscope.parseNodeProperty( line, matchProperty, split[ ++ i ] );\n\n\t\t\t} else if ( matchEnd ) {\n\n\t\t\t\tscope.popStack();\n\n\t\t\t} else if ( line.match( /^[^\\s\\t}]/ ) ) {\n\n\t\t\t\t// large arrays are split over multiple lines terminated with a ',' character\n\t\t\t\t// if this is encountered the line needs to be joined to the previous line\n\t\t\t\tscope.parseNodePropertyContinued( line );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn this.allNodes;\n\n\t}\n\n\tparseNodeBegin( line, property ) {\n\n\t\tconst nodeName = property[ 1 ].trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\tconst nodeAttrs = property[ 2 ].split( ',' ).map( function ( attr ) {\n\n\t\t\treturn attr.trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\t} );\n\n\t\tconst node = { name: nodeName };\n\t\tconst attrs = this.parseNodeAttr( nodeAttrs );\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\t// a top node\n\t\tif ( this.currentIndent === 0 ) {\n\n\t\t\tthis.allNodes.add( nodeName, node );\n\n\t\t} else { // a subnode\n\n\t\t\t// if the subnode already exists, append it\n\t\t\tif ( nodeName in currentNode ) {\n\n\t\t\t\t// special case Pose needs PoseNodes as an array\n\t\t\t\tif ( nodeName === 'PoseNode' ) {\n\n\t\t\t\t\tcurrentNode.PoseNode.push( node );\n\n\t\t\t\t} else if ( currentNode[ nodeName ].id !== undefined ) {\n\n\t\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\t\tcurrentNode[ nodeName ][ currentNode[ nodeName ].id ] = currentNode[ nodeName ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( attrs.id !== '' ) currentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( typeof attrs.id === 'number' ) {\n\n\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\tcurrentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( nodeName !== 'Properties70' ) {\n\n\t\t\t\tif ( nodeName === 'PoseNode' )\tcurrentNode[ nodeName ] = [ node ];\n\t\t\t\telse currentNode[ nodeName ] = node;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( typeof attrs.id === 'number' ) node.id = attrs.id;\n\t\tif ( attrs.name !== '' ) node.attrName = attrs.name;\n\t\tif ( attrs.type !== '' ) node.attrType = attrs.type;\n\n\t\tthis.pushStack( node );\n\n\t}\n\n\tparseNodeAttr( attrs ) {\n\n\t\tlet id = attrs[ 0 ];\n\n\t\tif ( attrs[ 0 ] !== '' ) {\n\n\t\t\tid = parseInt( attrs[ 0 ] );\n\n\t\t\tif ( isNaN( id ) ) {\n\n\t\t\t\tid = attrs[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet name = '', type = '';\n\n\t\tif ( attrs.length > 1 ) {\n\n\t\t\tname = attrs[ 1 ].replace( /^(\\w+)::/, '' );\n\t\t\ttype = attrs[ 2 ];\n\n\t\t}\n\n\t\treturn { id: id, name: name, type: type };\n\n\t}\n\n\tparseNodeProperty( line, property, contentLine ) {\n\n\t\tlet propName = property[ 1 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\t\tlet propValue = property[ 2 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\n\t\t// for special case: base64 image data follows \"Content: ,\" line\n\t\t//\tContent: ,\n\t\t//\t \"/9j/4RDaRXhpZgAATU0A...\"\n\t\tif ( propName === 'Content' && propValue === ',' ) {\n\n\t\t\tpropValue = contentLine.replace( /\"/g, '' ).replace( /,$/, '' ).trim();\n\n\t\t}\n\n\t\tconst currentNode = this.getCurrentNode();\n\t\tconst parentName = currentNode.name;\n\n\t\tif ( parentName === 'Properties70' ) {\n\n\t\t\tthis.parseNodeSpecialProperty( line, propName, propValue );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Connections\n\t\tif ( propName === 'C' ) {\n\n\t\t\tconst connProps = propValue.split( ',' ).slice( 1 );\n\t\t\tconst from = parseInt( connProps[ 0 ] );\n\t\t\tconst to = parseInt( connProps[ 1 ] );\n\n\t\t\tlet rest = propValue.split( ',' ).slice( 3 );\n\n\t\t\trest = rest.map( function ( elem ) {\n\n\t\t\t\treturn elem.trim().replace( /^\"/, '' );\n\n\t\t\t} );\n\n\t\t\tpropName = 'connections';\n\t\t\tpropValue = [ from, to ];\n\t\t\tappend( propValue, rest );\n\n\t\t\tif ( currentNode[ propName ] === undefined ) {\n\n\t\t\t\tcurrentNode[ propName ] = [];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Node\n\t\tif ( propName === 'Node' ) currentNode.id = propValue;\n\n\t\t// connections\n\t\tif ( propName in currentNode && Array.isArray( currentNode[ propName ] ) ) {\n\n\t\t\tcurrentNode[ propName ].push( propValue );\n\n\t\t} else {\n\n\t\t\tif ( propName !== 'a' ) currentNode[ propName ] = propValue;\n\t\t\telse currentNode.a = propValue;\n\n\t\t}\n\n\t\tthis.setCurrentProp( currentNode, propName );\n\n\t\t// convert string to array, unless it ends in ',' in which case more will be added to it\n\t\tif ( propName === 'a' && propValue.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( propValue );\n\n\t\t}\n\n\t}\n\n\tparseNodePropertyContinued( line ) {\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\tcurrentNode.a += line;\n\n\t\t// if the line doesn't end in ',' we have reached the end of the property value\n\t\t// so convert the string to an array\n\t\tif ( line.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( currentNode.a );\n\n\t\t}\n\n\t}\n\n\t// parse \"Property70\"\n\tparseNodeSpecialProperty( line, propName, propValue ) {\n\n\t\t// split this\n\t\t// P: \"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\",1,1,1\n\t\t// into array like below\n\t\t// [\"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\", \"1,1,1\" ]\n\t\tconst props = propValue.split( '\",' ).map( function ( prop ) {\n\n\t\t\treturn prop.trim().replace( /^\\\"/, '' ).replace( /\\s/, '_' );\n\n\t\t} );\n\n\t\tconst innerPropName = props[ 0 ];\n\t\tconst innerPropType1 = props[ 1 ];\n\t\tconst innerPropType2 = props[ 2 ];\n\t\tconst innerPropFlag = props[ 3 ];\n\t\tlet innerPropValue = props[ 4 ];\n\n\t\t// cast values where needed, otherwise leave as strings\n\t\tswitch ( innerPropType1 ) {\n\n\t\t\tcase 'int':\n\t\t\tcase 'enum':\n\t\t\tcase 'bool':\n\t\t\tcase 'ULongLong':\n\t\t\tcase 'double':\n\t\t\tcase 'Number':\n\t\t\tcase 'FieldOfView':\n\t\t\t\tinnerPropValue = parseFloat( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t\tcase 'Color':\n\t\t\tcase 'ColorRGB':\n\t\t\tcase 'Vector3D':\n\t\t\tcase 'Lcl_Translation':\n\t\t\tcase 'Lcl_Rotation':\n\t\t\tcase 'Lcl_Scaling':\n\t\t\t\tinnerPropValue = parseNumberArray( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t// CAUTION: these props must append to parent's parent\n\t\tthis.getPrevNode()[ innerPropName ] = {\n\n\t\t\t'type': innerPropType1,\n\t\t\t'type2': innerPropType2,\n\t\t\t'flag': innerPropFlag,\n\t\t\t'value': innerPropValue\n\n\t\t};\n\n\t\tthis.setCurrentProp( this.getPrevNode(), innerPropName );\n\n\t}\n\n}\n\n// Parse an FBX file in Binary format\nclass BinaryParser {\n\n\tparse( buffer ) {\n\n\t\tconst reader = new BinaryReader( buffer );\n\t\treader.skip( 23 ); // skip magic 23 bytes\n\n\t\tconst version = reader.getUint32();\n\n\t\tif ( version < 6400 ) {\n\n\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + version );\n\n\t\t}\n\n\t\tconst allNodes = new FBXTree();\n\n\t\twhile ( ! this.endOfContent( reader ) ) {\n\n\t\t\tconst node = this.parseNode( reader, version );\n\t\t\tif ( node !== null ) allNodes.add( node.name, node );\n\n\t\t}\n\n\t\treturn allNodes;\n\n\t}\n\n\t// Check if reader has reached the end of content.\n\tendOfContent( reader ) {\n\n\t\t// footer size: 160bytes + 16-byte alignment padding\n\t\t// - 16bytes: magic\n\t\t// - padding til 16-byte alignment (at least 1byte?)\n\t\t//\t(seems like some exporters embed fixed 15 or 16bytes?)\n\t\t// - 4bytes: magic\n\t\t// - 4bytes: version\n\t\t// - 120bytes: zero\n\t\t// - 16bytes: magic\n\t\tif ( reader.size() % 16 === 0 ) {\n\n\t\t\treturn ( ( reader.getOffset() + 160 + 16 ) & ~ 0xf ) >= reader.size();\n\n\t\t} else {\n\n\t\t\treturn reader.getOffset() + 160 + 16 >= reader.size();\n\n\t\t}\n\n\t}\n\n\t// recursively parse nodes until the end of the file is reached\n\tparseNode( reader, version ) {\n\n\t\tconst node = {};\n\n\t\t// The first three data sizes depends on version.\n\t\tconst endOffset = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\t\tconst numProperties = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\n\t\t( version >= 7500 ) ? reader.getUint64() : reader.getUint32(); // the returned propertyListLen is not used\n\n\t\tconst nameLen = reader.getUint8();\n\t\tconst name = reader.getString( nameLen );\n\n\t\t// Regards this node as NULL-record if endOffset is zero\n\t\tif ( endOffset === 0 ) return null;\n\n\t\tconst propertyList = [];\n\n\t\tfor ( let i = 0; i < numProperties; i ++ ) {\n\n\t\t\tpropertyList.push( this.parseProperty( reader ) );\n\n\t\t}\n\n\t\t// Regards the first three elements in propertyList as id, attrName, and attrType\n\t\tconst id = propertyList.length > 0 ? propertyList[ 0 ] : '';\n\t\tconst attrName = propertyList.length > 1 ? propertyList[ 1 ] : '';\n\t\tconst attrType = propertyList.length > 2 ? propertyList[ 2 ] : '';\n\n\t\t// check if this node represents just a single property\n\t\t// like (name, 0) set or (name2, [0, 1, 2]) set of {name: 0, name2: [0, 1, 2]}\n\t\tnode.singleProperty = ( numProperties === 1 && reader.getOffset() === endOffset ) ? true : false;\n\n\t\twhile ( endOffset > reader.getOffset() ) {\n\n\t\t\tconst subNode = this.parseNode( reader, version );\n\n\t\t\tif ( subNode !== null ) this.parseSubNode( name, node, subNode );\n\n\t\t}\n\n\t\tnode.propertyList = propertyList; // raw property list used by parent\n\n\t\tif ( typeof id === 'number' ) node.id = id;\n\t\tif ( attrName !== '' ) node.attrName = attrName;\n\t\tif ( attrType !== '' ) node.attrType = attrType;\n\t\tif ( name !== '' ) node.name = name;\n\n\t\treturn node;\n\n\t}\n\n\tparseSubNode( name, node, subNode ) {\n\n\t\t// special case: child node is single property\n\t\tif ( subNode.singleProperty === true ) {\n\n\t\t\tconst value = subNode.propertyList[ 0 ];\n\n\t\t\tif ( Array.isArray( value ) ) {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t\tsubNode.a = value;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = value;\n\n\t\t\t}\n\n\t\t} else if ( name === 'Connections' && subNode.name === 'C' ) {\n\n\t\t\tconst array = [];\n\n\t\t\tsubNode.propertyList.forEach( function ( property, i ) {\n\n\t\t\t\t// first Connection is FBX type (OO, OP, etc.). We'll discard these\n\t\t\t\tif ( i !== 0 ) array.push( property );\n\n\t\t\t} );\n\n\t\t\tif ( node.connections === undefined ) {\n\n\t\t\t\tnode.connections = [];\n\n\t\t\t}\n\n\t\t\tnode.connections.push( array );\n\n\t\t} else if ( subNode.name === 'Properties70' ) {\n\n\t\t\tconst keys = Object.keys( subNode );\n\n\t\t\tkeys.forEach( function ( key ) {\n\n\t\t\t\tnode[ key ] = subNode[ key ];\n\n\t\t\t} );\n\n\t\t} else if ( name === 'Properties70' && subNode.name === 'P' ) {\n\n\t\t\tlet innerPropName = subNode.propertyList[ 0 ];\n\t\t\tlet innerPropType1 = subNode.propertyList[ 1 ];\n\t\t\tconst innerPropType2 = subNode.propertyList[ 2 ];\n\t\t\tconst innerPropFlag = subNode.propertyList[ 3 ];\n\t\t\tlet innerPropValue;\n\n\t\t\tif ( innerPropName.indexOf( 'Lcl ' ) === 0 ) innerPropName = innerPropName.replace( 'Lcl ', 'Lcl_' );\n\t\t\tif ( innerPropType1.indexOf( 'Lcl ' ) === 0 ) innerPropType1 = innerPropType1.replace( 'Lcl ', 'Lcl_' );\n\n\t\t\tif ( innerPropType1 === 'Color' || innerPropType1 === 'ColorRGB' || innerPropType1 === 'Vector' || innerPropType1 === 'Vector3D' || innerPropType1.indexOf( 'Lcl_' ) === 0 ) {\n\n\t\t\t\tinnerPropValue = [\n\t\t\t\t\tsubNode.propertyList[ 4 ],\n\t\t\t\t\tsubNode.propertyList[ 5 ],\n\t\t\t\t\tsubNode.propertyList[ 6 ]\n\t\t\t\t];\n\n\t\t\t} else {\n\n\t\t\t\tinnerPropValue = subNode.propertyList[ 4 ];\n\n\t\t\t}\n\n\t\t\t// this will be copied to parent, see above\n\t\t\tnode[ innerPropName ] = {\n\n\t\t\t\t'type': innerPropType1,\n\t\t\t\t'type2': innerPropType2,\n\t\t\t\t'flag': innerPropFlag,\n\t\t\t\t'value': innerPropValue\n\n\t\t\t};\n\n\t\t} else if ( node[ subNode.name ] === undefined ) {\n\n\t\t\tif ( typeof subNode.id === 'number' ) {\n\n\t\t\t\tnode[ subNode.name ] = {};\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( subNode.name === 'PoseNode' ) {\n\n\t\t\t\tif ( ! Array.isArray( node[ subNode.name ] ) ) {\n\n\t\t\t\t\tnode[ subNode.name ] = [ node[ subNode.name ] ];\n\n\t\t\t\t}\n\n\t\t\t\tnode[ subNode.name ].push( subNode );\n\n\t\t\t} else if ( node[ subNode.name ][ subNode.id ] === undefined ) {\n\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tparseProperty( reader ) {\n\n\t\tconst type = reader.getString( 1 );\n\t\tlet length;\n\n\t\tswitch ( type ) {\n\n\t\t\tcase 'C':\n\t\t\t\treturn reader.getBoolean();\n\n\t\t\tcase 'D':\n\t\t\t\treturn reader.getFloat64();\n\n\t\t\tcase 'F':\n\t\t\t\treturn reader.getFloat32();\n\n\t\t\tcase 'I':\n\t\t\t\treturn reader.getInt32();\n\n\t\t\tcase 'L':\n\t\t\t\treturn reader.getInt64();\n\n\t\t\tcase 'R':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getArrayBuffer( length );\n\n\t\t\tcase 'S':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getString( length );\n\n\t\t\tcase 'Y':\n\t\t\t\treturn reader.getInt16();\n\n\t\t\tcase 'b':\n\t\t\tcase 'c':\n\t\t\tcase 'd':\n\t\t\tcase 'f':\n\t\t\tcase 'i':\n\t\t\tcase 'l':\n\n\t\t\t\tconst arrayLength = reader.getUint32();\n\t\t\t\tconst encoding = reader.getUint32(); // 0: non-compressed, 1: compressed\n\t\t\t\tconst compressedLength = reader.getUint32();\n\n\t\t\t\tif ( encoding === 0 ) {\n\n\t\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tcase 'c':\n\t\t\t\t\t\t\treturn reader.getBooleanArray( arrayLength );\n\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\treturn reader.getFloat64Array( arrayLength );\n\n\t\t\t\t\t\tcase 'f':\n\t\t\t\t\t\t\treturn reader.getFloat32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\treturn reader.getInt32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'l':\n\t\t\t\t\t\t\treturn reader.getInt64Array( arrayLength );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( typeof fflate === 'undefined' ) {\n\n\t\t\t\t\tconsole.error( 'THREE.FBXLoader: External library fflate.min.js required.' );\n\n\t\t\t\t}\n\n\t\t\t\tconst data = fflate.unzlibSync( new Uint8Array( reader.getArrayBuffer( compressedLength ) ) ); // eslint-disable-line no-undef\n\t\t\t\tconst reader2 = new BinaryReader( data.buffer );\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'b':\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\treturn reader2.getBooleanArray( arrayLength );\n\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\treturn reader2.getFloat64Array( arrayLength );\n\n\t\t\t\t\tcase 'f':\n\t\t\t\t\t\treturn reader2.getFloat32Array( arrayLength );\n\n\t\t\t\t\tcase 'i':\n\t\t\t\t\t\treturn reader2.getInt32Array( arrayLength );\n\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\treturn reader2.getInt64Array( arrayLength );\n\n\t\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown property type ' + type );\n\n\t\t}\n\n\t}\n\n}\n\nclass BinaryReader {\n\n\tconstructor( buffer, littleEndian ) {\n\n\t\tthis.dv = new DataView( buffer );\n\t\tthis.offset = 0;\n\t\tthis.littleEndian = ( littleEndian !== undefined ) ? littleEndian : true;\n\n\t}\n\n\tgetOffset() {\n\n\t\treturn this.offset;\n\n\t}\n\n\tsize() {\n\n\t\treturn this.dv.buffer.byteLength;\n\n\t}\n\n\tskip( length ) {\n\n\t\tthis.offset += length;\n\n\t}\n\n\t// seems like true/false representation depends on exporter.\n\t// true: 1 or 'Y'(=0x59), false: 0 or 'T'(=0x54)\n\t// then sees LSB.\n\tgetBoolean() {\n\n\t\treturn ( this.getUint8() & 1 ) === 1;\n\n\t}\n\n\tgetBooleanArray( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getBoolean() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint8() {\n\n\t\tconst value = this.dv.getUint8( this.offset );\n\t\tthis.offset += 1;\n\t\treturn value;\n\n\t}\n\n\tgetInt16() {\n\n\t\tconst value = this.dv.getInt16( this.offset, this.littleEndian );\n\t\tthis.offset += 2;\n\t\treturn value;\n\n\t}\n\n\tgetInt32() {\n\n\t\tconst value = this.dv.getInt32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetInt32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint32() {\n\n\t\tconst value = this.dv.getUint32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\t// JavaScript doesn't support 64-bit integer so calculate this here\n\t// 1 << 32 will return 1 so using multiply operation instead here.\n\t// There's a possibility that this method returns wrong value if the value\n\t// is out of the range between Number.MAX_SAFE_INTEGER and Number.MIN_SAFE_INTEGER.\n\t// TODO: safely handle 64-bit integer\n\tgetInt64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\t// calculate negative value\n\t\tif ( high & 0x80000000 ) {\n\n\t\t\thigh = ~ high & 0xFFFFFFFF;\n\t\t\tlow = ~ low & 0xFFFFFFFF;\n\n\t\t\tif ( low === 0xFFFFFFFF ) high = ( high + 1 ) & 0xFFFFFFFF;\n\n\t\t\tlow = ( low + 1 ) & 0xFFFFFFFF;\n\n\t\t\treturn - ( high * 0x100000000 + low );\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetInt64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\t// Note: see getInt64() comment\n\tgetUint64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetFloat32() {\n\n\t\tconst value = this.dv.getFloat32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetFloat32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetFloat64() {\n\n\t\tconst value = this.dv.getFloat64( this.offset, this.littleEndian );\n\t\tthis.offset += 8;\n\t\treturn value;\n\n\t}\n\n\tgetFloat64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetArrayBuffer( size ) {\n\n\t\tconst value = this.dv.buffer.slice( this.offset, this.offset + size );\n\t\tthis.offset += size;\n\t\treturn value;\n\n\t}\n\n\tgetString( size ) {\n\n\t\t// note: safari 9 doesn't support Uint8Array.indexOf; create intermediate array instead\n\t\tlet a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta[ i ] = this.getUint8();\n\n\t\t}\n\n\t\tconst nullByte = a.indexOf( 0 );\n\t\tif ( nullByte >= 0 ) a = a.slice( 0, nullByte );\n\n\t\treturn LoaderUtils.decodeText( new Uint8Array( a ) );\n\n\t}\n\n}\n\n// FBXTree holds a representation of the FBX data, returned by the TextParser ( FBX ASCII format)\n// and BinaryParser( FBX Binary format)\nclass FBXTree {\n\n\tadd( key, val ) {\n\n\t\tthis[ key ] = val;\n\n\t}\n\n}\n\n// ************** UTILITY FUNCTIONS **************\n\nfunction isFbxFormatBinary( buffer ) {\n\n\tconst CORRECT = 'Kaydara\\u0020FBX\\u0020Binary\\u0020\\u0020\\0';\n\n\treturn buffer.byteLength >= CORRECT.length && CORRECT === convertArrayBufferToString( buffer, 0, CORRECT.length );\n\n}\n\nfunction isFbxFormatASCII( text ) {\n\n\tconst CORRECT = [ 'K', 'a', 'y', 'd', 'a', 'r', 'a', '\\\\', 'F', 'B', 'X', '\\\\', 'B', 'i', 'n', 'a', 'r', 'y', '\\\\', '\\\\' ];\n\n\tlet cursor = 0;\n\n\tfunction read( offset ) {\n\n\t\tconst result = text[ offset - 1 ];\n\t\ttext = text.slice( cursor + offset );\n\t\tcursor ++;\n\t\treturn result;\n\n\t}\n\n\tfor ( let i = 0; i < CORRECT.length; ++ i ) {\n\n\t\tconst num = read( 1 );\n\t\tif ( num === CORRECT[ i ] ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nfunction getFbxVersion( text ) {\n\n\tconst versionRegExp = /FBXVersion: (\\d+)/;\n\tconst match = text.match( versionRegExp );\n\n\tif ( match ) {\n\n\t\tconst version = parseInt( match[ 1 ] );\n\t\treturn version;\n\n\t}\n\n\tthrow new Error( 'THREE.FBXLoader: Cannot find the version number for the file given.' );\n\n}\n\n// Converts FBX ticks into real time seconds.\nfunction convertFBXTimeToSeconds( time ) {\n\n\treturn time / 46186158000;\n\n}\n\nconst dataArray = [];\n\n// extracts the data from the correct position in the FBX array based on indexing type\nfunction getData( polygonVertexIndex, polygonIndex, vertexIndex, infoObject ) {\n\n\tlet index;\n\n\tswitch ( infoObject.mappingType ) {\n\n\t\tcase 'ByPolygonVertex' :\n\t\t\tindex = polygonVertexIndex;\n\t\t\tbreak;\n\t\tcase 'ByPolygon' :\n\t\t\tindex = polygonIndex;\n\t\t\tbreak;\n\t\tcase 'ByVertice' :\n\t\t\tindex = vertexIndex;\n\t\t\tbreak;\n\t\tcase 'AllSame' :\n\t\t\tindex = infoObject.indices[ 0 ];\n\t\t\tbreak;\n\t\tdefault :\n\t\t\tconsole.warn( 'THREE.FBXLoader: unknown attribute mapping type ' + infoObject.mappingType );\n\n\t}\n\n\tif ( infoObject.referenceType === 'IndexToDirect' ) index = infoObject.indices[ index ];\n\n\tconst from = index * infoObject.dataSize;\n\tconst to = from + infoObject.dataSize;\n\n\treturn slice( dataArray, infoObject.buffer, from, to );\n\n}\n\nconst tempEuler = new Euler();\nconst tempVec = new Vector3();\n\n// generate transformation from FBX transform data\n// ref: https://help.autodesk.com/view/FBX/2017/ENU/?guid=__files_GUID_10CDD63C_79C1_4F2D_BB28_AD2BE65A02ED_htm\n// ref: http://docs.autodesk.com/FBX/2014/ENU/FBX-SDK-Documentation/index.html?url=cpp_ref/_transformations_2main_8cxx-example.html,topicNumber=cpp_ref__transformations_2main_8cxx_example_htmlfc10a1e1-b18d-4e72-9dc0-70d0f1959f5e\nfunction generateTransform( transformData ) {\n\n\tconst lTranslationM = new Matrix4();\n\tconst lPreRotationM = new Matrix4();\n\tconst lRotationM = new Matrix4();\n\tconst lPostRotationM = new Matrix4();\n\n\tconst lScalingM = new Matrix4();\n\tconst lScalingPivotM = new Matrix4();\n\tconst lScalingOffsetM = new Matrix4();\n\tconst lRotationOffsetM = new Matrix4();\n\tconst lRotationPivotM = new Matrix4();\n\n\tconst lParentGX = new Matrix4();\n\tconst lParentLX = new Matrix4();\n\tconst lGlobalT = new Matrix4();\n\n\tconst inheritType = ( transformData.inheritType ) ? transformData.inheritType : 0;\n\n\tif ( transformData.translation ) lTranslationM.setPosition( tempVec.fromArray( transformData.translation ) );\n\n\tif ( transformData.preRotation ) {\n\n\t\tconst array = transformData.preRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPreRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.rotation ) {\n\n\t\tconst array = transformData.rotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.postRotation ) {\n\n\t\tconst array = transformData.postRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPostRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\t\tlPostRotationM.invert();\n\n\t}\n\n\tif ( transformData.scale ) lScalingM.scale( tempVec.fromArray( transformData.scale ) );\n\n\t// Pivots and offsets\n\tif ( transformData.scalingOffset ) lScalingOffsetM.setPosition( tempVec.fromArray( transformData.scalingOffset ) );\n\tif ( transformData.scalingPivot ) lScalingPivotM.setPosition( tempVec.fromArray( transformData.scalingPivot ) );\n\tif ( transformData.rotationOffset ) lRotationOffsetM.setPosition( tempVec.fromArray( transformData.rotationOffset ) );\n\tif ( transformData.rotationPivot ) lRotationPivotM.setPosition( tempVec.fromArray( transformData.rotationPivot ) );\n\n\t// parent transform\n\tif ( transformData.parentMatrixWorld ) {\n\n\t\tlParentLX.copy( transformData.parentMatrix );\n\t\tlParentGX.copy( transformData.parentMatrixWorld );\n\n\t}\n\n\tconst lLRM = lPreRotationM.clone().multiply( lRotationM ).multiply( lPostRotationM );\n\t// Global Rotation\n\tconst lParentGRM = new Matrix4();\n\tlParentGRM.extractRotation( lParentGX );\n\n\t// Global Shear*Scaling\n\tconst lParentTM = new Matrix4();\n\tlParentTM.copyPosition( lParentGX );\n\n\tconst lParentGRSM = lParentTM.clone().invert().multiply( lParentGX );\n\tconst lParentGSM = lParentGRM.clone().invert().multiply( lParentGRSM );\n\tconst lLSM = lScalingM;\n\n\tconst lGlobalRS = new Matrix4();\n\n\tif ( inheritType === 0 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM ).multiply( lLSM );\n\n\t} else if ( inheritType === 1 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lParentGSM ).multiply( lLRM ).multiply( lLSM );\n\n\t} else {\n\n\t\tconst lParentLSM = new Matrix4().scale( new Vector3().setFromMatrixScale( lParentLX ) );\n\t\tconst lParentLSM_inv = lParentLSM.clone().invert();\n\t\tconst lParentGSM_noLocal = lParentGSM.clone().multiply( lParentLSM_inv );\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM_noLocal ).multiply( lLSM );\n\n\t}\n\n\tconst lRotationPivotM_inv = lRotationPivotM.clone().invert();\n\tconst lScalingPivotM_inv = lScalingPivotM.clone().invert();\n\t// Calculate the local transform matrix\n\tlet lTransform = lTranslationM.clone().multiply( lRotationOffsetM ).multiply( lRotationPivotM ).multiply( lPreRotationM ).multiply( lRotationM ).multiply( lPostRotationM ).multiply( lRotationPivotM_inv ).multiply( lScalingOffsetM ).multiply( lScalingPivotM ).multiply( lScalingM ).multiply( lScalingPivotM_inv );\n\n\tconst lLocalTWithAllPivotAndOffsetInfo = new Matrix4().copyPosition( lTransform );\n\n\tconst lGlobalTranslation = lParentGX.clone().multiply( lLocalTWithAllPivotAndOffsetInfo );\n\tlGlobalT.copyPosition( lGlobalTranslation );\n\n\tlTransform = lGlobalT.clone().multiply( lGlobalRS );\n\n\t// from global to local\n\tlTransform.premultiply( lParentGX.invert() );\n\n\treturn lTransform;\n\n}\n\n// Returns the three.js intrinsic Euler order corresponding to FBX extrinsic Euler order\n// ref: http://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_class_fbx_euler_html\nfunction getEulerOrder( order ) {\n\n\torder = order || 0;\n\n\tconst enums = [\n\t\t'ZYX', // -> XYZ extrinsic\n\t\t'YZX', // -> XZY extrinsic\n\t\t'XZY', // -> YZX extrinsic\n\t\t'ZXY', // -> YXZ extrinsic\n\t\t'YXZ', // -> ZXY extrinsic\n\t\t'XYZ', // -> ZYX extrinsic\n\t\t//'SphericXYZ', // not possible to support\n\t];\n\n\tif ( order === 6 ) {\n\n\t\tconsole.warn( 'THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.' );\n\t\treturn enums[ 0 ];\n\n\t}\n\n\treturn enums[ order ];\n\n}\n\n// Parses comma separated list of numbers and returns them an array.\n// Used internally by the TextParser\nfunction parseNumberArray( value ) {\n\n\tconst array = value.split( ',' ).map( function ( val ) {\n\n\t\treturn parseFloat( val );\n\n\t} );\n\n\treturn array;\n\n}\n\nfunction convertArrayBufferToString( buffer, from, to ) {\n\n\tif ( from === undefined ) from = 0;\n\tif ( to === undefined ) to = buffer.byteLength;\n\n\treturn LoaderUtils.decodeText( new Uint8Array( buffer, from, to ) );\n\n}\n\nfunction append( a, b ) {\n\n\tfor ( let i = 0, j = a.length, l = b.length; i < l; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n}\n\nfunction slice( a, b, from, to ) {\n\n\tfor ( let i = from, j = 0; i < to; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n\treturn a;\n\n}\n\n// inject array a2 into array a1 at index\nfunction inject( a1, index, a2 ) {\n\n\treturn a1.slice( 0, index ).concat( a2 ).concat( a1.slice( index ) );\n\n}\n\nexport { FBXLoader };\n","import {\n\tGroup,\n\tMesh\n} from 'three';\n\n\n\nfunction createMeshesFromInstancedMesh( instancedMesh ) {\n\n\tconst group = new Group();\n\n\tconst count = instancedMesh.count;\n\tconst geometry = instancedMesh.geometry;\n\tconst material = instancedMesh.material;\n\n\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\tconst mesh = new Mesh( geometry, material );\n\n\t\tinstancedMesh.getMatrixAt( i, mesh.matrix );\n\t\tmesh.matrix.decompose( mesh.position, mesh.quaternion, mesh.scale );\n\n\t\tgroup.add( mesh );\n\n\t}\n\n\tgroup.copy( instancedMesh );\n\tgroup.updateMatrixWorld(); // ensure correct world matrices of meshes\n\n\treturn group;\n\n}\n\nfunction createMultiMaterialObject( geometry, materials ) {\n\n\tconst group = new Group();\n\n\tfor ( let i = 0, l = materials.length; i < l; i ++ ) {\n\n\t\tgroup.add( new Mesh( geometry, materials[ i ] ) );\n\n\t}\n\n\treturn group;\n\n}\n\nfunction detach( child, parent, scene ) {\n\n\tconsole.warn( 'THREE.SceneUtils: detach() has been deprecated. Use scene.attach( child ) instead.' );\n\n\tscene.attach( child );\n\n}\n\nfunction attach( child, scene, parent ) {\n\n\tconsole.warn( 'THREE.SceneUtils: attach() has been deprecated. Use parent.attach( child ) instead.' );\n\n\tparent.attach( child );\n\n}\n\n\n\nexport {\n\tcreateMeshesFromInstancedMesh,\n\tcreateMultiMaterialObject,\n\tdetach,\n\tattach,\n};\n","// inspired by https://github.com/stemkoski/stemkoski.github.com/blob/master/Three.js/js/ParticleEngine.js\r\n\r\nimport * as THREE from 'three'\r\n// import { loadShader } from '../Three/ShaderLoader'\r\nimport { controller } from '../AnimUtils/TweenUtils'\r\n\r\nexport class ParticleController {\r\n    birthTime: number\r\n    deathTime: number\r\n    position: THREE.Vector3\r\n    scale: number\r\n    rotation: THREE.Euler\r\n    // velocity: THREE.Vector3\r\n    // acceleration: THREE.Vector3\r\n    color: THREE.Color\r\n    instanceIndex: number\r\n    dummy: THREE.Object3D\r\n    constructor(position: THREE.Vector3, rotation: THREE.Euler, scale: number, color: THREE.Color, instanceIndex: number) {\r\n        this.birthTime = 0\r\n        this.deathTime = 1\r\n        this.position = position\r\n        this.rotation = rotation\r\n        this.scale = scale\r\n        this.dummy = new THREE.Object3D()\r\n        // this.velocity = new THREE.Vector3(0, 0, 0)\r\n        // this.acceleration = new THREE.Vector3(0, 0, 0)\r\n        this.color = color\r\n        this.instanceIndex = instanceIndex\r\n    }\r\n    resetGeom(mesh: THREE.InstancedMesh) {\r\n        this.dummy.position.copy(this.position)\r\n        this.dummy.rotation.copy(this.rotation)\r\n        this.dummy.scale.set(this.scale, this.scale, this.scale)\r\n        this.dummy.updateMatrix()\r\n        mesh.setMatrixAt(this.instanceIndex, this.dummy.matrix)\r\n        mesh.setColorAt(this.instanceIndex, this.color)\r\n    }\r\n}\r\n\r\nexport type ParticleAnimRuleIn = {\r\n    index: number,\r\n    interp: number,\r\n    originalPosition: THREE.Vector3,\r\n    originalRotation: THREE.Euler,\r\n    originalScale: number,\r\n    originalColor: THREE.Color,\r\n    mixColor: THREE.Color,\r\n    randomFactor: number\r\n}\r\n\r\nexport type ParticleAnimRuleOut = {\r\n    curPosition: THREE.Vector3,\r\n    curRotation: THREE.Euler,\r\n    curScale: number,\r\n    curColor: THREE.Color\r\n}\r\n\r\nexport class ParticleRuleController extends ParticleController {\r\n    direction: THREE.Vector3\r\n    mixColor: THREE.Color\r\n    randomFactor: number\r\n    constructor(position: THREE.Vector3, rotation: THREE.Euler, scale: number, color: THREE.Color, mixColor: THREE.Color, instanceIndex: number) {\r\n        super(position, rotation, scale, color, instanceIndex)\r\n        this.direction = new THREE.Vector3().copy(position)\r\n        this.birthTime = Math.random() * 0.2\r\n        this.deathTime = Math.random() * 0.2 + 0.8\r\n        this.mixColor = mixColor\r\n        this.randomFactor = Math.random()\r\n    }\r\n    updateGeomByRule(\r\n    mesh: THREE.InstancedMesh, interp: number,\r\n    animRuleFunc: (rule: ParticleAnimRuleIn) => ParticleAnimRuleOut) {\r\n        if (interp < this.birthTime) {\r\n            return\r\n        }\r\n        else if (interp >= this.deathTime) {\r\n            this.resetGeom(mesh)\r\n            return\r\n        }\r\n        else {\r\n            let ruleOut = animRuleFunc({\r\n                index: this.instanceIndex,\r\n                interp: (interp - this.birthTime) / (this.deathTime - this.birthTime),\r\n                originalPosition: this.position,\r\n                originalRotation: this.rotation,\r\n                originalColor: this.color,\r\n                originalScale: this.scale,\r\n                mixColor: this.mixColor,\r\n                randomFactor: this.randomFactor\r\n            })\r\n            this.dummy.position.copy(ruleOut.curPosition)\r\n            this.dummy.rotation.copy(ruleOut.curRotation)\r\n            this.dummy.scale.set(ruleOut.curScale, ruleOut.curScale, ruleOut.curScale)\r\n            this.dummy.updateMatrix()\r\n            mesh.setMatrixAt(this.instanceIndex, this.dummy.matrix)\r\n            mesh.setColorAt(this.instanceIndex, ruleOut.curColor)\r\n        }\r\n    }\r\n}\r\n\r\nexport class AbstractParticleEngine {\r\n    particleCount: number\r\n    mesh: THREE.InstancedMesh\r\n    constructor(particleCount: number = 100, geometry: THREE.BufferGeometry, material: THREE.Material, \r\n        // setInitPosition: (index: number) => THREE.Vector3,\r\n        // setInitRotation: (index: number) => THREE.Euler,\r\n        // setInitScale: (index: number) => number,\r\n        // setInitColor: (index: number) => THREE.Color,\r\n        ) {\r\n        this.particleCount = particleCount\r\n        this.mesh = new THREE.InstancedMesh(geometry, material, particleCount)\r\n        this.mesh.instanceMatrix.setUsage( THREE.DynamicDrawUsage )\r\n        // this.particleControllers = []\r\n        // for (let i = 0; i < particleCount; i++) {\r\n        //     let initPosition = setInitPosition(i)\r\n        //     let initRotation = setInitRotation(i)\r\n        //     let initScale = setInitScale(i)\r\n        //     let initColor = setInitColor(i)\r\n        //     let tempParticleController = new ParticleController(initPosition, initRotation, initScale, initColor)\r\n        //     this.particleControllers.push(\r\n        //         tempParticleController\r\n        //     )\r\n        //     tempParticleController.updateGeomForMesh(this.mesh, this.dummy, i)\r\n        // }\r\n    }\r\n}\r\n\r\n\r\nexport class ParticleStaticEngine extends AbstractParticleEngine {\r\n    particleControllers: Array<ParticleController>\r\n    constructor(particleCount: number = 100, geometry: THREE.BufferGeometry, material: THREE.Material, \r\n        setInitPosition: (index: number) => THREE.Vector3,\r\n        setInitRotation: (index: number) => THREE.Euler,\r\n        setInitScale: (index: number) => number,\r\n        setInitColor: (index: number) => THREE.Color,\r\n    ) {\r\n        super(particleCount, geometry, material)\r\n        this.particleControllers = []\r\n        for (let i = 0; i < particleCount; i++) {\r\n            let initPosition = setInitPosition(i)\r\n            let initRotation = setInitRotation(i)\r\n            let initScale = setInitScale(i)\r\n            let initColor = setInitColor(i)\r\n            let tempParticleController = new ParticleController(initPosition, initRotation, initScale, initColor, i)\r\n            this.particleControllers.push(\r\n                tempParticleController\r\n            )\r\n            tempParticleController.resetGeom(this.mesh)\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class ParticleRuleEngine extends AbstractParticleEngine {\r\n    isInTransition: boolean\r\n    particleControllers: Array<ParticleRuleController>\r\n    animRuleFunc: (rule: ParticleAnimRuleIn) => ParticleAnimRuleOut\r\n    constructor(particleCount: number = 100, geometry: THREE.BufferGeometry, material: THREE.Material, \r\n        setInitPosition: (index: number) => THREE.Vector3,\r\n        setInitRotation: (index: number) => THREE.Euler,\r\n        setInitScale: (index: number) => number,\r\n        setInitColor: (index: number) => THREE.Color,\r\n        setInitMixColor: (index: number) => THREE.Color,\r\n        animRuleFunc: (rule: ParticleAnimRuleIn) => ParticleAnimRuleOut\r\n    ) {\r\n        super(particleCount, geometry, material)\r\n        this.isInTransition = false\r\n        this.particleControllers = []\r\n        this.animRuleFunc = animRuleFunc\r\n        for (let i = 0; i < particleCount; i++) {\r\n            let initPosition = setInitPosition(i)\r\n            let initRotation = setInitRotation(i)\r\n            let initScale = setInitScale(i)\r\n            let initColor = setInitColor(i)\r\n            let initMixColor = setInitMixColor(i)\r\n            let tempParticleController = new ParticleRuleController(\r\n                initPosition, initRotation, initScale, initColor, initMixColor, i\r\n            )\r\n            this.particleControllers.push(\r\n                tempParticleController\r\n            )\r\n            tempParticleController.resetGeom(this.mesh)\r\n        }\r\n    }\r\n    transit(transitionTime: number = 1000) {\r\n        if (this.isInTransition) {\r\n            return\r\n        }\r\n        const self = this\r\n        controller.tweenNumber(0, 1, (interp) => {\r\n            self.particleControllers.forEach(pc => {\r\n                pc.updateGeomByRule(self.mesh, interp, self.animRuleFunc)\r\n            })\r\n            self.mesh.instanceMatrix.needsUpdate = true\r\n            if (self.mesh.instanceColor) {\r\n                self.mesh.instanceColor.needsUpdate = true\r\n            }\r\n        },\r\n        () => {\r\n            self.isInTransition = false\r\n            // self.particleControllers.forEach(pc => {\r\n            //     pc.resetGeom(self.mesh, self.dummy)\r\n            // })\r\n            self.mesh.instanceMatrix.needsUpdate = true\r\n            if (self.mesh.instanceColor) {\r\n                self.mesh.instanceColor.needsUpdate = true\r\n            }\r\n        }, transitionTime)\r\n    }\r\n}","import * as THREE from 'three'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass'\r\nimport { Stats } from 'three-stats'\r\n// import { TDSLoader } from 'three/examples/jsm/loaders/TDSLoader'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport { FBXLoader } from 'three/examples/jsm/loaders/FBXLoader'\r\nimport { createMultiMaterialObject } from 'three/examples/jsm/utils/SceneUtils'\r\nimport { CustomCSS3DObject, CustomCSS3DSprite, CustomCSS3DRenderer } from '../Three/CustomCSS3DRenderer'\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\r\nimport { DampingObjectController, DampingVector3Controller } from '../Three/Utils'\r\n// import { RefractionMesh, RefractionManager } from '../Three/Refraction2.0'\r\nimport { RefractionObject, RefractionManager } from '../ThreeRealisticRefraction/ThreeRealisticRefraction'\r\nimport { RoundedBoxGeometry } from 'three/examples/jsm/geometries/RoundedBoxGeometry'\r\nimport { controller } from '../AnimUtils/TweenUtils'\r\nimport * as PE from '../Three/ParticleEngine'\r\nimport { randn_bm } from '../Three/Utils'\r\n\r\nclass BackgroundManager {\r\n    container: HTMLElement\r\n    renderer: THREE.WebGLRenderer\r\n    scene: THREE.Scene\r\n    // composer: EffectComposer\r\n    stats: Stats\r\n    controls: OrbitControls\r\n\r\n    // cursor position\r\n    mousePosX: number\r\n    mousePosY: number\r\n    pointer: THREE.Vector2\r\n\r\n    // camera\r\n    camera: THREE.PerspectiveCamera\r\n    // cameraZPosition: number\r\n    // cameraLootAtController: DampingVector3Controller\r\n    // cameraTargetPosition: THREE.Vector3\r\n    // cameraWithMouseRotateFactor: number\r\n    // cameraWithMouseMoveFactor: number\r\n\r\n    // loading manager\r\n    loadingManager: THREE.LoadingManager\r\n\r\n    constructor(_container: HTMLElement,\r\n        onLoad?: () => void,\r\n        onProgress?: (url: string, loaded: number, total: number) => void,\r\n        onError?: (url: string) => void\r\n        ) {\r\n        const self = this\r\n\r\n        // *********** basic settings ***********\r\n        // this.cameraZPosition = 500\r\n        this.container = _container\r\n        this.camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 5000 )\r\n        this.renderer = new THREE.WebGLRenderer( {alpha: true} )\r\n        this.renderer.outputEncoding = THREE.sRGBEncoding\r\n        this.renderer.toneMappingExposure = THREE.ACESFilmicToneMapping\r\n        this.renderer.toneMappingExposure = 1.2\r\n        this.renderer.setClearColor( 0xffffff )\r\n        this.renderer.setPixelRatio( window.devicePixelRatio )\r\n        this.renderer.setSize(window.innerWidth, window.innerHeight)\r\n        this.renderer.domElement.style.position = 'absolute'\r\n        this.renderer.domElement.style.top = '0px'\r\n        this.renderer.domElement.style.left = '0px'\r\n        this.container.appendChild( this.renderer.domElement )\r\n        // TODO: (debug stats)\r\n        this.stats = new Stats()\r\n        this.stats.domElement.style.zIndex = '100'\r\n        this.container.appendChild( this.stats.domElement )\r\n        this.controls = new OrbitControls(this.camera, this.container)\r\n        this.camera.position.set(0, 200, 150)\r\n\r\n        this.scene = new THREE.Scene()\r\n\r\n        // \r\n        this.loadingManager = new THREE.LoadingManager(() => {\r\n            if (onLoad) {\r\n                onLoad()\r\n            }\r\n        }, (url: string, loaded: number, total: number) => {\r\n            if (onProgress) {\r\n                onProgress(url, loaded, total)\r\n            }\r\n        }, (url) => {\r\n            if (onError) {\r\n                onError(url)\r\n            }\r\n        })\r\n\r\n        // *********** background & env ***********\r\n        const png_urls = [\r\n            'px.png', 'nx.png',\r\n            'py.png', 'ny.png',\r\n            'pz.png', 'nz.png'\r\n        ]\r\n        const jpg_urls = [\r\n            'px.jpg', 'nx.jpg',\r\n            'py.jpg', 'ny.jpg',\r\n            'pz.jpg', 'nz.jpg'\r\n        ]\r\n        var urls = this.getCubemapUrls('./cube2/', png_urls)\r\n        const textureCube1 = new THREE.CubeTextureLoader(this.loadingManager).load( urls )\r\n        textureCube1.mapping = THREE.CubeRefractionMapping\r\n        // this.scene.background = textureCube\r\n        this.scene.environment = textureCube1\r\n\r\n        urls = this.getCubemapUrls('./bg/', png_urls)\r\n        const textureCube2 = new THREE.CubeTextureLoader(this.loadingManager).load( urls )\r\n        // textureCube2.mapping = THREE.CubeRefractionMapping\r\n        this.scene.background = textureCube2\r\n\r\n\r\n\r\n        const light = new THREE.DirectionalLight(0xffd060, 1)\r\n        light.position.set(10, 10, 0)\r\n        this.scene.add(light)\r\n        const light1 = new THREE.DirectionalLight(0x60d0ff, 1)\r\n        light1.position.set(-10, 10, 0)\r\n        this.scene.add(light1)\r\n        const light2 = new THREE.PointLight(0x60d0ff, 1)\r\n        light2.position.set(0, 100, 0)\r\n        this.scene.add(light2)\r\n\r\n\r\n        // generate sphere array\r\n        const sinPeriods = 3\r\n        const sinAmplitude = 10\r\n        const sinRadius1 = 120\r\n        const sinRadius2 = 80\r\n        const ps = []\r\n        for (let i = 0; i < sinPeriods; i++) {\r\n            ps.push(new THREE.Vector3(\r\n                sinAmplitude / 2,\r\n                Math.cos(Math.PI * 2 * i / sinPeriods) * sinRadius1,\r\n                Math.sin(Math.PI * 2 * i / sinPeriods) * sinRadius2\r\n            ))\r\n            ps.push(new THREE.Vector3(\r\n                -sinAmplitude / 2,\r\n                Math.cos(Math.PI * 2 * (i+0.5) / sinPeriods) * sinRadius1,\r\n                Math.sin(Math.PI * 2 * (i+0.5) / sinPeriods) * sinRadius2\r\n            ))\r\n        }\r\n\r\n        const spline = new THREE.CatmullRomCurve3(ps, true)\r\n        spline.type = 'centripetal'\r\n        const samples = spline.getPoints( ps.length * 10 )\r\n\r\n        console.log(spline.getLength())\r\n        const splineLength = spline.getLength()\r\n        const sphereRadius = 5\r\n        const sphereCount = Math.floor(splineLength / (sphereRadius * 2))\r\n        const spherePositions: Array<THREE.Vector3> = []\r\n        for ( let i = 0; i < sphereCount; i++ ) {\r\n            spherePositions.push(\r\n                spline.getPointAt(i / sphereCount)\r\n            )\r\n        }\r\n\r\n        const geometrySpline = new THREE.BufferGeometry().setFromPoints( samples )\r\n        const line = new THREE.Line( geometrySpline, new THREE.LineDashedMaterial( { color: 0xff0000, dashSize: 1, gapSize: 0.5 } ) )\r\n        this.scene.add( line )\r\n\r\n\r\n        var particleGeometry = new THREE.SphereBufferGeometry(sphereRadius)\r\n        var particleMaterial = new THREE.MeshPhysicalMaterial({\r\n            clearcoat: 2.0,\r\n            clearcoatRoughness: 0.1,\r\n            metalness: 0.8,\r\n            roughness: 0.2,\r\n            sheen: 2,\r\n            sheenColor: new THREE.Color(0xffa050)\r\n            // emissive: new THREE.Color(0xffff80),\r\n            // emissiveIntensity: 0.5\r\n        })\r\n        var particleEngine1 = new PE.ParticleStaticEngine(sphereCount, particleGeometry, particleMaterial,\r\n            (index) => {\r\n                return spherePositions[index]\r\n            },\r\n            (_) => {\r\n                return new THREE.Euler(0,0,0)\r\n            },\r\n            (_) => {\r\n                return 1\r\n            },\r\n            (_) => {\r\n                return new THREE.Color(0xffffe0)\r\n            }\r\n        )\r\n        this.scene.add(particleEngine1.mesh)\r\n\r\n        const loader = new FBXLoader(this.loadingManager)\r\n        var ao1Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/lotus/color.jpg' )\r\n        var texMap = new THREE.TextureLoader(this.loadingManager).load( './flower1/bump.jpg' )\r\n        var normMap = new THREE.TextureLoader(this.loadingManager).load( './flower1/normal.png' )\r\n        loader.load( './flower1/lotus/lotus.fbx', (obj) => {\r\n            if (obj instanceof THREE.Group && obj.children[0] instanceof THREE.Mesh) {\r\n                const mesh = obj.children[0]\r\n                mesh.material = new THREE.MeshPhysicalMaterial({\r\n                    color: 0xa0a080,\r\n                    map: ao1Map,\r\n                    // reflectivity: 0.5,\r\n                    normalMap: normMap,\r\n                    normalScale: new THREE.Vector2(0.6),\r\n                    metalness: 0.6,\r\n                    metalnessMap: texMap,\r\n                    // roughnessMap: texMap,\r\n                    clearcoat: 1.0,\r\n                    clearcoatRoughness: 0.4,\r\n                    clearcoatMap: texMap,\r\n                    side: THREE.DoubleSide\r\n                })\r\n                // mesh.rotation.x = Math.PI / 4\r\n                self.scene.add(mesh)\r\n            }\r\n        })\r\n\r\n        var kao1Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/kud/kud_1.jpg' )\r\n        var kao2Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/kud/kud_2.jpg' )\r\n        const loader2 = new FBXLoader(this.loadingManager)\r\n        loader2.load( './flower1/kud/kud.fbx', (obj) => {\r\n            if (obj instanceof THREE.Group && obj.children[0] instanceof THREE.Mesh) {\r\n                const mesh = obj.children[0]\r\n                const frontbackMaterials = [\r\n                    new THREE.MeshPhysicalMaterial({\r\n                        color: 0xff8000,\r\n                        map: kao1Map,\r\n                        reflectivity: 0.5,\r\n                        metalness: 0.5,\r\n                        metalnessMap: texMap,\r\n                        // bumpMap: lotusBumpMap,\r\n                        // bumpScale: 10,\r\n                        clearcoat: 1.0,\r\n                        // normalMapType: THREE.ObjectSpaceNormalMap,\r\n                        side: THREE.BackSide\r\n                    }),\r\n                    new THREE.MeshPhysicalMaterial({\r\n                        color: 0x8080ff,\r\n                        map: kao2Map,\r\n                        reflectivity: 0.5,\r\n                        metalness: 0.5,\r\n                        metalnessMap: texMap,\r\n                        // bumpMap: lotusBumpMap,\r\n                        // bumpScale: 10,\r\n                        clearcoat: 1.0,\r\n                        // normalMapType: THREE.ObjectSpaceNormalMap,\r\n                        side: THREE.FrontSide\r\n                    })\r\n                ]\r\n                var frontBackMesh = createMultiMaterialObject( mesh.geometry, frontbackMaterials );\r\n                frontBackMesh.position.x += 200\r\n                // mesh.rotation.x = Math.PI / 4\r\n                self.scene.add(frontBackMesh)\r\n            }\r\n        })\r\n\r\n        \r\n        var fao1Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/f3/ao_1.jpg' )\r\n        var fao2Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/f3/ao_21.jpg' )\r\n        const loader3 = new FBXLoader(this.loadingManager)\r\n        loader3.load( './flower1/f3/f3.fbx', (obj) => {\r\n            if (obj instanceof THREE.Group && obj.children[0] instanceof THREE.Mesh) {\r\n                const mesh = obj.children[0]\r\n                const frontbackMaterials = [\r\n                    new THREE.MeshPhysicalMaterial({\r\n                        color: 0xffff20,\r\n                        map: fao1Map,\r\n                        reflectivity: 0.5,\r\n                        metalness: 0.5,\r\n                        metalnessMap: texMap,\r\n                        // bumpMap: lotusBumpMap,\r\n                        // bumpScale: 10,\r\n                        clearcoat: 1.0,\r\n                        // normalMapType: THREE.ObjectSpaceNormalMap,\r\n                        side: THREE.BackSide\r\n                    }),\r\n                    new THREE.MeshPhysicalMaterial({\r\n                        color: 0xff4040,\r\n                        map: fao2Map,\r\n                        reflectivity: 0.5,\r\n                        metalness: 0.5,\r\n                        metalnessMap: texMap,\r\n                        // bumpMap: lotusBumpMap,\r\n                        // bumpScale: 10,\r\n                        clearcoat: 1.0,\r\n                        // normalMapType: THREE.ObjectSpaceNormalMap,\r\n                        side: THREE.FrontSide\r\n                    })\r\n                ]\r\n                var frontBackMesh = createMultiMaterialObject( mesh.geometry, frontbackMaterials );\r\n                frontBackMesh.position.x -= 200\r\n                // mesh.rotation.x = Math.PI / 4\r\n                self.scene.add(frontBackMesh)\r\n            }\r\n        })\r\n\r\n\r\n        // logo cards\r\n        const logoColorMap = new THREE.TextureLoader(this.loadingManager).load( './logo/logo.jpg' )\r\n        const logoReflectMap = new THREE.TextureLoader(this.loadingManager).load( './logo/reflect.jpg' )\r\n        const logoMaterial = new THREE.MeshPhysicalMaterial({\r\n            map: logoColorMap,\r\n            reflectivity: 10,\r\n            metalnessMap: logoReflectMap,\r\n            // metalness: 0.5,\r\n            // lightMap: logoReflectMap,\r\n            metalness: 2,\r\n            // metalnessMap: logoReflectMap,\r\n            clearcoat: 1.0,\r\n            // specularIntensity: 5.0,\r\n            // clearcoatMap: logoReflectMap,\r\n            side: THREE.DoubleSide\r\n        })\r\n        const logoCardGeometry = new THREE.PlaneBufferGeometry(100, 100)\r\n        var logoCardEngine = new PE.ParticleStaticEngine(10, logoCardGeometry, logoMaterial,\r\n            (index) => {\r\n                return this.getRandomLogoPosition(index, 350)\r\n            },\r\n            (_) => {\r\n                return new THREE.Euler(\r\n                    Math.random() * 0.5 - 0.5,\r\n                    Math.random() * 0.5 - 0.25,\r\n                    Math.random() * 0.2 - 0.1)\r\n            },\r\n            (_) => {\r\n                return 1\r\n            },\r\n            (_) => {\r\n                return new THREE.Color(0xffffff)\r\n            }\r\n        )\r\n        this.scene.add(logoCardEngine.mesh)\r\n\r\n\r\n\r\n        // *********** events ***********\r\n        this.mousePosX = 0\r\n        this.mousePosY = 0\r\n        this.pointer = new THREE.Vector2()\r\n        window.addEventListener( 'resize', () => {\r\n            self.onWindowResize()\r\n        } )\r\n        window.addEventListener( 'click', (e) => {\r\n            self.onClick(e)\r\n        } )\r\n\r\n        // *********** final animate ***********\r\n        this.animate()\r\n    }\r\n\r\n    animate = () => {\r\n        requestAnimationFrame( this.animate )\r\n        // damping controllers\r\n        // this.updatecornerObject()\r\n        this.render()\r\n        this.stats.update()\r\n        this.controls.update()\r\n    }\r\n\r\n    render()\r\n    {\r\n        this.renderer.render(this.scene, this.camera)\r\n    }\r\n\r\n    onWindowResize() {\r\n        this.camera.aspect = window.innerWidth / window.innerHeight\r\n        this.camera.updateProjectionMatrix()\r\n        this.renderer.setSize( window.innerWidth, window.innerHeight )\r\n    }\r\n    \r\n    onClick(e: MouseEvent) {\r\n    }\r\n\r\n    getRandomLogoPosition(index: number, radius: number = 300): THREE.Vector3 {\r\n        let angle = randn_bm() * 0.8 - Math.PI / 2\r\n        let radiusNew = radius + randn_bm()\r\n        let randomOffset = new THREE.Vector3(randn_bm() * 60, randn_bm() * 5, randn_bm() * 60)\r\n        return new THREE.Vector3(Math.cos(angle), 0, Math.sin(angle)).multiplyScalar(radiusNew).add(randomOffset)\r\n    }\r\n\r\n    getCubemapUrls(dir: string, path: Array<string>): Array<string> {\r\n        var urls: Array<string> = []\r\n        path.forEach(p => {\r\n            urls.push(dir + p)\r\n        })\r\n        return urls\r\n    }\r\n\r\n}\r\n\r\n\r\nexport {\r\n    BackgroundManager\r\n}","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport * as THREE from 'three'\r\nimport Vue from 'vue'\r\nimport { BackgroundManager } from '../scripts/Background1.0'\r\n\r\ntype Data = {\r\n    fpm: BackgroundManager | null,\r\n    loadingStat: {\r\n        loaded: number,\r\n        total: number,\r\n        isLoaded: boolean,\r\n        noLoadingStat: boolean\r\n    }\r\n}\r\n\r\nexport default Vue.extend({\r\n    data(): Data {\r\n        return {\r\n            fpm: null,\r\n            loadingStat: {\r\n                loaded: 0,\r\n                total: 1,\r\n                isLoaded: false,\r\n                noLoadingStat: false\r\n            }\r\n        }\r\n    },\r\n    mounted() {\r\n        const self = this\r\n        if (this.$refs['canvas-container'] instanceof HTMLElement) {\r\n            this.fpm = new BackgroundManager(\r\n                this.$refs['canvas-container'],\r\n                () => {\r\n                    console.log('loaded')\r\n                    self.loadingStat.isLoaded = true\r\n                    setTimeout(() => {\r\n                        self.loadingStat.noLoadingStat = true\r\n                    }, 501)\r\n                },\r\n                (_, loaded, total) => {\r\n                    this.loadingStat.loaded = loaded\r\n                    this.loadingStat.total = total\r\n                },\r\n                (url) => {\r\n                    console.error('failed to load asset: ' + url)\r\n                    self.loadingStat.isLoaded = true\r\n                }\r\n            )\r\n        }\r\n    }\r\n})\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--15-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeBackgroundTest.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--15-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeBackgroundTest.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ThreeBackgroundTest.vue?vue&type=template&id=17a177c4&scoped=true&\"\nimport script from \"./ThreeBackgroundTest.vue?vue&type=script&lang=ts&\"\nexport * from \"./ThreeBackgroundTest.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ThreeBackgroundTest.vue?vue&type=style&index=0&id=17a177c4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"17a177c4\",\n  null\n  \n)\n\nexport default component.exports","// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,\n// backported and transplited with Babel, with backwards-compat fixes\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  if (path.length === 0) return '.';\n  var code = path.charCodeAt(0);\n  var hasRoot = code === 47 /*/*/;\n  var end = -1;\n  var matchedSlash = true;\n  for (var i = path.length - 1; i >= 1; --i) {\n    code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) return hasRoot ? '/' : '.';\n  if (hasRoot && end === 1) {\n    // return '//';\n    // Backwards-compat fix:\n    return '/';\n  }\n  return path.slice(0, end);\n};\n\nfunction basename(path) {\n  if (typeof path !== 'string') path = path + '';\n\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  for (i = path.length - 1; i >= 0; --i) {\n    if (path.charCodeAt(i) === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // path component\n      matchedSlash = false;\n      end = i + 1;\n    }\n  }\n\n  if (end === -1) return '';\n  return path.slice(start, end);\n}\n\n// Uses a mixed approach for backwards-compatibility, as ext behavior changed\n// in new Node.js versions, so only basename() above is backported here\nexports.basename = function (path, ext) {\n  var f = basename(path);\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\nexports.extname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true;\n  // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n  var preDotState = 0;\n  for (var i = path.length - 1; i >= 0; --i) {\n    var code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n    if (code === 46 /*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 ||\n      // We saw a non-dot character immediately before the dot\n      preDotState === 0 ||\n      // The (right-most) trimmed path component is exactly '..'\n      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n  return path.slice(startDot, end);\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","import * as TWEEN from '@tweenjs/tween.js'\r\nimport * as THREE from 'three'\r\n// import store from '@/store'\r\nimport * as GEOM from '../GeomUtils'\r\n\r\nclass TweenAnimController {\r\n    animationObjectCount: number\r\n    requestId: number\r\n    constructor() {\r\n        this.animationObjectCount = 0\r\n        this.requestId = -1\r\n    }\r\n    addTweenAnimObject() {\r\n        if(this.animationObjectCount <= 0) {\r\n            this.startAnim()\r\n        }\r\n        this.animationObjectCount ++\r\n    }\r\n    removeTweenAnimObject() {\r\n        if (this.animationObjectCount <= 0) {\r\n            return\r\n        }\r\n        if(this.animationObjectCount == 1) {\r\n            this.stopAnim()\r\n        }\r\n        this.animationObjectCount --\r\n    }\r\n    loopAnim = () => {\r\n        TWEEN.update()\r\n        if (this.requestId >= 0) {\r\n            this.requestId = window.requestAnimationFrame(this.loopAnim)\r\n        }\r\n    }\r\n    startAnim = () => {\r\n        if (this.requestId < 0) {\r\n            this.requestId = window.requestAnimationFrame(this.loopAnim)\r\n        }\r\n    }\r\n    stopAnim = () => {\r\n        if (this.requestId >= 0) {\r\n            window.cancelAnimationFrame(this.requestId)\r\n            this.requestId = -1\r\n        }\r\n    }\r\n    tweenNumber(\r\n            fromValue: number,\r\n            toValue: number,\r\n            onUpdateFunc: (value: number) => any,\r\n            onCompleteFunc: (value: number) => any,\r\n            duration: number = 1000,\r\n            easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n        ): void {\r\n        const v = { a: fromValue }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v)\r\n            .to({ a: toValue }, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(v.a))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(v.a)\r\n            }).start()\r\n    }\r\n    tweenVector2(\r\n        fromValue: GEOM.Vector2,\r\n        toValue: GEOM.Vector2,\r\n        onUpdateFunc: (x: number, y: number) => any,\r\n        onCompleteFunc: (x: number, y: number) => any,\r\n        duration: number = 1000,\r\n        easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n    ): void {\r\n        const v1 = { x: fromValue.x, y: fromValue.y }\r\n        const v2 = { x: toValue.x, y: toValue.y }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v1)\r\n            .to(v2, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(v1.x, v1.y))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(v1.x, v1.y)\r\n            }).start()\r\n    }\r\n    tweenVector3(\r\n        fromValue: GEOM.Vector3,\r\n        toValue: GEOM.Vector3,\r\n        onUpdateFunc: (x: number, y: number, z: number) => any,\r\n        onCompleteFunc: (x: number, y: number, z: number) => any,\r\n        duration: number = 1000,\r\n        easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n    ): void {\r\n        const v1 = { x: fromValue.x, y: fromValue.y, z: fromValue.z }\r\n        const v2 = { x: toValue.x, y: toValue.y, z: toValue.z }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v1)\r\n            .to(v2, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(v1.x, v1.y, v1.z))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(v1.x, v1.y, v1.z)\r\n            }).start()\r\n    }\r\n    tweenEuler(\r\n        fromValue: THREE.Euler,\r\n        toValue: THREE.Euler,\r\n        onUpdateFunc: (eu: THREE.Euler) => any,\r\n        onCompleteFunc: (eu: THREE.Euler) => any,\r\n        duration: number = 1000,\r\n        easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n    ): void {\r\n        const v1 = { x: fromValue.x, y: fromValue.y, z: fromValue.z }\r\n        const v2 = { x: toValue.x, y: toValue.y, z: toValue.z }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v1)\r\n            .to(v2, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(new THREE.Euler(v1.x, v1.y, v1.z)))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(new THREE.Euler(v1.x, v1.y, v1.z))\r\n            }).start()\r\n    }\r\n    tweenThreeVector3(\r\n        fromValue: THREE.Vector3,\r\n        toValue: THREE.Vector3,\r\n        onUpdateFunc: (eu: THREE.Vector3) => any,\r\n        onCompleteFunc: (eu: THREE.Vector3) => any,\r\n        duration: number = 1000,\r\n        easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n    ): void {\r\n        const v1 = { x: fromValue.x, y: fromValue.y, z: fromValue.z }\r\n        const v2 = { x: toValue.x, y: toValue.y, z: toValue.z }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v1)\r\n            .to(v2, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(new THREE.Vector3(v1.x, v1.y, v1.z)))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(new THREE.Vector3(v1.x, v1.y, v1.z))\r\n            }).start()\r\n    }\r\n}\r\n\r\nconst controller = new TweenAnimController()\r\n\r\nexport { controller }"],"sourceRoot":""}