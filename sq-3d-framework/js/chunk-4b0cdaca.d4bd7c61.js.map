{"version":3,"sources":["webpack:///./node_modules/core-js/internals/engine-ff-version.js","webpack:///./src/scripts/ThreeRealisticRefraction sync ^\\.\\/.*\\/F\\.glsl$","webpack:///./node_modules/core-js/internals/string-repeat.js","webpack:///./node_modules/@tweenjs/tween.js/dist/tween.esm.js","webpack:///./src/views/ThreeFrontpageTest.vue?b037","webpack:///./node_modules/core-js/modules/es.string.repeat.js","webpack:///./node_modules/node-libs-browser/mock/process.js","webpack:///./src/views/ThreeFrontpageTest.vue?8e9f","webpack:///./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack:///./src/scripts/Three/Carousel.ts","webpack:///./node_modules/three/examples/jsm/loaders/TDSLoader.js","webpack:///./src/scripts/Three/FrontPage.ts","webpack:///./src/views/ThreeFrontpageTest.vue","webpack:///./src/views/ThreeFrontpageTest.vue?e700","webpack:///./src/views/ThreeFrontpageTest.vue?5b81","webpack:///./node_modules/core-js/modules/es.array.sort.js","webpack:///./node_modules/core-js/internals/engine-webkit-version.js","webpack:///./src/scripts/ThreeRealisticRefraction sync ^\\.\\/.*\\/V\\.glsl$","webpack:///./node_modules/three/examples/jsm/geometries/RoundedBoxGeometry.js","webpack:///./src/scripts/ThreeRealisticRefraction/ShaderLoader.ts","webpack:///./src/scripts/ThreeRealisticRefraction/ThreeRealisticRefraction.ts","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./node_modules/core-js/modules/es.array.splice.js","webpack:///./node_modules/core-js/internals/array-sort.js","webpack:///./node_modules/core-js/modules/es.object.keys.js","webpack:///./src/scripts/ThreeRealisticRefraction/GlassFrontShader/V.glsl","webpack:///./node_modules/core-js/modules/es.array.map.js","webpack:///./node_modules/core-js/internals/engine-is-ie-or-edge.js","webpack:///./node_modules/path-browserify/index.js","webpack:///./src/scripts/ThreeRealisticRefraction/GlassFrontShader/F.glsl","webpack:///./node_modules/three/examples/jsm/objects/Reflector.js","webpack:///./src/scripts/Three/SQWater.ts","webpack:///./src/scripts/AnimUtils/TweenUtils.ts"],"names":["userAgent","firefox","match","module","exports","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","global","toIntegerOrInfinity","toString","requireObjectCoercible","RangeError","count","str","this","result","n","Infinity","now","Easing","Linear","None","amount","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","Math","cos","PI","sin","Exponential","pow","Circular","sqrt","Elastic","Back","s","Bounce","self","process","hrtime","time","undefined","performance","bind","Date","getTime","now$1","Group","_tweens","_tweensAddedDuringUpdate","prototype","getAll","_this","tweenId","removeAll","add","tween","getId","remove","update","preserve","tweenIds","length","i","autoStart","Interpolation","v","k","m","f","floor","fn","Utils","Bezier","b","pw","bn","Bernstein","CatmullRom","p0","p1","t","fc","Factorial","a","p2","p3","v0","v1","t2","t3","Sequence","nextId","_nextId","mainGroup","Tween","_object","_group","_isPaused","_pauseStart","_valuesStart","_valuesEnd","_valuesStartRepeat","_duration","_initialRepeat","_repeat","_yoyo","_isPlaying","_reversed","_delayTime","_startTime","_easingFunction","_interpolationFunction","_chainedTweens","_onStartCallbackFired","_id","_isChainStopped","_goToEnd","isPlaying","isPaused","to","properties","duration","create","d","start","property","_swapEndStartRepeatValues","parseFloat","_setupProperties","startValue","startValueIsArray","Array","isArray","propType","isInterpolationList","endValues","_handleRelativeValue","concat","slice","reverse","prop","stop","stopChainedTweens","_onStopCallback","end","pause","resume","numChainedTweens","group","delay","repeat","times","repeatDelay","_repeatDelayTime","yoyo","easing","easingFunction","interpolation","interpolationFunction","chain","tweens","_i","arguments","onStart","callback","_onStartCallback","onUpdate","_onUpdateCallback","onRepeat","_onRepeatCallback","onComplete","_onCompleteCallback","onStop","elapsed","endTime","value","_updateProperties","isFinite","startIsArray","endIsArray","charAt","tmp","endValue","TWEEN","$","target","proto","nextTick","args","call","shift","setTimeout","apply","platform","arch","execPath","title","pid","browser","env","argv","binding","name","path","cwd","chdir","dir","exit","kill","umask","dlopen","uptime","memoryUsage","uvCounters","features","render","_vm","_h","$createElement","_c","_self","ref","attrs","staticClass","class","loadingStat","isLoaded","noLoadingStat","style","width","loaded","total","_v","_s","round","on","onGlassClick","_m","staticRenderFns","asyncGeneratorStep","gen","reject","_next","_throw","key","arg","info","error","done","Promise","then","_asyncToGenerator","err","index","mesh","uniforms","textureList","isPushingTexture","newTexture","push","splice","recPushTexture","vTextureMix","vTextures","tweenNumber","options","numOfVisiblePics","isRotating","rotateNode","currentCenter","planes","planeWidth","planeHeight","planeGap","preloadImgs","maxPreloadImgCount","carouselArrayRadius","carouselArrayAngle","atan","vs","fs","tempUniforms","vColor","type","tempPlane","vertexShader","fragmentShader","offset","rotation","y","position","x","z","forEach","plane","__imgSrcToTex","ceil","random","pushNewTexture","raycaster","getImgSrcFunc","imgMeshes","intersects","intersectObjects","intersectObj","object","intersectIndex","indexOf","src","step","moveLeft","moveRight","moveStep","sort","v2","rightmostImg","tempRotationPosition","leftmostImg","imgSrc","imageLoader","setCrossOrigin","load","tempImageElement","texture","needsUpdate","imgTex","canRemoveImg","planeIndex","dispose","manager","super","debug","materials","meshes","url","onLoad","onProgress","onError","scope","extractUrlBase","loader","setPath","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","data","parse","console","itemError","arraybuffer","readFile","DataView","chunk","Chunk","debugMessage","MLIBMAGIC","CMAGIC","M3DMAGIC","next","readChunk","M3D_VERSION","version","readDWord","MDATA","readMeshData","hexId","MESH_VERSION","MASTER_SCALE","scale","readFloat","set","NAMED_OBJECT","readNamedObject","MAT_ENTRY","readMaterialEntry","readString","N_TRI_OBJECT","readMesh","material","MAT_NAME","MAT_WIRE","wireframe","MAT_WIRE_SIZE","readByte","wireframeLinewidth","MAT_TWO_SIDE","side","MAT_ADDITIVE","blending","MAT_DIFFUSE","color","readColor","MAT_SPECULAR","specular","MAT_AMBIENT","MAT_SHININESS","shininess","readPercentage","MAT_TRANSPARENCY","transparency","opacity","transparent","MAT_TEXMAP","readMap","MAT_BUMPMAP","bumpMap","MAT_OPACMAP","alphaMap","MAT_SPECMAP","specularMap","geometry","POINT_ARRAY","points","readWord","vertices","setAttribute","FACE_ARRAY","readFaceArray","TEX_VERTS","texels","uvs","MESH_MATRIX","values","matrix","elements","transpose","inverse","copy","invert","applyMatrix4","decompose","quaternion","computeVertexNormals","faces","setIndex","materialIndex","endOfChunk","subchunk","MSH_MAT_GROUP","readMaterialGroup","addGroup","resourcePath","crossOrigin","MAT_MAPNAME","MAT_MAP_UOFFSET","MAT_MAP_VOFFSET","MAT_MAP_USCALE","MAT_MAP_VSCALE","numFaces","subChunk","COLOR_24","LIN_COLOR_24","r","g","setRGB","COLOR_F","LIN_COLOR_F","INT_PERCENTAGE","readShort","FLOAT_PERCENTAGE","message","log","Function","size","byteLength","getUint8","getFloat32","getInt32","getInt16","getUint32","getUint16","c","String","fromCharCode","_container","requestAnimationFrame","animate","updatecornerObject","updateCamera","updateCursorLight","stats","cameraZPosition","container","camera","window","innerWidth","innerHeight","renderer","alpha","setClearColor","setPixelRatio","devicePixelRatio","setSize","domElement","top","left","appendChild","zIndex","scene","cssScene","cardInsideScene","reflectionScene","loadingManager","urls","textureCube","mapping","environment","light","intensity","refractionManager","glassMesh1","RoundedBoxGeometry","glassMesh1InteractAgent","visible","addRefractionMesh","glassMesh1Controller","renderPass1","RenderPass","clear","renderPass2","clearDepth","composer","EffectComposer","offsetWidth","offsetHeight","addPass","renderTarget1","stencilBuffer","renderTarget2","tardisCardTop","TardisCard","RECT","addSkybox","contentGroupInTardisCardTop","titleTexture","tardisCardTopTitle","alphaToCoverage","cardMesh","addVisibleObjectGroup","cssAttachObject","tardisCard1","diffuseTexture","normalTexture","specTexture","texs","wrapS","wrapT","contentGroupInTardisCard1","pgnormal","setResourcePath","obj","traverse","child","normalMap","multiplyScalar","tardisCardBackground1","normalScale","specularColorMap","specularIntensity","reflectivity","metalness","roughness","clearcoat","tardisCard2","CIRCLE","carousel1","diffuseTexture2","normalTexture2","specTexture2","tardisCardBackground","contentGroupInTardisCard2","tardisCard3","carousel2","diffuseTexture3","normalTexture3","specTexture3","contentGroupInTardisCard3","waterGeometry","water","SQWater","flowDirection","textureWidth","textureHeight","cameraTargetPosition","lookAt","cameraWithMouseMoveFactor","cameraWithMouseRotateFactor","cameraPositionController","addEventListener","onMouseMove","cursorLightGroup","cursorLight","decay","distance","cursorLightController","intersectTardisCardObjs","intersectGlassObjs","glassSelected","glassIsRotating","mousePosX","mousePosY","pointer","onWindowResize","onClick","cssRenderer","aspect","updateProjectionMatrix","clientX","clientY","setFromCamera","parent","rotateObj","tweenEuler","val","refractionMaterialUniforms","refObj","tweenThreeVector3","updatedVec","clickToRotate","carouselIndex","clickToChangeTex","posX","posY","ray","unproject","targetPos","getRaycastPos","relX","relY","dampPos","vel","velocity","isNaN","camPosZ","targetPosVec","sub","newz","htmlContainer","htmlElem","CustomCSS3DRenderer","extend","fpm","mounted","$refs","HTMLElement","_","glassCSSObj","registerCSSCoordinator","setFollowObject","methods","alert","component","uncurryThis","aCallable","toObject","lengthOfArrayLike","fails","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","test","un$Sort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","chr","FORCED","getSortCompare","comparefn","forced","array","itemsLength","items","arrayLength","webkit","_tempNormal","getUv","faceDirVector","normal","uvAxis","projectionAxis","radius","sideLength","totArcLength","centerLength","max","halfArc","normalize","arcUvRatio","arcAngleRatio","angleTo","sign","lenUv","height","depth","segments","min","geometry2","toNonIndexed","attributes","uv","box","divideScalar","subScalar","positions","normals","faceTris","halfSegmentSize","j","fromArray","loadShader","shaderName","fragShader","controls","rm","suResolution","suBackground","suImage","suDepth","backColor","absorbColor","suRefractionFactor","suOpacity","originalMaterial","clone","glassFrontVS","glassFrontFS","refractionMaterial","backgroundScene","backDepthTextureSize","frontScene","backdepthTexture","backRenderTarget","depthBuffer","depthTexture","background","refractionObjectList","shader","lib","parameters","setDefaultBacksideMaterial","image","refractionFactor","opacityFactor","_backColor","setRenderTarget","initScene","antialias","OrbitControls","floorTexture","floorMaterial","floorGeometry","glassMesh2","glassMesh3","ballMesh","runtime","Op","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","defineProperty","enumerable","configurable","writable","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","makeInvokeMethod","tryCatch","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","Gp","defineIteratorMethods","method","AsyncIterator","PromiseImpl","invoke","record","__await","unwrapped","previousPromise","enqueue","callInvokeWithMethodAndArg","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","displayName","isGeneratorFunction","genFun","ctor","constructor","mark","setPrototypeOf","__proto__","awrap","async","iter","pop","skipTempReset","prev","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","globalThis","toAbsoluteIndex","arraySpeciesCreate","createProperty","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_LENGTH_EXCEEDED","deleteCount","insertCount","actualDeleteCount","A","from","O","len","actualStart","argumentsLength","arraySlice","mergeSort","middle","insertionSort","merge","element","right","llength","rlength","lindex","rindex","nativeKeys","FAILS_ON_PRIMITIVES","stat","it","$map","callbackfn","UA","normalizeArray","parts","allowAboveRoot","up","last","unshift","basename","matchedSlash","charCodeAt","filter","xs","res","resolvedPath","resolvedAbsolute","split","p","join","isAbsolute","trailingSlash","substr","paths","relative","trim","arr","fromParts","toParts","samePartsLength","outputParts","sep","delimiter","dirname","hasRoot","ext","extname","startDot","startPart","preDotState","clipBias","ReflectorShader","reflectorPlane","reflectorWorldPosition","cameraWorldPosition","rotationMatrix","lookAtPosition","clipPlane","view","q","textureMatrix","virtualCamera","renderTarget","onBeforeRender","setFromMatrixPosition","matrixWorld","extractRotation","subVectors","dot","reflect","negate","far","updateMatrixWorld","projectionMatrix","multiply","matrixWorldInverse","setFromNormalAndCoplanarPoint","constant","w","encoding","outputEncoding","currentRenderTarget","getRenderTarget","currentXrEnabled","xr","enabled","currentShadowAutoUpdate","shadowMap","autoUpdate","buffers","setMask","autoClear","viewport","isReflector","flowSpeed","WaterShader","textureLoader","normalMap0","normalMap1","cycle","halfCycle","clock","reflector","updateTextureMatrix","updateFlow","delta","getDelta","config","matrixAutoUpdate","fog","TweenAnimController","requestId","loopAnim","cancelAnimationFrame","animationObjectCount","startAnim","stopAnim","fromValue","toValue","onUpdateFunc","onCompleteFunc","addTweenAnimObject","removeTweenAnimObject","controller"],"mappings":"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","file":"js/chunk-4b0cdaca.d4bd7c61.js","sourcesContent":["var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","var map = {\n\t\"./GlassFrontShader/F.glsl\": \"f430\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"08fd\";","'use strict';\nvar global = require('../internals/global');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar RangeError = global.RangeError;\n\n// `String.prototype.repeat` method implementation\n// https://tc39.es/ecma262/#sec-string.prototype.repeat\nmodule.exports = function repeat(count) {\n  var str = toString(requireObjectCoercible(this));\n  var result = '';\n  var n = toIntegerOrInfinity(count);\n  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;\n  return result;\n};\n","/**\n * The Ease class provides a collection of easing functions for use with tween.js.\n */\nvar Easing = {\n    Linear: {\n        None: function (amount) {\n            return amount;\n        },\n    },\n    Quadratic: {\n        In: function (amount) {\n            return amount * amount;\n        },\n        Out: function (amount) {\n            return amount * (2 - amount);\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount;\n            }\n            return -0.5 * (--amount * (amount - 2) - 1);\n        },\n    },\n    Cubic: {\n        In: function (amount) {\n            return amount * amount * amount;\n        },\n        Out: function (amount) {\n            return --amount * amount * amount + 1;\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount * amount;\n            }\n            return 0.5 * ((amount -= 2) * amount * amount + 2);\n        },\n    },\n    Quartic: {\n        In: function (amount) {\n            return amount * amount * amount * amount;\n        },\n        Out: function (amount) {\n            return 1 - --amount * amount * amount * amount;\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount * amount * amount;\n            }\n            return -0.5 * ((amount -= 2) * amount * amount * amount - 2);\n        },\n    },\n    Quintic: {\n        In: function (amount) {\n            return amount * amount * amount * amount * amount;\n        },\n        Out: function (amount) {\n            return --amount * amount * amount * amount * amount + 1;\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount * amount * amount * amount;\n            }\n            return 0.5 * ((amount -= 2) * amount * amount * amount * amount + 2);\n        },\n    },\n    Sinusoidal: {\n        In: function (amount) {\n            return 1 - Math.cos((amount * Math.PI) / 2);\n        },\n        Out: function (amount) {\n            return Math.sin((amount * Math.PI) / 2);\n        },\n        InOut: function (amount) {\n            return 0.5 * (1 - Math.cos(Math.PI * amount));\n        },\n    },\n    Exponential: {\n        In: function (amount) {\n            return amount === 0 ? 0 : Math.pow(1024, amount - 1);\n        },\n        Out: function (amount) {\n            return amount === 1 ? 1 : 1 - Math.pow(2, -10 * amount);\n        },\n        InOut: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            if ((amount *= 2) < 1) {\n                return 0.5 * Math.pow(1024, amount - 1);\n            }\n            return 0.5 * (-Math.pow(2, -10 * (amount - 1)) + 2);\n        },\n    },\n    Circular: {\n        In: function (amount) {\n            return 1 - Math.sqrt(1 - amount * amount);\n        },\n        Out: function (amount) {\n            return Math.sqrt(1 - --amount * amount);\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return -0.5 * (Math.sqrt(1 - amount * amount) - 1);\n            }\n            return 0.5 * (Math.sqrt(1 - (amount -= 2) * amount) + 1);\n        },\n    },\n    Elastic: {\n        In: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            return -Math.pow(2, 10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI);\n        },\n        Out: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            return Math.pow(2, -10 * amount) * Math.sin((amount - 0.1) * 5 * Math.PI) + 1;\n        },\n        InOut: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            amount *= 2;\n            if (amount < 1) {\n                return -0.5 * Math.pow(2, 10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI);\n            }\n            return 0.5 * Math.pow(2, -10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI) + 1;\n        },\n    },\n    Back: {\n        In: function (amount) {\n            var s = 1.70158;\n            return amount * amount * ((s + 1) * amount - s);\n        },\n        Out: function (amount) {\n            var s = 1.70158;\n            return --amount * amount * ((s + 1) * amount + s) + 1;\n        },\n        InOut: function (amount) {\n            var s = 1.70158 * 1.525;\n            if ((amount *= 2) < 1) {\n                return 0.5 * (amount * amount * ((s + 1) * amount - s));\n            }\n            return 0.5 * ((amount -= 2) * amount * ((s + 1) * amount + s) + 2);\n        },\n    },\n    Bounce: {\n        In: function (amount) {\n            return 1 - Easing.Bounce.Out(1 - amount);\n        },\n        Out: function (amount) {\n            if (amount < 1 / 2.75) {\n                return 7.5625 * amount * amount;\n            }\n            else if (amount < 2 / 2.75) {\n                return 7.5625 * (amount -= 1.5 / 2.75) * amount + 0.75;\n            }\n            else if (amount < 2.5 / 2.75) {\n                return 7.5625 * (amount -= 2.25 / 2.75) * amount + 0.9375;\n            }\n            else {\n                return 7.5625 * (amount -= 2.625 / 2.75) * amount + 0.984375;\n            }\n        },\n        InOut: function (amount) {\n            if (amount < 0.5) {\n                return Easing.Bounce.In(amount * 2) * 0.5;\n            }\n            return Easing.Bounce.Out(amount * 2 - 1) * 0.5 + 0.5;\n        },\n    },\n};\n\nvar now;\n// Include a performance.now polyfill.\n// In node.js, use process.hrtime.\n// eslint-disable-next-line\n// @ts-ignore\nif (typeof self === 'undefined' && typeof process !== 'undefined' && process.hrtime) {\n    now = function () {\n        // eslint-disable-next-line\n        // @ts-ignore\n        var time = process.hrtime();\n        // Convert [seconds, nanoseconds] to milliseconds.\n        return time[0] * 1000 + time[1] / 1000000;\n    };\n}\n// In a browser, use self.performance.now if it is available.\nelse if (typeof self !== 'undefined' && self.performance !== undefined && self.performance.now !== undefined) {\n    // This must be bound, because directly assigning this function\n    // leads to an invocation exception in Chrome.\n    now = self.performance.now.bind(self.performance);\n}\n// Use Date.now if it is available.\nelse if (Date.now !== undefined) {\n    now = Date.now;\n}\n// Otherwise, use 'new Date().getTime()'.\nelse {\n    now = function () {\n        return new Date().getTime();\n    };\n}\nvar now$1 = now;\n\n/**\n * Controlling groups of tweens\n *\n * Using the TWEEN singleton to manage your tweens can cause issues in large apps with many components.\n * In these cases, you may want to create your own smaller groups of tween\n */\nvar Group = /** @class */ (function () {\n    function Group() {\n        this._tweens = {};\n        this._tweensAddedDuringUpdate = {};\n    }\n    Group.prototype.getAll = function () {\n        var _this = this;\n        return Object.keys(this._tweens).map(function (tweenId) {\n            return _this._tweens[tweenId];\n        });\n    };\n    Group.prototype.removeAll = function () {\n        this._tweens = {};\n    };\n    Group.prototype.add = function (tween) {\n        this._tweens[tween.getId()] = tween;\n        this._tweensAddedDuringUpdate[tween.getId()] = tween;\n    };\n    Group.prototype.remove = function (tween) {\n        delete this._tweens[tween.getId()];\n        delete this._tweensAddedDuringUpdate[tween.getId()];\n    };\n    Group.prototype.update = function (time, preserve) {\n        if (time === void 0) { time = now$1(); }\n        if (preserve === void 0) { preserve = false; }\n        var tweenIds = Object.keys(this._tweens);\n        if (tweenIds.length === 0) {\n            return false;\n        }\n        // Tweens are updated in \"batches\". If you add a new tween during an\n        // update, then the new tween will be updated in the next batch.\n        // If you remove a tween during an update, it may or may not be updated.\n        // However, if the removed tween was added during the current batch,\n        // then it will not be updated.\n        while (tweenIds.length > 0) {\n            this._tweensAddedDuringUpdate = {};\n            for (var i = 0; i < tweenIds.length; i++) {\n                var tween = this._tweens[tweenIds[i]];\n                var autoStart = !preserve;\n                if (tween && tween.update(time, autoStart) === false && !preserve) {\n                    delete this._tweens[tweenIds[i]];\n                }\n            }\n            tweenIds = Object.keys(this._tweensAddedDuringUpdate);\n        }\n        return true;\n    };\n    return Group;\n}());\n\n/**\n *\n */\nvar Interpolation = {\n    Linear: function (v, k) {\n        var m = v.length - 1;\n        var f = m * k;\n        var i = Math.floor(f);\n        var fn = Interpolation.Utils.Linear;\n        if (k < 0) {\n            return fn(v[0], v[1], f);\n        }\n        if (k > 1) {\n            return fn(v[m], v[m - 1], m - f);\n        }\n        return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\n    },\n    Bezier: function (v, k) {\n        var b = 0;\n        var n = v.length - 1;\n        var pw = Math.pow;\n        var bn = Interpolation.Utils.Bernstein;\n        for (var i = 0; i <= n; i++) {\n            b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\n        }\n        return b;\n    },\n    CatmullRom: function (v, k) {\n        var m = v.length - 1;\n        var f = m * k;\n        var i = Math.floor(f);\n        var fn = Interpolation.Utils.CatmullRom;\n        if (v[0] === v[m]) {\n            if (k < 0) {\n                i = Math.floor((f = m * (1 + k)));\n            }\n            return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\n        }\n        else {\n            if (k < 0) {\n                return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\n            }\n            if (k > 1) {\n                return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\n            }\n            return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\n        }\n    },\n    Utils: {\n        Linear: function (p0, p1, t) {\n            return (p1 - p0) * t + p0;\n        },\n        Bernstein: function (n, i) {\n            var fc = Interpolation.Utils.Factorial;\n            return fc(n) / fc(i) / fc(n - i);\n        },\n        Factorial: (function () {\n            var a = [1];\n            return function (n) {\n                var s = 1;\n                if (a[n]) {\n                    return a[n];\n                }\n                for (var i = n; i > 1; i--) {\n                    s *= i;\n                }\n                a[n] = s;\n                return s;\n            };\n        })(),\n        CatmullRom: function (p0, p1, p2, p3, t) {\n            var v0 = (p2 - p0) * 0.5;\n            var v1 = (p3 - p1) * 0.5;\n            var t2 = t * t;\n            var t3 = t * t2;\n            return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\n        },\n    },\n};\n\n/**\n * Utils\n */\nvar Sequence = /** @class */ (function () {\n    function Sequence() {\n    }\n    Sequence.nextId = function () {\n        return Sequence._nextId++;\n    };\n    Sequence._nextId = 0;\n    return Sequence;\n}());\n\nvar mainGroup = new Group();\n\n/**\n * Tween.js - Licensed under the MIT license\n * https://github.com/tweenjs/tween.js\n * ----------------------------------------------\n *\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\n * Thank you all, you're awesome!\n */\nvar Tween = /** @class */ (function () {\n    function Tween(_object, _group) {\n        if (_group === void 0) { _group = mainGroup; }\n        this._object = _object;\n        this._group = _group;\n        this._isPaused = false;\n        this._pauseStart = 0;\n        this._valuesStart = {};\n        this._valuesEnd = {};\n        this._valuesStartRepeat = {};\n        this._duration = 1000;\n        this._initialRepeat = 0;\n        this._repeat = 0;\n        this._yoyo = false;\n        this._isPlaying = false;\n        this._reversed = false;\n        this._delayTime = 0;\n        this._startTime = 0;\n        this._easingFunction = Easing.Linear.None;\n        this._interpolationFunction = Interpolation.Linear;\n        this._chainedTweens = [];\n        this._onStartCallbackFired = false;\n        this._id = Sequence.nextId();\n        this._isChainStopped = false;\n        this._goToEnd = false;\n    }\n    Tween.prototype.getId = function () {\n        return this._id;\n    };\n    Tween.prototype.isPlaying = function () {\n        return this._isPlaying;\n    };\n    Tween.prototype.isPaused = function () {\n        return this._isPaused;\n    };\n    Tween.prototype.to = function (properties, duration) {\n        // TODO? restore this, then update the 07_dynamic_to example to set fox\n        // tween's to on each update. That way the behavior is opt-in (there's\n        // currently no opt-out).\n        // for (const prop in properties) this._valuesEnd[prop] = properties[prop]\n        this._valuesEnd = Object.create(properties);\n        if (duration !== undefined) {\n            this._duration = duration;\n        }\n        return this;\n    };\n    Tween.prototype.duration = function (d) {\n        this._duration = d;\n        return this;\n    };\n    Tween.prototype.start = function (time) {\n        if (this._isPlaying) {\n            return this;\n        }\n        // eslint-disable-next-line\n        this._group && this._group.add(this);\n        this._repeat = this._initialRepeat;\n        if (this._reversed) {\n            // If we were reversed (f.e. using the yoyo feature) then we need to\n            // flip the tween direction back to forward.\n            this._reversed = false;\n            for (var property in this._valuesStartRepeat) {\n                this._swapEndStartRepeatValues(property);\n                this._valuesStart[property] = this._valuesStartRepeat[property];\n            }\n        }\n        this._isPlaying = true;\n        this._isPaused = false;\n        this._onStartCallbackFired = false;\n        this._isChainStopped = false;\n        this._startTime = time !== undefined ? (typeof time === 'string' ? now$1() + parseFloat(time) : time) : now$1();\n        this._startTime += this._delayTime;\n        this._setupProperties(this._object, this._valuesStart, this._valuesEnd, this._valuesStartRepeat);\n        return this;\n    };\n    Tween.prototype._setupProperties = function (_object, _valuesStart, _valuesEnd, _valuesStartRepeat) {\n        for (var property in _valuesEnd) {\n            var startValue = _object[property];\n            var startValueIsArray = Array.isArray(startValue);\n            var propType = startValueIsArray ? 'array' : typeof startValue;\n            var isInterpolationList = !startValueIsArray && Array.isArray(_valuesEnd[property]);\n            // If `to()` specifies a property that doesn't exist in the source object,\n            // we should not set that property in the object\n            if (propType === 'undefined' || propType === 'function') {\n                continue;\n            }\n            // Check if an Array was provided as property value\n            if (isInterpolationList) {\n                var endValues = _valuesEnd[property];\n                if (endValues.length === 0) {\n                    continue;\n                }\n                // handle an array of relative values\n                endValues = endValues.map(this._handleRelativeValue.bind(this, startValue));\n                // Create a local copy of the Array with the start value at the front\n                _valuesEnd[property] = [startValue].concat(endValues);\n            }\n            // handle the deepness of the values\n            if ((propType === 'object' || startValueIsArray) && startValue && !isInterpolationList) {\n                _valuesStart[property] = startValueIsArray ? [] : {};\n                // eslint-disable-next-line\n                for (var prop in startValue) {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _valuesStart[property][prop] = startValue[prop];\n                }\n                _valuesStartRepeat[property] = startValueIsArray ? [] : {}; // TODO? repeat nested values? And yoyo? And array values?\n                // eslint-disable-next-line\n                // @ts-ignore FIXME?\n                this._setupProperties(startValue, _valuesStart[property], _valuesEnd[property], _valuesStartRepeat[property]);\n            }\n            else {\n                // Save the starting value, but only once.\n                if (typeof _valuesStart[property] === 'undefined') {\n                    _valuesStart[property] = startValue;\n                }\n                if (!startValueIsArray) {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings\n                }\n                if (isInterpolationList) {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _valuesStartRepeat[property] = _valuesEnd[property].slice().reverse();\n                }\n                else {\n                    _valuesStartRepeat[property] = _valuesStart[property] || 0;\n                }\n            }\n        }\n    };\n    Tween.prototype.stop = function () {\n        if (!this._isChainStopped) {\n            this._isChainStopped = true;\n            this.stopChainedTweens();\n        }\n        if (!this._isPlaying) {\n            return this;\n        }\n        // eslint-disable-next-line\n        this._group && this._group.remove(this);\n        this._isPlaying = false;\n        this._isPaused = false;\n        if (this._onStopCallback) {\n            this._onStopCallback(this._object);\n        }\n        return this;\n    };\n    Tween.prototype.end = function () {\n        this._goToEnd = true;\n        this.update(Infinity);\n        return this;\n    };\n    Tween.prototype.pause = function (time) {\n        if (time === void 0) { time = now$1(); }\n        if (this._isPaused || !this._isPlaying) {\n            return this;\n        }\n        this._isPaused = true;\n        this._pauseStart = time;\n        // eslint-disable-next-line\n        this._group && this._group.remove(this);\n        return this;\n    };\n    Tween.prototype.resume = function (time) {\n        if (time === void 0) { time = now$1(); }\n        if (!this._isPaused || !this._isPlaying) {\n            return this;\n        }\n        this._isPaused = false;\n        this._startTime += time - this._pauseStart;\n        this._pauseStart = 0;\n        // eslint-disable-next-line\n        this._group && this._group.add(this);\n        return this;\n    };\n    Tween.prototype.stopChainedTweens = function () {\n        for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {\n            this._chainedTweens[i].stop();\n        }\n        return this;\n    };\n    Tween.prototype.group = function (group) {\n        this._group = group;\n        return this;\n    };\n    Tween.prototype.delay = function (amount) {\n        this._delayTime = amount;\n        return this;\n    };\n    Tween.prototype.repeat = function (times) {\n        this._initialRepeat = times;\n        this._repeat = times;\n        return this;\n    };\n    Tween.prototype.repeatDelay = function (amount) {\n        this._repeatDelayTime = amount;\n        return this;\n    };\n    Tween.prototype.yoyo = function (yoyo) {\n        this._yoyo = yoyo;\n        return this;\n    };\n    Tween.prototype.easing = function (easingFunction) {\n        this._easingFunction = easingFunction;\n        return this;\n    };\n    Tween.prototype.interpolation = function (interpolationFunction) {\n        this._interpolationFunction = interpolationFunction;\n        return this;\n    };\n    Tween.prototype.chain = function () {\n        var tweens = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            tweens[_i] = arguments[_i];\n        }\n        this._chainedTweens = tweens;\n        return this;\n    };\n    Tween.prototype.onStart = function (callback) {\n        this._onStartCallback = callback;\n        return this;\n    };\n    Tween.prototype.onUpdate = function (callback) {\n        this._onUpdateCallback = callback;\n        return this;\n    };\n    Tween.prototype.onRepeat = function (callback) {\n        this._onRepeatCallback = callback;\n        return this;\n    };\n    Tween.prototype.onComplete = function (callback) {\n        this._onCompleteCallback = callback;\n        return this;\n    };\n    Tween.prototype.onStop = function (callback) {\n        this._onStopCallback = callback;\n        return this;\n    };\n    /**\n     * @returns true if the tween is still playing after the update, false\n     * otherwise (calling update on a paused tween still returns true because\n     * it is still playing, just paused).\n     */\n    Tween.prototype.update = function (time, autoStart) {\n        if (time === void 0) { time = now$1(); }\n        if (autoStart === void 0) { autoStart = true; }\n        if (this._isPaused)\n            return true;\n        var property;\n        var elapsed;\n        var endTime = this._startTime + this._duration;\n        if (!this._goToEnd && !this._isPlaying) {\n            if (time > endTime)\n                return false;\n            if (autoStart)\n                this.start(time);\n        }\n        this._goToEnd = false;\n        if (time < this._startTime) {\n            return true;\n        }\n        if (this._onStartCallbackFired === false) {\n            if (this._onStartCallback) {\n                this._onStartCallback(this._object);\n            }\n            this._onStartCallbackFired = true;\n        }\n        elapsed = (time - this._startTime) / this._duration;\n        elapsed = this._duration === 0 || elapsed > 1 ? 1 : elapsed;\n        var value = this._easingFunction(elapsed);\n        // properties transformations\n        this._updateProperties(this._object, this._valuesStart, this._valuesEnd, value);\n        if (this._onUpdateCallback) {\n            this._onUpdateCallback(this._object, elapsed);\n        }\n        if (elapsed === 1) {\n            if (this._repeat > 0) {\n                if (isFinite(this._repeat)) {\n                    this._repeat--;\n                }\n                // Reassign starting values, restart by making startTime = now\n                for (property in this._valuesStartRepeat) {\n                    if (!this._yoyo && typeof this._valuesEnd[property] === 'string') {\n                        this._valuesStartRepeat[property] =\n                            // eslint-disable-next-line\n                            // @ts-ignore FIXME?\n                            this._valuesStartRepeat[property] + parseFloat(this._valuesEnd[property]);\n                    }\n                    if (this._yoyo) {\n                        this._swapEndStartRepeatValues(property);\n                    }\n                    this._valuesStart[property] = this._valuesStartRepeat[property];\n                }\n                if (this._yoyo) {\n                    this._reversed = !this._reversed;\n                }\n                if (this._repeatDelayTime !== undefined) {\n                    this._startTime = time + this._repeatDelayTime;\n                }\n                else {\n                    this._startTime = time + this._delayTime;\n                }\n                if (this._onRepeatCallback) {\n                    this._onRepeatCallback(this._object);\n                }\n                return true;\n            }\n            else {\n                if (this._onCompleteCallback) {\n                    this._onCompleteCallback(this._object);\n                }\n                for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {\n                    // Make the chained tweens start exactly at the time they should,\n                    // even if the `update()` method was called way past the duration of the tween\n                    this._chainedTweens[i].start(this._startTime + this._duration);\n                }\n                this._isPlaying = false;\n                return false;\n            }\n        }\n        return true;\n    };\n    Tween.prototype._updateProperties = function (_object, _valuesStart, _valuesEnd, value) {\n        for (var property in _valuesEnd) {\n            // Don't update properties that do not exist in the source object\n            if (_valuesStart[property] === undefined) {\n                continue;\n            }\n            var start = _valuesStart[property] || 0;\n            var end = _valuesEnd[property];\n            var startIsArray = Array.isArray(_object[property]);\n            var endIsArray = Array.isArray(end);\n            var isInterpolationList = !startIsArray && endIsArray;\n            if (isInterpolationList) {\n                _object[property] = this._interpolationFunction(end, value);\n            }\n            else if (typeof end === 'object' && end) {\n                // eslint-disable-next-line\n                // @ts-ignore FIXME?\n                this._updateProperties(_object[property], start, end, value);\n            }\n            else {\n                // Parses relative end values with start as base (e.g.: +10, -3)\n                end = this._handleRelativeValue(start, end);\n                // Protect against non numeric properties.\n                if (typeof end === 'number') {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _object[property] = start + (end - start) * value;\n                }\n            }\n        }\n    };\n    Tween.prototype._handleRelativeValue = function (start, end) {\n        if (typeof end !== 'string') {\n            return end;\n        }\n        if (end.charAt(0) === '+' || end.charAt(0) === '-') {\n            return start + parseFloat(end);\n        }\n        else {\n            return parseFloat(end);\n        }\n    };\n    Tween.prototype._swapEndStartRepeatValues = function (property) {\n        var tmp = this._valuesStartRepeat[property];\n        var endValue = this._valuesEnd[property];\n        if (typeof endValue === 'string') {\n            this._valuesStartRepeat[property] = this._valuesStartRepeat[property] + parseFloat(endValue);\n        }\n        else {\n            this._valuesStartRepeat[property] = this._valuesEnd[property];\n        }\n        this._valuesEnd[property] = tmp;\n    };\n    return Tween;\n}());\n\nvar VERSION = '18.6.4';\n\n/**\n * Tween.js - Licensed under the MIT license\n * https://github.com/tweenjs/tween.js\n * ----------------------------------------------\n *\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\n * Thank you all, you're awesome!\n */\nvar nextId = Sequence.nextId;\n/**\n * Controlling groups of tweens\n *\n * Using the TWEEN singleton to manage your tweens can cause issues in large apps with many components.\n * In these cases, you may want to create your own smaller groups of tweens.\n */\nvar TWEEN = mainGroup;\n// This is the best way to export things in a way that's compatible with both ES\n// Modules and CommonJS, without build hacks, and so as not to break the\n// existing API.\n// https://github.com/rollup/rollup/issues/1961#issuecomment-423037881\nvar getAll = TWEEN.getAll.bind(TWEEN);\nvar removeAll = TWEEN.removeAll.bind(TWEEN);\nvar add = TWEEN.add.bind(TWEEN);\nvar remove = TWEEN.remove.bind(TWEEN);\nvar update = TWEEN.update.bind(TWEEN);\nvar exports = {\n    Easing: Easing,\n    Group: Group,\n    Interpolation: Interpolation,\n    now: now$1,\n    Sequence: Sequence,\n    nextId: nextId,\n    Tween: Tween,\n    VERSION: VERSION,\n    getAll: getAll,\n    removeAll: removeAll,\n    add: add,\n    remove: remove,\n    update: update,\n};\n\nexport default exports;\nexport { Easing, Group, Interpolation, Sequence, Tween, VERSION, add, getAll, nextId, now$1 as now, remove, removeAll, update };\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeFrontpageTest.vue?vue&type=style&index=0&id=530f970e&scoped=true&lang=css&\"","var $ = require('../internals/export');\nvar repeat = require('../internals/string-repeat');\n\n// `String.prototype.repeat` method\n// https://tc39.es/ecma262/#sec-string.prototype.repeat\n$({ target: 'String', proto: true }, {\n  repeat: repeat\n});\n","exports.nextTick = function nextTick(fn) {\n    var args = Array.prototype.slice.call(arguments);\n    args.shift();\n    setTimeout(function () {\n        fn.apply(null, args);\n    }, 0);\n};\n\nexports.platform = exports.arch = \nexports.execPath = exports.title = 'browser';\nexports.pid = 1;\nexports.browser = true;\nexports.env = {};\nexports.argv = [];\n\nexports.binding = function (name) {\n\tthrow new Error('No such module. (Possibly not yet loaded)')\n};\n\n(function () {\n    var cwd = '/';\n    var path;\n    exports.cwd = function () { return cwd };\n    exports.chdir = function (dir) {\n        if (!path) path = require('path');\n        cwd = path.resolve(dir, cwd);\n    };\n})();\n\nexports.exit = exports.kill = \nexports.umask = exports.dlopen = \nexports.uptime = exports.memoryUsage = \nexports.uvCounters = function() {};\nexports.features = {};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{ref:\"canvas-container\",attrs:{\"id\":\"canvas-container\"}},[_c('div',{staticClass:\"loading-container\",class:{\n            'loading-container--hidden': _vm.loadingStat.isLoaded,\n            'loading-container--none': _vm.loadingStat.noLoadingStat\n        }},[_c('div',{staticClass:\"load-stat\"},[_c('div',{staticClass:\"load-pgbar\",style:({\n                    width: 100 * _vm.loadingStat.loaded / _vm.loadingStat.total + '%'\n                })}),_c('div',{staticClass:\"load-text\"},[_vm._v(_vm._s(Math.round(100 * _vm.loadingStat.loaded / _vm.loadingStat.total))+\" %\")])])])]),_c('div',{ref:\"dom3d-container\",attrs:{\"id\":\"dom3d-container\"}},[_c('div',{ref:\"dom3d-test\",attrs:{\"id\":\"dom3d-test\"}},[_c('p',[_vm._v(\"HTML element: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua\")])]),_c('div',{ref:\"dom3d-glass\",attrs:{\"id\":\"dom3d-glass\"},on:{\"click\":_vm.onGlassClick}},[_vm._m(0)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"dom3d-glass-ball\"},[_c('div',{staticClass:\"dom3d-glass-ball__text\"},[_vm._v(\"html element following object\")])])}]\n\nexport { render, staticRenderFns }","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import * as THREE from 'three'\r\nimport { controller } from '../AnimUtils/TweenUtils'\r\nimport { loadShader } from './ShaderLoader';\r\n\r\nexport interface CarouselOptions {\r\n    numOfVisiblePics: number;\r\n    planeWidth?: number;\r\n    planeHeight?: number;\r\n    planeGap?: number;\r\n    carouselArrayRadius?: number\r\n}\r\n\r\ninterface CarouselPlaneUniforms {\r\n    vColor: { type: string, value: THREE.Color };\r\n    vTextures: { type: string, value: Array<THREE.Texture | undefined> };\r\n    vTextureMix: { type: string, value: number };\r\n}\r\n\r\nclass CarouselPlane {\r\n    index: number\r\n    mesh: THREE.Mesh<THREE.PlaneBufferGeometry, THREE.ShaderMaterial>\r\n    uniforms: CarouselPlaneUniforms\r\n    textureList: Array<THREE.Texture | undefined>\r\n    isPushingTexture: Boolean\r\n    constructor(index: number, mesh: THREE.Mesh<THREE.PlaneBufferGeometry, THREE.ShaderMaterial>, uniforms: CarouselPlaneUniforms) {\r\n        this.index = index\r\n        this.mesh = mesh\r\n        this.uniforms = uniforms\r\n        this.mesh = mesh\r\n        this.textureList = []\r\n        this.isPushingTexture = false\r\n    }\r\n    pushNewTexture(newTexture: THREE.Texture) {\r\n        if (this.textureList.length == 0) {\r\n            this.textureList.push(undefined, newTexture)\r\n        }\r\n        else if (this.textureList.length == 1) {\r\n            this.textureList.push(newTexture)\r\n        }\r\n        else {\r\n            this.textureList.splice(1, this.textureList.length-2)\r\n            this.textureList.push(newTexture)\r\n        }\r\n        if (this.isPushingTexture == false) {\r\n            this.recPushTexture()\r\n        }\r\n    }\r\n    recPushTexture() {\r\n        if (this.textureList.length <= 1) {\r\n            this.isPushingTexture = false\r\n            return\r\n        }\r\n        this.isPushingTexture = true\r\n        if (this.textureList.length == 2) {\r\n            this.uniforms.vTextureMix.value = 0\r\n            // this.uniforms.vTexture1.value = undefined\r\n            // this.uniforms.vTexture2.value = undefined\r\n            this.uniforms.vTextures.value[0] = this.textureList[0]\r\n            this.uniforms.vTextures.value[1] = this.textureList[1]\r\n            // this.textureList.splice(0, 1)\r\n            this.isPushingTexture = false\r\n            controller.tweenNumber(0, 1, (v) => {\r\n                this.uniforms.vTextureMix.value = v\r\n            },\r\n            () => {\r\n                this.uniforms.vTextures.value[0] = this.textureList[1]\r\n                this.uniforms.vTextures.value[1] = this.textureList[1]\r\n                this.uniforms.vTextureMix.value = 1\r\n                this.textureList.splice(0, 1)\r\n                this.recPushTexture()\r\n            }, 500)\r\n        }\r\n    }\r\n}\r\n\r\nexport class Carousel extends THREE.Group {\r\n    numOfVisiblePics: number\r\n    rotateNode: THREE.Group\r\n    isRotating: Boolean\r\n    planes: Array<CarouselPlane>\r\n    planeWidth: number\r\n    planeHeight: number\r\n    planeGap: number\r\n    preloadImgs: { [key: string]: THREE.Texture }\r\n    maxPreloadImgCount: number\r\n    carouselArrayRadius: number\r\n    carouselArrayAngle: number\r\n    currentCenter: number\r\n    constructor(options: CarouselOptions = { numOfVisiblePics: 3 }) {\r\n\r\n        super()\r\n\r\n        this.isRotating = false\r\n        this.rotateNode = new THREE.Group()\r\n        this.add(this.rotateNode)\r\n        this.currentCenter = 0\r\n\r\n        this.numOfVisiblePics = options.numOfVisiblePics\r\n        this.planes = []\r\n        this.planeWidth = options.planeWidth || 50\r\n        this.planeHeight = options.planeHeight || 50\r\n        this.planeGap = options.planeGap || 10\r\n        this.preloadImgs = {}\r\n        this.maxPreloadImgCount = this.numOfVisiblePics * 2\r\n        this.carouselArrayRadius = options.carouselArrayRadius || 100\r\n        this.carouselArrayAngle = Math.atan((this.planeWidth + this.planeGap) / (this.carouselArrayRadius * 2)) * 2\r\n        var [vs, fs] = loadShader('CarouselBasicShader')\r\n        for (let i = 0; i < this.numOfVisiblePics; i++) {\r\n            const tempUniforms = {\r\n                vColor: { type: 'c', value: new THREE.Color(0xff0000) },\r\n                vTextures: { type: 'tv', value: [ undefined, undefined ] },\r\n                vTextureMix: { type: 'f', value: 1 },\r\n            }\r\n            const tempPlane = new THREE.Mesh(\r\n                new THREE.PlaneBufferGeometry(this.planeWidth, this.planeHeight, 1, 1),\r\n                new THREE.ShaderMaterial({\r\n                    uniforms : tempUniforms,\r\n                    vertexShader    : vs,\r\n                    fragmentShader  : fs\r\n                })\r\n            )\r\n            let offset = (i - (this.numOfVisiblePics - 1) / 2)\r\n            tempPlane.rotation.y = -(offset * this.carouselArrayAngle)\r\n            tempPlane.position.x = this.carouselArrayRadius * Math.sin(offset * this.carouselArrayAngle)\r\n            tempPlane.position.z = -this.carouselArrayRadius * Math.cos(offset * this.carouselArrayAngle)\r\n            this.planes.push(new CarouselPlane(i, tempPlane, tempUniforms))\r\n            this.rotateNode.add(tempPlane)\r\n        }\r\n        this.planes.forEach(plane => {\r\n            this.__imgSrcToTex(`https://picsum.photos/id/${Math.ceil(Math.random() * 50)}/200/200`).then((v) => {\r\n                plane.pushNewTexture(v)\r\n            })\r\n        })\r\n    }\r\n\r\n    clickToChangeTex(raycaster: THREE.Raycaster, getImgSrcFunc: (carouselIndex: number) => string) {\r\n        let imgMeshes = this.planes.map((v) => v.mesh)\r\n        let intersects = raycaster.intersectObjects(imgMeshes)\r\n        if (intersects.length == 1) {\r\n            const intersectObj = intersects[0].object\r\n            if (intersectObj instanceof THREE.Mesh) {\r\n                let intersectIndex = imgMeshes.indexOf(intersectObj)\r\n                let src = getImgSrcFunc(intersectIndex)\r\n                this.__imgSrcToTex(src).then((v) => {\r\n                    this.planes[intersectIndex].pushNewTexture(v)\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    clickToRotate(raycaster: THREE.Raycaster, getImgSrcFunc: (carouselIndex: number) => string) {\r\n        let imgMeshes = this.planes.map((v) => v.mesh)\r\n        let intersects = raycaster.intersectObjects(imgMeshes)\r\n        if (intersects.length == 1) {\r\n            const intersectObj = intersects[0].object\r\n            if (intersectObj instanceof THREE.Mesh) {\r\n                let intersectIndex = imgMeshes.indexOf(intersectObj)\r\n                let step = this.planes[intersectIndex].index - this.currentCenter - Math.floor(this.planes.length / 2)\r\n                if (step < 0) {\r\n                    this.moveLeft(-step, getImgSrcFunc)\r\n                }\r\n                else if (step > 0) {\r\n                    this.moveRight(step, getImgSrcFunc)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    moveLeft(moveStep: number = 1, getImgSrcFunc: (carouselIndex: number) => string) {\r\n        if (this.isRotating) {\r\n            return\r\n        }\r\n        this.isRotating = true\r\n        // move rightmost img to leftmost, change index, rotate rotateNode\r\n        for (let i = 0; i < moveStep; i++) {\r\n            this.planes.sort((v1, v2) => v2.index - v1.index)\r\n            const rightmostImg = this.planes[0]\r\n            rightmostImg.index = this.planes[this.planes.length - 1].index - 1\r\n            let offset = (rightmostImg.index - (this.numOfVisiblePics - 1) / 2)\r\n            rightmostImg.mesh.rotation.y = -(offset * this.carouselArrayAngle)\r\n            rightmostImg.mesh.position.x = this.carouselArrayRadius * Math.sin(offset * this.carouselArrayAngle)\r\n            rightmostImg.mesh.position.z = -this.carouselArrayRadius * Math.cos(offset * this.carouselArrayAngle)\r\n            let src = getImgSrcFunc(rightmostImg.index)\r\n            this.__imgSrcToTex(src).then((v) => {\r\n                rightmostImg.pushNewTexture(v)\r\n            })\r\n        }\r\n        controller.tweenNumber(0, moveStep, (v) => {\r\n            let tempRotationPosition = this.carouselArrayAngle * (this.currentCenter - v)\r\n            this.rotateNode.rotation.y = tempRotationPosition\r\n        }, () => {\r\n            this.currentCenter -= moveStep\r\n            this.isRotating = false\r\n        }, 500)\r\n    }\r\n\r\n    moveRight(moveStep: number = 1, getImgSrcFunc: (carouselIndex: number) => string) {\r\n        if (this.isRotating) {\r\n            return\r\n        }\r\n        this.isRotating = true\r\n        // move leftmost img to rightmost, change index, rotate rotateNode\r\n        for (let i = 0; i < moveStep; i++) {\r\n            this.planes.sort((v1, v2) => v1.index - v2.index)\r\n            const leftmostImg = this.planes[0]\r\n            leftmostImg.index = this.planes[this.planes.length - 1].index + 1\r\n            let offset = (leftmostImg.index - (this.numOfVisiblePics - 1) / 2)\r\n            leftmostImg.mesh.rotation.y = -(offset * this.carouselArrayAngle)\r\n            leftmostImg.mesh.position.x = this.carouselArrayRadius * Math.sin(offset * this.carouselArrayAngle)\r\n            leftmostImg.mesh.position.z = -this.carouselArrayRadius * Math.cos(offset * this.carouselArrayAngle)\r\n            let src = getImgSrcFunc(leftmostImg.index)\r\n            this.__imgSrcToTex(src).then((v) => {\r\n                leftmostImg.pushNewTexture(v)\r\n            })\r\n        }\r\n        controller.tweenNumber(0, moveStep, (v) => {\r\n            let tempRotationPosition = this.carouselArrayAngle * (this.currentCenter + v)\r\n            this.rotateNode.rotation.y = tempRotationPosition\r\n        }, () => {\r\n            this.currentCenter += moveStep\r\n            this.isRotating = false\r\n        }, 500)\r\n    }\r\n\r\n\r\n    async __imgSrcToTex(imgSrc: string): Promise<THREE.Texture> {\r\n        const self = this\r\n        return new Promise<THREE.Texture>((resolve, reject) => {\r\n            if (self.preloadImgs[imgSrc]) {\r\n                resolve(self.preloadImgs[imgSrc])\r\n            }\r\n            let imageLoader = new THREE.ImageLoader()\r\n            imageLoader.setCrossOrigin( 'anonymous' ) // TODO: debug\r\n            imageLoader.load(imgSrc, (tempImageElement) => {\r\n                let texture = new THREE.Texture( tempImageElement )\r\n                texture.needsUpdate = true\r\n                self.preloadImgs[imgSrc] = texture\r\n\r\n                // dispose textures\r\n                if (Object.keys(self.preloadImgs).length >= self.maxPreloadImgCount) {\r\n                    // remove an unused texture\r\n                    for (let k in self.preloadImgs) {\r\n                        let imgTex = self.preloadImgs[k]\r\n                        let canRemoveImg = true\r\n                        for (let planeIndex = 0; planeIndex < self.planes.length; planeIndex ++) {\r\n                            if (self.planes[planeIndex].uniforms.vTextures.value.indexOf(imgTex) > -1) {\r\n                                canRemoveImg = false\r\n                                break\r\n                            }\r\n                        }\r\n                        if (canRemoveImg) {\r\n                            // imgTex is not in use in any carousel card\r\n                            imgTex.dispose()\r\n                            delete self.preloadImgs[k]\r\n                            break\r\n                        }\r\n                    }\r\n                }\r\n                resolve(texture)\r\n            })\r\n        })\r\n    }\r\n}","import {\n\tAdditiveBlending,\n\tBufferGeometry,\n\tColor,\n\tDoubleSide,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLoader,\n\tLoaderUtils,\n\tMatrix4,\n\tMesh,\n\tMeshPhongMaterial,\n\tTextureLoader\n} from 'three';\n\n/**\n * Autodesk 3DS three.js file loader, based on lib3ds.\n *\n * Loads geometry with uv and materials basic properties with texture support.\n *\n * @class TDSLoader\n * @constructor\n */\n\nclass TDSLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.debug = false;\n\n\t\tthis.group = null;\n\n\t\tthis.materials = [];\n\t\tthis.meshes = [];\n\n\t}\n\n\t/**\n\t * Load 3ds file from url.\n\t *\n\t * @method load\n\t * @param {[type]} url URL for the file.\n\t * @param {Function} onLoad onLoad callback, receives group Object3D as argument.\n\t * @param {Function} onProgress onProgress callback.\n\t * @param {Function} onError onError callback.\n\t */\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( data, path ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\t/**\n\t * Parse arraybuffer data and load 3ds file.\n\t *\n\t * @method parse\n\t * @param {ArrayBuffer} arraybuffer Arraybuffer data to be loaded.\n\t * @param {String} path Path for external resources.\n\t * @return {Group} Group loaded from 3ds file.\n\t */\n\tparse( arraybuffer, path ) {\n\n\t\tthis.group = new Group();\n\t\tthis.materials = [];\n\t\tthis.meshes = [];\n\n\t\tthis.readFile( arraybuffer, path );\n\n\t\tfor ( let i = 0; i < this.meshes.length; i ++ ) {\n\n\t\t\tthis.group.add( this.meshes[ i ] );\n\n\t\t}\n\n\t\treturn this.group;\n\n\t}\n\n\t/**\n\t * Decode file content to read 3ds data.\n\t *\n\t * @method readFile\n\t * @param {ArrayBuffer} arraybuffer Arraybuffer data to be loaded.\n\t * @param {String} path Path for external resources.\n\t */\n\treadFile( arraybuffer, path ) {\n\n\t\tconst data = new DataView( arraybuffer );\n\t\tconst chunk = new Chunk( data, 0, this.debugMessage );\n\n\t\tif ( chunk.id === MLIBMAGIC || chunk.id === CMAGIC || chunk.id === M3DMAGIC ) {\n\n\t\t\tlet next = chunk.readChunk();\n\n\t\t\twhile ( next ) {\n\n\t\t\t\tif ( next.id === M3D_VERSION ) {\n\n\t\t\t\t\tconst version = next.readDWord();\n\t\t\t\t\tthis.debugMessage( '3DS file version: ' + version );\n\n\t\t\t\t} else if ( next.id === MDATA ) {\n\n\t\t\t\t\tthis.readMeshData( next, path );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.debugMessage( 'Unknown main chunk: ' + next.hexId );\n\n\t\t\t\t}\n\n\t\t\t\tnext = chunk.readChunk();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.debugMessage( 'Parsed ' + this.meshes.length + ' meshes' );\n\n\t}\n\n\t/**\n\t * Read mesh data chunk.\n\t *\n\t * @method readMeshData\n\t * @param {Chunk} chunk to read mesh from\n\t * @param {String} path Path for external resources.\n\t */\n\treadMeshData( chunk, path ) {\n\n\t\tlet next = chunk.readChunk();\n\n\t\twhile ( next ) {\n\n\t\t\tif ( next.id === MESH_VERSION ) {\n\n\t\t\t\tconst version = + next.readDWord();\n\t\t\t\tthis.debugMessage( 'Mesh Version: ' + version );\n\n\t\t\t} else if ( next.id === MASTER_SCALE ) {\n\n\t\t\t\tconst scale = next.readFloat();\n\t\t\t\tthis.debugMessage( 'Master scale: ' + scale );\n\t\t\t\tthis.group.scale.set( scale, scale, scale );\n\n\t\t\t} else if ( next.id === NAMED_OBJECT ) {\n\n\t\t\t\tthis.debugMessage( 'Named Object' );\n\t\t\t\tthis.readNamedObject( next );\n\n\t\t\t} else if ( next.id === MAT_ENTRY ) {\n\n\t\t\t\tthis.debugMessage( 'Material' );\n\t\t\t\tthis.readMaterialEntry( next, path );\n\n\t\t\t} else {\n\n\t\t\t\tthis.debugMessage( 'Unknown MDATA chunk: ' + next.hexId );\n\n\t\t\t}\n\n\t\t\tnext = chunk.readChunk();\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Read named object chunk.\n\t *\n\t * @method readNamedObject\n\t * @param {Chunk} chunk Chunk in use.\n\t */\n\treadNamedObject( chunk ) {\n\n\t\tconst name = chunk.readString();\n\n\t\tlet next = chunk.readChunk();\n\t\twhile ( next ) {\n\n\t\t\tif ( next.id === N_TRI_OBJECT ) {\n\n\t\t\t\tconst mesh = this.readMesh( next );\n\t\t\t\tmesh.name = name;\n\t\t\t\tthis.meshes.push( mesh );\n\n\t\t\t} else {\n\n\t\t\t\tthis.debugMessage( 'Unknown named object chunk: ' + next.hexId );\n\n\t\t\t}\n\n\t\t\tnext = chunk.readChunk( );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Read material data chunk and add it to the material list.\n\t *\n\t * @method readMaterialEntry\n\t * @param {Chunk} chunk Chunk in use.\n\t * @param {String} path Path for external resources.\n\t */\n\treadMaterialEntry( chunk, path ) {\n\n\t\tlet next = chunk.readChunk();\n\t\tconst material = new MeshPhongMaterial();\n\n\t\twhile ( next ) {\n\n\t\t\tif ( next.id === MAT_NAME ) {\n\n\t\t\t\tmaterial.name = next.readString();\n\t\t\t\tthis.debugMessage( '   Name: ' + material.name );\n\n\t\t\t} else if ( next.id === MAT_WIRE ) {\n\n\t\t\t\tthis.debugMessage( '   Wireframe' );\n\t\t\t\tmaterial.wireframe = true;\n\n\t\t\t} else if ( next.id === MAT_WIRE_SIZE ) {\n\n\t\t\t\tconst value = next.readByte();\n\t\t\t\tmaterial.wireframeLinewidth = value;\n\t\t\t\tthis.debugMessage( '   Wireframe Thickness: ' + value );\n\n\t\t\t} else if ( next.id === MAT_TWO_SIDE ) {\n\n\t\t\t\tmaterial.side = DoubleSide;\n\t\t\t\tthis.debugMessage( '   DoubleSided' );\n\n\t\t\t} else if ( next.id === MAT_ADDITIVE ) {\n\n\t\t\t\tthis.debugMessage( '   Additive Blending' );\n\t\t\t\tmaterial.blending = AdditiveBlending;\n\n\t\t\t} else if ( next.id === MAT_DIFFUSE ) {\n\n\t\t\t\tthis.debugMessage( '   Diffuse Color' );\n\t\t\t\tmaterial.color = this.readColor( next );\n\n\t\t\t} else if ( next.id === MAT_SPECULAR ) {\n\n\t\t\t\tthis.debugMessage( '   Specular Color' );\n\t\t\t\tmaterial.specular = this.readColor( next );\n\n\t\t\t} else if ( next.id === MAT_AMBIENT ) {\n\n\t\t\t\tthis.debugMessage( '   Ambient color' );\n\t\t\t\tmaterial.color = this.readColor( next );\n\n\t\t\t} else if ( next.id === MAT_SHININESS ) {\n\n\t\t\t\tconst shininess = this.readPercentage( next );\n\t\t\t\tmaterial.shininess = shininess * 100;\n\t\t\t\tthis.debugMessage( '   Shininess : ' + shininess );\n\n\t\t\t} else if ( next.id === MAT_TRANSPARENCY ) {\n\n\t\t\t\tconst transparency = this.readPercentage( next );\n\t\t\t\tmaterial.opacity = 1 - transparency;\n\t\t\t\tthis.debugMessage( '  Transparency : ' + transparency );\n\t\t\t\tmaterial.transparent = material.opacity < 1 ? true : false;\n\n\t\t\t} else if ( next.id === MAT_TEXMAP ) {\n\n\t\t\t\tthis.debugMessage( '   ColorMap' );\n\t\t\t\tmaterial.map = this.readMap( next, path );\n\n\t\t\t} else if ( next.id === MAT_BUMPMAP ) {\n\n\t\t\t\tthis.debugMessage( '   BumpMap' );\n\t\t\t\tmaterial.bumpMap = this.readMap( next, path );\n\n\t\t\t} else if ( next.id === MAT_OPACMAP ) {\n\n\t\t\t\tthis.debugMessage( '   OpacityMap' );\n\t\t\t\tmaterial.alphaMap = this.readMap( next, path );\n\n\t\t\t} else if ( next.id === MAT_SPECMAP ) {\n\n\t\t\t\tthis.debugMessage( '   SpecularMap' );\n\t\t\t\tmaterial.specularMap = this.readMap( next, path );\n\n\t\t\t} else {\n\n\t\t\t\tthis.debugMessage( '   Unknown material chunk: ' + next.hexId );\n\n\t\t\t}\n\n\t\t\tnext = chunk.readChunk();\n\n\t\t}\n\n\t\tthis.materials[ material.name ] = material;\n\n\t}\n\n\t/**\n\t * Read mesh data chunk.\n\t *\n\t * @method readMesh\n\t * @param {Chunk} chunk Chunk in use.\n\t * @return {Mesh} The parsed mesh.\n\t */\n\treadMesh( chunk ) {\n\n\t\tlet next = chunk.readChunk( );\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst material = new MeshPhongMaterial();\n\t\tconst mesh = new Mesh( geometry, material );\n\t\tmesh.name = 'mesh';\n\n\t\twhile ( next ) {\n\n\t\t\tif ( next.id === POINT_ARRAY ) {\n\n\t\t\t\tconst points = next.readWord( );\n\n\t\t\t\tthis.debugMessage( '   Vertex: ' + points );\n\n\t\t\t\t//BufferGeometry\n\n\t\t\t\tconst vertices = [];\n\n\t\t\t\tfor ( let i = 0; i < points; i ++ )\t\t{\n\n\t\t\t\t\tvertices.push( next.readFloat( ) );\n\t\t\t\t\tvertices.push( next.readFloat( ) );\n\t\t\t\t\tvertices.push( next.readFloat( ) );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\t\t} else if ( next.id === FACE_ARRAY ) {\n\n\t\t\t\tthis.readFaceArray( next, mesh );\n\n\t\t\t} else if ( next.id === TEX_VERTS ) {\n\n\t\t\t\tconst texels = next.readWord( );\n\n\t\t\t\tthis.debugMessage( '   UV: ' + texels );\n\n\t\t\t\t//BufferGeometry\n\n\t\t\t\tconst uvs = [];\n\n\t\t\t\tfor ( let i = 0; i < texels; i ++ ) {\n\n\t\t\t\t\tuvs.push( next.readFloat( ) );\n\t\t\t\t\tuvs.push( next.readFloat( ) );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\n\t\t\t} else if ( next.id === MESH_MATRIX ) {\n\n\t\t\t\tthis.debugMessage( '   Tranformation Matrix (TODO)' );\n\n\t\t\t\tconst values = [];\n\t\t\t\tfor ( let i = 0; i < 12; i ++ ) {\n\n\t\t\t\t\tvalues[ i ] = next.readFloat( );\n\n\t\t\t\t}\n\n\t\t\t\tconst matrix = new Matrix4();\n\n\t\t\t\t//X Line\n\t\t\t\tmatrix.elements[ 0 ] = values[ 0 ];\n\t\t\t\tmatrix.elements[ 1 ] = values[ 6 ];\n\t\t\t\tmatrix.elements[ 2 ] = values[ 3 ];\n\t\t\t\tmatrix.elements[ 3 ] = values[ 9 ];\n\n\t\t\t\t//Y Line\n\t\t\t\tmatrix.elements[ 4 ] = values[ 2 ];\n\t\t\t\tmatrix.elements[ 5 ] = values[ 8 ];\n\t\t\t\tmatrix.elements[ 6 ] = values[ 5 ];\n\t\t\t\tmatrix.elements[ 7 ] = values[ 11 ];\n\n\t\t\t\t//Z Line\n\t\t\t\tmatrix.elements[ 8 ] = values[ 1 ];\n\t\t\t\tmatrix.elements[ 9 ] = values[ 7 ];\n\t\t\t\tmatrix.elements[ 10 ] = values[ 4 ];\n\t\t\t\tmatrix.elements[ 11 ] = values[ 10 ];\n\n\t\t\t\t//W Line\n\t\t\t\tmatrix.elements[ 12 ] = 0;\n\t\t\t\tmatrix.elements[ 13 ] = 0;\n\t\t\t\tmatrix.elements[ 14 ] = 0;\n\t\t\t\tmatrix.elements[ 15 ] = 1;\n\n\t\t\t\tmatrix.transpose();\n\n\t\t\t\tconst inverse = new Matrix4();\n\t\t\t\tinverse.copy( matrix ).invert();\n\t\t\t\tgeometry.applyMatrix4( inverse );\n\n\t\t\t\tmatrix.decompose( mesh.position, mesh.quaternion, mesh.scale );\n\n\t\t\t} else {\n\n\t\t\t\tthis.debugMessage( '   Unknown mesh chunk: ' + next.hexId );\n\n\t\t\t}\n\n\t\t\tnext = chunk.readChunk( );\n\n\t\t}\n\n\t\tgeometry.computeVertexNormals();\n\n\t\treturn mesh;\n\n\t}\n\n\t/**\n\t * Read face array data chunk.\n\t *\n\t * @method readFaceArray\n\t * @param {Chunk} chunk Chunk in use.\n\t * @param {Mesh} mesh Mesh to be filled with the data read.\n\t */\n\treadFaceArray( chunk, mesh ) {\n\n\t\tconst faces = chunk.readWord( );\n\n\t\tthis.debugMessage( '   Faces: ' + faces );\n\n\t\tconst index = [];\n\n\t\tfor ( let i = 0; i < faces; ++ i ) {\n\n\t\t\tindex.push( chunk.readWord( ), chunk.readWord( ), chunk.readWord( ) );\n\n\t\t\tchunk.readWord( ); // visibility\n\n\t\t}\n\n\t\tmesh.geometry.setIndex( index );\n\n\t\t//The rest of the FACE_ARRAY chunk is subchunks\n\n\t\tlet materialIndex = 0;\n\t\tlet start = 0;\n\n\t\twhile ( ! chunk.endOfChunk ) {\n\n\t\t\tconst subchunk = chunk.readChunk( );\n\n\t\t\tif ( subchunk.id === MSH_MAT_GROUP ) {\n\n\t\t\t\tthis.debugMessage( '      Material Group' );\n\n\t\t\t\tconst group = this.readMaterialGroup( subchunk );\n\t\t\t\tconst count = group.index.length * 3; // assuming successive indices\n\n\t\t\t\tmesh.geometry.addGroup( start, count, materialIndex );\n\n\t\t\t\tstart += count;\n\t\t\t\tmaterialIndex ++;\n\n\t\t\t\tconst material = this.materials[ group.name ];\n\n\t\t\t\tif ( Array.isArray( mesh.material ) === false ) mesh.material = [];\n\n\t\t\t\tif ( material !== undefined )\t{\n\n\t\t\t\t\tmesh.material.push( material );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tthis.debugMessage( '      Unknown face array chunk: ' + subchunk.hexId );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( mesh.material.length === 1 ) mesh.material = mesh.material[ 0 ]; // for backwards compatibility\n\n\t}\n\n\t/**\n\t * Read texture map data chunk.\n\t *\n\t * @method readMap\n\t * @param {Chunk} chunk Chunk in use.\n\t * @param {String} path Path for external resources.\n\t * @return {Texture} Texture read from this data chunk.\n\t */\n\treadMap( chunk, path ) {\n\n\t\tlet next = chunk.readChunk( );\n\t\tlet texture = {};\n\n\t\tconst loader = new TextureLoader( this.manager );\n\t\tloader.setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n\t\twhile ( next ) {\n\n\t\t\tif ( next.id === MAT_MAPNAME ) {\n\n\t\t\t\tconst name = next.readString();\n\t\t\t\ttexture = loader.load( name );\n\n\t\t\t\tthis.debugMessage( '      File: ' + path + name );\n\n\t\t\t} else if ( next.id === MAT_MAP_UOFFSET ) {\n\n\t\t\t\ttexture.offset.x = next.readFloat( );\n\t\t\t\tthis.debugMessage( '      OffsetX: ' + texture.offset.x );\n\n\t\t\t} else if ( next.id === MAT_MAP_VOFFSET ) {\n\n\t\t\t\ttexture.offset.y = next.readFloat( );\n\t\t\t\tthis.debugMessage( '      OffsetY: ' + texture.offset.y );\n\n\t\t\t} else if ( next.id === MAT_MAP_USCALE ) {\n\n\t\t\t\ttexture.repeat.x = next.readFloat( );\n\t\t\t\tthis.debugMessage( '      RepeatX: ' + texture.repeat.x );\n\n\t\t\t} else if ( next.id === MAT_MAP_VSCALE ) {\n\n\t\t\t\ttexture.repeat.y = next.readFloat( );\n\t\t\t\tthis.debugMessage( '      RepeatY: ' + texture.repeat.y );\n\n\t\t\t} else {\n\n\t\t\t\tthis.debugMessage( '      Unknown map chunk: ' + next.hexId );\n\n\t\t\t}\n\n\t\t\tnext = chunk.readChunk( );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\t/**\n\t * Read material group data chunk.\n\t *\n\t * @method readMaterialGroup\n\t * @param {Chunk} chunk Chunk in use.\n\t * @return {Object} Object with name and index of the object.\n\t */\n\treadMaterialGroup( chunk ) {\n\n\t\tconst name = chunk.readString();\n\t\tconst numFaces = chunk.readWord();\n\n\t\tthis.debugMessage( '         Name: ' + name );\n\t\tthis.debugMessage( '         Faces: ' + numFaces );\n\n\t\tconst index = [];\n\t\tfor ( let i = 0; i < numFaces; ++ i ) {\n\n\t\t\tindex.push( chunk.readWord( ) );\n\n\t\t}\n\n\t\treturn { name: name, index: index };\n\n\t}\n\n\t/**\n\t * Read a color value.\n\t *\n\t * @method readColor\n\t * @param {Chunk} chunk Chunk.\n\t * @return {Color} Color value read..\n\t */\n\treadColor( chunk ) {\n\n\t\tconst subChunk = chunk.readChunk( );\n\t\tconst color = new Color();\n\n\t\tif ( subChunk.id === COLOR_24 || subChunk.id === LIN_COLOR_24 ) {\n\n\t\t\tconst r = subChunk.readByte( );\n\t\t\tconst g = subChunk.readByte( );\n\t\t\tconst b = subChunk.readByte( );\n\n\t\t\tcolor.setRGB( r / 255, g / 255, b / 255 );\n\n\t\t\tthis.debugMessage( '      Color: ' + color.r + ', ' + color.g + ', ' + color.b );\n\n\t\t}\telse if ( subChunk.id === COLOR_F || subChunk.id === LIN_COLOR_F ) {\n\n\t\t\tconst r = subChunk.readFloat( );\n\t\t\tconst g = subChunk.readFloat( );\n\t\t\tconst b = subChunk.readFloat( );\n\n\t\t\tcolor.setRGB( r, g, b );\n\n\t\t\tthis.debugMessage( '      Color: ' + color.r + ', ' + color.g + ', ' + color.b );\n\n\t\t}\telse {\n\n\t\t\tthis.debugMessage( '      Unknown color chunk: ' + subChunk.hexId );\n\n\t\t}\n\n\t\treturn color;\n\n\t}\n\n\t/**\n\t * Read percentage value.\n\t *\n\t * @method readPercentage\n\t * @param {Chunk} chunk Chunk to read data from.\n\t * @return {Number} Data read from the dataview.\n\t */\n\treadPercentage( chunk ) {\n\n\t\tconst subChunk = chunk.readChunk( );\n\n\t\tswitch ( subChunk.id ) {\n\n\t\t\tcase INT_PERCENTAGE:\n\t\t\t\treturn ( subChunk.readShort( ) / 100 );\n\t\t\t\tbreak;\n\n\t\t\tcase FLOAT_PERCENTAGE:\n\t\t\t\treturn subChunk.readFloat( );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthis.debugMessage( '      Unknown percentage chunk: ' + subChunk.hexId );\n\t\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Print debug message to the console.\n\t *\n\t * Is controlled by a flag to show or hide debug messages.\n\t *\n\t * @method debugMessage\n\t * @param {Object} message Debug message to print to the console.\n\t */\n\tdebugMessage( message ) {\n\n\t\tif ( this.debug ) {\n\n\t\t\tconsole.log( message );\n\n\t\t}\n\n\t}\n\n}\n\n\n/** Read data/sub-chunks from chunk */\nclass Chunk {\n\n\t/**\n\t * Create a new chunk\n\t *\n\t * @class Chunk\n\t * @param {DataView} data DataView to read from.\n\t * @param {Number} position in data.\n\t * @param {Function} debugMessage logging callback.\n\t */\n\tconstructor( data, position, debugMessage ) {\n\n\t\tthis.data = data;\n\t\t// the offset to the begin of this chunk\n\t\tthis.offset = position;\n\t\t// the current reading position\n\t\tthis.position = position;\n\t\tthis.debugMessage = debugMessage;\n\n\t\tif ( this.debugMessage instanceof Function ) {\n\n\t\t\tthis.debugMessage = function () {};\n\n\t\t}\n\n\t\tthis.id = this.readWord();\n\t\tthis.size = this.readDWord();\n\t\tthis.end = this.offset + this.size;\n\n\t\tif ( this.end > data.byteLength ) {\n\n\t\t\tthis.debugMessage( 'Bad chunk size for chunk at ' + position );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * read a sub cchunk.\n\t *\n\t * @method readChunk\n\t * @return {Chunk | null} next sub chunk\n\t */\n\treadChunk() {\n\n\t\tif ( this.endOfChunk ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\ttry {\n\n\t\t\tconst next = new Chunk( this.data, this.position, this.debugMessage );\n\t\t\tthis.position += next.size;\n\t\t\treturn next;\n\n\t\t}\tcatch ( e ) {\n\n\t\t\tthis.debugMessage( 'Unable to read chunk at ' + this.position );\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * return the ID of this chunk as Hex\n\t *\n\t * @method idToString\n\t * @return {String} hex-string of id\n\t */\n\tget hexId() {\n\n\t\treturn this.id.toString( 16 );\n\n\t}\n\n\tget endOfChunk() {\n\n\t\treturn this.position >= this.end;\n\n\t}\n\n\t/**\n\t * Read byte value.\n\t *\n\t * @method readByte\n\t * @return {Number} Data read from the dataview.\n\t */\n\treadByte() {\n\n\t\tconst v = this.data.getUint8( this.position, true );\n\t\tthis.position += 1;\n\t\treturn v;\n\n\t}\n\n\t/**\n\t * Read 32 bit float value.\n\t *\n\t * @method readFloat\n\t * @return {Number} Data read from the dataview.\n\t */\n\treadFloat() {\n\n\t\ttry {\n\n\t\t\tconst v = this.data.getFloat32( this.position, true );\n\t\t\tthis.position += 4;\n\t\t\treturn v;\n\n\t\t}\tcatch ( e ) {\n\n\t\t\tthis.debugMessage( e + ' ' + this.position + ' ' + this.data.byteLength );\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Read 32 bit signed integer value.\n\t *\n\t * @method readInt\n\t * @return {Number} Data read from the dataview.\n\t */\n\treadInt() {\n\n\t\tconst v = this.data.getInt32( this.position, true );\n\t\tthis.position += 4;\n\t\treturn v;\n\n\t}\n\n\t/**\n\t * Read 16 bit signed integer value.\n\t *\n\t * @method readShort\n\t * @return {Number} Data read from the dataview.\n\t */\n\treadShort() {\n\n\t\tconst v = this.data.getInt16( this.position, true );\n\t\tthis.position += 2;\n\t\treturn v;\n\n\t}\n\n\t/**\n\t * Read 64 bit unsigned integer value.\n\t *\n\t * @method readDWord\n\t * @return {Number} Data read from the dataview.\n\t */\n\treadDWord() {\n\n\t\tconst v = this.data.getUint32( this.position, true );\n\t\tthis.position += 4;\n\t\treturn v;\n\n\t}\n\n\t/**\n\t * Read 32 bit unsigned integer value.\n\t *\n\t * @method readWord\n\t * @return {Number} Data read from the dataview.\n\t */\n\treadWord() {\n\n\t\tconst v = this.data.getUint16( this.position, true );\n\t\tthis.position += 2;\n\t\treturn v;\n\n\t}\n\n\t/**\n\t * Read NULL terminated ASCII string value from chunk-pos.\n\t *\n\t * @method readString\n\t * @return {String} Data read from the dataview.\n\t */\n\treadString() {\n\n\t\tlet s = '';\n\t\tlet c = this.readByte();\n\t\twhile ( c ) {\n\n\t\t\ts += String.fromCharCode( c );\n\t\t\tc = this.readByte();\n\n\t\t}\n\n\t\treturn s;\n\n\t}\n\n}\n\n// const NULL_CHUNK = 0x0000;\nconst M3DMAGIC = 0x4D4D;\n// const SMAGIC = 0x2D2D;\n// const LMAGIC = 0x2D3D;\nconst MLIBMAGIC = 0x3DAA;\n// const MATMAGIC = 0x3DFF;\nconst CMAGIC = 0xC23D;\nconst M3D_VERSION = 0x0002;\n// const M3D_KFVERSION = 0x0005;\nconst COLOR_F = 0x0010;\nconst COLOR_24 = 0x0011;\nconst LIN_COLOR_24 = 0x0012;\nconst LIN_COLOR_F = 0x0013;\nconst INT_PERCENTAGE = 0x0030;\nconst FLOAT_PERCENTAGE = 0x0031;\nconst MDATA = 0x3D3D;\nconst MESH_VERSION = 0x3D3E;\nconst MASTER_SCALE = 0x0100;\n// const LO_SHADOW_BIAS = 0x1400;\n// const HI_SHADOW_BIAS = 0x1410;\n// const SHADOW_MAP_SIZE = 0x1420;\n// const SHADOW_SAMPLES = 0x1430;\n// const SHADOW_RANGE = 0x1440;\n// const SHADOW_FILTER = 0x1450;\n// const RAY_BIAS = 0x1460;\n// const O_CONSTS = 0x1500;\n// const AMBIENT_LIGHT = 0x2100;\n// const BIT_MAP = 0x1100;\n// const SOLID_BGND = 0x1200;\n// const V_GRADIENT = 0x1300;\n// const USE_BIT_MAP = 0x1101;\n// const USE_SOLID_BGND = 0x1201;\n// const USE_V_GRADIENT = 0x1301;\n// const FOG = 0x2200;\n// const FOG_BGND = 0x2210;\n// const LAYER_FOG = 0x2302;\n// const DISTANCE_CUE = 0x2300;\n// const DCUE_BGND = 0x2310;\n// const USE_FOG = 0x2201;\n// const USE_LAYER_FOG = 0x2303;\n// const USE_DISTANCE_CUE = 0x2301;\nconst MAT_ENTRY = 0xAFFF;\nconst MAT_NAME = 0xA000;\nconst MAT_AMBIENT = 0xA010;\nconst MAT_DIFFUSE = 0xA020;\nconst MAT_SPECULAR = 0xA030;\nconst MAT_SHININESS = 0xA040;\n// const MAT_SHIN2PCT = 0xA041;\nconst MAT_TRANSPARENCY = 0xA050;\n// const MAT_XPFALL = 0xA052;\n// const MAT_USE_XPFALL = 0xA240;\n// const MAT_REFBLUR = 0xA053;\n// const MAT_SHADING = 0xA100;\n// const MAT_USE_REFBLUR = 0xA250;\n// const MAT_SELF_ILLUM = 0xA084;\nconst MAT_TWO_SIDE = 0xA081;\n// const MAT_DECAL = 0xA082;\nconst MAT_ADDITIVE = 0xA083;\nconst MAT_WIRE = 0xA085;\n// const MAT_FACEMAP = 0xA088;\n// const MAT_TRANSFALLOFF_IN = 0xA08A;\n// const MAT_PHONGSOFT = 0xA08C;\n// const MAT_WIREABS = 0xA08E;\nconst MAT_WIRE_SIZE = 0xA087;\nconst MAT_TEXMAP = 0xA200;\n// const MAT_SXP_TEXT_DATA = 0xA320;\n// const MAT_TEXMASK = 0xA33E;\n// const MAT_SXP_TEXTMASK_DATA = 0xA32A;\n// const MAT_TEX2MAP = 0xA33A;\n// const MAT_SXP_TEXT2_DATA = 0xA321;\n// const MAT_TEX2MASK = 0xA340;\n// const MAT_SXP_TEXT2MASK_DATA = 0xA32C;\nconst MAT_OPACMAP = 0xA210;\n// const MAT_SXP_OPAC_DATA = 0xA322;\n// const MAT_OPACMASK = 0xA342;\n// const MAT_SXP_OPACMASK_DATA = 0xA32E;\nconst MAT_BUMPMAP = 0xA230;\n// const MAT_SXP_BUMP_DATA = 0xA324;\n// const MAT_BUMPMASK = 0xA344;\n// const MAT_SXP_BUMPMASK_DATA = 0xA330;\nconst MAT_SPECMAP = 0xA204;\n// const MAT_SXP_SPEC_DATA = 0xA325;\n// const MAT_SPECMASK = 0xA348;\n// const MAT_SXP_SPECMASK_DATA = 0xA332;\n// const MAT_SHINMAP = 0xA33C;\n// const MAT_SXP_SHIN_DATA = 0xA326;\n// const MAT_SHINMASK = 0xA346;\n// const MAT_SXP_SHINMASK_DATA = 0xA334;\n// const MAT_SELFIMAP = 0xA33D;\n// const MAT_SXP_SELFI_DATA = 0xA328;\n// const MAT_SELFIMASK = 0xA34A;\n// const MAT_SXP_SELFIMASK_DATA = 0xA336;\n// const MAT_REFLMAP = 0xA220;\n// const MAT_REFLMASK = 0xA34C;\n// const MAT_SXP_REFLMASK_DATA = 0xA338;\n// const MAT_ACUBIC = 0xA310;\nconst MAT_MAPNAME = 0xA300;\n// const MAT_MAP_TILING = 0xA351;\n// const MAT_MAP_TEXBLUR = 0xA353;\nconst MAT_MAP_USCALE = 0xA354;\nconst MAT_MAP_VSCALE = 0xA356;\nconst MAT_MAP_UOFFSET = 0xA358;\nconst MAT_MAP_VOFFSET = 0xA35A;\n// const MAT_MAP_ANG = 0xA35C;\n// const MAT_MAP_COL1 = 0xA360;\n// const MAT_MAP_COL2 = 0xA362;\n// const MAT_MAP_RCOL = 0xA364;\n// const MAT_MAP_GCOL = 0xA366;\n// const MAT_MAP_BCOL = 0xA368;\nconst NAMED_OBJECT = 0x4000;\n// const N_DIRECT_LIGHT = 0x4600;\n// const DL_OFF = 0x4620;\n// const DL_OUTER_RANGE = 0x465A;\n// const DL_INNER_RANGE = 0x4659;\n// const DL_MULTIPLIER = 0x465B;\n// const DL_EXCLUDE = 0x4654;\n// const DL_ATTENUATE = 0x4625;\n// const DL_SPOTLIGHT = 0x4610;\n// const DL_SPOT_ROLL = 0x4656;\n// const DL_SHADOWED = 0x4630;\n// const DL_LOCAL_SHADOW2 = 0x4641;\n// const DL_SEE_CONE = 0x4650;\n// const DL_SPOT_RECTANGULAR = 0x4651;\n// const DL_SPOT_ASPECT = 0x4657;\n// const DL_SPOT_PROJECTOR = 0x4653;\n// const DL_SPOT_OVERSHOOT = 0x4652;\n// const DL_RAY_BIAS = 0x4658;\n// const DL_RAYSHAD = 0x4627;\n// const N_CAMERA = 0x4700;\n// const CAM_SEE_CONE = 0x4710;\n// const CAM_RANGES = 0x4720;\n// const OBJ_HIDDEN = 0x4010;\n// const OBJ_VIS_LOFTER = 0x4011;\n// const OBJ_DOESNT_CAST = 0x4012;\n// const OBJ_DONT_RECVSHADOW = 0x4017;\n// const OBJ_MATTE = 0x4013;\n// const OBJ_FAST = 0x4014;\n// const OBJ_PROCEDURAL = 0x4015;\n// const OBJ_FROZEN = 0x4016;\nconst N_TRI_OBJECT = 0x4100;\nconst POINT_ARRAY = 0x4110;\n// const POINT_FLAG_ARRAY = 0x4111;\nconst FACE_ARRAY = 0x4120;\nconst MSH_MAT_GROUP = 0x4130;\n// const SMOOTH_GROUP = 0x4150;\n// const MSH_BOXMAP = 0x4190;\nconst TEX_VERTS = 0x4140;\nconst MESH_MATRIX = 0x4160;\n// const MESH_COLOR = 0x4165;\n// const MESH_TEXTURE_INFO = 0x4170;\n// const KFDATA = 0xB000;\n// const KFHDR = 0xB00A;\n// const KFSEG = 0xB008;\n// const KFCURTIME = 0xB009;\n// const AMBIENT_NODE_TAG = 0xB001;\n// const OBJECT_NODE_TAG = 0xB002;\n// const CAMERA_NODE_TAG = 0xB003;\n// const TARGET_NODE_TAG = 0xB004;\n// const LIGHT_NODE_TAG = 0xB005;\n// const L_TARGET_NODE_TAG = 0xB006;\n// const SPOTLIGHT_NODE_TAG = 0xB007;\n// const NODE_ID = 0xB030;\n// const NODE_HDR = 0xB010;\n// const PIVOT = 0xB013;\n// const INSTANCE_NAME = 0xB011;\n// const MORPH_SMOOTH = 0xB015;\n// const BOUNDBOX = 0xB014;\n// const POS_TRACK_TAG = 0xB020;\n// const COL_TRACK_TAG = 0xB025;\n// const ROT_TRACK_TAG = 0xB021;\n// const SCL_TRACK_TAG = 0xB022;\n// const MORPH_TRACK_TAG = 0xB026;\n// const FOV_TRACK_TAG = 0xB023;\n// const ROLL_TRACK_TAG = 0xB024;\n// const HOT_TRACK_TAG = 0xB027;\n// const FALL_TRACK_TAG = 0xB028;\n// const HIDE_TRACK_TAG = 0xB029;\n// const POLY_2D = 0x5000;\n// const SHAPE_OK = 0x5010;\n// const SHAPE_NOT_OK = 0x5011;\n// const SHAPE_HOOK = 0x5020;\n// const PATH_3D = 0x6000;\n// const PATH_MATRIX = 0x6005;\n// const SHAPE_2D = 0x6010;\n// const M_SCALE = 0x6020;\n// const M_TWIST = 0x6030;\n// const M_TEETER = 0x6040;\n// const M_FIT = 0x6050;\n// const M_BEVEL = 0x6060;\n// const XZ_CURVE = 0x6070;\n// const YZ_CURVE = 0x6080;\n// const INTERPCT = 0x6090;\n// const DEFORM_LIMIT = 0x60A0;\n// const USE_CONTOUR = 0x6100;\n// const USE_TWEEN = 0x6110;\n// const USE_SCALE = 0x6120;\n// const USE_TWIST = 0x6130;\n// const USE_TEETER = 0x6140;\n// const USE_FIT = 0x6150;\n// const USE_BEVEL = 0x6160;\n// const DEFAULT_VIEW = 0x3000;\n// const VIEW_TOP = 0x3010;\n// const VIEW_BOTTOM = 0x3020;\n// const VIEW_LEFT = 0x3030;\n// const VIEW_RIGHT = 0x3040;\n// const VIEW_FRONT = 0x3050;\n// const VIEW_BACK = 0x3060;\n// const VIEW_USER = 0x3070;\n// const VIEW_CAMERA = 0x3080;\n// const VIEW_WINDOW = 0x3090;\n// const VIEWPORT_LAYOUT_OLD = 0x7000;\n// const VIEWPORT_DATA_OLD = 0x7010;\n// const VIEWPORT_LAYOUT = 0x7001;\n// const VIEWPORT_DATA = 0x7011;\n// const VIEWPORT_DATA_3 = 0x7012;\n// const VIEWPORT_SIZE = 0x7020;\n// const NETWORK_VIEW = 0x7030;\n\nexport { TDSLoader };\n","import * as THREE from 'three'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass'\r\nimport { SQWater } from './SQWater'\r\n// import { ClearPass } from 'three/examples/jsm/postprocessing/ClearPass'\r\n// import FresnelShader from './FresnelShader'\r\nimport { Stats } from 'three-stats'\r\nimport { TardisCard, TardisCardShape } from './TardisCard'\r\nimport { Carousel } from './Carousel'\r\nimport { TDSLoader } from 'three/examples/jsm/loaders/TDSLoader'\r\nimport { CustomCSS3DObject, CustomCSS3DSprite, CustomCSS3DRenderer } from './CustomCSS3DRenderer'\r\nimport { DampingObjectController, DampingVector3Controller } from './Utils'\r\nimport { RefractionObject, RefractionManager } from '../ThreeRealisticRefraction/ThreeRealisticRefraction'\r\nimport { RoundedBoxGeometry } from 'three/examples/jsm/geometries/RoundedBoxGeometry'\r\n// import { TextGeometry } from 'three/examples/jsm/geometries/TextGeometry'\r\n// import { Font } from 'three/examples/jsm/loaders/FontLoader'\r\n// import { BrickManager } from './Brick'\r\nimport { controller } from '../AnimUtils/TweenUtils'\r\n// import * as GEOM from '../GeomUtils'\r\n\r\nclass FrontPageManager {\r\n    container: HTMLElement\r\n    renderer: THREE.WebGLRenderer\r\n    // controls: OrbitControls\r\n    cardInsideScene: THREE.Scene\r\n    scene: THREE.Scene\r\n    reflectionScene: THREE.Scene\r\n    composer: EffectComposer\r\n    stats: Stats\r\n\r\n    refractionManager: RefractionManager\r\n    glassMesh1Controller: DampingObjectController\r\n\r\n    // cursor position\r\n    mousePosX: number\r\n    mousePosY: number\r\n    pointer: THREE.Vector2\r\n\r\n    // camera\r\n    camera: THREE.PerspectiveCamera\r\n    cameraZPosition: number\r\n    cameraPositionController: DampingVector3Controller\r\n    cameraTargetPosition: THREE.Vector3\r\n    cameraWithMouseMoveFactor: number\r\n    cameraWithMouseRotateFactor: number\r\n\r\n    // cursor light\r\n    cursorLightGroup: THREE.Group\r\n    cursorLight: THREE.PointLight\r\n    cursorLightController: DampingObjectController\r\n\r\n    // intersections\r\n    raycaster: THREE.Raycaster\r\n    intersectTardisCardObjs: Array<THREE.Object3D>\r\n    intersectGlassObjs: Array<THREE.Object3D>\r\n\r\n    // glass intersections\r\n    glassSelected: THREE.Mesh | undefined\r\n    glassIsRotating: Boolean\r\n\r\n    // css\r\n    cssScene: THREE.Scene\r\n    cssRenderer: CustomCSS3DRenderer | undefined\r\n    cssAttachObject: THREE.Mesh\r\n\r\n    // carousel\r\n    carousel1: Carousel\r\n    carousel2: Carousel\r\n\r\n    // loading manager\r\n    loadingManager: THREE.LoadingManager\r\n\r\n    constructor(_container: HTMLElement,\r\n        onLoad?: () => void,\r\n        onProgress?: (url: string, loaded: number, total: number) => void,\r\n        onError?: (url: string) => void\r\n        ) {\r\n\r\n        // *********** basic settings ***********\r\n        this.cameraZPosition = 500\r\n        this.container = _container\r\n        this.camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 5000 )\r\n        this.renderer = new THREE.WebGLRenderer( {alpha: true} )\r\n        this.renderer.setClearColor( 0xffffff )\r\n        this.renderer.setPixelRatio( window.devicePixelRatio )\r\n        this.renderer.setSize(window.innerWidth, window.innerHeight)\r\n        this.renderer.domElement.style.position = 'absolute'\r\n        this.renderer.domElement.style.top = '0px'\r\n        this.renderer.domElement.style.left = '0px'\r\n        this.container.appendChild( this.renderer.domElement )\r\n        // TODO: (debug stats)\r\n        this.stats = new Stats()\r\n        this.stats.domElement.style.zIndex = '100'\r\n        this.container.appendChild( this.stats.domElement )\r\n\r\n        this.scene = new THREE.Scene()\r\n        this.cssScene = new THREE.Scene()\r\n        this.cardInsideScene = new THREE.Scene()\r\n        this.reflectionScene = new THREE.Scene()\r\n\r\n        // \r\n        this.loadingManager = new THREE.LoadingManager(() => {\r\n            if (onLoad) {\r\n                onLoad()\r\n            }\r\n        }, (url: string, loaded: number, total: number) => {\r\n            if (onProgress) {\r\n                onProgress(url, loaded, total)\r\n            }\r\n        }, (url) => {\r\n            if (onError) {\r\n                onError(url)\r\n            }\r\n        })\r\n\r\n        // *********** background & env ***********\r\n        const r = './cube1/'\r\n        const urls = [\r\n            r + 'px.jpg', r + 'nx.jpg',\r\n            r + 'py.jpg', r + 'ny.jpg',\r\n            r + 'pz.jpg', r + 'nz.jpg'\r\n        ]\r\n        const textureCube = new THREE.CubeTextureLoader(this.loadingManager).load( urls )\r\n        textureCube.mapping = THREE.CubeRefractionMapping\r\n        // this.scene.background = textureCube\r\n        this.scene.environment = textureCube\r\n\r\n\r\n        // *********** set light ***********\r\n        var light = new THREE.DirectionalLight()\r\n        light.intensity = 0.8\r\n        light.position.x = 80\r\n        light.position.y = 80\r\n        light.position.z = 100\r\n        this.scene.add(light)\r\n\r\n        // *********** refraction objects ***********\r\n        this.refractionManager = new RefractionManager(this.scene, this.container, this.renderer, this.camera)\r\n        var glassMesh1 = new THREE.Mesh(\r\n            new RoundedBoxGeometry(40, 40, 40, 5, 5),\r\n            // new THREE.BoxGeometry(40, 40, 40),\r\n            new THREE.MeshPhongMaterial({})\r\n        )\r\n        // raycast interaction agent with simple shape, to save calculation cost\r\n        var glassMesh1InteractAgent = new THREE.Mesh(new THREE.BoxGeometry(40,40,40), new THREE.MeshBasicMaterial({}))\r\n        glassMesh1InteractAgent.visible = false\r\n        glassMesh1.add(glassMesh1InteractAgent)\r\n\r\n        glassMesh1.rotation.set(1,1,1)\r\n        this.refractionManager.addRefractionMesh(glassMesh1, true, null, 0x00ff00, 0x4060ff, 1.3, 0.8)\r\n        this.glassMesh1Controller = new DampingObjectController(glassMesh1, 0.2, 0.1)\r\n\r\n\r\n        // *********** composers ***********\r\n        const renderPass1 = new RenderPass(this.scene, this.camera)\r\n        renderPass1.clear = true\r\n        const renderPass2 = new RenderPass(this.cardInsideScene, this.camera)\r\n        renderPass2.clearDepth = true\r\n        renderPass2.clear = false\r\n        this.composer = new EffectComposer(this.renderer, new THREE.WebGLMultisampleRenderTarget(\r\n            this.container.offsetWidth * window.devicePixelRatio,\r\n            this.container.offsetHeight * window.devicePixelRatio\r\n        ))\r\n        // this.composer = new EffectComposer(this.renderer)\r\n        this.composer.addPass(renderPass1)\r\n        this.composer.addPass(renderPass2)\r\n        this.composer.renderTarget1.stencilBuffer = true\r\n        this.composer.renderTarget2.stencilBuffer = true\r\n\r\n\r\n        // *********** tardis cards ***********\r\n\r\n        var tardisCardTop = new TardisCard(100, 400, 110,\r\n            this.scene, this.cardInsideScene, new THREE.Vector3(0, 200, 0), new THREE.Euler(), TardisCardShape.RECT,\r\n            null)\r\n        tardisCardTop.addSkybox(textureCube)\r\n        var contentGroupInTardisCardTop = new THREE.Group()\r\n        var titleTexture = new THREE.TextureLoader(this.loadingManager).load( './title.png' )\r\n        var tardisCardTopTitle = new THREE.Mesh(\r\n            new THREE.PlaneBufferGeometry(390, 90, 1, 1),\r\n            new THREE.MeshBasicMaterial({\r\n                color: 0xffffff,\r\n                alphaMap: titleTexture,\r\n                alphaToCoverage: true,\r\n                transparent: true,\r\n            })\r\n        )\r\n        contentGroupInTardisCardTop.add(tardisCardTopTitle)\r\n        contentGroupInTardisCardTop.position.copy(tardisCardTop.cardMesh.position)\r\n        tardisCardTop.addVisibleObjectGroup(contentGroupInTardisCardTop)\r\n        this.cssAttachObject = tardisCardTop.cardMesh\r\n            \r\n        var tardisCard1 = new TardisCard(200, 200, 111,\r\n            this.scene, this.cardInsideScene, new THREE.Vector3(0, 0, 0), new THREE.Euler(), TardisCardShape.RECT,\r\n            this.reflectionScene, 0xc0d0d0)\r\n        \r\n        var diffuseTexture = new THREE.TextureLoader(this.loadingManager).load( './marble/diffuse.jpg' )\r\n        var normalTexture = new THREE.TextureLoader(this.loadingManager).load( './marble/normal.jpg' )\r\n        var specTexture = new THREE.TextureLoader(this.loadingManager).load( './marble/specular.jpg' )\r\n        var texs = [diffuseTexture, normalTexture, specTexture]\r\n        texs.forEach(t => {\r\n            t.wrapS = t.wrapT = THREE.RepeatWrapping\r\n            t.repeat.set(1, 2)\r\n        })\r\n        var contentGroupInTardisCard1 = new THREE.Group()\r\n        // https://github.com/mrdoob/three.js/blob/master/examples/webgl_loader_3ds.html\r\n        const pgnormal = new THREE.TextureLoader(this.loadingManager).load( './jutabag3ds/texture/normal.jpg' )\r\n        const loader = new TDSLoader(this.loadingManager);\r\n        loader.setResourcePath('./jutabag3ds/texture/')\r\n        loader.load( './jutabag3ds/portalgun.3ds', (obj) => {\r\n            if (obj instanceof THREE.Group) {\r\n                obj.traverse( function ( child ) {\r\n                    if ( child instanceof THREE.Mesh ) {\r\n                        console.log(child.material)\r\n                        child.material.color = new THREE.Color(0xffffff)\r\n                        // child.material.map = pgcolor\r\n                        child.material.normalMap = pgnormal\r\n                    }\r\n                } )\r\n                obj.scale.multiplyScalar(80)\r\n                obj.position.x -= 20\r\n                obj.position.y += 10\r\n                obj.position.z -= 80\r\n                obj.rotation.x = -2\r\n                obj.rotation.z = 0.7\r\n                contentGroupInTardisCard1.add(obj)\r\n                \r\n                var tardisCardBackground1 = new THREE.Mesh(\r\n                    new THREE.PlaneBufferGeometry(500, 500, 1, 1),\r\n                    new THREE.MeshPhysicalMaterial({\r\n                        color: 0xccffff,\r\n                        map: diffuseTexture,\r\n                        normalMap: normalTexture,\r\n                        normalScale: new THREE.Vector2(0.1, 0.1),\r\n                        specularColorMap: specTexture,\r\n                        specularIntensity: 4,\r\n                        reflectivity: 1.0,\r\n                        metalness: 0.2,\r\n                        roughness: 0.1,\r\n                        clearcoat: 0.5,\r\n\r\n                    })\r\n                )\r\n                tardisCardBackground1.position.set(0, 0, -150)\r\n                contentGroupInTardisCard1.add(tardisCardBackground1)\r\n                contentGroupInTardisCard1.position.copy(tardisCard1.cardMesh.position)\r\n                tardisCard1.addVisibleObjectGroup(contentGroupInTardisCard1)\r\n            }\r\n            // contentGroupInTardisCard1.add(obj)\r\n        });\r\n\r\n        \r\n        var tardisCard2 = new TardisCard(100, 100, 112, this.scene, this.cardInsideScene, new THREE.Vector3(200, 0, 0), new THREE.Euler(), TardisCardShape.CIRCLE,\r\n        this.reflectionScene, 0xd0c0d0)\r\n        this.carousel1 = new Carousel({\r\n            numOfVisiblePics: 5,\r\n            planeWidth: 80,\r\n            planeHeight: 80,\r\n            carouselArrayRadius: 120\r\n        })\r\n        var diffuseTexture2 = new THREE.TextureLoader(this.loadingManager).load( './painting/crop1_diffuse.png' )\r\n        var normalTexture2 = new THREE.TextureLoader(this.loadingManager).load( './painting/crop1_normal.png' )\r\n        var specTexture2 = new THREE.TextureLoader(this.loadingManager).load( './painting/crop1_specular.png' )\r\n        texs = [diffuseTexture2, normalTexture2, specTexture2]\r\n        var tardisCardBackground = new THREE.Mesh(\r\n            new THREE.PlaneBufferGeometry(500, 500, 1, 1),\r\n            new THREE.MeshPhysicalMaterial({\r\n                map: diffuseTexture2,\r\n                normalMap: normalTexture2,\r\n                specularColorMap: specTexture2,\r\n                normalScale: new THREE.Vector2(0.4, 0.4),\r\n                specularIntensity: 0.2,\r\n                reflectivity: 0.1,\r\n                metalness: 0.1,\r\n                roughness: 0.4\r\n            })\r\n        )\r\n        tardisCardBackground.position.set(0, 0, -150)\r\n        // scene.add(contentInTardisCard)\r\n        var contentGroupInTardisCard2 = new THREE.Group()\r\n        contentGroupInTardisCard2.add(this.carousel1)\r\n        contentGroupInTardisCard2.add(tardisCardBackground)\r\n        contentGroupInTardisCard2.position.copy(tardisCard2.cardMesh.position)\r\n        tardisCard2.addVisibleObjectGroup(contentGroupInTardisCard2)\r\n        \r\n        var tardisCard3 = new TardisCard(100, 100, 113, this.scene, this.cardInsideScene, new THREE.Vector3(-200, 0, 0), new THREE.Euler(), TardisCardShape.CIRCLE,\r\n        this.reflectionScene, 0xa0c090)\r\n        this.carousel2 = new Carousel({\r\n            numOfVisiblePics: 4,\r\n            planeWidth: 70,\r\n            planeHeight: 70,\r\n            carouselArrayRadius: 120\r\n        })\r\n        var diffuseTexture3 = new THREE.TextureLoader(this.loadingManager).load( './painting/crop2_diffuse.png' )\r\n        var normalTexture3 = new THREE.TextureLoader(this.loadingManager).load( './painting/crop2_normal.png' )\r\n        var specTexture3 = new THREE.TextureLoader(this.loadingManager).load( './painting/crop2_specular.png' )\r\n        texs = [diffuseTexture3, normalTexture3]\r\n        // texs.forEach(t => {\r\n        //     t.wrapS = t.wrapT = THREE.RepeatWrapping\r\n        //     t.repeat.set(4, 4)\r\n        // })\r\n        tardisCardBackground = new THREE.Mesh(\r\n            new THREE.PlaneBufferGeometry(500, 500, 1, 1),\r\n            new THREE.MeshPhysicalMaterial({\r\n                color: 0xffff80,\r\n                map: diffuseTexture3,\r\n                normalMap: normalTexture3,\r\n                specularColorMap: specTexture3,\r\n                normalScale: new THREE.Vector2(0.5, 0.5),\r\n                specularIntensity: 0.2,\r\n                reflectivity: 0.8,\r\n                metalness: 0,\r\n                roughness: 0.2,\r\n            })\r\n        )\r\n        tardisCardBackground.position.set(0, 0, -150)\r\n        var contentGroupInTardisCard3 = new THREE.Group()\r\n        contentGroupInTardisCard3.add(this.carousel2)\r\n        contentGroupInTardisCard3.add(tardisCardBackground)\r\n        contentGroupInTardisCard3.position.copy(tardisCard3.cardMesh.position)\r\n        tardisCard3.addVisibleObjectGroup(contentGroupInTardisCard3)\r\n\r\n\r\n        // *********** water ***********\r\n        const waterGeometry = new THREE.PlaneGeometry( 1000, 400 )\r\n        const water = new SQWater( waterGeometry, this.reflectionScene, {\r\n            // color: params.color,\r\n            // scale: params.scale,\r\n            flowDirection: new THREE.Vector2( 1, 1 ),\r\n            textureWidth: 512,\r\n            textureHeight: 512\r\n        } );\r\n\r\n        // water.position.y = 1;\r\n        water.position.z += 200;\r\n        water.position.y -= 110;\r\n        water.rotation.x = Math.PI * - 0.5;\r\n        this.scene.add( water );\r\n\r\n\r\n        // *********** camera movement ***********\r\n        this.cameraTargetPosition = new THREE.Vector3(0, 0, this.cameraZPosition)\r\n        this.camera.position.copy(this.cameraTargetPosition)\r\n        this.camera.lookAt(0, 0, 0)\r\n        this.cameraWithMouseMoveFactor = 0.04\r\n        this.cameraWithMouseRotateFactor = 0.015\r\n        this.cameraPositionController = new DampingVector3Controller(this.camera.position, 0.5, 0.05)\r\n        window.addEventListener('mousemove', e => {\r\n            self.onMouseMove(e)\r\n        })\r\n\r\n\r\n        // *********** cursor light ***********\r\n        this.cursorLightGroup = new THREE.Group()\r\n        this.cursorLight = new THREE.PointLight()\r\n        this.cursorLight.intensity = 1\r\n        this.cursorLight.decay = 1\r\n        this.cursorLight.distance = 200\r\n        this.cursorLight.color = new THREE.Color( 0xaaccff )\r\n        this.cursorLightGroup.add(this.cursorLight)\r\n        this.scene.add(this.cursorLightGroup)\r\n        this.cursorLightController = new DampingObjectController(this.cursorLightGroup, 0.3, 0.1)\r\n        \r\n\r\n        // *********** raycast intersections ***********\r\n        this.raycaster = new THREE.Raycaster()\r\n        this.intersectTardisCardObjs = []\r\n        this.intersectTardisCardObjs.push(tardisCardTop.cardMesh, tardisCard1.cardMesh, tardisCard2.cardMesh, tardisCard3.cardMesh)\r\n        this.intersectGlassObjs = []\r\n        this.glassSelected = undefined\r\n        this.glassIsRotating = false\r\n        this.intersectGlassObjs.push(glassMesh1InteractAgent)\r\n\r\n\r\n        // *********** events ***********\r\n        this.mousePosX = 0\r\n        this.mousePosY = 0\r\n        this.pointer = new THREE.Vector2()\r\n        const self = this\r\n        window.addEventListener( 'resize', () => {\r\n            self.onWindowResize()\r\n        } )\r\n        window.addEventListener( 'click', (e) => {\r\n            self.onClick(e)\r\n        } )\r\n\r\n\r\n        // *********** final animate ***********\r\n        this.animate()\r\n    }\r\n\r\n    animate = () => {\r\n        requestAnimationFrame( this.animate )\r\n        // damping controllers\r\n        this.updatecornerObject()\r\n        this.updateCamera()\r\n        this.updateCursorLight()\r\n        this.render()\r\n        this.stats.update()\r\n    }\r\n\r\n    render()\r\n    {\r\n        this.composer.render()\r\n        this.renderer.clearDepth()\r\n        this.refractionManager.render()\r\n        if (this.cssRenderer) {\r\n            this.cssRenderer.render(this.cssScene, this.camera)\r\n        }\r\n    }\r\n\r\n    onWindowResize() {\r\n        this.camera.aspect = window.innerWidth / window.innerHeight\r\n        this.camera.updateProjectionMatrix()\r\n        this.refractionManager.onWindowResize()\r\n        this.renderer.setSize( window.innerWidth, window.innerHeight )\r\n        this.composer.setSize( window.innerWidth, window.innerHeight )\r\n        if (this.cssRenderer) {\r\n            this.cssRenderer.setSize( window.innerWidth, window.innerHeight )\r\n        }\r\n    }\r\n    \r\n    onMouseMove(e: MouseEvent) {\r\n        this.mousePosX = e.clientX\r\n        this.mousePosY = e.clientY\r\n        this.pointer.x = ( e.clientX / window.innerWidth ) * 2 - 1;\r\n\t\tthis.pointer.y = - ( e.clientY / window.innerHeight ) * 2 + 1;\r\n\r\n        this.raycaster.setFromCamera( this.pointer, this.camera )\r\n        const intersects = this.raycaster.intersectObjects( this.intersectGlassObjs, false )\r\n        if (intersects.length == 1 && !this.glassIsRotating && this.glassSelected !== intersects[0].object.parent) {\r\n            console.log('in')\r\n            this.glassIsRotating = true\r\n            const intersectObj = intersects[0].object.parent\r\n            const refObj = intersectObj ? intersectObj['refractionObject'] : null\r\n            if (intersectObj instanceof THREE.Mesh && refObj instanceof RefractionObject) {\r\n                this.glassSelected = intersectObj\r\n                controller.tweenEuler(this.glassSelected.rotation, new THREE.Euler(1,6,1), (v) => {\r\n                        intersectObj.rotation.copy(v)\r\n                    },\r\n                    () => {this.glassIsRotating = false},\r\n                    500\r\n                )\r\n                controller.tweenNumber(1, 0, (val) => {\r\n                    refObj.refractionMaterialUniforms['absorbColor'].value.b = val\r\n                },\r\n                () => {},\r\n                500)\r\n            }\r\n            // this.glassSelected.rotation.set(1,2,1)\r\n        }\r\n        else if (intersects.length == 0 && !this.glassIsRotating && this.glassSelected !== undefined) {\r\n            console.log('out')\r\n            this.glassIsRotating = true\r\n            let rotateObj = this.glassSelected\r\n            const refObj = this.glassSelected['refractionObject']\r\n            controller.tweenEuler(this.glassSelected.rotation, new THREE.Euler(1,1,1), (v) => {\r\n                rotateObj.rotation.copy(v)\r\n                },\r\n                () => {this.glassIsRotating = false},\r\n                500\r\n            )\r\n            controller.tweenNumber(0, 1, (val) => {\r\n                refObj.refractionMaterialUniforms['absorbColor'].value.b = val\r\n            },\r\n            () => {},\r\n            500)\r\n            this.glassSelected = undefined\r\n        }\r\n    }\r\n\r\n    onClick(e: MouseEvent) {\r\n        if (this.glassSelected) {\r\n            return\r\n        }\r\n        const intersects = this.raycaster.intersectObjects( this.intersectTardisCardObjs, false )\r\n        \r\n        if (intersects.length == 1) {\r\n            const intersectObj = intersects[0]\r\n            controller.tweenThreeVector3(\r\n                this.cameraTargetPosition,\r\n                new THREE.Vector3(\r\n                    intersectObj.object.position.x,\r\n                    intersectObj.object.position.y,\r\n                    this.cameraTargetPosition.z\r\n                ),\r\n                (updatedVec) => {\r\n                    this.cameraTargetPosition.copy(updatedVec)\r\n                },\r\n                () => {},\r\n                750\r\n            )\r\n            this.carousel1.clickToRotate(this.raycaster, (carouselIndex) => {\r\n                console.log('new carousel img index', carouselIndex)\r\n                return `https://picsum.photos/id/${Math.ceil(Math.random() * 50)}/200/200`\r\n            })\r\n            this.carousel2.clickToChangeTex(this.raycaster, (carouselIndex) => {\r\n                console.log('new carousel img index', carouselIndex)\r\n                return `https://picsum.photos/id/${Math.ceil(Math.random() * 50)}/200/200`\r\n            })\r\n            // change carousel\r\n        }\r\n    }\r\n\r\n    getRaycastPos(posX: number, posY: number) {\r\n        let x = (2.0 * posX) / window.innerWidth - 1.0\r\n        let y = 1.0 - (2.0 * posY) / window.innerHeight\r\n        // let z = 1.0\r\n        // let ray_nds = new THREE.Vector3(x, y, z)\r\n        let ray = new THREE.Vector3(x, y, 0.995)\r\n        ray.unproject(this.camera)\r\n        return ray\r\n    }\r\n\r\n    updatecornerObject() {\r\n        let targetPos = this.getRaycastPos(window.innerWidth - 200, window.innerHeight / 2)\r\n        // let lastPos = cornerObject.position\r\n        this.glassMesh1Controller.update(targetPos)\r\n        // let currentPath = targetPos.sub(lastPos)\r\n        // cornerObjectVelocity.multiplyScalar(0.3)\r\n        // cornerObjectVelocity.add(currentPath.multiplyScalar(damp))\r\n        // cornerObject.position.add(cornerObjectVelocity)\r\n    }\r\n\r\n    updateCamera() {\r\n        const relX = window.innerWidth / 2 - this.mousePosX\r\n        const relY = window.innerHeight / 2 - this.mousePosY\r\n        // console.log(this.cameraTargetPosition)\r\n        const dampPos = (new THREE.Vector3(\r\n            -relX * this.cameraWithMouseMoveFactor,\r\n            relY * this.cameraWithMouseMoveFactor,\r\n            0\r\n        )).add(this.cameraTargetPosition)\r\n\r\n        this.cameraPositionController.update(dampPos)\r\n        var vel = this.cameraPositionController.velocity\r\n        this.camera.rotation.x = vel.y * this.cameraWithMouseRotateFactor\r\n        this.camera.rotation.y = -vel.x * this.cameraWithMouseRotateFactor\r\n    }\r\n\r\n    updateCursorLight() {\r\n        if (!isNaN(this.mousePosX) && !isNaN(this.mousePosY)) {\r\n            let targetPos = this.getRaycastPos(this.mousePosX, this.mousePosY)\r\n            let camPosZ = this.camera.position.z\r\n            let targetPosVec = new THREE.Vector3().copy(targetPos)\r\n            targetPosVec = targetPosVec.sub(this.camera.position)\r\n            let newz = -200\r\n            let x = (newz - camPosZ) / targetPosVec.z\r\n            targetPos.copy(this.camera.position)\r\n            targetPosVec.multiplyScalar(x)\r\n            targetPos.add(targetPosVec)\r\n            targetPos.z += 100\r\n            this.cursorLightController.update(targetPos)\r\n            // console.log(targetPos)\r\n        }\r\n    }\r\n\r\n    registerCSSCoordinator(htmlContainer: HTMLElement, htmlElem: HTMLElement, position: THREE.Vector3 = new THREE.Vector3(), scale: number = 1.0): CustomCSS3DObject {\r\n        if (this.cssRenderer == undefined) {\r\n            this.cssRenderer = new CustomCSS3DRenderer(htmlContainer)\r\n            this.cssRenderer.setSize( window.innerWidth, window.innerHeight )\r\n        }\r\n        // controls = new OrbitControls(camera, cssRenderer.domElement)\r\n        const object = new CustomCSS3DObject( htmlElem )\r\n        object.position.copy(position)\r\n        object.scale.multiplyScalar(scale)\r\n        this.cssScene.add(object)\r\n        return object\r\n        // cssCoordinators.push(new ThreeCSSCoordinator(htmlContainer, htmlCamera, htmlElem, camera, position))\r\n    }\r\n\r\n\r\n\r\n    \r\n}\r\n\r\n\r\n\r\nexport {\r\n    FrontPageManager\r\n}","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport * as THREE from 'three'\r\nimport Vue from 'vue'\r\nimport { FrontPageManager } from '../scripts/Three/FrontPage'\r\n\r\ntype Data = {\r\n    fpm: FrontPageManager | null,\r\n    loadingStat: {\r\n        loaded: number,\r\n        total: number,\r\n        isLoaded: boolean,\r\n        noLoadingStat: boolean\r\n    }\r\n}\r\n\r\nexport default Vue.extend({\r\n    data(): Data {\r\n        return {\r\n            fpm: null,\r\n            loadingStat: {\r\n                loaded: 1,\r\n                total: 2,\r\n                isLoaded: false,\r\n                noLoadingStat: false\r\n            }\r\n        }\r\n    },\r\n    mounted() {\r\n        const self = this\r\n        if (this.$refs['canvas-container'] instanceof HTMLElement) {\r\n            this.fpm = new FrontPageManager(\r\n                this.$refs['canvas-container'],\r\n                () => {\r\n                    console.log('loaded')\r\n                    self.loadingStat.isLoaded = true\r\n                    setTimeout(() => {\r\n                        self.loadingStat.noLoadingStat = true\r\n                    }, 501)\r\n                },\r\n                (_, loaded, total) => {\r\n                    this.loadingStat.loaded = loaded\r\n                    this.loadingStat.total = total\r\n                },\r\n                (url) => {\r\n                    console.error('failed to load asset: ' + url)\r\n                    self.loadingStat.isLoaded = true\r\n                }\r\n            )\r\n            // ThreeGlassRefraction.initScene(this.$refs['canvas-container'])\r\n            if (this.$refs['dom3d-container'] instanceof HTMLElement && this.$refs['dom3d-glass'] instanceof HTMLElement) {\r\n                const glassCSSObj = this.fpm.registerCSSCoordinator(this.$refs['dom3d-container'], this.$refs['dom3d-glass'], new THREE.Vector3(0, 20, 10))\r\n                glassCSSObj.setFollowObject(this.fpm.glassMesh1Controller.object, new THREE.Vector3())\r\n            }\r\n            if (this.$refs['dom3d-container'] instanceof HTMLElement && this.$refs['dom3d-test'] instanceof HTMLElement) {\r\n                this.fpm.registerCSSCoordinator(this.$refs['dom3d-container'], this.$refs['dom3d-test'], new THREE.Vector3(-200, 110, 0))\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        onGlassClick() {\r\n            alert('glass clicked!')\r\n        }\r\n    }\r\n})\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--15-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeFrontpageTest.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--15-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeFrontpageTest.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ThreeFrontpageTest.vue?vue&type=template&id=530f970e&scoped=true&\"\nimport script from \"./ThreeFrontpageTest.vue?vue&type=script&lang=ts&\"\nexport * from \"./ThreeFrontpageTest.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ThreeFrontpageTest.vue?vue&type=style&index=0&id=530f970e&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"530f970e\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar un$Sort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? un$Sort(array) : un$Sort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","var map = {\n\t\"./GlassFrontShader/V.glsl\": \"c444\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"5303\";","import {\n\tBoxGeometry,\n\tVector3\n} from 'three';\n\nconst _tempNormal = new Vector3();\n\nfunction getUv( faceDirVector, normal, uvAxis, projectionAxis, radius, sideLength ) {\n\n\tconst totArcLength = 2 * Math.PI * radius / 4;\n\n\t// length of the planes between the arcs on each axis\n\tconst centerLength = Math.max( sideLength - 2 * radius, 0 );\n\tconst halfArc = Math.PI / 4;\n\n\t// Get the vector projected onto the Y plane\n\t_tempNormal.copy( normal );\n\t_tempNormal[ projectionAxis ] = 0;\n\t_tempNormal.normalize();\n\n\t// total amount of UV space alloted to a single arc\n\tconst arcUvRatio = 0.5 * totArcLength / ( totArcLength + centerLength );\n\n\t// the distance along one arc the point is at\n\tconst arcAngleRatio = 1.0 - ( _tempNormal.angleTo( faceDirVector ) / halfArc );\n\n\tif ( Math.sign( _tempNormal[ uvAxis ] ) === 1 ) {\n\n\t\treturn arcAngleRatio * arcUvRatio;\n\n\t} else {\n\n\t\t// total amount of UV space alloted to the plane between the arcs\n\t\tconst lenUv = centerLength / ( totArcLength + centerLength );\n\t\treturn lenUv + arcUvRatio + arcUvRatio * ( 1.0 - arcAngleRatio );\n\n\t}\n\n}\n\nclass RoundedBoxGeometry extends BoxGeometry {\n\n\tconstructor( width = 1, height = 1, depth = 1, segments = 2, radius = 0.1 ) {\n\n\t\t// ensure segments is odd so we have a plane connecting the rounded corners\n\t\tsegments = segments * 2 + 1;\n\n\t\t// ensure radius isn't bigger than shortest side\n\t\tradius = Math.min( width / 2, height / 2, depth / 2, radius );\n\n\t\tsuper( 1, 1, 1, segments, segments, segments );\n\n\t\t// if we just have one segment we're the same as a regular box\n\t\tif ( segments === 1 ) return;\n\n\t\tconst geometry2 = this.toNonIndexed();\n\n\t\tthis.index = null;\n\t\tthis.attributes.position = geometry2.attributes.position;\n\t\tthis.attributes.normal = geometry2.attributes.normal;\n\t\tthis.attributes.uv = geometry2.attributes.uv;\n\n\t\t//\n\n\t\tconst position = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\tconst box = new Vector3( width, height, depth ).divideScalar( 2 ).subScalar( radius );\n\n\t\tconst positions = this.attributes.position.array;\n\t\tconst normals = this.attributes.normal.array;\n\t\tconst uvs = this.attributes.uv.array;\n\n\t\tconst faceTris = positions.length / 6;\n\t\tconst faceDirVector = new Vector3();\n\t\tconst halfSegmentSize = 0.5 / segments;\n\n\t\tfor ( let i = 0, j = 0; i < positions.length; i += 3, j += 2 ) {\n\n\t\t\tposition.fromArray( positions, i );\n\t\t\tnormal.copy( position );\n\t\t\tnormal.x -= Math.sign( normal.x ) * halfSegmentSize;\n\t\t\tnormal.y -= Math.sign( normal.y ) * halfSegmentSize;\n\t\t\tnormal.z -= Math.sign( normal.z ) * halfSegmentSize;\n\t\t\tnormal.normalize();\n\n\t\t\tpositions[ i + 0 ] = box.x * Math.sign( position.x ) + normal.x * radius;\n\t\t\tpositions[ i + 1 ] = box.y * Math.sign( position.y ) + normal.y * radius;\n\t\t\tpositions[ i + 2 ] = box.z * Math.sign( position.z ) + normal.z * radius;\n\n\t\t\tnormals[ i + 0 ] = normal.x;\n\t\t\tnormals[ i + 1 ] = normal.y;\n\t\t\tnormals[ i + 2 ] = normal.z;\n\n\t\t\tconst side = Math.floor( i / faceTris );\n\n\t\t\tswitch ( side ) {\n\n\t\t\t\tcase 0: // right\n\n\t\t\t\t\t// generate UVs along Z then Y\n\t\t\t\t\tfaceDirVector.set( 1, 0, 0 );\n\t\t\t\t\tuvs[ j + 0 ] = getUv( faceDirVector, normal, 'z', 'y', radius, depth );\n\t\t\t\t\tuvs[ j + 1 ] = 1.0 - getUv( faceDirVector, normal, 'y', 'z', radius, height );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // left\n\n\t\t\t\t\t// generate UVs along Z then Y\n\t\t\t\t\tfaceDirVector.set( - 1, 0, 0 );\n\t\t\t\t\tuvs[ j + 0 ] = 1.0 - getUv( faceDirVector, normal, 'z', 'y', radius, depth );\n\t\t\t\t\tuvs[ j + 1 ] = 1.0 - getUv( faceDirVector, normal, 'y', 'z', radius, height );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2: // top\n\n\t\t\t\t\t// generate UVs along X then Z\n\t\t\t\t\tfaceDirVector.set( 0, 1, 0 );\n\t\t\t\t\tuvs[ j + 0 ] = 1.0 - getUv( faceDirVector, normal, 'x', 'z', radius, width );\n\t\t\t\t\tuvs[ j + 1 ] = getUv( faceDirVector, normal, 'z', 'x', radius, depth );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 3: // bottom\n\n\t\t\t\t\t// generate UVs along X then Z\n\t\t\t\t\tfaceDirVector.set( 0, - 1, 0 );\n\t\t\t\t\tuvs[ j + 0 ] = 1.0 - getUv( faceDirVector, normal, 'x', 'z', radius, width );\n\t\t\t\t\tuvs[ j + 1 ] = 1.0 - getUv( faceDirVector, normal, 'z', 'x', radius, depth );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 4: // front\n\n\t\t\t\t\t// generate UVs along X then Y\n\t\t\t\t\tfaceDirVector.set( 0, 0, 1 );\n\t\t\t\t\tuvs[ j + 0 ] = 1.0 - getUv( faceDirVector, normal, 'x', 'y', radius, width );\n\t\t\t\t\tuvs[ j + 1 ] = 1.0 - getUv( faceDirVector, normal, 'y', 'x', radius, height );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 5: // back\n\n\t\t\t\t\t// generate UVs along X then Y\n\t\t\t\t\tfaceDirVector.set( 0, 0, - 1 );\n\t\t\t\t\tuvs[ j + 0 ] = getUv( faceDirVector, normal, 'x', 'y', radius, width );\n\t\t\t\t\tuvs[ j + 1 ] = 1.0 - getUv( faceDirVector, normal, 'y', 'x', radius, height );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nexport { RoundedBoxGeometry };\n","export function loadShader(shaderName: string): Array<string> {\r\n    try {\r\n        var vertexShader = require('./' + shaderName + '/V.glsl')\r\n        var fragShader = require('./' + shaderName + '/F.glsl')\r\n        return [vertexShader, fragShader]\r\n    }\r\n    catch(err) {\r\n        console.error('failed to fetch shader', err)\r\n        return ['', '']\r\n    }\r\n}","import * as THREE from 'three'\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\r\nimport { RoundedBoxGeometry } from 'three/examples/jsm/geometries/RoundedBoxGeometry'\r\nimport { loadShader } from './ShaderLoader'\r\nimport { Stats } from 'three-stats'\r\nimport { ShaderMaterial } from 'three'\r\n\r\nexport class RefractionObject {\r\n    mesh: THREE.Mesh\r\n    originalMaterial: THREE.Material | THREE.Material[]\r\n    refractionMaterial: THREE.ShaderMaterial\r\n    backColor: THREE.Color\r\n    refractionMaterialUniforms: { [uniform: string]: THREE.IUniform }\r\n    // suResolution: THREE.Vector2\r\n    // suBackground: THREE.Texture\r\n    // suDepth: THREE.DepthTexture\r\n    constructor(scene: THREE.Scene, mesh: THREE.Mesh, suResolution: THREE.Vector2, suBackground: THREE.Texture, suImage: THREE.Texture | null, suDepth: THREE.DepthTexture,\r\n        backColor: THREE.Color, absorbColor: number, suRefractionFactor: number, suOpacity: number) {\r\n        this.mesh = mesh\r\n        this.mesh['refractionObject'] = this\r\n        // copy material\r\n        if (this.mesh.material instanceof Array) {\r\n            this.originalMaterial = new Array<THREE.Material>()\r\n            for (let i = 0; i < this.mesh.material.length; i++) {\r\n                this.originalMaterial.push(this.mesh.material[i].clone())\r\n            }\r\n        }\r\n        else {\r\n            this.originalMaterial = this.mesh.material.clone()\r\n        }\r\n        this.backColor = backColor\r\n        this.refractionMaterialUniforms = {\r\n            \"resolution\": { value: suResolution },\r\n            \"tBackground\":    { value: suBackground },\r\n            \"tBackDepth\": { value: suDepth },\r\n            \"tDisplayImage\": { value: suImage },\r\n            \"tSkybox\": { value: scene.environment },\r\n            \"refractionFactor\": { value: suRefractionFactor },\r\n            \"opacity\": { value: suOpacity },\r\n            \"absorbColor\": { value: new THREE.Color(absorbColor) },\r\n            \"objectCenter\": { value: mesh.position },\r\n        }\r\n        var [glassFrontVS, glassFrontFS] = loadShader('GlassFrontShader')\r\n        this.refractionMaterial = new ShaderMaterial({\r\n            vertexShader:   glassFrontVS,\r\n            fragmentShader: glassFrontFS,\r\n            uniforms: this.refractionMaterialUniforms,\r\n            // depthTest: false,\r\n            // stencilWrite: true,\r\n            // stencilRef: 999,\r\n            // stencilZPass: THREE.ReplaceStencilOp,  // write if the depth buffer test passes\r\n            side: THREE.FrontSide\r\n        })\r\n    }\r\n}\r\n\r\nexport class RefractionManager {\r\n    container: HTMLElement\r\n    backgroundScene: THREE.Scene\r\n    renderer: THREE.WebGLRenderer\r\n    camera: THREE.PerspectiveCamera\r\n\r\n    frontScene: THREE.Scene\r\n\r\n    backdepthTexture: THREE.DepthTexture\r\n    backRenderTarget: THREE.WebGLRenderTarget\r\n\r\n    refractionObjectList: Array<RefractionObject>\r\n\r\n    suResolution: THREE.Vector2\r\n\r\n    constructor(\r\n        backgroundScene: THREE.Scene, container: HTMLElement, renderer: THREE.WebGLRenderer, camera: THREE.PerspectiveCamera,\r\n        backDepthTextureSize: number = 512\r\n    ) {\r\n        this.container = container\r\n        this.backgroundScene = backgroundScene\r\n        this.renderer = renderer\r\n        this.camera = camera\r\n\r\n        this.frontScene = new THREE.Scene()\r\n        this.backdepthTexture = new THREE.DepthTexture(\r\n            backDepthTextureSize, backDepthTextureSize,\r\n            THREE.FloatType\r\n        )\r\n        this.backRenderTarget = new THREE.WebGLRenderTarget(\r\n            this.container.offsetWidth * window.devicePixelRatio,\r\n            this.container.offsetHeight * window.devicePixelRatio\r\n        )\r\n        this.backRenderTarget.depthBuffer = true;\r\n        this.backRenderTarget.depthTexture = this.backdepthTexture;\r\n        this.backRenderTarget.depthTexture.type = THREE.UnsignedIntType;\r\n        this.frontScene.background = this.backRenderTarget.texture\r\n        this.frontScene.environment = this.backgroundScene.environment\r\n        this.refractionObjectList = []\r\n        this.suResolution = new THREE.Vector2(\r\n            this.container.offsetWidth * window.devicePixelRatio,\r\n            this.container.offsetHeight * window.devicePixelRatio\r\n        )\r\n\r\n    }\r\n\r\n    genFresnelMaterial(textureCube: THREE.Texture | null) {\r\n        var shader = THREE.ShaderLib.lib[ \"fresnel\" ];\r\n        var uniforms = THREE.UniformsUtils.clone( shader.uniforms );\r\n\r\n        uniforms[ \"tCube\" ].value = textureCube;\r\n\r\n        var parameters = { fragmentShader: shader.fragmentShader, vertexShader: shader.vertexShader, uniforms: uniforms };\r\n        var material = new THREE.ShaderMaterial( parameters );\r\n        return material\r\n    }\r\n\r\n    addRefractionMesh(mesh: THREE.Mesh, setDefaultBacksideMaterial: boolean = true,\r\n        image: THREE.Texture | null,\r\n        backColor: number = 0xffffff,\r\n        absorbColor: number = 0x000000, refractionFactor: number = 1.49, opacityFactor: number = 0.2) {\r\n        const _backColor = new THREE.Color(backColor)\r\n        if (setDefaultBacksideMaterial) {\r\n            mesh.material = new THREE.MeshPhysicalMaterial({\r\n                color: _backColor,\r\n                transparent: true,\r\n                opacity: 0.5,\r\n                metalness: 1,\r\n                reflectivity: 0,\r\n                roughness: 0,\r\n                side: THREE.BackSide\r\n                // colorWrite: false\r\n            })\r\n            // mesh.material = this.genFresnelMaterial(this.backgroundScene.environment)\r\n        }\r\n        this.refractionObjectList.push(new RefractionObject(\r\n            this.backgroundScene,\r\n            mesh,\r\n            this.suResolution,\r\n            this.backRenderTarget.texture,\r\n            image,\r\n            this.backRenderTarget.depthTexture,\r\n            _backColor,\r\n            absorbColor,\r\n            refractionFactor,\r\n            opacityFactor\r\n        ))\r\n        this.backgroundScene.add(mesh)\r\n    }\r\n\r\n    onWindowResize() {\r\n        this.suResolution.x = this.container.offsetWidth * window.devicePixelRatio\r\n        this.suResolution.y = this.container.offsetHeight * window.devicePixelRatio\r\n    }\r\n\r\n    render() {\r\n        this.refractionObjectList.forEach(refObj => {\r\n            refObj.mesh.material = refObj.refractionMaterial\r\n            this.frontScene.add(refObj.mesh)\r\n        })\r\n\r\n        this.renderer.setRenderTarget(null)\r\n        this.renderer.render(this.frontScene, this.camera)\r\n\r\n        this.refractionObjectList.forEach(refObj => {\r\n            refObj.mesh.material = refObj.originalMaterial\r\n            this.backgroundScene.add(refObj.mesh)\r\n        })\r\n    }\r\n}\r\n\r\nvar container: HTMLElement\r\nvar renderer: THREE.WebGLRenderer, camera: THREE.PerspectiveCamera, controls: OrbitControls\r\nvar stats: Stats\r\nvar scene: THREE.Scene\r\nvar rm: RefractionManager\r\n\r\nexport function initScene(_container: HTMLElement) {\r\n    container = _container\r\n    camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 5000 )\r\n    camera.position.set(30, 20, 200)\r\n    camera.lookAt(0, 0, 0)\r\n\r\n    scene = new THREE.Scene()\r\n\r\n    renderer = new THREE.WebGLRenderer( {antialias: true, alpha: true} )\r\n    \r\n    renderer.setClearColor( 0xffffff )\r\n    renderer.setPixelRatio( window.devicePixelRatio )\r\n    renderer.setSize(window.innerWidth, window.innerHeight)\r\n    container.appendChild( renderer.domElement )\r\n    controls = new OrbitControls(camera, container)\r\n    container.style.position = 'absolute'\r\n    container.style.top = '0px'\r\n    container.style.left = '0px'\r\n    stats = new Stats()\r\n    stats.domElement.style.zIndex = '100'\r\n    container.appendChild( stats.domElement )\r\n\r\n    // set background\r\n    const r = './cube/'\r\n\r\n    const urls = [\r\n        r + 'px.jpg', r + 'nx.jpg',\r\n        r + 'py.jpg', r + 'ny.jpg',\r\n        r + 'pz.jpg', r + 'nz.jpg'\r\n    ]\r\n\r\n    const textureCube = new THREE.CubeTextureLoader().load( urls )\r\n    textureCube.mapping = THREE.CubeRefractionMapping\r\n\r\n    scene.background = textureCube\r\n    scene.environment = textureCube\r\n    \r\n    // set light\r\n    var light = new THREE.DirectionalLight()\r\n    light.position.x = 300\r\n    light.position.y = 200\r\n    light.position.z = 100\r\n    scene.add(light)\r\n\r\n    // set floor\r\n    var floorTexture = new THREE.TextureLoader().load( './checkerboard.jpg' )\r\n\tfloorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping\r\n\tfloorTexture.repeat.set( 10, 10 )\r\n    var floorMaterial = new THREE.MeshBasicMaterial( { map: floorTexture, side: THREE.DoubleSide } )\r\n\tvar floorGeometry = new THREE.PlaneGeometry(1000, 1000, 1, 1)\r\n\tvar floor = new THREE.Mesh(floorGeometry, floorMaterial)\r\n\tfloor.position.y -= 20.1\r\n\tfloor.rotation.x = Math.PI / 2\r\n    // scene.add(floor)\r\n\r\n    rm = new RefractionManager(scene, container, renderer, camera)\r\n\r\n    var glassMesh1 = new THREE.Mesh(\r\n        new RoundedBoxGeometry(40, 40, 40, 5, 5),\r\n        new THREE.MeshPhongMaterial({})\r\n    )\r\n    glassMesh1.position.x -= 40\r\n    var glassMesh2 = new THREE.Mesh(\r\n        new THREE.SphereGeometry( 20 ),\r\n        new THREE.MeshPhongMaterial({})\r\n    )\r\n    var glassMesh3 = new THREE.Mesh(\r\n        new THREE.CylinderGeometry( 20, 20, 80, 36 ),\r\n        new THREE.MeshPhongMaterial({})\r\n    )\r\n    glassMesh3.position.x += 40\r\n    glassMesh3.position.y += 20\r\n\r\n    rm.addRefractionMesh(glassMesh1, true, null, 0x000000, 0x000000)\r\n    rm.addRefractionMesh(glassMesh2, true, null, 0x006000, 0x006000)\r\n    rm.addRefractionMesh(glassMesh3, true, null, 0x000633, 0x000633)\r\n\r\n    // add a few spheres\r\n    var ballMesh = new THREE.Mesh(\r\n        new THREE.SphereGeometry( 20 ),\r\n        new THREE.MeshPhongMaterial({\r\n            color: 0xff0000\r\n        })\r\n    )\r\n    ballMesh.position.copy(glassMesh1.position)\r\n    ballMesh.position.z -= 50\r\n    scene.add(ballMesh)\r\n\r\n    window.addEventListener( 'resize', onWindowResize )\r\n    animate()\r\n\r\n}\r\n\r\nfunction onWindowResize() {\r\n\r\n    camera.aspect = window.innerWidth / window.innerHeight\r\n    camera.updateProjectionMatrix()\r\n    rm.onWindowResize()\r\n    renderer.setSize( window.innerWidth, window.innerHeight )\r\n\r\n}\r\n\r\nfunction animate() {\r\n    requestAnimationFrame( animate )\r\n    render()\r\n    controls.update()\r\n    stats.update()\r\n}\r\n\r\nfunction render()\r\n{\r\n    rm.render()\r\n}","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\n\nvar TypeError = global.TypeError;\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\n// `Array.prototype.splice` method\n// https://tc39.es/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = lengthOfArrayLike(O);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toIntegerOrInfinity(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n","var arraySlice = require('../internals/array-slice-simple');\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","module.exports = \"varying vec2 vUv;\\r\\nvarying vec3 vNormal;\\r\\nvarying vec3 vCameraPosition;\\r\\nvarying vec4 vWorldPosition;\\r\\nvarying mat4 vProjectionMatrix;\\r\\n// varying vec3 vRefract;\\r\\n// varying vec2 vRefractOffset;\\r\\nvarying vec4 vImageUVCenter;\\r\\n\\r\\nuniform vec3 objectCenter;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n    vWorldPosition = modelMatrix * vec4( position, 1.0 );\\r\\n    vec4 mvPosition = viewMatrix * vWorldPosition;\\r\\n    gl_Position = projectionMatrix * mvPosition;\\r\\n    vUv = uv;\\r\\n\\r\\n    vNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );\\r\\n    vCameraPosition = cameraPosition;\\r\\n\\r\\n    vProjectionMatrix = projectionMatrix * modelViewMatrix;\\r\\n    vImageUVCenter = vProjectionMatrix * vec4( objectCenter, 1.0 );\\r\\n}\\r\\n\"","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n","// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,\n// backported and transplited with Babel, with backwards-compat fixes\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  if (path.length === 0) return '.';\n  var code = path.charCodeAt(0);\n  var hasRoot = code === 47 /*/*/;\n  var end = -1;\n  var matchedSlash = true;\n  for (var i = path.length - 1; i >= 1; --i) {\n    code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) return hasRoot ? '/' : '.';\n  if (hasRoot && end === 1) {\n    // return '//';\n    // Backwards-compat fix:\n    return '/';\n  }\n  return path.slice(0, end);\n};\n\nfunction basename(path) {\n  if (typeof path !== 'string') path = path + '';\n\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  for (i = path.length - 1; i >= 0; --i) {\n    if (path.charCodeAt(i) === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // path component\n      matchedSlash = false;\n      end = i + 1;\n    }\n  }\n\n  if (end === -1) return '';\n  return path.slice(start, end);\n}\n\n// Uses a mixed approach for backwards-compatibility, as ext behavior changed\n// in new Node.js versions, so only basename() above is backported here\nexports.basename = function (path, ext) {\n  var f = basename(path);\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\nexports.extname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true;\n  // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n  var preDotState = 0;\n  for (var i = path.length - 1; i >= 0; --i) {\n    var code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n    if (code === 46 /*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 ||\n      // We saw a non-dot character immediately before the dot\n      preDotState === 0 ||\n      // The (right-most) trimmed path component is exactly '..'\n      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n  return path.slice(startDot, end);\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","module.exports = \"uniform vec2 resolution;\\r\\nuniform sampler2D tBackground;\\r\\nuniform sampler2D tBackDepth;\\r\\nuniform sampler2D tDisplayImage;\\r\\n\\r\\nuniform samplerCube tSkybox;\\r\\nuniform vec3 absorbColor;\\r\\nuniform float refractionFactor;\\r\\nuniform float opacity;\\r\\n\\r\\nvarying vec2 vUv;\\r\\nvarying vec3 vNormal;\\r\\nvarying vec3 vCameraPosition;\\r\\nvarying vec4 vWorldPosition;\\r\\nvarying mat4 vProjectionMatrix;\\r\\nvarying vec4 vImageUVCenter;\\r\\n\\r\\nfloat near = 0.1;\\r\\nfloat far  = 5000.0;\\r\\n\\r\\nfloat LinearizeDepth(float depth) \\r\\n{\\r\\n    float z = depth * 2.0 - 1.0; // back to NDC \\r\\n    return (2.0 * near * far) / (far + near - z * (far - near));\\t\\r\\n}\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n    // gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\\r\\n    // return;\\r\\n    float backDepth = float(texture2D( tBackDepth, vec2( gl_FragCoord.x / resolution.x, gl_FragCoord.y / resolution.y ) ).x);\\r\\n    float frontDepth = gl_FragCoord.z;\\r\\n\\r\\n    if (frontDepth > backDepth) {\\r\\n        discard;\\r\\n    }\\r\\n\\r\\n    float backDepthlinear = LinearizeDepth(backDepth);\\r\\n    float frontDepthlinear = LinearizeDepth(frontDepth);\\r\\n    \\r\\n    float backToFrontDepth = backDepthlinear - frontDepthlinear;\\r\\n    backToFrontDepth *= 0.5;\\r\\n    \\r\\n    vec3 vCameraRay = vWorldPosition.xyz / vWorldPosition.w - vCameraPosition;\\r\\n    vCameraRay = normalize(vCameraRay);\\r\\n    vec3 vRefract = refract( vCameraRay, vNormal, 1.0 / refractionFactor );\\r\\n    vec4 vOriginalPos = vWorldPosition + vec4(vCameraRay, 0.0);\\r\\n    vec4 vRefractedPos = vWorldPosition + vec4(vRefract, 0.0);\\r\\n    // vRefractedPos = vOriginalPos; //vWorldPosition + vec4(vRefract, 0.0);\\r\\n    vec4 vOriginalProjectedPos = vProjectionMatrix * vOriginalPos;\\r\\n    vec4 vRefractedProjectedPos = vProjectionMatrix * vRefractedPos;\\r\\n    vec2 offset = normalize(vRefractedProjectedPos - vOriginalProjectedPos).xy;\\r\\n    offset = normalize(offset);\\r\\n\\r\\n    // reflect\\r\\n    vec3 vReflect = reflect( vCameraRay, vNormal );\\r\\n    vec3 refCol = vec3(textureCube(tSkybox, vReflect));\\r\\n\\r\\n    // snell's law\\r\\n    float cosTheta1 = dot(vCameraRay, vNormal);\\r\\n    float sinTheta1 = 1.0 - cosTheta1 * cosTheta1;\\r\\n    float sinTheta2 = sinTheta1 / refractionFactor;\\r\\n    float theta2 = asin(sinTheta2);\\r\\n    offset *= sinTheta2;\\r\\n    offset *= 100.0;\\r\\n\\r\\n    offset /= backDepth;\\r\\n\\r\\n    float samplePointX_r = (gl_FragCoord.x + backToFrontDepth * offset.x * 0.9) / resolution.x;\\r\\n    float samplePointY_r = (gl_FragCoord.y + backToFrontDepth * offset.y * 0.9) / resolution.y;\\r\\n\\r\\n    float samplePointX_g = (gl_FragCoord.x + backToFrontDepth * offset.x * 0.95) / resolution.x;\\r\\n    float samplePointY_g = (gl_FragCoord.y + backToFrontDepth * offset.y * 0.95) / resolution.y;\\r\\n\\r\\n    float samplePointX_b = (gl_FragCoord.x + backToFrontDepth * offset.x) / resolution.x;\\r\\n    float samplePointY_b = (gl_FragCoord.y + backToFrontDepth * offset.y) / resolution.y;\\r\\n    \\r\\n    float backColor_r = texture2D( tBackground, vec2( samplePointX_r, samplePointY_r ) * 1.0 ).x;\\r\\n    float backColor_g = texture2D( tBackground, vec2( samplePointX_g, samplePointY_g ) * 1.0 ).y;\\r\\n    float backColor_b = texture2D( tBackground, vec2( samplePointX_b, samplePointY_b ) * 1.0 ).z;\\r\\n\\r\\n    vec3 backColor = vec3(backColor_r, backColor_g, backColor_b);\\r\\n    vec3 absorbColor = absorbColor * sqrt(backToFrontDepth) * opacity;\\r\\n    float sqrtDepth = sqrt(backToFrontDepth) * opacity;\\r\\n    float absorbFactor = sqrtDepth / (1.0 + sqrtDepth);\\r\\n    vec3 refractCol = mix(backColor, absorbColor, absorbFactor);\\r\\n\\r\\n    // backColor = texture2D( tBackground, vec2( (gl_FragCoord.x + backToFrontDepth * offset.x) / resolution.x, (gl_FragCoord.y + backToFrontDepth * offset.y) / resolution.y ) * 1.0 ).xyz;\\r\\n\\r\\n    // gl_FragColor = vec4(refCol, 1.0);\\r\\n    float reflectionCoeff = pow(sinTheta1, 4.0);\\r\\n    // reflectionCoeff = 1.0;\\r\\n\\r\\n    // vec4 image = vec4(vec3(texture2D( tDisplayImage, vec2( (gl_FragCoord.x + vImageUVCenter.x) / resolution.x, (gl_FragCoord.y + vImageUVCenter.y) / resolution.y ) )), 1.0);\\r\\n    // vec4 image = vec4((gl_FragCoord.x + vImageUVCenter.x) / resolution.x, (gl_FragCoord.y + vImageUVCenter.y) / resolution.y, 1.0, 1.0);\\r\\n    // vec4 image = vec4(1.0, 0.0, 0.0, 1.0);\\r\\n\\r\\n    // gl_FragColor = vec4(mix(refractCol, refCol, reflectionCoeff), 1.0);\\r\\n    gl_FragColor = vec4(mix(refractCol, refCol, reflectionCoeff), 1.0);\\r\\n    // gl_FragColor = image;\\r\\n    // if (gl_FragCoord.x < 600.0) {\\r\\n    //     gl_FragColor = vec4(mix(refractCol, refCol, reflectionCoeff), 1.0);\\r\\n    // }\\r\\n    // gl_FragColor = vec4(backColor, 1.0);\\r\\n    // gl_FragColor = vec4(vec3(backDepthlinear * 0.01), 1.0);\\r\\n}\"","import {\n\tColor,\n\tMatrix4,\n\tMesh,\n\tPerspectiveCamera,\n\tPlane,\n\tShaderMaterial,\n\tUniformsUtils,\n\tVector3,\n\tVector4,\n\tWebGLRenderTarget\n} from 'three';\n\nclass Reflector extends Mesh {\n\n\tconstructor( geometry, options = {} ) {\n\n\t\tsuper( geometry );\n\n\t\tthis.type = 'Reflector';\n\n\t\tconst scope = this;\n\n\t\tconst color = ( options.color !== undefined ) ? new Color( options.color ) : new Color( 0x7F7F7F );\n\t\tconst textureWidth = options.textureWidth || 512;\n\t\tconst textureHeight = options.textureHeight || 512;\n\t\tconst clipBias = options.clipBias || 0;\n\t\tconst shader = options.shader || Reflector.ReflectorShader;\n\n\t\t//\n\n\t\tconst reflectorPlane = new Plane();\n\t\tconst normal = new Vector3();\n\t\tconst reflectorWorldPosition = new Vector3();\n\t\tconst cameraWorldPosition = new Vector3();\n\t\tconst rotationMatrix = new Matrix4();\n\t\tconst lookAtPosition = new Vector3( 0, 0, - 1 );\n\t\tconst clipPlane = new Vector4();\n\n\t\tconst view = new Vector3();\n\t\tconst target = new Vector3();\n\t\tconst q = new Vector4();\n\n\t\tconst textureMatrix = new Matrix4();\n\t\tconst virtualCamera = new PerspectiveCamera();\n\n\t\tconst renderTarget = new WebGLRenderTarget( textureWidth, textureHeight );\n\n\t\tconst material = new ShaderMaterial( {\n\t\t\tuniforms: UniformsUtils.clone( shader.uniforms ),\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\tvertexShader: shader.vertexShader\n\t\t} );\n\n\t\tmaterial.uniforms[ 'tDiffuse' ].value = renderTarget.texture;\n\t\tmaterial.uniforms[ 'color' ].value = color;\n\t\tmaterial.uniforms[ 'textureMatrix' ].value = textureMatrix;\n\n\t\tthis.material = material;\n\n\t\tthis.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\treflectorWorldPosition.setFromMatrixPosition( scope.matrixWorld );\n\t\t\tcameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );\n\n\t\t\trotationMatrix.extractRotation( scope.matrixWorld );\n\n\t\t\tnormal.set( 0, 0, 1 );\n\t\t\tnormal.applyMatrix4( rotationMatrix );\n\n\t\t\tview.subVectors( reflectorWorldPosition, cameraWorldPosition );\n\n\t\t\t// Avoid rendering when reflector is facing away\n\n\t\t\tif ( view.dot( normal ) > 0 ) return;\n\n\t\t\tview.reflect( normal ).negate();\n\t\t\tview.add( reflectorWorldPosition );\n\n\t\t\trotationMatrix.extractRotation( camera.matrixWorld );\n\n\t\t\tlookAtPosition.set( 0, 0, - 1 );\n\t\t\tlookAtPosition.applyMatrix4( rotationMatrix );\n\t\t\tlookAtPosition.add( cameraWorldPosition );\n\n\t\t\ttarget.subVectors( reflectorWorldPosition, lookAtPosition );\n\t\t\ttarget.reflect( normal ).negate();\n\t\t\ttarget.add( reflectorWorldPosition );\n\n\t\t\tvirtualCamera.position.copy( view );\n\t\t\tvirtualCamera.up.set( 0, 1, 0 );\n\t\t\tvirtualCamera.up.applyMatrix4( rotationMatrix );\n\t\t\tvirtualCamera.up.reflect( normal );\n\t\t\tvirtualCamera.lookAt( target );\n\n\t\t\tvirtualCamera.far = camera.far; // Used in WebGLBackground\n\n\t\t\tvirtualCamera.updateMatrixWorld();\n\t\t\tvirtualCamera.projectionMatrix.copy( camera.projectionMatrix );\n\n\t\t\t// Update the texture matrix\n\t\t\ttextureMatrix.set(\n\t\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t\t);\n\t\t\ttextureMatrix.multiply( virtualCamera.projectionMatrix );\n\t\t\ttextureMatrix.multiply( virtualCamera.matrixWorldInverse );\n\t\t\ttextureMatrix.multiply( scope.matrixWorld );\n\n\t\t\t// Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n\t\t\t// Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n\t\t\treflectorPlane.setFromNormalAndCoplanarPoint( normal, reflectorWorldPosition );\n\t\t\treflectorPlane.applyMatrix4( virtualCamera.matrixWorldInverse );\n\n\t\t\tclipPlane.set( reflectorPlane.normal.x, reflectorPlane.normal.y, reflectorPlane.normal.z, reflectorPlane.constant );\n\n\t\t\tconst projectionMatrix = virtualCamera.projectionMatrix;\n\n\t\t\tq.x = ( Math.sign( clipPlane.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];\n\t\t\tq.y = ( Math.sign( clipPlane.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];\n\t\t\tq.z = - 1.0;\n\t\t\tq.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];\n\n\t\t\t// Calculate the scaled plane vector\n\t\t\tclipPlane.multiplyScalar( 2.0 / clipPlane.dot( q ) );\n\n\t\t\t// Replacing the third row of the projection matrix\n\t\t\tprojectionMatrix.elements[ 2 ] = clipPlane.x;\n\t\t\tprojectionMatrix.elements[ 6 ] = clipPlane.y;\n\t\t\tprojectionMatrix.elements[ 10 ] = clipPlane.z + 1.0 - clipBias;\n\t\t\tprojectionMatrix.elements[ 14 ] = clipPlane.w;\n\n\t\t\t// Render\n\n\t\t\trenderTarget.texture.encoding = renderer.outputEncoding;\n\n\t\t\tscope.visible = false;\n\n\t\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\t\tconst currentXrEnabled = renderer.xr.enabled;\n\t\t\tconst currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;\n\n\t\t\trenderer.xr.enabled = false; // Avoid camera modification\n\t\t\trenderer.shadowMap.autoUpdate = false; // Avoid re-computing shadows\n\n\t\t\trenderer.setRenderTarget( renderTarget );\n\n\t\t\trenderer.state.buffers.depth.setMask( true ); // make sure the depth buffer is writable so it can be properly cleared, see #18897\n\n\t\t\tif ( renderer.autoClear === false ) renderer.clear();\n\t\t\trenderer.render( scene, virtualCamera );\n\n\t\t\trenderer.xr.enabled = currentXrEnabled;\n\t\t\trenderer.shadowMap.autoUpdate = currentShadowAutoUpdate;\n\n\t\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\t\t// Restore viewport\n\n\t\t\tconst viewport = camera.viewport;\n\n\t\t\tif ( viewport !== undefined ) {\n\n\t\t\t\trenderer.state.viewport( viewport );\n\n\t\t\t}\n\n\t\t\tscope.visible = true;\n\n\t\t};\n\n\t\tthis.getRenderTarget = function () {\n\n\t\t\treturn renderTarget;\n\n\t\t};\n\n\t\tthis.dispose = function () {\n\n\t\t\trenderTarget.dispose();\n\t\t\tscope.material.dispose();\n\n\t\t};\n\n\t}\n\n}\n\nReflector.prototype.isReflector = true;\n\nReflector.ReflectorShader = {\n\n\tuniforms: {\n\n\t\t'color': {\n\t\t\tvalue: null\n\t\t},\n\n\t\t'tDiffuse': {\n\t\t\tvalue: null\n\t\t},\n\n\t\t'textureMatrix': {\n\t\t\tvalue: null\n\t\t}\n\n\t},\n\n\tvertexShader: /* glsl */`\n\t\tuniform mat4 textureMatrix;\n\t\tvarying vec4 vUv;\n\n\t\t#include <common>\n\t\t#include <logdepthbuf_pars_vertex>\n\n\t\tvoid main() {\n\n\t\t\tvUv = textureMatrix * vec4( position, 1.0 );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t#include <logdepthbuf_vertex>\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\t\tuniform vec3 color;\n\t\tuniform sampler2D tDiffuse;\n\t\tvarying vec4 vUv;\n\n\t\t#include <logdepthbuf_pars_fragment>\n\n\t\tfloat blendOverlay( float base, float blend ) {\n\n\t\t\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n\n\t\t}\n\n\t\tvec3 blendOverlay( vec3 base, vec3 blend ) {\n\n\t\t\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <logdepthbuf_fragment>\n\n\t\t\tvec4 base = texture2DProj( tDiffuse, vUv );\n\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\n\n\t\t}`\n};\n\nexport { Reflector };\n","import {\r\n\tClock,\r\n\tColor,\r\n\tMatrix4,\r\n\tMesh,\r\n\tRepeatWrapping,\r\n\tShaderMaterial,\r\n\tTextureLoader,\r\n\tUniformsLib,\r\n\tUniformsUtils,\r\n\tVector2,\r\n\tVector4,\r\n    BufferGeometry,\r\n    Camera,\r\n    Material,\r\n    Group,\r\n    Scene\r\n} from 'three';\r\nimport { Reflector } from 'three/examples/jsm/objects/Reflector'\r\nimport { Refractor } from 'three/examples/jsm/objects/Refractor'\r\nimport { Water2Options } from 'three/examples/jsm/objects/Water2'\r\n/**\r\n * References:\r\n *\thttps://github.com/mrdoob/three.js/blob/dev/examples/jsm/objects/Water2.js\r\n *\r\n */\r\n\r\nclass SQWater extends Mesh {\r\n\r\n    material: ShaderMaterial\r\n\r\n\tconstructor( geometry: BufferGeometry, reflectionScene: Scene, options: Water2Options = {} ) {\r\n\r\n\t\tsuper( geometry );\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tconst color = ( options.color !== undefined ) ? new Color( options.color ) : new Color( 0xFFFFFF );\r\n\t\tconst textureWidth = options.textureWidth || 512;\r\n\t\tconst textureHeight = options.textureHeight || 512;\r\n\t\tconst clipBias = options.clipBias || 0;\r\n\t\tconst flowDirection = options.flowDirection || new Vector2( 1, 0 );\r\n\t\tconst flowSpeed = options.flowSpeed || 0.01;\r\n\t\tconst reflectivity = options.reflectivity || 0.5;\r\n\t\tconst scale = options.scale || 1;\r\n\t\tconst shader = WaterShader;\r\n\r\n\t\tconst textureLoader = new TextureLoader();\r\n\r\n\t\tconst normalMap0 = options.normalMap0 || textureLoader.load( './water/Water_1_M_Normal.jpg' );\r\n\t\tconst normalMap1 = options.normalMap1 || textureLoader.load( './water/Water_2_M_Normal.jpg' );\r\n\r\n\t\tconst cycle = 0.15; // a cycle of a flow map phase\r\n\t\tconst halfCycle = cycle * 0.5;\r\n\t\tconst textureMatrix = new Matrix4();\r\n\t\tconst clock = new Clock();\r\n        this.material = new ShaderMaterial()\r\n\t\t// internal components\r\n\r\n\t\tconst reflector = new Reflector( geometry, {\r\n\t\t\ttextureWidth: textureWidth,\r\n\t\t\ttextureHeight: textureHeight,\r\n\t\t\tclipBias: clipBias\r\n\t\t} );\r\n\r\n\t\treflector.matrixAutoUpdate = false\r\n\r\n\t\t// material\r\n\r\n\t\tthis.material = new ShaderMaterial( {\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib[ 'fog' ],\r\n\t\t\t\tshader.uniforms\r\n\t\t\t] ),\r\n\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\tfragmentShader: shader.fragmentShader,\r\n\t\t\ttransparent: true,\r\n\t\t\tfog: true\r\n\t\t} );\r\n\r\n        this.material.uniforms[ 'flowDirection' ].value = flowDirection\r\n\r\n\t\t// maps\r\n\r\n\t\tnormalMap0.wrapS = normalMap0.wrapT = RepeatWrapping;\r\n\t\tnormalMap1.wrapS = normalMap1.wrapT = RepeatWrapping;\r\n\r\n\t\tthis.material.uniforms[ 'tReflectionMap' ].value = reflector.getRenderTarget().texture;\r\n\t\tthis.material.uniforms[ 'tNormalMap0' ].value = normalMap0;\r\n\t\tthis.material.uniforms[ 'tNormalMap1' ].value = normalMap1;\r\n\r\n\t\t// water\r\n\r\n\t\tthis.material.uniforms[ 'reflectivity' ].value = reflectivity;\r\n\t\tthis.material.uniforms[ 'textureMatrix' ].value = textureMatrix;\r\n\r\n\t\t// inital values\r\n\r\n\t\tthis.material.uniforms[ 'config' ].value.x = 0; // flowMapOffset0\r\n\t\tthis.material.uniforms[ 'config' ].value.y = halfCycle; // flowMapOffset1\r\n\t\tthis.material.uniforms[ 'config' ].value.z = halfCycle; // halfCycle\r\n\t\tthis.material.uniforms[ 'config' ].value.w = scale; // scale\r\n\r\n\t\t// functions\r\n\r\n\t\tfunction updateTextureMatrix( camera: Camera ) {\r\n\r\n\t\t\ttextureMatrix.set(\r\n\t\t\t\t0.5, 0.0, 0.0, 0.5,\r\n\t\t\t\t0.0, 0.5, 0.0, 0.5,\r\n\t\t\t\t0.0, 0.0, 0.5, 0.5,\r\n\t\t\t\t0.0, 0.0, 0.0, 1.0\r\n\t\t\t);\r\n\r\n\t\t\ttextureMatrix.multiply( camera.projectionMatrix );\r\n\t\t\ttextureMatrix.multiply( camera.matrixWorldInverse );\r\n\t\t\ttextureMatrix.multiply( scope.matrixWorld );\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateFlow() {\r\n\r\n\t\t\tconst delta = clock.getDelta();\r\n\t\t\tconst config = scope.material.uniforms[ 'config' ];\r\n\r\n\t\t\tconfig.value.x += flowSpeed * delta; // flowMapOffset0\r\n\t\t\tconfig.value.y = config.value.x + halfCycle; // flowMapOffset1\r\n\r\n\t\t\t// Important: The distance between offsets should be always the value of \"halfCycle\".\r\n\t\t\t// Moreover, both offsets should be in the range of [ 0, cycle ].\r\n\t\t\t// This approach ensures a smooth water flow and avoids \"reset\" effects.\r\n\r\n\t\t\tif ( config.value.x >= cycle ) {\r\n\r\n\t\t\t\tconfig.value.x = 0;\r\n\t\t\t\tconfig.value.y = halfCycle;\r\n\r\n\t\t\t} else if ( config.value.y >= cycle ) {\r\n\r\n\t\t\t\tconfig.value.y = config.value.y - cycle;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tthis.onBeforeRender = function ( renderer, scene, camera: Camera, geometry: BufferGeometry, material: Material, group: Group ) {\r\n\r\n\t\t\tupdateTextureMatrix( camera );\r\n\t\t\tupdateFlow();\r\n\r\n\t\t\tscope.visible = false;\r\n\r\n\t\t\treflector.matrixWorld.copy( scope.matrixWorld );\r\n\r\n\t\t\treflector.onBeforeRender( renderer, reflectionScene, camera, geometry, material, group );\r\n\r\n\t\t\tscope.visible = true;\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n}\r\n\r\nconst WaterShader = {\r\n\r\n\tuniforms: {\r\n\r\n\t\t'reflectivity': {\r\n\t\t\ttype: 'f',\r\n\t\t\tvalue: 0\r\n\t\t},\r\n\r\n\t\t'tReflectionMap': {\r\n\t\t\ttype: 't',\r\n\t\t\tvalue: null\r\n\t\t},\r\n\r\n\t\t'tRefractionMap': {\r\n\t\t\ttype: 't',\r\n\t\t\tvalue: null\r\n\t\t},\r\n\r\n\t\t'tNormalMap0': {\r\n\t\t\ttype: 't',\r\n\t\t\tvalue: null\r\n\t\t},\r\n\r\n\t\t'tNormalMap1': {\r\n\t\t\ttype: 't',\r\n\t\t\tvalue: null\r\n\t\t},\r\n\r\n\t\t'textureMatrix': {\r\n\t\t\ttype: 'm4',\r\n\t\t\tvalue: null\r\n\t\t},\r\n\r\n\t\t'config': {\r\n\t\t\ttype: 'v4',\r\n\t\t\tvalue: new Vector4()\r\n\t\t},\r\n\r\n\t\t'flowDirection': {\r\n            type: 'v2',\r\n            value: new Vector2()\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tvertexShader: /* glsl */`\r\n\r\n\t\t#include <common>\r\n\t\t#include <fog_pars_vertex>\r\n\t\t#include <logdepthbuf_pars_vertex>\r\n\r\n\t\tuniform mat4 textureMatrix;\r\n\r\n\t\tvarying vec4 vCoord;\r\n\t\tvarying vec2 vUv;\r\n\t\tvarying vec3 vToEye;\r\n\r\n\t\tvoid main() {\r\n\r\n\t\t\tvUv = uv;\r\n\t\t\tvCoord = textureMatrix * vec4( position, 1.0 );\r\n\r\n\t\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\r\n\t\t\tvToEye = cameraPosition - worldPosition.xyz;\r\n\r\n\t\t\tvec4 mvPosition =  viewMatrix * worldPosition; // used in fog_vertex\r\n\t\t\tgl_Position = projectionMatrix * mvPosition;\r\n\r\n\t\t\t#include <logdepthbuf_vertex>\r\n\t\t\t#include <fog_vertex>\r\n\r\n\t\t}`,\r\n\r\n\tfragmentShader: /* glsl */`\r\n\r\n\t\t#include <common>\r\n\t\t#include <fog_pars_fragment>\r\n\t\t#include <logdepthbuf_pars_fragment>\r\n\r\n\t\tuniform sampler2D tReflectionMap;\r\n\t\tuniform sampler2D tRefractionMap;\r\n\t\tuniform sampler2D tNormalMap0;\r\n\t\tuniform sampler2D tNormalMap1;\r\n\r\n\t\tuniform vec2 flowDirection;\r\n\r\n\t\tuniform float reflectivity;\r\n\t\tuniform vec4 config;\r\n\r\n\t\tvarying vec4 vCoord;\r\n\t\tvarying vec2 vUv;\r\n\t\tvarying vec3 vToEye;\r\n\r\n\t\tvoid main() {\r\n\r\n\t\t\t#include <logdepthbuf_fragment>\r\n\r\n\t\t\tfloat flowMapOffset0 = config.x;\r\n\t\t\tfloat flowMapOffset1 = config.y;\r\n\t\t\tfloat halfCycle = config.z;\r\n\t\t\tfloat scale = config.w;\r\n\r\n\t\t\tvec3 toEye = normalize( vToEye );\r\n\r\n\t\t\t// determine flow direction\r\n\t\t\tvec2 flow;\r\n\t\t\tflow = flowDirection;\r\n\t\t\tflow.x *= - 1.0;\r\n\r\n\t\t\t// sample normal maps (distort uvs with flowdata)\r\n\t\t\tvec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );\r\n\t\t\tvec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );\r\n\r\n\t\t\t// linear interpolate to get the final normal color\r\n\t\t\tfloat flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;\r\n\t\t\tvec4 normalColor = mix( normalColor0, normalColor1, flowLerp );\r\n\r\n\t\t\t// calculate normal vector\r\n\t\t\tvec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );\r\n\r\n\t\t\t// calculate the fresnel term to blend reflection and refraction maps\r\n\t\t\tfloat theta = max( dot( toEye, normal ), 0.0 );\r\n\t\t\tfloat reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );\r\n            reflectance = pow(reflectance + 0.3, 4.0);\r\n            // reflectance = floor(reflectance *  2.0) / 4.0;\r\n            vec4 refractColor = vec4(1.0);\r\n\r\n\t\t\t// calculate final uv coords\r\n\t\t\tvec3 coord = vCoord.xyz / vCoord.w;\r\n\t\t\tvec2 uv = coord.xy + coord.z * normal.xz * 0.05;\r\n\r\n\t\t\tvec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );\r\n            reflectColor *= vec4(1.0, 1.0, 1.0, 1.0);\r\n\t\t\treflectColor *= 0.5;\r\n\t\t\treflectColor += 0.5;\r\n\r\n\t\t\tgl_FragColor = mix(refractColor, reflectColor, reflectance);\r\n\t\t\t// gl_FragColor = reflectColor;\r\n\r\n\t\t\t#include <tonemapping_fragment>\r\n\t\t\t#include <encodings_fragment>\r\n\t\t\t#include <fog_fragment>\r\n\r\n\t\t}`\r\n\r\n};\r\n\r\nexport { SQWater };","import * as TWEEN from '@tweenjs/tween.js'\r\nimport * as THREE from 'three'\r\n// import store from '@/store'\r\nimport * as GEOM from '../GeomUtils'\r\n\r\nclass TweenAnimController {\r\n    animationObjectCount: number\r\n    requestId: number\r\n    constructor() {\r\n        this.animationObjectCount = 0\r\n        this.requestId = -1\r\n    }\r\n    addTweenAnimObject() {\r\n        if(this.animationObjectCount <= 0) {\r\n            this.startAnim()\r\n        }\r\n        this.animationObjectCount ++\r\n    }\r\n    removeTweenAnimObject() {\r\n        if (this.animationObjectCount <= 0) {\r\n            return\r\n        }\r\n        if(this.animationObjectCount == 1) {\r\n            this.stopAnim()\r\n        }\r\n        this.animationObjectCount --\r\n    }\r\n    loopAnim = () => {\r\n        TWEEN.update()\r\n        if (this.requestId >= 0) {\r\n            this.requestId = window.requestAnimationFrame(this.loopAnim)\r\n        }\r\n    }\r\n    startAnim = () => {\r\n        if (this.requestId < 0) {\r\n            this.requestId = window.requestAnimationFrame(this.loopAnim)\r\n        }\r\n    }\r\n    stopAnim = () => {\r\n        if (this.requestId >= 0) {\r\n            window.cancelAnimationFrame(this.requestId)\r\n            this.requestId = -1\r\n        }\r\n    }\r\n    tweenNumber(\r\n            fromValue: number,\r\n            toValue: number,\r\n            onUpdateFunc: (value: number) => any,\r\n            onCompleteFunc: (value: number) => any,\r\n            duration: number = 1000,\r\n            easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n        ): void {\r\n        const v = { a: fromValue }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v)\r\n            .to({ a: toValue }, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(v.a))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(v.a)\r\n            }).start()\r\n    }\r\n    tweenVector2(\r\n        fromValue: GEOM.Vector2,\r\n        toValue: GEOM.Vector2,\r\n        onUpdateFunc: (x: number, y: number) => any,\r\n        onCompleteFunc: (x: number, y: number) => any,\r\n        duration: number = 1000,\r\n        easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n    ): void {\r\n        const v1 = { x: fromValue.x, y: fromValue.y }\r\n        const v2 = { x: toValue.x, y: toValue.y }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v1)\r\n            .to(v2, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(v1.x, v1.y))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(v1.x, v1.y)\r\n            }).start()\r\n    }\r\n    tweenVector3(\r\n        fromValue: GEOM.Vector3,\r\n        toValue: GEOM.Vector3,\r\n        onUpdateFunc: (x: number, y: number, z: number) => any,\r\n        onCompleteFunc: (x: number, y: number, z: number) => any,\r\n        duration: number = 1000,\r\n        easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n    ): void {\r\n        const v1 = { x: fromValue.x, y: fromValue.y, z: fromValue.z }\r\n        const v2 = { x: toValue.x, y: toValue.y, z: toValue.z }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v1)\r\n            .to(v2, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(v1.x, v1.y, v1.z))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(v1.x, v1.y, v1.z)\r\n            }).start()\r\n    }\r\n    tweenEuler(\r\n        fromValue: THREE.Euler,\r\n        toValue: THREE.Euler,\r\n        onUpdateFunc: (eu: THREE.Euler) => any,\r\n        onCompleteFunc: (eu: THREE.Euler) => any,\r\n        duration: number = 1000,\r\n        easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n    ): void {\r\n        const v1 = { x: fromValue.x, y: fromValue.y, z: fromValue.z }\r\n        const v2 = { x: toValue.x, y: toValue.y, z: toValue.z }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v1)\r\n            .to(v2, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(new THREE.Euler(v1.x, v1.y, v1.z)))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(new THREE.Euler(v1.x, v1.y, v1.z))\r\n            }).start()\r\n    }\r\n    tweenThreeVector3(\r\n        fromValue: THREE.Vector3,\r\n        toValue: THREE.Vector3,\r\n        onUpdateFunc: (eu: THREE.Vector3) => any,\r\n        onCompleteFunc: (eu: THREE.Vector3) => any,\r\n        duration: number = 1000,\r\n        easing: (amount: number) => number = TWEEN.Easing.Quadratic.InOut\r\n    ): void {\r\n        const v1 = { x: fromValue.x, y: fromValue.y, z: fromValue.z }\r\n        const v2 = { x: toValue.x, y: toValue.y, z: toValue.z }\r\n        this.addTweenAnimObject()\r\n        new TWEEN.Tween(v1)\r\n            .to(v2, duration)\r\n            .easing(easing)\r\n            .onUpdate(() => onUpdateFunc(new THREE.Vector3(v1.x, v1.y, v1.z)))\r\n            .onComplete(() => {\r\n                this.removeTweenAnimObject()\r\n                onCompleteFunc(new THREE.Vector3(v1.x, v1.y, v1.z))\r\n            }).start()\r\n    }\r\n}\r\n\r\nconst controller = new TweenAnimController()\r\n\r\nexport { controller }"],"sourceRoot":""}