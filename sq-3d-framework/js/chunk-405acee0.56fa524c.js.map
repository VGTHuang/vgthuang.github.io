{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.weak-map.js","webpack:///./src/scripts/Three/CarouselBasicShader/F.glsl","webpack:///./src/scripts/Three/Refraction2.0/GlassFrontShader/F.glsl","webpack:///./node_modules/three/examples/jsm/postprocessing/Pass.js","webpack:///./src/scripts/Three/TardisCard.ts","webpack:///./src/scripts/Three/Utils.ts","webpack:///./node_modules/three/examples/jsm/shaders/CopyShader.js","webpack:///./node_modules/three/examples/jsm/postprocessing/MaskPass.js","webpack:///./node_modules/three/examples/jsm/postprocessing/EffectComposer.js","webpack:///./node_modules/three/examples/jsm/postprocessing/ShaderPass.js","webpack:///./src/scripts/Three/ShaderLoader.ts","webpack:///./node_modules/core-js/internals/object-is-extensible.js","webpack:///./src/scripts/Three sync ^\\.\\/.*\\/V\\.glsl$","webpack:///./node_modules/core-js/internals/collection.js","webpack:///./src/scripts/Three/GlassFrontShader/F.glsl","webpack:///./src/scripts/Three/Refraction2.0/GlassFrontShader/V.glsl","webpack:///./src/scripts/Three/FresnelShader/F.glsl","webpack:///./src/scripts/Three/CardSkyboxShader/V.glsl","webpack:///./src/scripts/Three/FresnelShader/V.glsl","webpack:///./src/scripts/Three sync ^\\.\\/.*\\/F\\.glsl$","webpack:///./src/scripts/Three/CardSkyboxShader/F.glsl","webpack:///./node_modules/three/examples/jsm/postprocessing/RenderPass.js","webpack:///./node_modules/core-js/internals/collection-weak.js","webpack:///./src/scripts/Three/ParticleShader/V.glsl","webpack:///./node_modules/core-js/internals/freezing.js","webpack:///./src/scripts/Three/GlassFrontShader/V.glsl","webpack:///./src/scripts/Three/ParticleShader/F.glsl","webpack:///./node_modules/core-js/internals/array-buffer-non-extensible.js","webpack:///./node_modules/core-js/internals/internal-metadata.js","webpack:///./src/scripts/Three/CarouselBasicShader/V.glsl","webpack:///./src/scripts/Three/CustomCSS3DRenderer.ts"],"names":["InternalWeakMap","global","uncurryThis","redefineAll","InternalMetadataModule","collection","collectionWeak","isObject","isExtensible","enforceInternalState","enforce","NATIVE_WEAK_MAP","IS_IE11","ActiveXObject","wrapper","init","this","arguments","length","undefined","$WeakMap","getConstructor","enable","WeakMapPrototype","prototype","nativeDelete","nativeHas","has","nativeGet","get","nativeSet","set","key","state","frozen","value","module","exports","Pass","enabled","needsSwap","clear","renderToScreen","console","error","_camera","_geometry","setAttribute","FullScreenQuad","material","_mesh","geometry","dispose","renderer","render","TardisCardShape","TardisCard","height","width","stencilId","cardOutsideScene","cardInsideScene","position","rotation","shape","RECT","reflectionScene","reflectionColor","cardGeometry","cardMaterial","color","stencilWrite","stencilRef","stencilZPass","depthWrite","cardMesh","copy","add","isFocused","frontWallGeom","frontWallMesh","cardReflectionMesh","group","_recursiveGetGroupProperty","stencilFunc","setFunc","children","forEach","v","Array","mat","thickness","positions","indices","points","i","tv","push","setFromPoints","computeVertexNormals","frontWallMat","textureCube","vs","fs","uniforms","type","customMaterial","vertexShader","fragmentShader","DampingObjectController","object","damp","attract","velocity","childObjects","target","multiplyScalar","currentPath","sub","obj","DampingVector3Controller","currentVec3","randn_bm","u","Math","random","sqrt","log","cos","PI","CopyShader","scene","camera","super","inverse","writeBuffer","readBuffer","context","getContext","writeValue","clearValue","buffers","setMask","depth","setLocked","stencil","setTest","setOp","REPLACE","ALWAYS","setClear","setRenderTarget","EQUAL","KEEP","renderTarget","parameters","minFilter","magFilter","format","size","getSize","_pixelRatio","getPixelRatio","_width","_height","texture","name","renderTarget1","renderTarget2","clone","passes","ShaderPass","copyPass","clock","tmp","pass","setSize","index","splice","indexOf","passIndex","deltaTime","getDelta","currentRenderTarget","getRenderTarget","maskActive","il","isLastEnabledPass","NOTEQUAL","swapBuffers","effectiveWidth","effectiveHeight","pixelRatio","shader","textureID","defines","Object","assign","fsQuad","autoClearColor","autoClearDepth","autoClearStencil","loadShader","shaderName","fragShader","err","fails","classof","ARRAY_BUFFER_NON_EXTENSIBLE","$isExtensible","FAILS_ON_PRIMITIVES","it","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","resolve","$","isForced","redefine","iterate","anInstance","isCallable","checkCorrectnessOfIteration","setToStringTag","inheritIfRequired","CONSTRUCTOR_NAME","common","IS_MAP","IS_WEAK","ADDER","NativeConstructor","NativePrototype","Constructor","exported","fixMethod","KEY","uncurriedNativeMethod","entries","next","instance","HASNT_CHAINING","THROWS_ON_PRIMITIVES","ACCEPT_ITERABLES","iterable","BUGGY_ZERO","$instance","dummy","that","AS_ENTRIES","constructor","forced","setStrong","RenderPass","overrideMaterial","clearColor","clearAlpha","clearDepth","_oldClearColor","oldAutoClear","autoClear","oldClearAlpha","oldOverrideMaterial","getClearColor","getClearAlpha","setClearColor","getWeakData","anObject","ArrayIterationModule","hasOwn","InternalStateModule","setInternalState","internalStateGetterFor","getterFor","find","findIndex","uncaughtFrozenStore","store","UncaughtFrozenStore","findUncaughtFrozen","entry","Prototype","getInternalState","define","data","preventExtensions","ArrayBuffer","buffer","defineProperty","hiddenKeys","f","getOwnPropertyNamesModule","getOwnPropertyNamesExternalModule","uid","FREEZING","REQUIRED","METADATA","setMetadata","objectID","weakData","fastKey","create","onFreeze","meta","getOwnPropertyNames","test","result","stat","_position","_quaternion","_scale","CustomCSS3DObject","element","document","createElement","style","pointerEvents","parentNode","removeChild","followObject","followObjectOffset","CustomCSS3DSprite","rotation2D","_matrix","_matrix2","CustomCSS3DRenderer","domElement","_widthHalf","_heightHalf","cache","fov","objects","WeakMap","overflow","cameraElement","transformStyle","appendChild","projectionMatrix","elements","perspective","autoUpdate","updateMatrixWorld","parent","cameraCSSMatrix","getCameraCSSMatrix","matrixWorldInverse","transform","renderObject","abs","matrix","epsilon","matrix3d","visible","layers","display","transpose","multiply","makeRotationZ","matrixWorld","decompose","setPosition","scale","getObjectCSSMatrix","cachedObject","objectData","l"],"mappings":"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","file":"js/chunk-405acee0.56fa524c.js","sourcesContent":["'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefineAll = require('../internals/redefine-all');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar collection = require('../internals/collection');\nvar collectionWeak = require('../internals/collection-weak');\nvar isObject = require('../internals/is-object');\nvar isExtensible = require('../internals/object-is-extensible');\nvar enforceInternalState = require('../internals/internal-state').enforce;\nvar NATIVE_WEAK_MAP = require('../internals/native-weak-map');\n\nvar IS_IE11 = !global.ActiveXObject && 'ActiveXObject' in global;\nvar InternalWeakMap;\n\nvar wrapper = function (init) {\n  return function WeakMap() {\n    return init(this, arguments.length ? arguments[0] : undefined);\n  };\n};\n\n// `WeakMap` constructor\n// https://tc39.es/ecma262/#sec-weakmap-constructor\nvar $WeakMap = collection('WeakMap', wrapper, collectionWeak);\n\n// IE11 WeakMap frozen keys fix\n// We can't use feature detection because it crash some old IE builds\n// https://github.com/zloirock/core-js/issues/485\nif (NATIVE_WEAK_MAP && IS_IE11) {\n  InternalWeakMap = collectionWeak.getConstructor(wrapper, 'WeakMap', true);\n  InternalMetadataModule.enable();\n  var WeakMapPrototype = $WeakMap.prototype;\n  var nativeDelete = uncurryThis(WeakMapPrototype['delete']);\n  var nativeHas = uncurryThis(WeakMapPrototype.has);\n  var nativeGet = uncurryThis(WeakMapPrototype.get);\n  var nativeSet = uncurryThis(WeakMapPrototype.set);\n  redefineAll(WeakMapPrototype, {\n    'delete': function (key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeDelete(this, key) || state.frozen['delete'](key);\n      } return nativeDelete(this, key);\n    },\n    has: function has(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas(this, key) || state.frozen.has(key);\n      } return nativeHas(this, key);\n    },\n    get: function get(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas(this, key) ? nativeGet(this, key) : state.frozen.get(key);\n      } return nativeGet(this, key);\n    },\n    set: function set(key, value) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        nativeHas(this, key) ? nativeSet(this, key, value) : state.frozen.set(key, value);\n      } else nativeSet(this, key, value);\n      return this;\n    }\n  });\n}\n","module.exports = \"varying vec2 vUv;\\r\\n\\r\\nuniform float vTextureMix;\\r\\n\\r\\nuniform sampler2D vTextures[ 2 ];\\r\\n\\r\\nvoid main()\\r\\n{\\r\\n    vec4 tColor1 = vec4(texture2D( vTextures[0], vUv ));\\r\\n    vec4 tColor2 = vec4(texture2D( vTextures[1], vUv ));\\r\\n    gl_FragColor = mix( tColor1, tColor2, vTextureMix );\\r\\n    // gl_FragColor = mix( tColor1, tColor2, 0.5 );\\r\\n    // gl_FragColor = tColor2;\\r\\n}\"","module.exports = \"uniform vec2 resolution;\\r\\nuniform sampler2D tBackground;\\r\\nuniform sampler2D tBackDepth;\\r\\nuniform samplerCube tSkybox;\\r\\nuniform vec3 absorbColor;\\r\\nuniform float refractionFactor;\\r\\nuniform float opacity;\\r\\n\\r\\nvarying vec2 vUv;\\r\\nvarying vec3 vNormal;\\r\\nvarying vec3 vCameraPosition;\\r\\nvarying vec4 vWorldPosition;\\r\\nvarying mat4 vProjectionMatrix;\\r\\n\\r\\nfloat near = 0.1;\\r\\nfloat far  = 5000.0;\\r\\n\\r\\nfloat LinearizeDepth(float depth) \\r\\n{\\r\\n    float z = depth * 2.0 - 1.0; // back to NDC \\r\\n    return (2.0 * near * far) / (far + near - z * (far - near));\\t\\r\\n}\\r\\n\\r\\nvoid main() {\\r\\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\\r\\n}\\r\\n\\r\\nvoid main1() {\\r\\n\\r\\n    float backDepth = float(texture2D( tBackDepth, vec2( gl_FragCoord.x / resolution.x, gl_FragCoord.y / resolution.y ) ).x);\\r\\n    float frontDepth = gl_FragCoord.z;\\r\\n\\r\\n    float backDepthlinear = LinearizeDepth(backDepth);\\r\\n    float frontDepthlinear = LinearizeDepth(frontDepth);\\r\\n    \\r\\n    float backToFrontDepth = backDepthlinear - frontDepthlinear;\\r\\n    backToFrontDepth *= 0.25;\\r\\n    \\r\\n    vec3 vCameraRay = vWorldPosition.xyz / vWorldPosition.w - vCameraPosition;\\r\\n    vCameraRay = normalize(vCameraRay);\\r\\n    vec3 vRefract = refract( vCameraRay, vNormal, 1.0 / refractionFactor );\\r\\n    vec4 vOriginalPos = vWorldPosition + vec4(vCameraRay, 0.0);\\r\\n    vec4 vRefractedPos = vWorldPosition + vec4(vRefract, 0.0);\\r\\n    // vRefractedPos = vOriginalPos; //vWorldPosition + vec4(vRefract, 0.0);\\r\\n    vec4 vOriginalProjectedPos = vProjectionMatrix * vOriginalPos;\\r\\n    vec4 vRefractedProjectedPos = vProjectionMatrix * vRefractedPos;\\r\\n    vec2 offset = normalize(vRefractedProjectedPos - vOriginalProjectedPos).xy;\\r\\n    offset = normalize(offset);\\r\\n\\r\\n    // reflect\\r\\n    vec3 vReflect = reflect( vCameraRay, vNormal );\\r\\n    vec3 refCol = vec3(textureCube(tSkybox, vReflect));\\r\\n\\r\\n    // snell's law\\r\\n    float cosTheta1 = dot(vCameraRay, vNormal);\\r\\n    float sinTheta1 = 1.0 - cosTheta1 * cosTheta1;\\r\\n    float sinTheta2 = sinTheta1 / refractionFactor;\\r\\n    float theta2 = asin(sinTheta2);\\r\\n    offset *= sinTheta2;\\r\\n    offset *= 50.0;\\r\\n\\r\\n    float samplePointX_r = (gl_FragCoord.x + backToFrontDepth * offset.x * 0.9) / resolution.x;\\r\\n    float samplePointY_r = (gl_FragCoord.y + backToFrontDepth * offset.y * 0.9) / resolution.y;\\r\\n\\r\\n    float samplePointX_g = (gl_FragCoord.x + backToFrontDepth * offset.x * 0.95) / resolution.x;\\r\\n    float samplePointY_g = (gl_FragCoord.y + backToFrontDepth * offset.y * 0.95) / resolution.y;\\r\\n\\r\\n    float samplePointX_b = (gl_FragCoord.x + backToFrontDepth * offset.x) / resolution.x;\\r\\n    float samplePointY_b = (gl_FragCoord.y + backToFrontDepth * offset.y) / resolution.y;\\r\\n    \\r\\n    float backColor_r = texture2D( tBackground, vec2( samplePointX_r, samplePointY_r ) * 1.0 ).x;\\r\\n    float backColor_g = texture2D( tBackground, vec2( samplePointX_g, samplePointY_g ) * 1.0 ).y;\\r\\n    float backColor_b = texture2D( tBackground, vec2( samplePointX_b, samplePointY_b ) * 1.0 ).z;\\r\\n\\r\\n    vec3 backColor = vec3(backColor_r, backColor_g, backColor_b);\\r\\n    vec3 absorbColor = absorbColor * sqrt(backToFrontDepth) * opacity;\\r\\n\\r\\n    // backColor = texture2D( tBackground, vec2( (gl_FragCoord.x + backToFrontDepth * offset.x) / resolution.x, (gl_FragCoord.y + backToFrontDepth * offset.y) / resolution.y ) * 1.0 ).xyz;\\r\\n\\r\\n    // gl_FragColor = vec4(refCol, 1.0);\\r\\n    float reflectionCoeff = 0.5 * pow(sinTheta1, 4.0);\\r\\n    // reflectionCoeff = 1.0;\\r\\n    gl_FragColor = vec4(mix(backColor + absorbColor, refCol, reflectionCoeff), 1.0);\\r\\n    // gl_FragColor = vec4(vec3(backDepthlinear*0.01), 1.0);\\r\\n}\"","import {\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tOrthographicCamera,\n\tMesh\n} from 'three';\n\nclass Pass {\n\n\tconstructor() {\n\n\t\t// if set to true, the pass is processed by the composer\n\t\tthis.enabled = true;\n\n\t\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\t\tthis.needsSwap = true;\n\n\t\t// if set to true, the pass clears its buffer before rendering\n\t\tthis.clear = false;\n\n\t\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\t\tthis.renderToScreen = false;\n\n\t}\n\n\tsetSize( /* width, height */ ) {}\n\n\trender( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n}\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nconst _camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\n// https://github.com/mrdoob/three.js/pull/21358\n\nconst _geometry = new BufferGeometry();\n_geometry.setAttribute( 'position', new Float32BufferAttribute( [ - 1, 3, 0, - 1, - 1, 0, 3, - 1, 0 ], 3 ) );\n_geometry.setAttribute( 'uv', new Float32BufferAttribute( [ 0, 2, 0, 0, 2, 0 ], 2 ) );\n\nclass FullScreenQuad {\n\n\tconstructor( material ) {\n\n\t\tthis._mesh = new Mesh( _geometry, material );\n\n\t}\n\n\tdispose() {\n\n\t\tthis._mesh.geometry.dispose();\n\n\t}\n\n\trender( renderer ) {\n\n\t\trenderer.render( this._mesh, _camera );\n\n\t}\n\n\tget material() {\n\n\t\treturn this._mesh.material;\n\n\t}\n\n\tset material( value ) {\n\n\t\tthis._mesh.material = value;\n\n\t}\n\n}\n\nexport { Pass, FullScreenQuad };\n","import * as THREE from 'three'\r\nimport { loadShader } from './ShaderLoader'\r\n\r\nexport enum TardisCardShape {\r\n    RECT,\r\n    CIRCLE\r\n}\r\n\r\nexport class TardisCard {\r\n    cardGeometry: THREE.BufferGeometry\r\n    cardMaterial: THREE.Material\r\n    cardMesh: THREE.Mesh\r\n    stencilId: number\r\n    cardOutsideScene: THREE.Scene\r\n    cardInsideScene: THREE.Scene\r\n    isFocused: boolean\r\n    height: number\r\n    width: number\r\n    frontWallGeom: THREE.BufferGeometry\r\n    frontWallMesh: THREE.Mesh\r\n    constructor(height: number = 100, width: number = 100,\r\n        stencilId: number,\r\n        cardOutsideScene: THREE.Scene, cardInsideScene: THREE.Scene,\r\n        position: THREE.Vector3, rotation: THREE.Euler,\r\n        shape: TardisCardShape = TardisCardShape.RECT,\r\n        reflectionScene: THREE.Scene | null = null, reflectionColor: number = 0xff0000\r\n        ) {\r\n        this.stencilId = stencilId\r\n        this.height = height\r\n        this.width = width\r\n        if (shape == TardisCardShape.RECT) {\r\n            this.cardGeometry = new THREE.PlaneGeometry(width, height)\r\n        }\r\n        else {\r\n            this.cardGeometry = new THREE.CircleGeometry(width, 64)\r\n        }\r\n        this.cardMaterial = new THREE.MeshBasicMaterial({\r\n            color: 0xf0f0f0,\r\n            // colorWrite: false,\r\n            stencilWrite: true,\r\n            stencilRef: stencilId,\r\n            stencilZPass: THREE.ReplaceStencilOp,  // write if the depth buffer test passes\r\n            depthWrite: false\r\n        })\r\n        this.cardMesh = new THREE.Mesh(this.cardGeometry, this.cardMaterial)\r\n        this.cardMesh['tardis'] = this\r\n        this.cardMesh.position.copy(position)\r\n        this.cardMesh.rotation.copy(rotation)\r\n        this.cardOutsideScene = cardOutsideScene\r\n        this.cardInsideScene = cardInsideScene\r\n        this.cardOutsideScene.add(this.cardMesh)\r\n        this.isFocused = false\r\n        this.frontWallGeom = new THREE.BufferGeometry()\r\n        this.frontWallMesh = new THREE.Mesh()\r\n\r\n        if (reflectionScene != null) {\r\n            var cardReflectionMesh = new THREE.Mesh().copy(this.cardMesh)\r\n            cardReflectionMesh.material = new THREE.MeshBasicMaterial({\r\n                color: reflectionColor\r\n            })\r\n            reflectionScene.add(cardReflectionMesh)\r\n        }\r\n    }\r\n    /**\r\n     * add group of objects to card that acts as contents that COULD BE VISIBLE FROM THE OUTSIDE\r\n     * @param group\r\n     */\r\n    addVisibleObjectGroup(group: THREE.Group) {\r\n        this._recursiveGetGroupProperty(group, (cardMaterial) => {\r\n            cardMaterial\r\n            cardMaterial.stencilWrite = true\r\n            cardMaterial.stencilRef = this.stencilId\r\n            cardMaterial.stencilFunc = THREE.EqualStencilFunc\r\n            // cardMaterial.depthTest = false\r\n        })\r\n        this.cardOutsideScene.add(group)\r\n    }\r\n    _recursiveGetGroupProperty( group: THREE.Group, setFunc: { (cardMat: THREE.Material): any } ) {\r\n        group.children.forEach(v => {\r\n            if (v instanceof THREE.Mesh) {\r\n                if (v.material instanceof THREE.Material) {\r\n                    setFunc(v.material)\r\n                }\r\n                else if (v.material instanceof Array) {\r\n                    v.material.forEach(mat => {\r\n                        setFunc(mat)\r\n                    })\r\n                }\r\n            }\r\n            else if (v instanceof THREE.Group) {\r\n                this._recursiveGetGroupProperty(v, setFunc)\r\n            }\r\n        })\r\n    }\r\n    addFrontWall(thickness: number = 10, material: THREE.Material | undefined = undefined) {\r\n        const positions = [\r\n            new THREE.Vector3(-this.width/2, -this.height/2, 0),\r\n            new THREE.Vector3(-this.width/2,  this.height/2, 0),\r\n            new THREE.Vector3( this.width/2,  this.height/2, 0),\r\n            new THREE.Vector3( this.width/2, -this.height/2, 0),\r\n            new THREE.Vector3(-this.width/2, -this.height/2, -thickness),\r\n            new THREE.Vector3(-this.width/2,  this.height/2, -thickness),\r\n            new THREE.Vector3( this.width/2,  this.height/2, -thickness),\r\n            new THREE.Vector3( this.width/2, -this.height/2, -thickness)\r\n        ]\r\n\r\n        const indices = [\r\n            1, 0, 4,\r\n            5, 1, 4,\r\n            2, 1, 5,\r\n            6, 2, 5,\r\n            3, 2, 6,\r\n            7, 3, 6,\r\n            0, 3, 7,\r\n            4, 0, 7\r\n        ]\r\n\r\n        const points: Array<THREE.Vector3> = []\r\n        indices.forEach(i => {\r\n            let tv = new THREE.Vector3()\r\n            // tv.multiplyScalar(100)\r\n            tv.copy(positions[i])\r\n            points.push(tv)\r\n        })\r\n        this.frontWallGeom.setFromPoints(points)\r\n        this.frontWallGeom.computeVertexNormals()\r\n        const frontWallMat = (material == undefined) ? new THREE.MeshPhongMaterial({\r\n            color: 0xa0a0a0,\r\n        }) : material\r\n        frontWallMat.stencilWrite = true\r\n        frontWallMat.stencilRef = this.stencilId\r\n        frontWallMat.stencilFunc = THREE.EqualStencilFunc\r\n        this.frontWallMesh = new THREE.Mesh(\r\n            this.frontWallGeom,\r\n            frontWallMat\r\n        )\r\n        this.frontWallMesh.position.copy(this.cardMesh.position)\r\n        this.cardOutsideScene.add(this.frontWallMesh)\r\n    }\r\n    addSkybox(textureCube: THREE.CubeTexture) {\r\n        var [vs, fs] = loadShader('CardSkyboxShader')\r\n        var uniforms = \r\n        {\r\n            \"tCube\":            { type: \"t\", value: textureCube }\r\n        }\r\n        var customMaterial = new THREE.ShaderMaterial( \r\n            {\r\n                uniforms:       uniforms,\r\n                vertexShader:   vs,\r\n                fragmentShader: fs,\r\n                stencilWrite: true,\r\n                stencilRef: this.stencilId,\r\n                stencilZPass: THREE.ReplaceStencilOp,  // write if the depth buffer test passes\r\n                depthWrite: false,\r\n            }\r\n        )\r\n        this.cardMaterial = customMaterial\r\n        this.cardMesh.material = this.cardMaterial\r\n    }\r\n}","import { Vector3, Object3D } from 'three'\r\n\r\nexport class DampingObjectController {\r\n    damp: number\r\n    attract: number\r\n    object: Object3D\r\n    velocity: Vector3\r\n    childObjects: Array<Object3D>\r\n    constructor(object: Object3D, damp: number = 0.5, attract: number = 0.5) {\r\n        this.damp = damp\r\n        this.attract = attract\r\n        this.object = object\r\n        this.velocity = new Vector3()\r\n        this.childObjects = []\r\n    }\r\n    addChildObj(object: Object3D) {\r\n        this.childObjects.push(object)\r\n    }\r\n    update(target: Vector3) {\r\n        this.velocity.multiplyScalar(this.damp)\r\n        let currentPath = target.sub(this.object.position)\r\n        this.velocity.add(currentPath.multiplyScalar(this.attract))\r\n        this.object.position.add(this.velocity)\r\n        this.childObjects.forEach(obj => {\r\n            obj.position.copy(this.object.position)\r\n            obj.rotation.copy(this.object.rotation)\r\n        })\r\n    }\r\n}\r\n\r\nexport class DampingVector3Controller {\r\n    damp: number\r\n    attract: number\r\n    velocity: Vector3\r\n    currentVec3: Vector3\r\n    constructor(currentVec3: Vector3, damp: number = 0.5, attract: number = 0.5) {\r\n        this.damp = damp\r\n        this.attract = attract\r\n        this.velocity = new Vector3()\r\n        this.currentVec3 = currentVec3\r\n    }\r\n    update(target: Vector3) {\r\n        this.velocity.multiplyScalar(this.damp)\r\n        let currentPath = new Vector3().copy(target).sub(this.currentVec3)\r\n        this.velocity.add(currentPath.multiplyScalar(this.attract))\r\n        this.currentVec3.add(this.velocity)\r\n    }\r\n}\r\n\r\nexport function randn_bm(): number {\r\n    var u = 0, v = 0;\r\n    while(u === 0) u = Math.random(); //Converting [0,1) to (0,1)\r\n    while(v === 0) v = Math.random();\r\n    return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );\r\n}","/**\n * Full-screen textured quad shader\n */\n\nvar CopyShader = {\n\n\tuniforms: {\n\n\t\t'tDiffuse': { value: null },\n\t\t'opacity': { value: 1.0 }\n\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}`\n\n};\n\nexport { CopyShader };\n","import { Pass } from './Pass.js';\n\nclass MaskPass extends Pass {\n\n\tconstructor( scene, camera ) {\n\n\t\tsuper();\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.clear = true;\n\t\tthis.needsSwap = false;\n\n\t\tthis.inverse = false;\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tconst context = renderer.getContext();\n\t\tconst state = renderer.state;\n\n\t\t// don't update color or depth\n\n\t\tstate.buffers.color.setMask( false );\n\t\tstate.buffers.depth.setMask( false );\n\n\t\t// lock buffers\n\n\t\tstate.buffers.color.setLocked( true );\n\t\tstate.buffers.depth.setLocked( true );\n\n\t\t// set up stencil\n\n\t\tlet writeValue, clearValue;\n\n\t\tif ( this.inverse ) {\n\n\t\t\twriteValue = 0;\n\t\t\tclearValue = 1;\n\n\t\t} else {\n\n\t\t\twriteValue = 1;\n\t\t\tclearValue = 0;\n\n\t\t}\n\n\t\tstate.buffers.stencil.setTest( true );\n\t\tstate.buffers.stencil.setOp( context.REPLACE, context.REPLACE, context.REPLACE );\n\t\tstate.buffers.stencil.setFunc( context.ALWAYS, writeValue, 0xffffffff );\n\t\tstate.buffers.stencil.setClear( clearValue );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t\t// draw into the stencil buffer\n\n\t\trenderer.setRenderTarget( readBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\trenderer.setRenderTarget( writeBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\t// unlock color and depth buffer for subsequent rendering\n\n\t\tstate.buffers.color.setLocked( false );\n\t\tstate.buffers.depth.setLocked( false );\n\n\t\t// only render where stencil is set to 1\n\n\t\tstate.buffers.stencil.setLocked( false );\n\t\tstate.buffers.stencil.setFunc( context.EQUAL, 1, 0xffffffff ); // draw if == 1\n\t\tstate.buffers.stencil.setOp( context.KEEP, context.KEEP, context.KEEP );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t}\n\n}\n\nclass ClearMaskPass extends Pass {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.needsSwap = false;\n\n\t}\n\n\trender( renderer /*, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\trenderer.state.buffers.stencil.setLocked( false );\n\t\trenderer.state.buffers.stencil.setTest( false );\n\n\t}\n\n}\n\nexport { MaskPass, ClearMaskPass };\n","import {\n\tBufferGeometry,\n\tClock,\n\tFloat32BufferAttribute,\n\tLinearFilter,\n\tMesh,\n\tOrthographicCamera,\n\tRGBAFormat,\n\tVector2,\n\tWebGLRenderTarget\n} from 'three';\nimport { CopyShader } from '../shaders/CopyShader.js';\nimport { ShaderPass } from './ShaderPass.js';\nimport { MaskPass } from './MaskPass.js';\nimport { ClearMaskPass } from './MaskPass.js';\n\nclass EffectComposer {\n\n\tconstructor( renderer, renderTarget ) {\n\n\t\tthis.renderer = renderer;\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tconst parameters = {\n\t\t\t\tminFilter: LinearFilter,\n\t\t\t\tmagFilter: LinearFilter,\n\t\t\t\tformat: RGBAFormat\n\t\t\t};\n\n\t\t\tconst size = renderer.getSize( new Vector2() );\n\t\t\tthis._pixelRatio = renderer.getPixelRatio();\n\t\t\tthis._width = size.width;\n\t\t\tthis._height = size.height;\n\n\t\t\trenderTarget = new WebGLRenderTarget( this._width * this._pixelRatio, this._height * this._pixelRatio, parameters );\n\t\t\trenderTarget.texture.name = 'EffectComposer.rt1';\n\n\t\t} else {\n\n\t\t\tthis._pixelRatio = 1;\n\t\t\tthis._width = renderTarget.width;\n\t\t\tthis._height = renderTarget.height;\n\n\t\t}\n\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\t\tthis.renderTarget2.texture.name = 'EffectComposer.rt2';\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t\tthis.renderToScreen = true;\n\n\t\tthis.passes = [];\n\n\t\t// dependencies\n\n\t\tif ( CopyShader === undefined ) {\n\n\t\t\tconsole.error( 'THREE.EffectComposer relies on CopyShader' );\n\n\t\t}\n\n\t\tif ( ShaderPass === undefined ) {\n\n\t\t\tconsole.error( 'THREE.EffectComposer relies on ShaderPass' );\n\n\t\t}\n\n\t\tthis.copyPass = new ShaderPass( CopyShader );\n\n\t\tthis.clock = new Clock();\n\n\t}\n\n\tswapBuffers() {\n\n\t\tconst tmp = this.readBuffer;\n\t\tthis.readBuffer = this.writeBuffer;\n\t\tthis.writeBuffer = tmp;\n\n\t}\n\n\taddPass( pass ) {\n\n\t\tthis.passes.push( pass );\n\t\tpass.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t}\n\n\tinsertPass( pass, index ) {\n\n\t\tthis.passes.splice( index, 0, pass );\n\t\tpass.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t}\n\n\tremovePass( pass ) {\n\n\t\tconst index = this.passes.indexOf( pass );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tthis.passes.splice( index, 1 );\n\n\t\t}\n\n\t}\n\n\tisLastEnabledPass( passIndex ) {\n\n\t\tfor ( let i = passIndex + 1; i < this.passes.length; i ++ ) {\n\n\t\t\tif ( this.passes[ i ].enabled ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\trender( deltaTime ) {\n\n\t\t// deltaTime value is in seconds\n\n\t\tif ( deltaTime === undefined ) {\n\n\t\t\tdeltaTime = this.clock.getDelta();\n\n\t\t}\n\n\t\tconst currentRenderTarget = this.renderer.getRenderTarget();\n\n\t\tlet maskActive = false;\n\n\t\tfor ( let i = 0, il = this.passes.length; i < il; i ++ ) {\n\n\t\t\tconst pass = this.passes[ i ];\n\n\t\t\tif ( pass.enabled === false ) continue;\n\n\t\t\tpass.renderToScreen = ( this.renderToScreen && this.isLastEnabledPass( i ) );\n\t\t\tpass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive );\n\n\t\t\tif ( pass.needsSwap ) {\n\n\t\t\t\tif ( maskActive ) {\n\n\t\t\t\t\tconst context = this.renderer.getContext();\n\t\t\t\t\tconst stencil = this.renderer.state.buffers.stencil;\n\n\t\t\t\t\t//context.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.NOTEQUAL, 1, 0xffffffff );\n\n\t\t\t\t\tthis.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime );\n\n\t\t\t\t\t//context.stencilFunc( context.EQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.EQUAL, 1, 0xffffffff );\n\n\t\t\t\t}\n\n\t\t\t\tthis.swapBuffers();\n\n\t\t\t}\n\n\t\t\tif ( MaskPass !== undefined ) {\n\n\t\t\t\tif ( pass instanceof MaskPass ) {\n\n\t\t\t\t\tmaskActive = true;\n\n\t\t\t\t} else if ( pass instanceof ClearMaskPass ) {\n\n\t\t\t\t\tmaskActive = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.renderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n\treset( renderTarget ) {\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tconst size = this.renderer.getSize( new Vector2() );\n\t\t\tthis._pixelRatio = this.renderer.getPixelRatio();\n\t\t\tthis._width = size.width;\n\t\t\tthis._height = size.height;\n\n\t\t\trenderTarget = this.renderTarget1.clone();\n\t\t\trenderTarget.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t\t}\n\n\t\tthis.renderTarget1.dispose();\n\t\tthis.renderTarget2.dispose();\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tconst effectiveWidth = this._width * this._pixelRatio;\n\t\tconst effectiveHeight = this._height * this._pixelRatio;\n\n\t\tthis.renderTarget1.setSize( effectiveWidth, effectiveHeight );\n\t\tthis.renderTarget2.setSize( effectiveWidth, effectiveHeight );\n\n\t\tfor ( let i = 0; i < this.passes.length; i ++ ) {\n\n\t\t\tthis.passes[ i ].setSize( effectiveWidth, effectiveHeight );\n\n\t\t}\n\n\t}\n\n\tsetPixelRatio( pixelRatio ) {\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this._width, this._height );\n\n\t}\n\n}\n\n\nclass Pass {\n\n\tconstructor() {\n\n\t\t// if set to true, the pass is processed by the composer\n\t\tthis.enabled = true;\n\n\t\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\t\tthis.needsSwap = true;\n\n\t\t// if set to true, the pass clears its buffer before rendering\n\t\tthis.clear = false;\n\n\t\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\t\tthis.renderToScreen = false;\n\n\t}\n\n\tsetSize( /* width, height */ ) {}\n\n\trender( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n}\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nconst _camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\n// https://github.com/mrdoob/three.js/pull/21358\n\nconst _geometry = new BufferGeometry();\n_geometry.setAttribute( 'position', new Float32BufferAttribute( [ - 1, 3, 0, - 1, - 1, 0, 3, - 1, 0 ], 3 ) );\n_geometry.setAttribute( 'uv', new Float32BufferAttribute( [ 0, 2, 0, 0, 2, 0 ], 2 ) );\n\nclass FullScreenQuad {\n\n\tconstructor( material ) {\n\n\t\tthis._mesh = new Mesh( _geometry, material );\n\n\t}\n\n\tdispose() {\n\n\t\tthis._mesh.geometry.dispose();\n\n\t}\n\n\trender( renderer ) {\n\n\t\trenderer.render( this._mesh, _camera );\n\n\t}\n\n\tget material() {\n\n\t\treturn this._mesh.material;\n\n\t}\n\n\tset material( value ) {\n\n\t\tthis._mesh.material = value;\n\n\t}\n\n}\n\nexport { EffectComposer, Pass, FullScreenQuad };\n","import {\n\tShaderMaterial,\n\tUniformsUtils\n} from 'three';\nimport { Pass, FullScreenQuad } from './Pass.js';\n\nclass ShaderPass extends Pass {\n\n\tconstructor( shader, textureID ) {\n\n\t\tsuper();\n\n\t\tthis.textureID = ( textureID !== undefined ) ? textureID : 'tDiffuse';\n\n\t\tif ( shader instanceof ShaderMaterial ) {\n\n\t\t\tthis.uniforms = shader.uniforms;\n\n\t\t\tthis.material = shader;\n\n\t\t} else if ( shader ) {\n\n\t\t\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\t\tthis.material = new ShaderMaterial( {\n\n\t\t\t\tdefines: Object.assign( {}, shader.defines ),\n\t\t\t\tuniforms: this.uniforms,\n\t\t\t\tvertexShader: shader.vertexShader,\n\t\t\t\tfragmentShader: shader.fragmentShader\n\n\t\t\t} );\n\n\t\t}\n\n\t\tthis.fsQuad = new FullScreenQuad( this.material );\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tif ( this.uniforms[ this.textureID ] ) {\n\n\t\t\tthis.uniforms[ this.textureID ].value = readBuffer.texture;\n\n\t\t}\n\n\t\tthis.fsQuad.material = this.material;\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( writeBuffer );\n\t\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t}\n\n}\n\nexport { ShaderPass };\n","export function loadShader(shaderName: string): Array<string> {\r\n    try {\r\n        var vertexShader = require('./' + shaderName + '/V.glsl')\r\n        var fragShader = require('./' + shaderName + '/F.glsl')\r\n        return [vertexShader, fragShader]\r\n    }\r\n    catch(err) {\r\n        console.error('failed to fetch shader', err)\r\n        return ['', '']\r\n    }\r\n}","var fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-isextensible -- safe\nvar $isExtensible = Object.isExtensible;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isExtensible(1); });\n\n// `Object.isExtensible` method\n// https://tc39.es/ecma262/#sec-object.isextensible\nmodule.exports = (FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE) ? function isExtensible(it) {\n  if (!isObject(it)) return false;\n  if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return false;\n  return $isExtensible ? $isExtensible(it) : true;\n} : $isExtensible;\n","var map = {\n\t\"./CardSkyboxShader/V.glsl\": \"8437\",\n\t\"./CarouselBasicShader/V.glsl\": \"f4ce\",\n\t\"./FresnelShader/V.glsl\": \"8c9f\",\n\t\"./GlassFrontShader/V.glsl\": \"c182\",\n\t\"./ParticleShader/V.glsl\": \"b837\",\n\t\"./Refraction2.0/GlassFrontShader/V.glsl\": \"79c3\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"5d16\";","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar iterate = require('../internals/iterate');\nvar anInstance = require('../internals/an-instance');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nmodule.exports = function (CONSTRUCTOR_NAME, wrapper, common) {\n  var IS_MAP = CONSTRUCTOR_NAME.indexOf('Map') !== -1;\n  var IS_WEAK = CONSTRUCTOR_NAME.indexOf('Weak') !== -1;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var NativeConstructor = global[CONSTRUCTOR_NAME];\n  var NativePrototype = NativeConstructor && NativeConstructor.prototype;\n  var Constructor = NativeConstructor;\n  var exported = {};\n\n  var fixMethod = function (KEY) {\n    var uncurriedNativeMethod = uncurryThis(NativePrototype[KEY]);\n    redefine(NativePrototype, KEY,\n      KEY == 'add' ? function add(value) {\n        uncurriedNativeMethod(this, value === 0 ? 0 : value);\n        return this;\n      } : KEY == 'delete' ? function (key) {\n        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : KEY == 'get' ? function get(key) {\n        return IS_WEAK && !isObject(key) ? undefined : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : KEY == 'has' ? function has(key) {\n        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : function set(key, value) {\n        uncurriedNativeMethod(this, key === 0 ? 0 : key, value);\n        return this;\n      }\n    );\n  };\n\n  var REPLACE = isForced(\n    CONSTRUCTOR_NAME,\n    !isCallable(NativeConstructor) || !(IS_WEAK || NativePrototype.forEach && !fails(function () {\n      new NativeConstructor().entries().next();\n    }))\n  );\n\n  if (REPLACE) {\n    // create collection constructor\n    Constructor = common.getConstructor(wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER);\n    InternalMetadataModule.enable();\n  } else if (isForced(CONSTRUCTOR_NAME, true)) {\n    var instance = new Constructor();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~ Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    // eslint-disable-next-line no-new -- required for testing\n    var ACCEPT_ITERABLES = checkCorrectnessOfIteration(function (iterable) { new NativeConstructor(iterable); });\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new NativeConstructor();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n\n    if (!ACCEPT_ITERABLES) {\n      Constructor = wrapper(function (dummy, iterable) {\n        anInstance(dummy, NativePrototype);\n        var that = inheritIfRequired(new NativeConstructor(), dummy, Constructor);\n        if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n        return that;\n      });\n      Constructor.prototype = NativePrototype;\n      NativePrototype.constructor = Constructor;\n    }\n\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n\n    // weak collections should not contains .clear method\n    if (IS_WEAK && NativePrototype.clear) delete NativePrototype.clear;\n  }\n\n  exported[CONSTRUCTOR_NAME] = Constructor;\n  $({ global: true, forced: Constructor != NativeConstructor }, exported);\n\n  setToStringTag(Constructor, CONSTRUCTOR_NAME);\n\n  if (!IS_WEAK) common.setStrong(Constructor, CONSTRUCTOR_NAME, IS_MAP);\n\n  return Constructor;\n};\n","module.exports = \"uniform vec2 resolution;\\r\\nuniform sampler2D tBackground;\\r\\nuniform sampler2D tBackDepth;\\r\\nuniform sampler2D tDisplayImage;\\r\\n\\r\\nvarying vec2 vUv;\\r\\nvarying vec3 vNormal;\\r\\nvarying vec3 vCameraRay;\\r\\nvarying vec4 vWorldPosition;\\r\\nvarying mat4 vProjectionMatrix;\\r\\n\\r\\nfloat near = 0.1;\\r\\nfloat far  = 20000.0; \\r\\n\\r\\nfloat LinearizeDepth(float depth) \\r\\n{\\r\\n    float z = depth * 2.0 - 1.0; // back to NDC \\r\\n    return (2.0 * near * far) / (far + near - z * (far - near));\\t\\r\\n}\\r\\n\\r\\nfloat refractionFactor = 1.49; // glass\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n    vec4 image = texture2D( tDisplayImage, vec2( gl_FragCoord.x / resolution.x, gl_FragCoord.y / resolution.y ) );\\r\\n    float backDepth = float(texture2D( tBackDepth, vec2( gl_FragCoord.x / resolution.x, gl_FragCoord.y / resolution.y ) ).x);\\r\\n    float frontDepth = gl_FragCoord.z;\\r\\n\\r\\n    float backDepthlinear = LinearizeDepth(backDepth);\\r\\n    float frontDepthlinear = LinearizeDepth(frontDepth);\\r\\n    \\r\\n    float backToFrontDepth = backDepthlinear - frontDepthlinear;\\r\\n    backToFrontDepth *= 0.005;\\r\\n    \\r\\n    vec3 vRefract = refract( vCameraRay, vNormal, 1.0 / refractionFactor );\\r\\n    vec4 vOriginalPos = vWorldPosition + vec4(vCameraRay, 0.0);\\r\\n    vec4 vRefractedPos = vWorldPosition + vec4(vRefract, 0.0);\\r\\n    // vRefractedPos = vOriginalPos; //vWorldPosition + vec4(vRefract, 0.0);\\r\\n    vec4 vOriginalProjectedPos = vProjectionMatrix * vOriginalPos;\\r\\n    vec4 vRefractedProjectedPos = vProjectionMatrix * vRefractedPos;\\r\\n    vec4 offset = normalize(vRefractedProjectedPos - vOriginalProjectedPos);\\r\\n\\r\\n    // snell's law\\r\\n    float cosTheta1 = dot(vCameraRay, vNormal);\\r\\n    float sinTheta1 = 1.0 - cosTheta1 * cosTheta1;\\r\\n    float sinTheta2 = sinTheta1 / refractionFactor;\\r\\n    float theta2 = asin(sinTheta2);\\r\\n    offset *= theta2;\\r\\n\\r\\n    float samplePointX = gl_FragCoord.x / resolution.x + backToFrontDepth * offset.x;\\r\\n    float samplePointY = gl_FragCoord.y / resolution.y + backToFrontDepth * offset.y;\\r\\n    \\r\\n    vec3 backColor = texture2D( tBackground, vec2( samplePointX, samplePointY ) ).xyz;\\r\\n    // vec4 vNewSample = projectionMatrix * (vec4(vRefract, 0.0) + worldPosition);\\r\\n    // vRefractOffset = vNewSample.xy / vNewSample.w;\\r\\n    // // vNormal = normal;\\r\\n    // vec3 vRefractOffsetT = vRefract + 0.5;\\r\\n    // gl_FragColor = vec4(backColor * 0.5 + vNormal * 0.2 + depthColor * 0.1, 1.0);\\r\\n    gl_FragColor = vec4(backColor, 1.0);\\r\\n    // gl_FragColor = vec4(vec3(backToFrontDepth) * 100.0, 1.0);\\r\\n    // gl_FragColor = vec4(offset.xy / offset.w + 0.5, 0.0, 1.0);\\r\\n    // gl_FragColor = vec4(vec3(theta2), 1.0);\\r\\n\\r\\n    // gl_FragColor = vec4(vec3(gl_FragCoord.z / gl_FragCoord.w - fragColor2.x * 10.0) / 2000.0, 1.0);\\r\\n}\"","module.exports = \"varying vec2 vUv;\\r\\nvarying vec3 vNormal;\\r\\nvarying vec3 vCameraPosition;\\r\\nvarying vec4 vWorldPosition;\\r\\nvarying mat4 vProjectionMatrix;\\r\\n// varying vec3 vRefract;\\r\\n// varying vec2 vRefractOffset;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n    vWorldPosition = modelMatrix * vec4( position, 1.0 );\\r\\n    vec4 mvPosition = viewMatrix * vWorldPosition;\\r\\n    gl_Position = projectionMatrix * mvPosition;\\r\\n    vUv = uv;\\r\\n\\r\\n    vNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );\\r\\n    vCameraPosition = cameraPosition;\\r\\n\\r\\n    vProjectionMatrix = projectionMatrix * modelViewMatrix;\\r\\n}\\r\\n\"","module.exports = \"uniform samplerCube tCube;\\r\\nvarying vec3 vReflect;\\r\\nvarying vec3 vRefract[3];\\r\\nvarying float vReflectionFactor;\\r\\nvarying vec2 vUv;\\r\\n\\r\\nuniform sampler2D tNormal;\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n    vec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\\r\\n    vec4 refractedColor = vec4( 1.0 );\\r\\n\\r\\n    vec3 tnm = vec3(texture2D(tNormal, vUv));\\r\\n    tnm = tnm * 2.0 - 1.0;\\r\\n    tnm = 0.0 * tnm;\\r\\n    // tnm *= 0.01;\\r\\n    refractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) - tnm ).r;\\r\\n    refractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) - tnm ).g;\\r\\n    refractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) - tnm ).b;\\r\\n\\r\\n    gl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );\\r\\n}\"","module.exports = \"varying vec3 vPos;\\r\\n\\r\\nvoid main() {\\r\\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\r\\n    gl_Position = projectionMatrix * mvPosition;\\r\\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\\r\\n    vPos = worldPosition.xyz - cameraPosition;\\r\\n}\\r\\n\"","module.exports = \"uniform float mRefractionRatio;\\r\\nuniform float mFresnelBias;\\r\\nuniform float mFresnelScale;\\r\\nuniform float mFresnelPower;\\r\\n\\r\\nvarying vec3 vReflect;\\r\\nvarying vec3 vRefract[3];\\r\\nvarying float vReflectionFactor;\\r\\nvarying vec2 vUv;\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\r\\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\\r\\n\\r\\n    vec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );\\r\\n\\r\\n    vec3 I = worldPosition.xyz - cameraPosition;\\r\\n\\r\\n    vReflect = reflect( I, worldNormal );\\r\\n    vRefract[0] = refract( normalize( I ), worldNormal, mRefractionRatio );\\r\\n    vRefract[1] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.99 );\\r\\n    vRefract[2] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.98 );\\r\\n    vReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), worldNormal ), mFresnelPower );\\r\\n\\r\\n    gl_Position = projectionMatrix * mvPosition;\\r\\n    vUv = uv;\\r\\n\\r\\n}\\r\\n\"","var map = {\n\t\"./CardSkyboxShader/F.glsl\": \"91bc\",\n\t\"./CarouselBasicShader/F.glsl\": \"1333\",\n\t\"./FresnelShader/F.glsl\": \"7bcb\",\n\t\"./GlassFrontShader/F.glsl\": \"71cc\",\n\t\"./ParticleShader/F.glsl\": \"d32d\",\n\t\"./Refraction2.0/GlassFrontShader/F.glsl\": \"16a7\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"8e1c\";","module.exports = \"uniform samplerCube tCube;\\r\\nvarying vec3 vPos;\\r\\n\\r\\nvoid main() {\\r\\n    vec4 reflectedColor = textureCube( tCube, vec3(-vPos.x, vPos.yz) );\\r\\n    gl_FragColor = reflectedColor;\\r\\n}\"","import {\n\tColor\n} from 'three';\nimport { Pass } from './Pass.js';\n\nclass RenderPass extends Pass {\n\n\tconstructor( scene, camera, overrideMaterial, clearColor, clearAlpha ) {\n\n\t\tsuper();\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.overrideMaterial = overrideMaterial;\n\n\t\tthis.clearColor = clearColor;\n\t\tthis.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;\n\n\t\tthis.clear = true;\n\t\tthis.clearDepth = false;\n\t\tthis.needsSwap = false;\n\t\tthis._oldClearColor = new Color();\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tconst oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tlet oldClearAlpha, oldOverrideMaterial;\n\n\t\tif ( this.overrideMaterial !== undefined ) {\n\n\t\t\toldOverrideMaterial = this.scene.overrideMaterial;\n\n\t\t\tthis.scene.overrideMaterial = this.overrideMaterial;\n\n\t\t}\n\n\t\tif ( this.clearColor ) {\n\n\t\t\trenderer.getClearColor( this._oldClearColor );\n\t\t\toldClearAlpha = renderer.getClearAlpha();\n\n\t\t\trenderer.setClearColor( this.clearColor, this.clearAlpha );\n\n\t\t}\n\n\t\tif ( this.clearDepth ) {\n\n\t\t\trenderer.clearDepth();\n\n\t\t}\n\n\t\trenderer.setRenderTarget( this.renderToScreen ? null : readBuffer );\n\n\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\trenderer.render( this.scene, this.camera );\n\n\t\tif ( this.clearColor ) {\n\n\t\t\trenderer.setClearColor( this._oldClearColor, oldClearAlpha );\n\n\t\t}\n\n\t\tif ( this.overrideMaterial !== undefined ) {\n\n\t\t\tthis.scene.overrideMaterial = oldOverrideMaterial;\n\n\t\t}\n\n\t\trenderer.autoClear = oldAutoClear;\n\n\t}\n\n}\n\nexport { RenderPass };\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefineAll = require('../internals/redefine-all');\nvar getWeakData = require('../internals/internal-metadata').getWeakData;\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar ArrayIterationModule = require('../internals/array-iteration');\nvar hasOwn = require('../internals/has-own-property');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\nvar find = ArrayIterationModule.find;\nvar findIndex = ArrayIterationModule.findIndex;\nvar splice = uncurryThis([].splice);\nvar id = 0;\n\n// fallback for uncaught frozen keys\nvar uncaughtFrozenStore = function (store) {\n  return store.frozen || (store.frozen = new UncaughtFrozenStore());\n};\n\nvar UncaughtFrozenStore = function () {\n  this.entries = [];\n};\n\nvar findUncaughtFrozen = function (store, key) {\n  return find(store.entries, function (it) {\n    return it[0] === key;\n  });\n};\n\nUncaughtFrozenStore.prototype = {\n  get: function (key) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) return entry[1];\n  },\n  has: function (key) {\n    return !!findUncaughtFrozen(this, key);\n  },\n  set: function (key, value) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) entry[1] = value;\n    else this.entries.push([key, value]);\n  },\n  'delete': function (key) {\n    var index = findIndex(this.entries, function (it) {\n      return it[0] === key;\n    });\n    if (~index) splice(this.entries, index, 1);\n    return !!~index;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var Constructor = wrapper(function (that, iterable) {\n      anInstance(that, Prototype);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        id: id++,\n        frozen: undefined\n      });\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var Prototype = Constructor.prototype;\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var data = getWeakData(anObject(key), true);\n      if (data === true) uncaughtFrozenStore(state).set(key, value);\n      else data[state.id] = value;\n      return that;\n    };\n\n    redefineAll(Prototype, {\n      // `{ WeakMap, WeakSet }.prototype.delete(key)` methods\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.delete\n      // https://tc39.es/ecma262/#sec-weakset.prototype.delete\n      'delete': function (key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state)['delete'](key);\n        return data && hasOwn(data, state.id) && delete data[state.id];\n      },\n      // `{ WeakMap, WeakSet }.prototype.has(key)` methods\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.has\n      // https://tc39.es/ecma262/#sec-weakset.prototype.has\n      has: function has(key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state).has(key);\n        return data && hasOwn(data, state.id);\n      }\n    });\n\n    redefineAll(Prototype, IS_MAP ? {\n      // `WeakMap.prototype.get(key)` method\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.get\n      get: function get(key) {\n        var state = getInternalState(this);\n        if (isObject(key)) {\n          var data = getWeakData(key);\n          if (data === true) return uncaughtFrozenStore(state).get(key);\n          return data ? data[state.id] : undefined;\n        }\n      },\n      // `WeakMap.prototype.set(key, value)` method\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.set\n      set: function set(key, value) {\n        return define(this, key, value);\n      }\n    } : {\n      // `WeakSet.prototype.add(value)` method\n      // https://tc39.es/ecma262/#sec-weakset.prototype.add\n      add: function add(value) {\n        return define(this, value, true);\n      }\n    });\n\n    return Constructor;\n  }\n};\n","module.exports = \"precision highp float;\\r\\n\\r\\nuniform mat4 modelViewMatrix;\\r\\nuniform mat4 projectionMatrix;\\r\\n// uniform vec2 uv;\\r\\n\\r\\nattribute vec3 position;\\r\\nattribute vec3 vPos;\\r\\n\\r\\nattribute vec3  customColor;\\r\\nattribute float customOpacity;\\r\\nattribute float customSize;\\r\\nattribute float customVisible;  // float used as boolean (0 = false, 1 = true)\\r\\n\\r\\n// varying vec2 vUv;\\r\\nvarying vec4  vColor;\\r\\nvarying float vAngle;\\r\\n\\r\\nvoid main()\\r\\n{\\r\\n\\tif ( customVisible > 0.5 ) \\t\\t\\t\\t// true\\r\\n\\t\\tvColor = vec4( customColor, customOpacity ); //     set color associated to vertex; use later in fragment shader.\\r\\n\\telse\\t\\t\\t\\t\\t\\t\\t// false\\r\\n\\t\\tvColor = vec4(0.0, 0.0, 0.0, 0.0); \\t\\t//     make particle invisible.\\r\\n    mat3 scaleMatrix = mat3(customSize, 0.0, 0.0, 0.0, customSize, 0.0, 0.0, 0.0, customSize);\\r\\n\\tvec4 mvPosition = modelViewMatrix * vec4( vPos + scaleMatrix * position, 1.0 );\\r\\n\\tgl_PointSize = customSize * ( 300.0 / length( mvPosition.xyz ) );     // scale particles as objects in 3D space\\r\\n\\tgl_Position = projectionMatrix * mvPosition;\\r\\n    // vUv = uv;\\r\\n    // vUv = vec2(1.0, 0.4);\\r\\n    // gl_Position = projectionMatrix * modelViewMatrix * vec4( vPos + position, 1.0 );\\r\\n}\"","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-isextensible, es/no-object-preventextensions -- required for testing\n  return Object.isExtensible(Object.preventExtensions({}));\n});\n","module.exports = \"varying vec2 vUv;\\r\\nvarying vec3 vNormal;\\r\\nvarying vec3 vCameraRay;\\r\\nvarying vec4 vWorldPosition;\\r\\nvarying mat4 vProjectionMatrix;\\r\\n// varying vec3 vRefract;\\r\\n// varying vec2 vRefractOffset;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n    vWorldPosition = modelMatrix * vec4( position, 1.0 );\\r\\n    vec4 mvPosition = viewMatrix * vWorldPosition;\\r\\n    gl_Position = projectionMatrix * mvPosition;\\r\\n    vUv = uv;\\r\\n\\r\\n    vNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );\\r\\n    vCameraRay = normalize(vWorldPosition.xyz - cameraPosition);\\r\\n\\r\\n    vProjectionMatrix = projectionMatrix * modelViewMatrix;\\r\\n}\\r\\n\"","module.exports = \"precision highp float;\\r\\n\\r\\nuniform sampler2D texture;\\r\\n\\r\\n// varying vec2 vUv;\\r\\nvarying vec4 vColor;\\r\\nvarying float vAngle;\\r\\n\\r\\nvoid main()\\r\\n{\\r\\n\\tgl_FragColor = vColor;\\r\\n\\t\\r\\n\\t// float c = cos(vAngle);\\r\\n\\t// float s = sin(vAngle);\\r\\n\\t// vec2 rotatedUV = vec2(c * (gl_PointCoord.x - 0.5) + s * (gl_PointCoord.y - 0.5) + 0.5,\\r\\n\\t//                       c * (gl_PointCoord.y - 0.5) - s * (gl_PointCoord.x - 0.5) + 0.5);  // rotate UV coordinates to rotate texture\\r\\n    // vec4 rotatedTexture = texture2D( texture,  rotatedUV );\\r\\n    // vec4 rotatedTexture = texture2D( texture,  vUv );\\r\\n\\t// gl_FragColor = rotatedTexture;    // sets an otherwise white particle texture to desired color\\r\\n    // gl_FragColor = vec4(vUv.x, vUv.y, 0.0, 1.0);\\r\\n}\"","// FF26- bug: ArrayBuffers are non-extensible, but Object.isExtensible does not report it\nvar fails = require('../internals/fails');\n\nmodule.exports = fails(function () {\n  if (typeof ArrayBuffer == 'function') {\n    var buffer = new ArrayBuffer(8);\n    // eslint-disable-next-line es/no-object-isextensible, es/no-object-defineproperty -- safe\n    if (Object.isExtensible(buffer)) Object.defineProperty(buffer, 'a', { value: 8 });\n  }\n});\n","var $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertyNamesExternalModule = require('../internals/object-get-own-property-names-external');\nvar isExtensible = require('../internals/object-is-extensible');\nvar uid = require('../internals/uid');\nvar FREEZING = require('../internals/freezing');\n\nvar REQUIRED = false;\nvar METADATA = uid('meta');\nvar id = 0;\n\nvar setMetadata = function (it) {\n  defineProperty(it, METADATA, { value: {\n    objectID: 'O' + id++, // object ID\n    weakData: {}          // weak collections IDs\n  } });\n};\n\nvar fastKey = function (it, create) {\n  // return a primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!hasOwn(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMetadata(it);\n  // return object ID\n  } return it[METADATA].objectID;\n};\n\nvar getWeakData = function (it, create) {\n  if (!hasOwn(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMetadata(it);\n  // return the store of weak collections IDs\n  } return it[METADATA].weakData;\n};\n\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZING && REQUIRED && isExtensible(it) && !hasOwn(it, METADATA)) setMetadata(it);\n  return it;\n};\n\nvar enable = function () {\n  meta.enable = function () { /* empty */ };\n  REQUIRED = true;\n  var getOwnPropertyNames = getOwnPropertyNamesModule.f;\n  var splice = uncurryThis([].splice);\n  var test = {};\n  test[METADATA] = 1;\n\n  // prevent exposing of metadata key\n  if (getOwnPropertyNames(test).length) {\n    getOwnPropertyNamesModule.f = function (it) {\n      var result = getOwnPropertyNames(it);\n      for (var i = 0, length = result.length; i < length; i++) {\n        if (result[i] === METADATA) {\n          splice(result, i, 1);\n          break;\n        }\n      } return result;\n    };\n\n    $({ target: 'Object', stat: true, forced: true }, {\n      getOwnPropertyNames: getOwnPropertyNamesExternalModule.f\n    });\n  }\n};\n\nvar meta = module.exports = {\n  enable: enable,\n  fastKey: fastKey,\n  getWeakData: getWeakData,\n  onFreeze: onFreeze\n};\n\nhiddenKeys[METADATA] = true;\n","module.exports = \"varying vec2 vUv;\\r\\nvoid main() {\\r\\n    vUv = vec2(1.0, 0.5);\\r\\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\r\\n}\"","import * as THREE from 'three'\r\n/**\r\n * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\r\n */\r\n\r\nconst _position = new THREE.Vector3();\r\nconst _quaternion = new THREE.Quaternion();\r\nconst _scale = new THREE.Vector3();\r\n\r\nclass CustomCSS3DObject extends THREE.Object3D {\r\n\r\n    element: HTMLElement\r\n    followObject: THREE.Object3D | null\r\n    followObjectOffset: THREE.Vector3\r\n\r\n    constructor( element: HTMLElement = document.createElement( 'div' ) ) {\r\n\r\n        super();\r\n\r\n        this.element = element;\r\n        this.element.style.position = 'absolute';\r\n        this.element.style.pointerEvents = 'all';\r\n        \r\n        if (element.parentNode !== null) {\r\n            element.parentNode.removeChild( element )\r\n        }\r\n        else {\r\n            document.removeChild(element)\r\n        }\r\n        this.followObject = null\r\n        this.followObjectOffset = new THREE.Vector3()\r\n\r\n    }\r\n\r\n    setFollowObject(followObject: THREE.Object3D, followObjectOffset: THREE.Vector3) {\r\n        this.followObject = followObject\r\n        this.followObjectOffset = followObjectOffset\r\n    }\r\n\r\n}\r\n\r\n\r\nclass CustomCSS3DSprite extends CustomCSS3DObject {\r\n\r\n    rotation2D: number\r\n\r\n    constructor( element: HTMLElement ) {\r\n\r\n        super( element );\r\n\r\n        this.rotation2D = 0;\r\n\r\n    }\r\n\r\n}\r\n\r\nconst _matrix = new THREE.Matrix4();\r\nconst _matrix2 = new THREE.Matrix4();\r\n\r\ninterface CustomCSS3DRendererCache {\r\n    camera: {\r\n        fov: number,\r\n        style: string\r\n    },\r\n    objects: WeakMap<any, any>\r\n}\r\n\r\nclass CustomCSS3DRenderer {\r\n\r\n    domElement: HTMLElement\r\n    cameraElement: HTMLElement\r\n    _width: number\r\n    _height: number\r\n    _widthHalf: number\r\n    _heightHalf: number\r\n    cache: CustomCSS3DRendererCache\r\n\r\n    constructor( domElement: HTMLElement ) {\r\n\r\n        this._width = 0\r\n        this._height = 0\r\n        this._widthHalf = 0\r\n        this._heightHalf = 0\r\n\r\n        this.cache = {\r\n            camera: { fov: 0, style: '' },\r\n            objects: new WeakMap()\r\n        };\r\n\r\n        this.domElement = domElement !== undefined ? domElement : document.createElement( 'div' );\r\n\r\n        // this.domElement.style.overflow = 'hidden';\r\n        this.domElement.style.position = 'absolute';\r\n        this.domElement.style.overflow = 'visible';\r\n        this.domElement.style.pointerEvents = 'none';\r\n\r\n        this.cameraElement = document.createElement( 'div' );\r\n        this.cameraElement.style.overflow = 'visible';\r\n\r\n        this.cameraElement.style.transformStyle = 'preserve-3d';\r\n        this.cameraElement.style.pointerEvents = 'none';\r\n\r\n        domElement.appendChild( this.cameraElement );\r\n    }\r\n    \r\n    getSize () {\r\n\r\n        return {\r\n            width: this._width,\r\n            height: this._height\r\n        };\r\n\r\n    }\r\n    \r\n    render ( scene: THREE.Scene, camera: THREE.PerspectiveCamera ) {\r\n\r\n        const fov = camera.projectionMatrix.elements[ 5 ] * this._heightHalf;\r\n\r\n        if ( this.cache.camera.fov !== fov ) {\r\n\r\n            this.domElement.style.perspective = fov + 'px'\r\n            this.cache.camera.fov = fov;\r\n\r\n        }\r\n\r\n        if ( scene.autoUpdate === true ) scene.updateMatrixWorld();\r\n        if ( camera.parent === null ) camera.updateMatrixWorld();\r\n\r\n        const cameraCSSMatrix = 'translateZ(' + fov + 'px)' + this.getCameraCSSMatrix( camera.matrixWorldInverse );\r\n\r\n        const style = cameraCSSMatrix +\r\n            'translate(' + this._widthHalf + 'px,' + this._heightHalf + 'px)';\r\n\r\n        if ( this.cache.camera.style !== style ) {\r\n\r\n            this.cameraElement.style.transform = style;\r\n\r\n            this.cache.camera.style = style;\r\n\r\n        }\r\n\r\n        this.renderObject( scene, scene, camera, cameraCSSMatrix );\r\n\r\n    }\r\n\r\n    setSize ( width: number, height: number ) {\r\n\r\n        this._width = width;\r\n        this._height = height;\r\n        this._widthHalf = this._width / 2;\r\n        this._heightHalf = this._height / 2;\r\n\r\n        this.domElement.style.width = this._width + 'px';\r\n        this.domElement.style.height = this._height + 'px';\r\n\r\n        this.cameraElement.style.width = this._width + 'px';\r\n        this.cameraElement.style.height = this._height + 'px';\r\n\r\n    }\r\n\r\n    epsilon( value: number ) {\r\n\r\n        return Math.abs( value ) < 1e-10 ? 0 : value;\r\n\r\n    }\r\n\r\n    getCameraCSSMatrix( matrix: THREE.Matrix4 ) {\r\n\r\n        const elements = matrix.elements;\r\n\r\n        return 'matrix3d(' +\r\n            this.epsilon( elements[ 0 ] ) + ',' +\r\n            this.epsilon( - elements[ 1 ] ) + ',' +\r\n            this.epsilon( elements[ 2 ] ) + ',' +\r\n            this.epsilon( elements[ 3 ] ) + ',' +\r\n            this.epsilon( elements[ 4 ] ) + ',' +\r\n            this.epsilon( - elements[ 5 ] ) + ',' +\r\n            this.epsilon( elements[ 6 ] ) + ',' +\r\n            this.epsilon( elements[ 7 ] ) + ',' +\r\n            this.epsilon( elements[ 8 ] ) + ',' +\r\n            this.epsilon( - elements[ 9 ] ) + ',' +\r\n            this.epsilon( elements[ 10 ] ) + ',' +\r\n            this.epsilon( elements[ 11 ] ) + ',' +\r\n            this.epsilon( elements[ 12 ] ) + ',' +\r\n            this.epsilon( - elements[ 13 ] ) + ',' +\r\n            this.epsilon( elements[ 14 ] ) + ',' +\r\n            this.epsilon( elements[ 15 ] ) +\r\n        ')';\r\n\r\n    }\r\n\r\n    getObjectCSSMatrix( matrix: THREE.Matrix4 ) {\r\n\r\n        const elements = matrix.elements;\r\n        const matrix3d = 'matrix3d(' +\r\n            this.epsilon( elements[ 0 ] ) + ',' +\r\n            this.epsilon( elements[ 1 ] ) + ',' +\r\n            this.epsilon( elements[ 2 ] ) + ',' +\r\n            this.epsilon( elements[ 3 ] ) + ',' +\r\n            this.epsilon( - elements[ 4 ] ) + ',' +\r\n            this.epsilon( - elements[ 5 ] ) + ',' +\r\n            this.epsilon( - elements[ 6 ] ) + ',' +\r\n            this.epsilon( - elements[ 7 ] ) + ',' +\r\n            this.epsilon( elements[ 8 ] ) + ',' +\r\n            this.epsilon( elements[ 9 ] ) + ',' +\r\n            this.epsilon( elements[ 10 ] ) + ',' +\r\n            this.epsilon( elements[ 11 ] ) + ',' +\r\n            this.epsilon( elements[ 12 ] ) + ',' +\r\n            this.epsilon( elements[ 13 ] ) + ',' +\r\n            this.epsilon( elements[ 14 ] ) + ',' +\r\n            this.epsilon( elements[ 15 ] ) +\r\n        ')';\r\n\r\n        return matrix3d;\r\n\r\n    }\r\n\r\n    renderObject( object: THREE.Object3D, scene: THREE.Scene, camera: THREE.PerspectiveCamera, cameraCSSMatrix: string ) {\r\n\r\n        if ( object instanceof CustomCSS3DObject ) {\r\n\r\n            const visible = object.visible && object.layers.test( camera.layers );\r\n            object.element.style.display = visible ? '' : 'none';\r\n\r\n            // only getObjectCSSMatrix when object.visible\r\n            if ( visible ) {\r\n\r\n                let style;\r\n\r\n                if (object.followObject != undefined) {\r\n                    object.position.copy(object.followObject.position)\r\n                    object.position.add(object.followObjectOffset)\r\n                }\r\n\r\n                if ( object instanceof CustomCSS3DSprite ) {\r\n\r\n                    // http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\r\n\r\n                    _matrix.copy( camera.matrixWorldInverse );\r\n                    _matrix.transpose();\r\n\r\n                    if ( object.rotation2D !== 0 ) _matrix.multiply( _matrix2.makeRotationZ( object.rotation2D ) );\r\n\r\n                    object.matrixWorld.decompose( _position, _quaternion, _scale );\r\n                    _matrix.setPosition( _position );\r\n                    _matrix.scale( _scale );\r\n\r\n                    _matrix.elements[ 3 ] = 0;\r\n                    _matrix.elements[ 7 ] = 0;\r\n                    _matrix.elements[ 11 ] = 0;\r\n                    _matrix.elements[ 15 ] = 1;\r\n\r\n                    style = this.getObjectCSSMatrix( _matrix );\r\n\r\n                } else {\r\n\r\n                    style = this.getObjectCSSMatrix( object.matrixWorld );\r\n\r\n                }\r\n\r\n                const element = object.element;\r\n                const cachedObject = this.cache.objects.get( object );\r\n\r\n                if ( cachedObject === undefined || cachedObject.style !== style ) {\r\n\r\n                    element.style.transform = style;\r\n\r\n                    const objectData = { style: style };\r\n                    this.cache.objects.set( object, objectData );\r\n\r\n                }\r\n\r\n                if ( element.parentNode !== this.cameraElement ) {\r\n\r\n                    this.cameraElement.appendChild( element );\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        for ( let i = 0, l = object.children.length; i < l; i ++ ) {\r\n            if (object.children[ i ] instanceof CustomCSS3DObject) {\r\n                this.renderObject( object.children[ i ], scene, camera, cameraCSSMatrix );\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport { CustomCSS3DObject, CustomCSS3DSprite, CustomCSS3DRenderer };\r\n"],"sourceRoot":""}