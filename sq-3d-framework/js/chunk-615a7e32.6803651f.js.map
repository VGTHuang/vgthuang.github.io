{"version":3,"sources":["webpack:///./src/views/ThreeBackgroundTest.vue?4ceb","webpack:///./node_modules/core-js/internals/function-bind.js","webpack:///./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack:///./src/scripts/Three/Utils.ts","webpack:///./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createSuper.js","webpack:///./node_modules/core-js/modules/es.object.get-prototype-of.js","webpack:///./node_modules/core-js/modules/es.reflect.construct.js","webpack:///./node_modules/core-js/modules/es.string.sub.js","webpack:///./src/views/ThreeBackgroundTest.vue?0acb","webpack:///./node_modules/three/examples/jsm/libs/fflate.module.js","webpack:///./node_modules/three/examples/jsm/curves/NURBSUtils.js","webpack:///./node_modules/three/examples/jsm/curves/NURBSCurve.js","webpack:///./node_modules/three/examples/jsm/loaders/FBXLoader.js","webpack:///./node_modules/three/examples/jsm/utils/SceneUtils.js","webpack:///./src/scripts/Three/ParticleEngine.ts","webpack:///./src/scripts/Background1.0/index.ts","webpack:///./src/views/ThreeBackgroundTest.vue","webpack:///./src/views/ThreeBackgroundTest.vue?c381","webpack:///./src/views/ThreeBackgroundTest.vue?8fd4","webpack:///./node_modules/core-js/internals/create-html.js","webpack:///./node_modules/core-js/internals/string-html-forced.js","webpack:///./node_modules/core-js/modules/es.reflect.to-string-tag.js"],"names":["global","uncurryThis","aCallable","isObject","hasOwn","arraySlice","NATIVE_BIND","Function","concat","join","factories","construct","C","argsLength","args","list","i","module","exports","bind","that","F","this","Prototype","prototype","partArgs","arguments","boundFunction","length","apply","_assertThisInitialized","self","ReferenceError","_setPrototypeOf","o","p","Object","setPrototypeOf","__proto__","_inherits","subClass","superClass","TypeError","create","constructor","value","writable","configurable","defineProperty","DampingObjectController","object","damp","attract","velocity","childObjects","push","target","multiplyScalar","currentPath","sub","position","add","forEach","obj","copy","rotation","DampingVector3Controller","currentVec3","randn_bm","u","v","Math","random","sqrt","log","cos","PI","_getPrototypeOf","getPrototypeOf","_isNativeReflectConstruct","Reflect","sham","Proxy","Boolean","valueOf","call","e","_typeof","Symbol","iterator","_possibleConstructorReturn","assertThisInitialized","_createSuper","Derived","hasNativeReflectConstruct","isNativeReflectConstruct","result","Super","NewTarget","possibleConstructorReturn","$","fails","toObject","nativeGetPrototypeOf","CORRECT_PROTOTYPE_GETTER","FAILS_ON_PRIMITIVES","stat","forced","it","getBuiltIn","aConstructor","anObject","nativeConstruct","ObjectPrototype","NEW_TARGET_BUG","ARGS_BUG","FORCED","Target","newTarget","$args","proto","instance","createHTML","forcedStringHTMLMethod","render","_vm","_h","$createElement","_c","_self","ref","attrs","staticClass","class","loadingStat","isLoaded","noLoadingStat","style","width","loaded","total","_v","_s","round","staticRenderFns","ch2","durl","c","URL","createObjectURL","Blob","type","cwk","Worker","revokeObjectURL","encodeURI","wk","id","msg","transfer","cb","w","onerror","error","onmessage","data","postMessage","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","start","b","r","j","_a","fl","revfl","_b","fd","revfd","rev","x","hMap","cd","mb","s","l","co","le","rvb","sv","r_1","m","flt","fdt","flm","flrm","fdm","fdrm","max","a","bits","d","bits16","shft","slc","n","set","subarray","inflt","dat","buf","st","sl","noBuf","noSt","cbuf","bl","nbuf","final","f","pos","bt","lm","dm","lbt","dbt","tbts","t","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","dsym","end","wbits","wbits16","hTree","t2","slice","et","sort","i0","i1","i2","maxSym","tr","mbt","ln","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","clen","cf","wfblk","out","wblk","syms","lf","df","li","bs","dlt","mlb","ddt","mdb","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","ll","dl","flen","ftlen","dtlen","llm","lcts","clct","len","dst","deo","dflt","lvl","plvl","pre","post","lst","ceil","opt","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","min","maxd","ml","nl","mmd","md","ti","pti","lin","din","crct","k","crc","cr","adler","dopt","level","mem","mrg","wcln","fn","fnStr","td","toString","ks","indexOf","lastIndexOf","replace","split","st_1","spInd","ch","cbfs","buffer","wrkr","fns","init","td_1","bInflt","inflateSync","pbf","gu8","bDflt","deflateSync","gze","gzh","gzhl","wbytes","guze","gzs","gzl","zle","zlh","zule","zlv","size","cbify","opts","err","terminate","consume","astrm","strm","ondata","ev","astrmify","b2","b4","b8","filename","mtime","floor","Date","now","charCodeAt","flg","zs","lv","AsyncCmpStrm","Deflate","chunk","AsyncDeflate","deflate","Inflate","bts","AsyncInflate","inflate","Gzip","raw","AsyncGzip","gzip","gzipSync","Gunzip","AsyncGunzip","gunzip","gunzipSync","Zlib","AsyncZlib","zlib","zlibSync","Unzlib","AsyncUnzlib","unzlib","unzlibSync","Decompress","G","I","Z","_this_1","AsyncDecompress","decompress","decompressSync","fltn","val","Array","isArray","te","TextEncoder","TextDecoder","tds","decode","stream","dutf8","String","fromCharCode","DecodeUTF8","np","EncodeUTF8","strToU8","str","latin1","ar_1","encode","ar","ai","strFromU8","ext","dbf","slzh","zh","z","fnl","es","z64e","sc","su","off","exfl","ex","wzh","ce","extra","col","exl","os","flag","compression","y","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","exf","wzf","ZipPassThrough","process","ZipDeflate","AsyncZipDeflate","Zip","file","com","comment","hl","header","chks","pAll","_i","chks_1","chk","ind","uf","nxt","dd","splice","zip","keys","tot","slft","files","term","tAll","cbf","oe","cdl","badd","loc","_loop_1","ms","cbl","zipSync","UnzipPassThrough","UnzipInflate","AsyncUnzipInflate","_","sz","Unzip","onfile","0","toAdd","is","oc","_loop_2","sig","this_1","bf","cmp_1","chks_2","unshift","d_1","sc_1","su_1","fn_1","file_1","name","ctr","chks_3","originalSize","state_1","register","decoder","unzip","_loop_3","c_1","no","infl","unzipSync","c_2","findSpan","U","low","high","mid","calcBasisFunctions","span","N","left","right","saved","rv","temp","calcBSplinePoint","P","point","Nj","wNj","calcBasisFunctionDerivatives","zeroArr","ders","ndu","s1","s2","rk","pk","j1","j2","calcBSplineDerivatives","nd","du","CK","nders","Pw","clone","calcKoverI","nom","denom","calcRationalCurveDerivatives","Pders","Aders","wders","divideScalar","calcNURBSDerivatives","degree","knots","controlPoints","startKnot","endKnot","super","optionalTarget","hpoint","tangent","normalize","fbxTree","connections","sceneGraph","manager","url","onLoad","onProgress","onError","scope","path","extractUrlBase","loader","setPath","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","load","parse","console","itemError","FBXBuffer","isFbxFormatBinary","FBXText","convertArrayBufferToString","isFbxFormatASCII","Error","getFbxVersion","TextParser","textureLoader","resourcePath","setCrossOrigin","crossOrigin","parseConnections","images","parseImages","textures","parseTextures","materials","parseMaterials","deformers","parseDeformers","geometryMap","parseScene","connectionMap","Map","rawConnections","Connections","rawConnection","fromID","toID","relationship","has","parents","children","parentRelationship","ID","get","childRelationship","blobs","Objects","videoNodes","Video","nodeID","videoNode","parseInt","RelativeFilename","Filename","arrayBufferContent","Content","ArrayBuffer","byteLength","base64Content","image","parseImage","undefined","pop","content","fileName","extension","toLowerCase","getHandler","warn","array","window","textureMap","textureNodes","Texture","texture","parseTexture","textureNode","loadTexture","attrName","wrapModeU","WrapModeU","wrapModeV","WrapModeV","valueU","valueV","wrapS","wrapT","values","Scaling","repeat","FileName","materialMap","materialNodes","Material","material","parseMaterial","materialNode","ShadingModel","parameters","parseParameters","setValues","BumpFactor","bumpScale","Diffuse","color","fromArray","DiffuseColor","DisplacementFactor","displacementScale","Emissive","emissive","EmissiveColor","EmissiveFactor","emissiveIntensity","parseFloat","Opacity","opacity","transparent","ReflectionFactor","reflectivity","Shininess","shininess","Specular","specular","SpecularColor","child","bumpMap","getTexture","aoMap","map","encoding","displacementMap","emissiveMap","normalMap","envMap","mapping","specularMap","alphaMap","LayeredTexture","skeletons","morphTargets","DeformerNodes","Deformer","deformerNode","relationships","attrType","skeleton","parseSkeleton","geometryID","morphTarget","rawTargets","parseMorphTargets","deformerNodes","rawBones","boneNode","rawBone","indices","weights","transformLink","TransformLink","Indexes","Weights","bones","rawMorphTargets","morphTargetNode","rawMorphTarget","initialWeight","DeformPercent","fullWeights","FullWeights","geoID","filter","modelMap","parseModels","modelNodes","Model","model","modelNode","setLookAtProperties","parentConnections","connection","parent","bindSkeleton","createAmbientLight","traverse","node","userData","transformData","parentMatrix","matrix","parentMatrixWorld","matrixWorld","transform","generateTransform","applyMatrix4","updateWorldMatrix","animations","isGroup","buildSkeleton","createCamera","createLight","createMesh","createCurve","sanitizeNodeName","getTransformData","bone","subBone","cameraAttribute","attr","NodeAttribute","CameraProjectionType","nearClippingPlane","NearPlane","farClippingPlane","FarPlane","innerWidth","height","innerHeight","AspectWidth","AspectHeight","aspect","fov","FieldOfView","focalLength","FocalLength","setFocalLength","lightAttribute","LightType","Color","intensity","Intensity","CastLightOnObject","distance","FarAttenuationEnd","EnableFarAttenuation","decay","angle","InnerAngle","degToRad","penumbra","OuterAngle","CastShadows","castShadow","geometry","attributes","vertexColors","FBX_Deformer","normalizeSkinWeights","reduce","geo","linewidth","inheritType","InheritType","eulerOrder","getEulerOrder","RotationOrder","translation","Lcl_Translation","preRotation","PreRotation","Lcl_Rotation","postRotation","PostRotation","scale","Lcl_Scaling","scalingOffset","ScalingOffset","scalingPivot","ScalingPivot","rotationOffset","RotationOffset","rotationPivot","RotationPivot","lookAtTarget","lookAt","bindMatrices","parsePoseNodes","geoRelationships","geoConnParent","BindPoseNode","Pose","NbPoseNodes","poseNodes","PoseNode","poseNode","Node","Matrix","GlobalSettings","ambientColor","AmbientColor","g","geoNodes","Geometry","parseGeometry","geoNode","parseMeshGeometry","parseNurbsGeometry","GeometricTranslation","GeometricRotation","GeometricScaling","genGeometry","preTransform","geoInfo","parseGeoNode","buffers","genBuffers","positionAttribute","vertex","setAttribute","colors","weightsIndices","vertexWeights","normal","normalMatrix","getNormalMatrix","normalAttribute","applyNormalMatrix","uvs","uvBuffer","mappingType","prevMaterialIndex","materialIndex","startIndex","currentIndex","addGroup","groups","lastGroup","lastIndex","count","addMorphTargets","vertexPositions","Vertices","vertexIndices","PolygonVertexIndex","LayerElementColor","parseVertexColors","LayerElementMaterial","parseMaterialIndices","LayerElementNormal","parseNormals","LayerElementUV","uv","UV","parseUVs","weightTable","index","weight","polygonIndex","faceLength","displayedWeightsWarning","facePositionIndexes","faceNormals","faceColors","faceUVs","faceWeights","faceWeightIndices","vertexIndex","polygonVertexIndex","endOfFace","weightIndices","getData","wt","wIndex","Weight","weightIndex","currentWeight","comparedWeight","comparedWeightIndex","comparedWeightArray","tmp","genFace","parentGeo","parentGeoNode","morphTargetsRelative","morphAttributes","rawTarget","morphGeoNode","genMorphGeometry","morphPositionsSparse","morphPositions","Float32Array","morphIndex","morphGeoInfo","morphBuffers","NormalNode","MappingInformationType","referenceType","ReferenceInformationType","Normals","indexBuffer","NormalIndex","NormalsIndex","dataSize","UVNode","UVIndex","ColorNode","Colors","ColorIndex","MaterialNode","materialIndexBuffer","Materials","materialIndices","order","Order","isNaN","KnotVector","pointsValues","Points","Form","curve","points","getPoints","setFromPoints","animationClips","rawClips","parseClips","key","rawClip","clip","addClip","AnimationCurve","curveNodesMap","parseAnimationCurveNodes","parseAnimationCurves","layersMap","parseAnimationLayers","parseAnimStacks","rawCurveNodes","AnimationCurveNode","rawCurveNode","match","curveNode","curves","rawCurves","animationCurve","times","KeyTime","convertFBXTimeToSeconds","KeyValueFloat","animationCurveID","animationCurveRelationship","rawLayers","AnimationLayer","layerCurveNodes","modelID","rawModel","modelName","initialPosition","initialRotation","initialScale","morph","deformerID","morpherID","morphName","rawStacks","AnimationStack","layer","tracks","rawTracks","generateTracks","decompose","toArray","setFromQuaternion","T","positionTrack","generateVectorTrack","R","rotationTrack","generateRotationTrack","S","scaleTrack","morphTrack","generateMorphTrack","initialValue","getTimesForAllAxes","getKeyframeTrackValues","interpolateRotations","setFromEuler","invert","quaternion","euler","quaternionValues","premultiply","multiply","morphNum","getObjectByName","morphTargetDictionary","targetIndex","lastValue","currentValue","prevValue","xIndex","yIndex","zIndex","time","xValue","yValue","zValue","valuesSpan","absoluteSpan","abs","numSubIntervals","step","nextValue","initialTime","timeSpan","interval","nextTime","interpolatedTimes","interpolatedValues","inject","nodeStack","currentIndent","currentProp","currentPropName","text","allNodes","FBXTree","line","matchComment","matchEmpty","matchBeginning","matchProperty","matchEnd","parseNodeBegin","parseNodeProperty","popStack","parseNodePropertyContinued","property","nodeName","trim","nodeAttrs","parseNodeAttr","currentNode","getCurrentNode","pushStack","contentLine","propName","propValue","parentName","connProps","from","to","rest","elem","append","setCurrentProp","parseNumberArray","parseNodeSpecialProperty","props","prop","innerPropName","innerPropType1","innerPropType2","innerPropFlag","innerPropValue","getPrevNode","reader","skip","version","getUint32","endOfContent","parseNode","getOffset","endOffset","getUint64","numProperties","nameLen","getUint8","getString","propertyList","parseProperty","singleProperty","subNode","parseSubNode","getBoolean","getFloat64","getFloat32","getInt32","getInt64","getArrayBuffer","getInt16","arrayLength","compressedLength","getBooleanArray","getFloat64Array","getFloat32Array","getInt32Array","getInt64Array","reader2","littleEndian","dv","DataView","offset","nullByte","decodeText","CORRECT","cursor","read","num","versionRegExp","dataArray","infoObject","tempEuler","tempVec","lTranslationM","lPreRotationM","lRotationM","lPostRotationM","lScalingM","lScalingPivotM","lScalingOffsetM","lRotationOffsetM","lRotationPivotM","lParentGX","lParentLX","lGlobalT","setPosition","makeRotationFromEuler","lLRM","lParentGRM","extractRotation","lParentTM","copyPosition","lParentGRSM","lParentGSM","lLSM","lGlobalRS","lParentLSM","setFromMatrixScale","lParentLSM_inv","lParentGSM_noLocal","lRotationPivotM_inv","lScalingPivotM_inv","lTransform","lLocalTWithAllPivotAndOffsetInfo","lGlobalTranslation","enums","a1","a2","createMultiMaterialObject","group","instanceIndex","birthTime","deathTime","dummy","mesh","updateMatrix","setMatrixAt","setColorAt","particleCount","instanceMatrix","setUsage","setInitPosition","setInitRotation","setInitScale","setInitColor","particleControllers","initPosition","initRotation","initScale","initColor","tempParticleController","resetGeom","_container","requestAnimationFrame","animate","stats","update","controls","container","camera","renderer","alpha","outputEncoding","toneMappingExposure","setClearColor","setPixelRatio","devicePixelRatio","setSize","domElement","top","appendChild","OrbitControls","scene","loadingManager","png_urls","urls","getCubemapUrls","textureCube1","environment","textureCube2","background","light","light1","light2","sinPeriods","sinAmplitude","sinRadius1","sinRadius2","ps","sin","spline","samples","getLength","splineLength","sphereRadius","sphereCount","spherePositions","getPointAt","geometrySpline","dashSize","gapSize","particleGeometry","particleMaterial","clearcoat","clearcoatRoughness","metalness","roughness","sheen","sheenColor","particleEngine1","ao1Map","texMap","normMap","normalScale","metalnessMap","clearcoatMap","side","kao1Map","kao2Map","loader2","frontbackMaterials","frontBackMesh","fao1Map","fao2Map","loader3","logoColorMap","logoReflectMap","logoMaterial","logoCardGeometry","logoCardEngine","getRandomLogoPosition","mousePosX","mousePosY","pointer","addEventListener","onWindowResize","onClick","updateProjectionMatrix","radius","radiusNew","randomOffset","dir","extend","fpm","mounted","$refs","HTMLElement","setTimeout","component","requireObjectCoercible","quot","string","tag","attribute","p1","METHOD_NAME","test","setToStringTag"],"mappings":"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","file":"js/chunk-615a7e32.6803651f.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeBackgroundTest.vue?vue&type=style&index=0&id=17a177c4&scoped=true&lang=css&\"","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar arraySlice = require('../internals/array-slice');\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar Function = global.Function;\nvar concat = uncurryThis([].concat);\nvar join = uncurryThis([].join);\nvar factories = {};\n\nvar construct = function (C, argsLength, args) {\n  if (!hasOwn(factories, argsLength)) {\n    for (var list = [], i = 0; i < argsLength; i++) list[i] = 'a[' + i + ']';\n    factories[argsLength] = Function('C,a', 'return new C(' + join(list, ',') + ')');\n  } return factories[argsLength](C, args);\n};\n\n// `Function.prototype.bind` method implementation\n// https://tc39.es/ecma262/#sec-function.prototype.bind\nmodule.exports = NATIVE_BIND ? Function.bind : function bind(that /* , ...args */) {\n  var F = aCallable(this);\n  var Prototype = F.prototype;\n  var partArgs = arraySlice(arguments, 1);\n  var boundFunction = function bound(/* args... */) {\n    var args = concat(partArgs, arraySlice(arguments));\n    return this instanceof boundFunction ? construct(F, args.length, args) : F.apply(that, args);\n  };\n  if (isObject(Prototype)) boundFunction.prototype = Prototype;\n  return boundFunction;\n};\n","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import { Vector3, Object3D } from 'three'\r\n\r\nexport class DampingObjectController {\r\n    damp: number\r\n    attract: number\r\n    object: Object3D\r\n    velocity: Vector3\r\n    childObjects: Array<Object3D>\r\n    constructor(object: Object3D, damp: number = 0.5, attract: number = 0.5) {\r\n        this.damp = damp\r\n        this.attract = attract\r\n        this.object = object\r\n        this.velocity = new Vector3()\r\n        this.childObjects = []\r\n    }\r\n    addChildObj(object: Object3D) {\r\n        this.childObjects.push(object)\r\n    }\r\n    update(target: Vector3) {\r\n        this.velocity.multiplyScalar(this.damp)\r\n        let currentPath = target.sub(this.object.position)\r\n        this.velocity.add(currentPath.multiplyScalar(this.attract))\r\n        this.object.position.add(this.velocity)\r\n        this.childObjects.forEach(obj => {\r\n            obj.position.copy(this.object.position)\r\n            obj.rotation.copy(this.object.rotation)\r\n        })\r\n    }\r\n}\r\n\r\nexport class DampingVector3Controller {\r\n    damp: number\r\n    attract: number\r\n    velocity: Vector3\r\n    currentVec3: Vector3\r\n    constructor(currentVec3: Vector3, damp: number = 0.5, attract: number = 0.5) {\r\n        this.damp = damp\r\n        this.attract = attract\r\n        this.velocity = new Vector3()\r\n        this.currentVec3 = currentVec3\r\n    }\r\n    update(target: Vector3) {\r\n        this.velocity.multiplyScalar(this.damp)\r\n        let currentPath = new Vector3().copy(target).sub(this.currentVec3)\r\n        this.velocity.add(currentPath.multiplyScalar(this.attract))\r\n        this.currentVec3.add(this.velocity)\r\n    }\r\n}\r\n\r\nexport function randn_bm(): number {\r\n    var u = 0, v = 0;\r\n    while(u === 0) u = Math.random(); //Converting [0,1) to (0,1)\r\n    while(v === 0) v = Math.random();\r\n    return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );\r\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return assertThisInitialized(self);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nimport possibleConstructorReturn from \"./possibleConstructorReturn.js\";\nexport default function _createSuper(Derived) {\n  var hasNativeReflectConstruct = isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return possibleConstructorReturn(this, result);\n  };\n}","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar nativeGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetPrototypeOf(1); });\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(it) {\n    return nativeGetPrototypeOf(toObject(it));\n  }\n});\n\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\nvar bind = require('../internals/function-bind');\nvar aConstructor = require('../internals/a-constructor');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar create = require('../internals/object-create');\nvar fails = require('../internals/fails');\n\nvar nativeConstruct = getBuiltIn('Reflect', 'construct');\nvar ObjectPrototype = Object.prototype;\nvar push = [].push;\n\n// `Reflect.construct` method\n// https://tc39.es/ecma262/#sec-reflect.construct\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(nativeConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\n\nvar ARGS_BUG = !fails(function () {\n  nativeConstruct(function () { /* empty */ });\n});\n\nvar FORCED = NEW_TARGET_BUG || ARGS_BUG;\n\n$({ target: 'Reflect', stat: true, forced: FORCED, sham: FORCED }, {\n  construct: function construct(Target, args /* , newTarget */) {\n    aConstructor(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aConstructor(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return nativeConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      apply(push, $args, args);\n      return new (apply(bind, Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : ObjectPrototype);\n    var result = apply(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.sub` method\n// https://tc39.es/ecma262/#sec-string.prototype.sub\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('sub') }, {\n  sub: function sub() {\n    return createHTML(this, 'sub', '', '');\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{ref:\"canvas-container\",attrs:{\"id\":\"canvas-container\"}},[_c('div',{staticClass:\"loading-container\",class:{\n            'loading-container--hidden': _vm.loadingStat.isLoaded,\n            'loading-container--none': _vm.loadingStat.noLoadingStat\n        }},[_c('div',{staticClass:\"load-stat\"},[_c('div',{staticClass:\"load-pgbar\",style:({\n                    width: 100 * _vm.loadingStat.loaded / _vm.loadingStat.total + '%'\n                })}),_c('div',{staticClass:\"load-text\"},[_vm._v(_vm._s(Math.round(100 * _vm.loadingStat.loaded / _vm.loadingStat.total))+\" %\")])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*!\nfflate - fast JavaScript compression/decompression\n<https://101arrowz.github.io/fflate>\nLicensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE\nversion 0.6.9\n*/\n\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar durl = function (c) { return URL.createObjectURL(new Blob([c], { type: 'text/javascript' })); };\nvar cwk = function (u) { return new Worker(u); };\ntry {\n    URL.revokeObjectURL(durl(''));\n}\ncatch (e) {\n    // We're in Deno or a very old browser\n    durl = function (c) { return 'data:application/javascript;charset=UTF-8,' + encodeURI(c); };\n    // If Deno, this is necessary; if not, this changes nothing\n    cwk = function (u) { return new Worker(u, { type: 'module' }); };\n}\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = cwk(ch2[id] || (ch2[id] = durl(c)));\n    w.onerror = function (e) { return cb(e.error, null); };\n    w.onmessage = function (e) { return cb(null, e.data); };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p / 8) | 0) + (p & 7 && 1); };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && !st.l && sl < 5))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            st.f = final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                throw 'invalid block type';\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n            if (!c)\n                throw 'invalid length/literal';\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    throw 'invalid distance';\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new u32(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && 0xEDB88320) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, hMap, max, bits, bits16, shft, slc, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (t)\n            throw 'stream finished';\n        if (!strm.ondata)\n            throw 'no stream handler';\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        throw 'invalid gzip data';\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        throw 'invalid zlib data';\n    if (d[1] & 32)\n        throw 'invalid zlib data: preset dictionaries not supported';\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                throw 'invalid gzip stream';\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                throw 'invalid zlib stream';\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no stream handler';\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    throw 'invalid utf-8 data';\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            throw 'stream finished';\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                throw 'invalid utf-8 data';\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        if (this.d)\n            throw 'stream finished';\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            throw 'invalid utf-8 data';\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                throw 'extra field too long';\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        throw 'date not in range 1980-2099';\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != null) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback - add to ZIP archive before pushing';\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (this.d & 2)\n            throw 'stream finished';\n        var f = strToU8(file.filename), fl = f.length;\n        var com = file.comment, o = com && strToU8(com);\n        var u = fl != file.filename.length || (o && (com.length != o.length));\n        var hl = fl + exfl(file.extra) + 30;\n        if (fl > 65535)\n            throw 'filename too long';\n        var header = new u8(hl);\n        wzh(header, 0, file, f, u);\n        var chks = [header];\n        var pAll = function () {\n            for (var _i = 0, chks_1 = chks; _i < chks_1.length; _i++) {\n                var chk = chks_1[_i];\n                _this_1.ondata(null, chk, false);\n            }\n            chks = [];\n        };\n        var tr = this.d;\n        this.d = 0;\n        var ind = this.u.length;\n        var uf = mrg(file, {\n            f: f,\n            u: u,\n            o: o,\n            t: function () {\n                if (file.terminate)\n                    file.terminate();\n            },\n            r: function () {\n                pAll();\n                if (tr) {\n                    var nxt = _this_1.u[ind + 1];\n                    if (nxt)\n                        nxt.r();\n                    else\n                        _this_1.d = 1;\n                }\n                tr = 1;\n            }\n        });\n        var cl = 0;\n        file.ondata = function (err, dat, final) {\n            if (err) {\n                _this_1.ondata(err, dat, final);\n                _this_1.terminate();\n            }\n            else {\n                cl += dat.length;\n                chks.push(dat);\n                if (final) {\n                    var dd = new u8(16);\n                    wbytes(dd, 0, 0x8074B50);\n                    wbytes(dd, 4, file.crc);\n                    wbytes(dd, 8, cl);\n                    wbytes(dd, 12, file.size);\n                    chks.push(dd);\n                    uf.c = cl, uf.b = hl + cl + 16, uf.crc = file.crc, uf.size = file.size;\n                    if (tr)\n                        uf.r();\n                    tr = 1;\n                }\n                else if (tr)\n                    pAll();\n            }\n        };\n        this.u.push(uf);\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            if (this.d & 1)\n                throw 'stream finishing';\n            throw 'stream finished';\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cb(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cb(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl('filename too long', null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            throw 'filename too long';\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, data, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            throw 'no callback';\n        if (!this.p)\n            throw 'stream finished';\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_2 = [];\n                        this_1.k.unshift(chks_2);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    throw 'no callback';\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        throw 'unknown compression type ' + cmp_1;\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_3 = chks_2; _i < chks_3.length; _i++) {\n                                        var dat = chks_3[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_2 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                throw 'invalid zip file';\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data, cb) {\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cb('invalid zip file', null);\n            return;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (!lft)\n        cb(null, {});\n    var c = lft;\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50) {\n            cb('invalid zip file', null);\n            return;\n        }\n        c = lft = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var _loop_3 = function (i) {\n        var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                files[fn] = d;\n                if (!--lft)\n                    cb(null, files);\n            }\n        };\n        if (!c_1)\n            cbl(null, slc(data, b, b + sc));\n        else if (c_1 == 8) {\n            var infl = data.subarray(b, b + sc);\n            if (sc < 320000) {\n                try {\n                    cbl(null, inflateSync(infl, new u8(su)));\n                }\n                catch (e) {\n                    cbl(e, null);\n                }\n            }\n            else\n                term.push(inflate(infl, { size: su }, cbl));\n        }\n        else\n            cbl('unknown compression type ' + c_1, null);\n    };\n    for (var i = 0; i < c; ++i) {\n        _loop_3(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            throw 'invalid zip file';\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!c_2)\n            files[fn] = slc(data, b, b + sc);\n        else if (c_2 == 8)\n            files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n        else\n            throw 'unknown compression type ' + c_2;\n    }\n    return files;\n}\n","import {\n\tVector3,\n\tVector4\n} from 'three';\n\n/**\n * NURBS utils\n *\n * See NURBSCurve and NURBSSurface.\n **/\n\n\n/**************************************************************\n *\tNURBS Utils\n **************************************************************/\n\n/*\nFinds knot vector span.\n\np : degree\nu : parametric value\nU : knot vector\n\nreturns the span\n*/\nfunction findSpan( p, u, U ) {\n\n\tconst n = U.length - p - 1;\n\n\tif ( u >= U[ n ] ) {\n\n\t\treturn n - 1;\n\n\t}\n\n\tif ( u <= U[ p ] ) {\n\n\t\treturn p;\n\n\t}\n\n\tlet low = p;\n\tlet high = n;\n\tlet mid = Math.floor( ( low + high ) / 2 );\n\n\twhile ( u < U[ mid ] || u >= U[ mid + 1 ] ) {\n\n\t\tif ( u < U[ mid ] ) {\n\n\t\t\thigh = mid;\n\n\t\t} else {\n\n\t\t\tlow = mid;\n\n\t\t}\n\n\t\tmid = Math.floor( ( low + high ) / 2 );\n\n\t}\n\n\treturn mid;\n\n}\n\n\n/*\nCalculate basis functions. See The NURBS Book, page 70, algorithm A2.2\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nU    : knot vector\n\nreturns array[p+1] with basis functions values.\n*/\nfunction calcBasisFunctions( span, u, p, U ) {\n\n\tconst N = [];\n\tconst left = [];\n\tconst right = [];\n\tN[ 0 ] = 1.0;\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tconst temp = N[ r ] / ( rv + lv );\n\t\t\tN[ r ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tN[ j ] = saved;\n\n\t}\n\n\treturn N;\n\n}\n\n\n/*\nCalculate B-Spline curve points. See The NURBS Book, page 82, algorithm A3.1.\n\np : degree of B-Spline\nU : knot vector\nP : control points (x, y, z, w)\nu : parametric point\n\nreturns point for given u\n*/\nfunction calcBSplinePoint( p, U, P, u ) {\n\n\tconst span = findSpan( p, u, U );\n\tconst N = calcBasisFunctions( span, u, p, U );\n\tconst C = new Vector4( 0, 0, 0, 0 );\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tconst point = P[ span - p + j ];\n\t\tconst Nj = N[ j ];\n\t\tconst wNj = point.w * Nj;\n\t\tC.x += point.x * wNj;\n\t\tC.y += point.y * wNj;\n\t\tC.z += point.z * wNj;\n\t\tC.w += point.w * Nj;\n\n\t}\n\n\treturn C;\n\n}\n\n\n/*\nCalculate basis functions derivatives. See The NURBS Book, page 72, algorithm A2.3.\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nn    : number of derivatives to calculate\nU    : knot vector\n\nreturns array[n+1][p+1] with basis functions derivatives\n*/\nfunction calcBasisFunctionDerivatives( span, u, p, n, U ) {\n\n\tconst zeroArr = [];\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tzeroArr[ i ] = 0.0;\n\n\tconst ders = [];\n\n\tfor ( let i = 0; i <= n; ++ i )\n\t\tders[ i ] = zeroArr.slice( 0 );\n\n\tconst ndu = [];\n\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tndu[ i ] = zeroArr.slice( 0 );\n\n\tndu[ 0 ][ 0 ] = 1.0;\n\n\tconst left = zeroArr.slice( 0 );\n\tconst right = zeroArr.slice( 0 );\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tndu[ j ][ r ] = rv + lv;\n\n\t\t\tconst temp = ndu[ r ][ j - 1 ] / ndu[ j ][ r ];\n\t\t\tndu[ r ][ j ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tndu[ j ][ j ] = saved;\n\n\t}\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tders[ 0 ][ j ] = ndu[ j ][ p ];\n\n\t}\n\n\tfor ( let r = 0; r <= p; ++ r ) {\n\n\t\tlet s1 = 0;\n\t\tlet s2 = 1;\n\n\t\tconst a = [];\n\t\tfor ( let i = 0; i <= p; ++ i ) {\n\n\t\t\ta[ i ] = zeroArr.slice( 0 );\n\n\t\t}\n\n\t\ta[ 0 ][ 0 ] = 1.0;\n\n\t\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\t\tlet d = 0.0;\n\t\t\tconst rk = r - k;\n\t\t\tconst pk = p - k;\n\n\t\t\tif ( r >= k ) {\n\n\t\t\t\ta[ s2 ][ 0 ] = a[ s1 ][ 0 ] / ndu[ pk + 1 ][ rk ];\n\t\t\t\td = a[ s2 ][ 0 ] * ndu[ rk ][ pk ];\n\n\t\t\t}\n\n\t\t\tconst j1 = ( rk >= - 1 ) ? 1 : - rk;\n\t\t\tconst j2 = ( r - 1 <= pk ) ? k - 1 : p - r;\n\n\t\t\tfor ( let j = j1; j <= j2; ++ j ) {\n\n\t\t\t\ta[ s2 ][ j ] = ( a[ s1 ][ j ] - a[ s1 ][ j - 1 ] ) / ndu[ pk + 1 ][ rk + j ];\n\t\t\t\td += a[ s2 ][ j ] * ndu[ rk + j ][ pk ];\n\n\t\t\t}\n\n\t\t\tif ( r <= pk ) {\n\n\t\t\t\ta[ s2 ][ k ] = - a[ s1 ][ k - 1 ] / ndu[ pk + 1 ][ r ];\n\t\t\t\td += a[ s2 ][ k ] * ndu[ r ][ pk ];\n\n\t\t\t}\n\n\t\t\tders[ k ][ r ] = d;\n\n\t\t\tconst j = s1;\n\t\t\ts1 = s2;\n\t\t\ts2 = j;\n\n\t\t}\n\n\t}\n\n\tlet r = p;\n\n\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\t\tders[ k ][ j ] *= r;\n\n\t\t}\n\n\t\tr *= p - k;\n\n\t}\n\n\treturn ders;\n\n}\n\n\n/*\n\tCalculate derivatives of a B-Spline. See The NURBS Book, page 93, algorithm A3.2.\n\n\tp  : degree\n\tU  : knot vector\n\tP  : control points\n\tu  : Parametric points\n\tnd : number of derivatives\n\n\treturns array[d+1] with derivatives\n\t*/\nfunction calcBSplineDerivatives( p, U, P, u, nd ) {\n\n\tconst du = nd < p ? nd : p;\n\tconst CK = [];\n\tconst span = findSpan( p, u, U );\n\tconst nders = calcBasisFunctionDerivatives( span, u, p, du, U );\n\tconst Pw = [];\n\n\tfor ( let i = 0; i < P.length; ++ i ) {\n\n\t\tconst point = P[ i ].clone();\n\t\tconst w = point.w;\n\n\t\tpoint.x *= w;\n\t\tpoint.y *= w;\n\t\tpoint.z *= w;\n\n\t\tPw[ i ] = point;\n\n\t}\n\n\tfor ( let k = 0; k <= du; ++ k ) {\n\n\t\tconst point = Pw[ span - p ].clone().multiplyScalar( nders[ k ][ 0 ] );\n\n\t\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\t\tpoint.add( Pw[ span - p + j ].clone().multiplyScalar( nders[ k ][ j ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = point;\n\n\t}\n\n\tfor ( let k = du + 1; k <= nd + 1; ++ k ) {\n\n\t\tCK[ k ] = new Vector4( 0, 0, 0 );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate \"K over I\"\n\nreturns k!/(i!(k-i)!)\n*/\nfunction calcKoverI( k, i ) {\n\n\tlet nom = 1;\n\n\tfor ( let j = 2; j <= k; ++ j ) {\n\n\t\tnom *= j;\n\n\t}\n\n\tlet denom = 1;\n\n\tfor ( let j = 2; j <= i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\tfor ( let j = 2; j <= k - i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\treturn nom / denom;\n\n}\n\n\n/*\nCalculate derivatives (0-nd) of rational curve. See The NURBS Book, page 127, algorithm A4.2.\n\nPders : result of function calcBSplineDerivatives\n\nreturns array with derivatives for rational curve.\n*/\nfunction calcRationalCurveDerivatives( Pders ) {\n\n\tconst nd = Pders.length;\n\tconst Aders = [];\n\tconst wders = [];\n\n\tfor ( let i = 0; i < nd; ++ i ) {\n\n\t\tconst point = Pders[ i ];\n\t\tAders[ i ] = new Vector3( point.x, point.y, point.z );\n\t\twders[ i ] = point.w;\n\n\t}\n\n\tconst CK = [];\n\n\tfor ( let k = 0; k < nd; ++ k ) {\n\n\t\tconst v = Aders[ k ].clone();\n\n\t\tfor ( let i = 1; i <= k; ++ i ) {\n\n\t\t\tv.sub( CK[ k - i ].clone().multiplyScalar( calcKoverI( k, i ) * wders[ i ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = v.divideScalar( wders[ 0 ] );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate NURBS curve derivatives. See The NURBS Book, page 127, algorithm A4.2.\n\np  : degree\nU  : knot vector\nP  : control points in homogeneous space\nu  : parametric points\nnd : number of derivatives\n\nreturns array with derivatives.\n*/\nfunction calcNURBSDerivatives( p, U, P, u, nd ) {\n\n\tconst Pders = calcBSplineDerivatives( p, U, P, u, nd );\n\treturn calcRationalCurveDerivatives( Pders );\n\n}\n\n\n/*\nCalculate rational B-Spline surface point. See The NURBS Book, page 134, algorithm A4.3.\n\np1, p2 : degrees of B-Spline surface\nU1, U2 : knot vectors\nP      : control points (x, y, z, w)\nu, v   : parametric values\n\nreturns point for given (u, v)\n*/\nfunction calcSurfacePoint( p, q, U, V, P, u, v, target ) {\n\n\tconst uspan = findSpan( p, u, U );\n\tconst vspan = findSpan( q, v, V );\n\tconst Nu = calcBasisFunctions( uspan, u, p, U );\n\tconst Nv = calcBasisFunctions( vspan, v, q, V );\n\tconst temp = [];\n\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\ttemp[ l ] = new Vector4( 0, 0, 0, 0 );\n\t\tfor ( let k = 0; k <= p; ++ k ) {\n\n\t\t\tconst point = P[ uspan - p + k ][ vspan - q + l ].clone();\n\t\t\tconst w = point.w;\n\t\t\tpoint.x *= w;\n\t\t\tpoint.y *= w;\n\t\t\tpoint.z *= w;\n\t\t\ttemp[ l ].add( point.multiplyScalar( Nu[ k ] ) );\n\n\t\t}\n\n\t}\n\n\tconst Sw = new Vector4( 0, 0, 0, 0 );\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\tSw.add( temp[ l ].multiplyScalar( Nv[ l ] ) );\n\n\t}\n\n\tSw.divideScalar( Sw.w );\n\ttarget.set( Sw.x, Sw.y, Sw.z );\n\n}\n\n\n\nexport {\n\tfindSpan,\n\tcalcBasisFunctions,\n\tcalcBSplinePoint,\n\tcalcBasisFunctionDerivatives,\n\tcalcBSplineDerivatives,\n\tcalcKoverI,\n\tcalcRationalCurveDerivatives,\n\tcalcNURBSDerivatives,\n\tcalcSurfacePoint,\n};\n","import {\n\tCurve,\n\tVector3,\n\tVector4\n} from 'three';\nimport * as NURBSUtils from '../curves/NURBSUtils.js';\n\n/**\n * NURBS curve object\n *\n * Derives from Curve, overriding getPoint and getTangent.\n *\n * Implementation is based on (x, y [, z=0 [, w=1]]) control points with w=weight.\n *\n **/\n\nclass NURBSCurve extends Curve {\n\n\tconstructor(\n\t\tdegree,\n\t\tknots /* array of reals */,\n\t\tcontrolPoints /* array of Vector(2|3|4) */,\n\t\tstartKnot /* index in knots */,\n\t\tendKnot /* index in knots */\n\t) {\n\n\t\tsuper();\n\n\t\tthis.degree = degree;\n\t\tthis.knots = knots;\n\t\tthis.controlPoints = [];\n\t\t// Used by periodic NURBS to remove hidden spans\n\t\tthis.startKnot = startKnot || 0;\n\t\tthis.endKnot = endKnot || ( this.knots.length - 1 );\n\n\t\tfor ( let i = 0; i < controlPoints.length; ++ i ) {\n\n\t\t\t// ensure Vector4 for control points\n\t\t\tconst point = controlPoints[ i ];\n\t\t\tthis.controlPoints[ i ] = new Vector4( point.x, point.y, point.z, point.w );\n\n\t\t}\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst u = this.knots[ this.startKnot ] + t * ( this.knots[ this.endKnot ] - this.knots[ this.startKnot ] ); // linear mapping t->u\n\n\t\t// following results in (wx, wy, wz, w) homogeneous point\n\t\tconst hpoint = NURBSUtils.calcBSplinePoint( this.degree, this.knots, this.controlPoints, u );\n\n\t\tif ( hpoint.w !== 1.0 ) {\n\n\t\t\t// project to 3D space: (wx, wy, wz, w) -> (x, y, z, 1)\n\t\t\thpoint.divideScalar( hpoint.w );\n\n\t\t}\n\n\t\treturn point.set( hpoint.x, hpoint.y, hpoint.z );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector3() ) {\n\n\t\tconst tangent = optionalTarget;\n\n\t\tconst u = this.knots[ 0 ] + t * ( this.knots[ this.knots.length - 1 ] - this.knots[ 0 ] );\n\t\tconst ders = NURBSUtils.calcNURBSDerivatives( this.degree, this.knots, this.controlPoints, u, 1 );\n\t\ttangent.copy( ders[ 1 ] ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n}\n\nexport { NURBSCurve };\n","import {\n\tAmbientLight,\n\tAnimationClip,\n\tBone,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tEquirectangularReflectionMapping,\n\tEuler,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLine,\n\tLineBasicMaterial,\n\tLoader,\n\tLoaderUtils,\n\tMathUtils,\n\tMatrix3,\n\tMatrix4,\n\tMesh,\n\tMeshLambertMaterial,\n\tMeshPhongMaterial,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tUint16BufferAttribute,\n\tVector3,\n\tVector4,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\nimport * as fflate from '../libs/fflate.module.js';\nimport { NURBSCurve } from '../curves/NURBSCurve.js';\n\n/**\n * Loader loads FBX file and generates Group representing FBX scene.\n * Requires FBX file to be >= 7.0 and in ASCII or >= 6400 in Binary format\n * Versions lower than this may load but will probably have errors\n *\n * Needs Support:\n *  Morph normals / blend shape normals\n *\n * FBX format references:\n * \thttps://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_index_html (C++ SDK reference)\n *\n * Binary format specification:\n *\thttps://code.blender.org/2013/08/fbx-binary-file-format-specification/\n */\n\n\nlet fbxTree;\nlet connections;\nlet sceneGraph;\n\nclass FBXLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( scope.path === '' ) ? LoaderUtils.extractUrlBase( url ) : scope.path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( buffer, path ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( FBXBuffer, path ) {\n\n\t\tif ( isFbxFormatBinary( FBXBuffer ) ) {\n\n\t\t\tfbxTree = new BinaryParser().parse( FBXBuffer );\n\n\t\t} else {\n\n\t\t\tconst FBXText = convertArrayBufferToString( FBXBuffer );\n\n\t\t\tif ( ! isFbxFormatASCII( FBXText ) ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown format.' );\n\n\t\t\t}\n\n\t\t\tif ( getFbxVersion( FBXText ) < 7000 ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + getFbxVersion( FBXText ) );\n\n\t\t\t}\n\n\t\t\tfbxTree = new TextParser().parse( FBXText );\n\n\t\t}\n\n\t\t// console.log( fbxTree );\n\n\t\tconst textureLoader = new TextureLoader( this.manager ).setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n\t\treturn new FBXTreeParser( textureLoader, this.manager ).parse( fbxTree );\n\n\t}\n\n}\n\n// Parse the FBXTree object returned by the BinaryParser or TextParser and return a Group\nclass FBXTreeParser {\n\n\tconstructor( textureLoader, manager ) {\n\n\t\tthis.textureLoader = textureLoader;\n\t\tthis.manager = manager;\n\n\t}\n\n\tparse() {\n\n\t\tconnections = this.parseConnections();\n\n\t\tconst images = this.parseImages();\n\t\tconst textures = this.parseTextures( images );\n\t\tconst materials = this.parseMaterials( textures );\n\t\tconst deformers = this.parseDeformers();\n\t\tconst geometryMap = new GeometryParser().parse( deformers );\n\n\t\tthis.parseScene( deformers, geometryMap, materials );\n\n\t\treturn sceneGraph;\n\n\t}\n\n\t// Parses FBXTree.Connections which holds parent-child connections between objects (e.g. material -> texture, model->geometry )\n\t// and details the connection type\n\tparseConnections() {\n\n\t\tconst connectionMap = new Map();\n\n\t\tif ( 'Connections' in fbxTree ) {\n\n\t\t\tconst rawConnections = fbxTree.Connections.connections;\n\n\t\t\trawConnections.forEach( function ( rawConnection ) {\n\n\t\t\t\tconst fromID = rawConnection[ 0 ];\n\t\t\t\tconst toID = rawConnection[ 1 ];\n\t\t\t\tconst relationship = rawConnection[ 2 ];\n\n\t\t\t\tif ( ! connectionMap.has( fromID ) ) {\n\n\t\t\t\t\tconnectionMap.set( fromID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst parentRelationship = { ID: toID, relationship: relationship };\n\t\t\t\tconnectionMap.get( fromID ).parents.push( parentRelationship );\n\n\t\t\t\tif ( ! connectionMap.has( toID ) ) {\n\n\t\t\t\t\tconnectionMap.set( toID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst childRelationship = { ID: fromID, relationship: relationship };\n\t\t\t\tconnectionMap.get( toID ).children.push( childRelationship );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn connectionMap;\n\n\t}\n\n\t// Parse FBXTree.Objects.Video for embedded image data\n\t// These images are connected to textures in FBXTree.Objects.Textures\n\t// via FBXTree.Connections.\n\tparseImages() {\n\n\t\tconst images = {};\n\t\tconst blobs = {};\n\n\t\tif ( 'Video' in fbxTree.Objects ) {\n\n\t\t\tconst videoNodes = fbxTree.Objects.Video;\n\n\t\t\tfor ( const nodeID in videoNodes ) {\n\n\t\t\t\tconst videoNode = videoNodes[ nodeID ];\n\n\t\t\t\tconst id = parseInt( nodeID );\n\n\t\t\t\timages[ id ] = videoNode.RelativeFilename || videoNode.Filename;\n\n\t\t\t\t// raw image data is in videoNode.Content\n\t\t\t\tif ( 'Content' in videoNode ) {\n\n\t\t\t\t\tconst arrayBufferContent = ( videoNode.Content instanceof ArrayBuffer ) && ( videoNode.Content.byteLength > 0 );\n\t\t\t\t\tconst base64Content = ( typeof videoNode.Content === 'string' ) && ( videoNode.Content !== '' );\n\n\t\t\t\t\tif ( arrayBufferContent || base64Content ) {\n\n\t\t\t\t\t\tconst image = this.parseImage( videoNodes[ nodeID ] );\n\n\t\t\t\t\t\tblobs[ videoNode.RelativeFilename || videoNode.Filename ] = image;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const id in images ) {\n\n\t\t\tconst filename = images[ id ];\n\n\t\t\tif ( blobs[ filename ] !== undefined ) images[ id ] = blobs[ filename ];\n\t\t\telse images[ id ] = images[ id ].split( '\\\\' ).pop();\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\t// Parse embedded image data in FBXTree.Video.Content\n\tparseImage( videoNode ) {\n\n\t\tconst content = videoNode.Content;\n\t\tconst fileName = videoNode.RelativeFilename || videoNode.Filename;\n\t\tconst extension = fileName.slice( fileName.lastIndexOf( '.' ) + 1 ).toLowerCase();\n\n\t\tlet type;\n\n\t\tswitch ( extension ) {\n\n\t\t\tcase 'bmp':\n\n\t\t\t\ttype = 'image/bmp';\n\t\t\t\tbreak;\n\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\n\t\t\t\ttype = 'image/jpeg';\n\t\t\t\tbreak;\n\n\t\t\tcase 'png':\n\n\t\t\t\ttype = 'image/png';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tif':\n\n\t\t\t\ttype = 'image/tiff';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tga':\n\n\t\t\t\tif ( this.manager.getHandler( '.tga' ) === null ) {\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, skipping ', fileName );\n\n\t\t\t\t}\n\n\t\t\t\ttype = 'image/tga';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'FBXLoader: Image type \"' + extension + '\" is not supported.' );\n\t\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof content === 'string' ) { // ASCII format\n\n\t\t\treturn 'data:' + type + ';base64,' + content;\n\n\t\t} else { // Binary Format\n\n\t\t\tconst array = new Uint8Array( content );\n\t\t\treturn window.URL.createObjectURL( new Blob( [ array ], { type: type } ) );\n\n\t\t}\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Texture\n\t// These contain details such as UV scaling, cropping, rotation etc and are connected\n\t// to images in FBXTree.Objects.Video\n\tparseTextures( images ) {\n\n\t\tconst textureMap = new Map();\n\n\t\tif ( 'Texture' in fbxTree.Objects ) {\n\n\t\t\tconst textureNodes = fbxTree.Objects.Texture;\n\t\t\tfor ( const nodeID in textureNodes ) {\n\n\t\t\t\tconst texture = this.parseTexture( textureNodes[ nodeID ], images );\n\t\t\t\ttextureMap.set( parseInt( nodeID ), texture );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textureMap;\n\n\t}\n\n\t// Parse individual node in FBXTree.Objects.Texture\n\tparseTexture( textureNode, images ) {\n\n\t\tconst texture = this.loadTexture( textureNode, images );\n\n\t\ttexture.ID = textureNode.id;\n\n\t\ttexture.name = textureNode.attrName;\n\n\t\tconst wrapModeU = textureNode.WrapModeU;\n\t\tconst wrapModeV = textureNode.WrapModeV;\n\n\t\tconst valueU = wrapModeU !== undefined ? wrapModeU.value : 0;\n\t\tconst valueV = wrapModeV !== undefined ? wrapModeV.value : 0;\n\n\t\t// http://download.autodesk.com/us/fbx/SDKdocs/FBX_SDK_Help/files/fbxsdkref/class_k_fbx_texture.html#889640e63e2e681259ea81061b85143a\n\t\t// 0: repeat(default), 1: clamp\n\n\t\ttexture.wrapS = valueU === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\t\ttexture.wrapT = valueV === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\n\t\tif ( 'Scaling' in textureNode ) {\n\n\t\t\tconst values = textureNode.Scaling.value;\n\n\t\t\ttexture.repeat.x = values[ 0 ];\n\t\t\ttexture.repeat.y = values[ 1 ];\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\t// load a texture specified as a blob or data URI, or via an external URL using TextureLoader\n\tloadTexture( textureNode, images ) {\n\n\t\tlet fileName;\n\n\t\tconst currentPath = this.textureLoader.path;\n\n\t\tconst children = connections.get( textureNode.id ).children;\n\n\t\tif ( children !== undefined && children.length > 0 && images[ children[ 0 ].ID ] !== undefined ) {\n\n\t\t\tfileName = images[ children[ 0 ].ID ];\n\n\t\t\tif ( fileName.indexOf( 'blob:' ) === 0 || fileName.indexOf( 'data:' ) === 0 ) {\n\n\t\t\t\tthis.textureLoader.setPath( undefined );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet texture;\n\n\t\tconst extension = textureNode.FileName.slice( - 3 ).toLowerCase();\n\n\t\tif ( extension === 'tga' ) {\n\n\t\t\tconst loader = this.manager.getHandler( '.tga' );\n\n\t\t\tif ( loader === null ) {\n\n\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\t\ttexture = new Texture();\n\n\t\t\t} else {\n\n\t\t\t\tloader.setPath( this.textureLoader.path );\n\t\t\t\ttexture = loader.load( fileName );\n\n\t\t\t}\n\n\t\t} else if ( extension === 'psd' ) {\n\n\t\t\tconsole.warn( 'FBXLoader: PSD textures are not supported, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\ttexture = new Texture();\n\n\t\t} else {\n\n\t\t\ttexture = this.textureLoader.load( fileName );\n\n\t\t}\n\n\t\tthis.textureLoader.setPath( currentPath );\n\n\t\treturn texture;\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Material\n\tparseMaterials( textureMap ) {\n\n\t\tconst materialMap = new Map();\n\n\t\tif ( 'Material' in fbxTree.Objects ) {\n\n\t\t\tconst materialNodes = fbxTree.Objects.Material;\n\n\t\t\tfor ( const nodeID in materialNodes ) {\n\n\t\t\t\tconst material = this.parseMaterial( materialNodes[ nodeID ], textureMap );\n\n\t\t\t\tif ( material !== null ) materialMap.set( parseInt( nodeID ), material );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materialMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Material\n\t// Materials are connected to texture maps in FBXTree.Objects.Textures\n\t// FBX format currently only supports Lambert and Phong shading models\n\tparseMaterial( materialNode, textureMap ) {\n\n\t\tconst ID = materialNode.id;\n\t\tconst name = materialNode.attrName;\n\t\tlet type = materialNode.ShadingModel;\n\n\t\t// Case where FBX wraps shading model in property object.\n\t\tif ( typeof type === 'object' ) {\n\n\t\t\ttype = type.value;\n\n\t\t}\n\n\t\t// Ignore unused materials which don't have any connections.\n\t\tif ( ! connections.has( ID ) ) return null;\n\n\t\tconst parameters = this.parseParameters( materialNode, textureMap, ID );\n\n\t\tlet material;\n\n\t\tswitch ( type.toLowerCase() ) {\n\n\t\t\tcase 'phong':\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\t\t\tcase 'lambert':\n\t\t\t\tmaterial = new MeshLambertMaterial();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: unknown material type \"%s\". Defaulting to MeshPhongMaterial.', type );\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tmaterial.setValues( parameters );\n\t\tmaterial.name = name;\n\n\t\treturn material;\n\n\t}\n\n\t// Parse FBX material and return parameters suitable for a three.js material\n\t// Also parse the texture map and return any textures associated with the material\n\tparseParameters( materialNode, textureMap, ID ) {\n\n\t\tconst parameters = {};\n\n\t\tif ( materialNode.BumpFactor ) {\n\n\t\t\tparameters.bumpScale = materialNode.BumpFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Diffuse ) {\n\n\t\t\tparameters.color = new Color().fromArray( materialNode.Diffuse.value );\n\n\t\t} else if ( materialNode.DiffuseColor && ( materialNode.DiffuseColor.type === 'Color' || materialNode.DiffuseColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports diffuse here instead of in materialNode.Diffuse\n\t\t\tparameters.color = new Color().fromArray( materialNode.DiffuseColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.DisplacementFactor ) {\n\n\t\t\tparameters.displacementScale = materialNode.DisplacementFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Emissive ) {\n\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.Emissive.value );\n\n\t\t} else if ( materialNode.EmissiveColor && ( materialNode.EmissiveColor.type === 'Color' || materialNode.EmissiveColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports emissive color here instead of in materialNode.Emissive\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.EmissiveColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.EmissiveFactor ) {\n\n\t\t\tparameters.emissiveIntensity = parseFloat( materialNode.EmissiveFactor.value );\n\n\t\t}\n\n\t\tif ( materialNode.Opacity ) {\n\n\t\t\tparameters.opacity = parseFloat( materialNode.Opacity.value );\n\n\t\t}\n\n\t\tif ( parameters.opacity < 1.0 ) {\n\n\t\t\tparameters.transparent = true;\n\n\t\t}\n\n\t\tif ( materialNode.ReflectionFactor ) {\n\n\t\t\tparameters.reflectivity = materialNode.ReflectionFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Shininess ) {\n\n\t\t\tparameters.shininess = materialNode.Shininess.value;\n\n\t\t}\n\n\t\tif ( materialNode.Specular ) {\n\n\t\t\tparameters.specular = new Color().fromArray( materialNode.Specular.value );\n\n\t\t} else if ( materialNode.SpecularColor && materialNode.SpecularColor.type === 'Color' ) {\n\n\t\t\t// The blender exporter exports specular color here instead of in materialNode.Specular\n\t\t\tparameters.specular = new Color().fromArray( materialNode.SpecularColor.value );\n\n\t\t}\n\n\t\tconst scope = this;\n\t\tconnections.get( ID ).children.forEach( function ( child ) {\n\n\t\t\tconst type = child.relationship;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'Bump':\n\t\t\t\t\tparameters.bumpMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Maya|TEX_ao_map':\n\t\t\t\t\tparameters.aoMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DiffuseColor':\n\t\t\t\tcase 'Maya|TEX_color_map':\n\t\t\t\t\tparameters.map = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.map !== undefined ) {\n\n\t\t\t\t\t\tparameters.map.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DisplacementColor':\n\t\t\t\t\tparameters.displacementMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'EmissiveColor':\n\t\t\t\t\tparameters.emissiveMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.emissiveMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'NormalMap':\n\t\t\t\tcase 'Maya|TEX_normal_map':\n\t\t\t\t\tparameters.normalMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ReflectionColor':\n\t\t\t\t\tparameters.envMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.envMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.envMap.mapping = EquirectangularReflectionMapping;\n\t\t\t\t\t\tparameters.envMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpecularColor':\n\t\t\t\t\tparameters.specularMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.specularMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.specularMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'TransparentColor':\n\t\t\t\tcase 'TransparencyFactor':\n\t\t\t\t\tparameters.alphaMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.transparent = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'AmbientColor':\n\t\t\t\tcase 'ShininessExponent': // AKA glossiness map\n\t\t\t\tcase 'SpecularFactor': // AKA specularLevel\n\t\t\t\tcase 'VectorDisplacementColor': // NOTE: Seems to be a copy of DisplacementColor\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: %s map is not supported in three.js, skipping texture.', type );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn parameters;\n\n\t}\n\n\t// get a texture from the textureMap for use by a material.\n\tgetTexture( textureMap, id ) {\n\n\t\t// if the texture is a layered texture, just use the first layer and issue a warning\n\t\tif ( 'LayeredTexture' in fbxTree.Objects && id in fbxTree.Objects.LayeredTexture ) {\n\n\t\t\tconsole.warn( 'THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.' );\n\t\t\tid = connections.get( id ).children[ 0 ].ID;\n\n\t\t}\n\n\t\treturn textureMap.get( id );\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Deformer\n\t// Deformer node can contain skinning or Vertex Cache animation data, however only skinning is supported here\n\t// Generates map of Skeleton-like objects for use later when generating and binding skeletons.\n\tparseDeformers() {\n\n\t\tconst skeletons = {};\n\t\tconst morphTargets = {};\n\n\t\tif ( 'Deformer' in fbxTree.Objects ) {\n\n\t\t\tconst DeformerNodes = fbxTree.Objects.Deformer;\n\n\t\t\tfor ( const nodeID in DeformerNodes ) {\n\n\t\t\t\tconst deformerNode = DeformerNodes[ nodeID ];\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\n\t\t\t\tif ( deformerNode.attrType === 'Skin' ) {\n\n\t\t\t\t\tconst skeleton = this.parseSkeleton( relationships, DeformerNodes );\n\t\t\t\t\tskeleton.ID = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: skeleton attached to more than one geometry is not supported.' );\n\t\t\t\t\tskeleton.geometryID = relationships.parents[ 0 ].ID;\n\n\t\t\t\t\tskeletons[ nodeID ] = skeleton;\n\n\t\t\t\t} else if ( deformerNode.attrType === 'BlendShape' ) {\n\n\t\t\t\t\tconst morphTarget = {\n\t\t\t\t\t\tid: nodeID,\n\t\t\t\t\t};\n\n\t\t\t\t\tmorphTarget.rawTargets = this.parseMorphTargets( relationships, DeformerNodes );\n\t\t\t\t\tmorphTarget.id = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: morph target attached to more than one geometry is not supported.' );\n\n\t\t\t\t\tmorphTargets[ nodeID ] = morphTarget;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tskeletons: skeletons,\n\t\t\tmorphTargets: morphTargets,\n\n\t\t};\n\n\t}\n\n\t// Parse single nodes in FBXTree.Objects.Deformer\n\t// The top level skeleton node has type 'Skin' and sub nodes have type 'Cluster'\n\t// Each skin node represents a skeleton and each cluster node represents a bone\n\tparseSkeleton( relationships, deformerNodes ) {\n\n\t\tconst rawBones = [];\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst boneNode = deformerNodes[ child.ID ];\n\n\t\t\tif ( boneNode.attrType !== 'Cluster' ) return;\n\n\t\t\tconst rawBone = {\n\n\t\t\t\tID: child.ID,\n\t\t\t\tindices: [],\n\t\t\t\tweights: [],\n\t\t\t\ttransformLink: new Matrix4().fromArray( boneNode.TransformLink.a ),\n\t\t\t\t// transform: new Matrix4().fromArray( boneNode.Transform.a ),\n\t\t\t\t// linkMode: boneNode.Mode,\n\n\t\t\t};\n\n\t\t\tif ( 'Indexes' in boneNode ) {\n\n\t\t\t\trawBone.indices = boneNode.Indexes.a;\n\t\t\t\trawBone.weights = boneNode.Weights.a;\n\n\t\t\t}\n\n\t\t\trawBones.push( rawBone );\n\n\t\t} );\n\n\t\treturn {\n\n\t\t\trawBones: rawBones,\n\t\t\tbones: []\n\n\t\t};\n\n\t}\n\n\t// The top level morph deformer node has type \"BlendShape\" and sub nodes have type \"BlendShapeChannel\"\n\tparseMorphTargets( relationships, deformerNodes ) {\n\n\t\tconst rawMorphTargets = [];\n\n\t\tfor ( let i = 0; i < relationships.children.length; i ++ ) {\n\n\t\t\tconst child = relationships.children[ i ];\n\n\t\t\tconst morphTargetNode = deformerNodes[ child.ID ];\n\n\t\t\tconst rawMorphTarget = {\n\n\t\t\t\tname: morphTargetNode.attrName,\n\t\t\t\tinitialWeight: morphTargetNode.DeformPercent,\n\t\t\t\tid: morphTargetNode.id,\n\t\t\t\tfullWeights: morphTargetNode.FullWeights.a\n\n\t\t\t};\n\n\t\t\tif ( morphTargetNode.attrType !== 'BlendShapeChannel' ) return;\n\n\t\t\trawMorphTarget.geoID = connections.get( parseInt( child.ID ) ).children.filter( function ( child ) {\n\n\t\t\t\treturn child.relationship === undefined;\n\n\t\t\t} )[ 0 ].ID;\n\n\t\t\trawMorphTargets.push( rawMorphTarget );\n\n\t\t}\n\n\t\treturn rawMorphTargets;\n\n\t}\n\n\t// create the main Group() to be returned by the loader\n\tparseScene( deformers, geometryMap, materialMap ) {\n\n\t\tsceneGraph = new Group();\n\n\t\tconst modelMap = this.parseModels( deformers.skeletons, geometryMap, materialMap );\n\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tconst scope = this;\n\t\tmodelMap.forEach( function ( model ) {\n\n\t\t\tconst modelNode = modelNodes[ model.ID ];\n\t\t\tscope.setLookAtProperties( model, modelNode );\n\n\t\t\tconst parentConnections = connections.get( model.ID ).parents;\n\n\t\t\tparentConnections.forEach( function ( connection ) {\n\n\t\t\t\tconst parent = modelMap.get( connection.ID );\n\t\t\t\tif ( parent !== undefined ) parent.add( model );\n\n\t\t\t} );\n\n\t\t\tif ( model.parent === null ) {\n\n\t\t\t\tsceneGraph.add( model );\n\n\t\t\t}\n\n\n\t\t} );\n\n\t\tthis.bindSkeleton( deformers.skeletons, geometryMap, modelMap );\n\n\t\tthis.createAmbientLight();\n\n\t\tsceneGraph.traverse( function ( node ) {\n\n\t\t\tif ( node.userData.transformData ) {\n\n\t\t\t\tif ( node.parent ) {\n\n\t\t\t\t\tnode.userData.transformData.parentMatrix = node.parent.matrix;\n\t\t\t\t\tnode.userData.transformData.parentMatrixWorld = node.parent.matrixWorld;\n\n\t\t\t\t}\n\n\t\t\t\tconst transform = generateTransform( node.userData.transformData );\n\n\t\t\t\tnode.applyMatrix4( transform );\n\t\t\t\tnode.updateWorldMatrix();\n\n\t\t\t}\n\n\t\t} );\n\n\t\tconst animations = new AnimationParser().parse();\n\n\t\t// if all the models where already combined in a single group, just return that\n\t\tif ( sceneGraph.children.length === 1 && sceneGraph.children[ 0 ].isGroup ) {\n\n\t\t\tsceneGraph.children[ 0 ].animations = animations;\n\t\t\tsceneGraph = sceneGraph.children[ 0 ];\n\n\t\t}\n\n\t\tsceneGraph.animations = animations;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.Model\n\tparseModels( skeletons, geometryMap, materialMap ) {\n\n\t\tconst modelMap = new Map();\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tfor ( const nodeID in modelNodes ) {\n\n\t\t\tconst id = parseInt( nodeID );\n\t\t\tconst node = modelNodes[ nodeID ];\n\t\t\tconst relationships = connections.get( id );\n\n\t\t\tlet model = this.buildSkeleton( relationships, skeletons, id, node.attrName );\n\n\t\t\tif ( ! model ) {\n\n\t\t\t\tswitch ( node.attrType ) {\n\n\t\t\t\t\tcase 'Camera':\n\t\t\t\t\t\tmodel = this.createCamera( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Light':\n\t\t\t\t\t\tmodel = this.createLight( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Mesh':\n\t\t\t\t\t\tmodel = this.createMesh( relationships, geometryMap, materialMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'NurbsCurve':\n\t\t\t\t\t\tmodel = this.createCurve( relationships, geometryMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'LimbNode':\n\t\t\t\t\tcase 'Root':\n\t\t\t\t\t\tmodel = new Bone();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Null':\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmodel = new Group();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tmodel.name = node.attrName ? PropertyBinding.sanitizeNodeName( node.attrName ) : '';\n\n\t\t\t\tmodel.ID = id;\n\n\t\t\t}\n\n\t\t\tthis.getTransformData( model, node );\n\t\t\tmodelMap.set( id, model );\n\n\t\t}\n\n\t\treturn modelMap;\n\n\t}\n\n\tbuildSkeleton( relationships, skeletons, id, name ) {\n\n\t\tlet bone = null;\n\n\t\trelationships.parents.forEach( function ( parent ) {\n\n\t\t\tfor ( const ID in skeletons ) {\n\n\t\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t\tif ( rawBone.ID === parent.ID ) {\n\n\t\t\t\t\t\tconst subBone = bone;\n\t\t\t\t\t\tbone = new Bone();\n\n\t\t\t\t\t\tbone.matrixWorld.copy( rawBone.transformLink );\n\n\t\t\t\t\t\t// set name and id here - otherwise in cases where \"subBone\" is created it will not have a name / id\n\n\t\t\t\t\t\tbone.name = name ? PropertyBinding.sanitizeNodeName( name ) : '';\n\t\t\t\t\t\tbone.ID = id;\n\n\t\t\t\t\t\tskeleton.bones[ i ] = bone;\n\n\t\t\t\t\t\t// In cases where a bone is shared between multiple meshes\n\t\t\t\t\t\t// duplicate the bone here and and it as a child of the first bone\n\t\t\t\t\t\tif ( subBone !== null ) {\n\n\t\t\t\t\t\t\tbone.add( subBone );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn bone;\n\n\t}\n\n\t// create a PerspectiveCamera or OrthographicCamera\n\tcreateCamera( relationships ) {\n\n\t\tlet model;\n\t\tlet cameraAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tcameraAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( cameraAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type = 0;\n\t\t\tif ( cameraAttribute.CameraProjectionType !== undefined && cameraAttribute.CameraProjectionType.value === 1 ) {\n\n\t\t\t\ttype = 1;\n\n\t\t\t}\n\n\t\t\tlet nearClippingPlane = 1;\n\t\t\tif ( cameraAttribute.NearPlane !== undefined ) {\n\n\t\t\t\tnearClippingPlane = cameraAttribute.NearPlane.value / 1000;\n\n\t\t\t}\n\n\t\t\tlet farClippingPlane = 1000;\n\t\t\tif ( cameraAttribute.FarPlane !== undefined ) {\n\n\t\t\t\tfarClippingPlane = cameraAttribute.FarPlane.value / 1000;\n\n\t\t\t}\n\n\n\t\t\tlet width = window.innerWidth;\n\t\t\tlet height = window.innerHeight;\n\n\t\t\tif ( cameraAttribute.AspectWidth !== undefined && cameraAttribute.AspectHeight !== undefined ) {\n\n\t\t\t\twidth = cameraAttribute.AspectWidth.value;\n\t\t\t\theight = cameraAttribute.AspectHeight.value;\n\n\t\t\t}\n\n\t\t\tconst aspect = width / height;\n\n\t\t\tlet fov = 45;\n\t\t\tif ( cameraAttribute.FieldOfView !== undefined ) {\n\n\t\t\t\tfov = cameraAttribute.FieldOfView.value;\n\n\t\t\t}\n\n\t\t\tconst focalLength = cameraAttribute.FocalLength ? cameraAttribute.FocalLength.value : null;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Perspective\n\t\t\t\t\tmodel = new PerspectiveCamera( fov, aspect, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tif ( focalLength !== null ) model.setFocalLength( focalLength );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Orthographic\n\t\t\t\t\tmodel = new OrthographicCamera( - width / 2, width / 2, height / 2, - height / 2, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown camera type ' + type + '.' );\n\t\t\t\t\tmodel = new Object3D();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\t// Create a DirectionalLight, PointLight or SpotLight\n\tcreateLight( relationships ) {\n\n\t\tlet model;\n\t\tlet lightAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tlightAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( lightAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type;\n\n\t\t\t// LightType can be undefined for Point lights\n\t\t\tif ( lightAttribute.LightType === undefined ) {\n\n\t\t\t\ttype = 0;\n\n\t\t\t} else {\n\n\t\t\t\ttype = lightAttribute.LightType.value;\n\n\t\t\t}\n\n\t\t\tlet color = 0xffffff;\n\n\t\t\tif ( lightAttribute.Color !== undefined ) {\n\n\t\t\t\tcolor = new Color().fromArray( lightAttribute.Color.value );\n\n\t\t\t}\n\n\t\t\tlet intensity = ( lightAttribute.Intensity === undefined ) ? 1 : lightAttribute.Intensity.value / 100;\n\n\t\t\t// light disabled\n\t\t\tif ( lightAttribute.CastLightOnObject !== undefined && lightAttribute.CastLightOnObject.value === 0 ) {\n\n\t\t\t\tintensity = 0;\n\n\t\t\t}\n\n\t\t\tlet distance = 0;\n\t\t\tif ( lightAttribute.FarAttenuationEnd !== undefined ) {\n\n\t\t\t\tif ( lightAttribute.EnableFarAttenuation !== undefined && lightAttribute.EnableFarAttenuation.value === 0 ) {\n\n\t\t\t\t\tdistance = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdistance = lightAttribute.FarAttenuationEnd.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// TODO: could this be calculated linearly from FarAttenuationStart to FarAttenuationEnd?\n\t\t\tconst decay = 1;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Point\n\t\t\t\t\tmodel = new PointLight( color, intensity, distance, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Directional\n\t\t\t\t\tmodel = new DirectionalLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2: // Spot\n\t\t\t\t\tlet angle = Math.PI / 3;\n\n\t\t\t\t\tif ( lightAttribute.InnerAngle !== undefined ) {\n\n\t\t\t\t\t\tangle = MathUtils.degToRad( lightAttribute.InnerAngle.value );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet penumbra = 0;\n\t\t\t\t\tif ( lightAttribute.OuterAngle !== undefined ) {\n\n\t\t\t\t\t\t// TODO: this is not correct - FBX calculates outer and inner angle in degrees\n\t\t\t\t\t\t// with OuterAngle > InnerAngle && OuterAngle <= Math.PI\n\t\t\t\t\t\t// while three.js uses a penumbra between (0, 1) to attenuate the inner angle\n\t\t\t\t\t\tpenumbra = MathUtils.degToRad( lightAttribute.OuterAngle.value );\n\t\t\t\t\t\tpenumbra = Math.max( penumbra, 1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmodel = new SpotLight( color, intensity, distance, angle, penumbra, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown light type ' + lightAttribute.LightType.value + ', defaulting to a PointLight.' );\n\t\t\t\t\tmodel = new PointLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( lightAttribute.CastShadows !== undefined && lightAttribute.CastShadows.value === 1 ) {\n\n\t\t\t\tmodel.castShadow = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateMesh( relationships, geometryMap, materialMap ) {\n\n\t\tlet model;\n\t\tlet geometry = null;\n\t\tlet material = null;\n\t\tconst materials = [];\n\n\t\t// get geometry and materials(s) from connections\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) {\n\n\t\t\t\tgeometry = geometryMap.get( child.ID );\n\n\t\t\t}\n\n\t\t\tif ( materialMap.has( child.ID ) ) {\n\n\t\t\t\tmaterials.push( materialMap.get( child.ID ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( materials.length > 1 ) {\n\n\t\t\tmaterial = materials;\n\n\t\t} else if ( materials.length > 0 ) {\n\n\t\t\tmaterial = materials[ 0 ];\n\n\t\t} else {\n\n\t\t\tmaterial = new MeshPhongMaterial( { color: 0xcccccc } );\n\t\t\tmaterials.push( material );\n\n\t\t}\n\n\t\tif ( 'color' in geometry.attributes ) {\n\n\t\t\tmaterials.forEach( function ( material ) {\n\n\t\t\t\tmaterial.vertexColors = true;\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( geometry.FBX_Deformer ) {\n\n\t\t\tmodel = new SkinnedMesh( geometry, material );\n\t\t\tmodel.normalizeSkinWeights();\n\n\t\t} else {\n\n\t\t\tmodel = new Mesh( geometry, material );\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateCurve( relationships, geometryMap ) {\n\n\t\tconst geometry = relationships.children.reduce( function ( geo, child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) geo = geometryMap.get( child.ID );\n\n\t\t\treturn geo;\n\n\t\t}, null );\n\n\t\t// FBX does not list materials for Nurbs lines, so we'll just put our own in here.\n\t\tconst material = new LineBasicMaterial( { color: 0x3300ff, linewidth: 1 } );\n\t\treturn new Line( geometry, material );\n\n\t}\n\n\t// parse the model node for transform data\n\tgetTransformData( model, modelNode ) {\n\n\t\tconst transformData = {};\n\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\telse transformData.eulerOrder = 'ZYX';\n\n\t\tif ( 'Lcl_Translation' in modelNode ) transformData.translation = modelNode.Lcl_Translation.value;\n\n\t\tif ( 'PreRotation' in modelNode ) transformData.preRotation = modelNode.PreRotation.value;\n\t\tif ( 'Lcl_Rotation' in modelNode ) transformData.rotation = modelNode.Lcl_Rotation.value;\n\t\tif ( 'PostRotation' in modelNode ) transformData.postRotation = modelNode.PostRotation.value;\n\n\t\tif ( 'Lcl_Scaling' in modelNode ) transformData.scale = modelNode.Lcl_Scaling.value;\n\n\t\tif ( 'ScalingOffset' in modelNode ) transformData.scalingOffset = modelNode.ScalingOffset.value;\n\t\tif ( 'ScalingPivot' in modelNode ) transformData.scalingPivot = modelNode.ScalingPivot.value;\n\n\t\tif ( 'RotationOffset' in modelNode ) transformData.rotationOffset = modelNode.RotationOffset.value;\n\t\tif ( 'RotationPivot' in modelNode ) transformData.rotationPivot = modelNode.RotationPivot.value;\n\n\t\tmodel.userData.transformData = transformData;\n\n\t}\n\n\tsetLookAtProperties( model, modelNode ) {\n\n\t\tif ( 'LookAtProperty' in modelNode ) {\n\n\t\t\tconst children = connections.get( model.ID ).children;\n\n\t\t\tchildren.forEach( function ( child ) {\n\n\t\t\t\tif ( child.relationship === 'LookAtProperty' ) {\n\n\t\t\t\t\tconst lookAtTarget = fbxTree.Objects.Model[ child.ID ];\n\n\t\t\t\t\tif ( 'Lcl_Translation' in lookAtTarget ) {\n\n\t\t\t\t\t\tconst pos = lookAtTarget.Lcl_Translation.value;\n\n\t\t\t\t\t\t// DirectionalLight, SpotLight\n\t\t\t\t\t\tif ( model.target !== undefined ) {\n\n\t\t\t\t\t\t\tmodel.target.position.fromArray( pos );\n\t\t\t\t\t\t\tsceneGraph.add( model.target );\n\n\t\t\t\t\t\t} else { // Cameras and other Object3Ds\n\n\t\t\t\t\t\t\tmodel.lookAt( new Vector3().fromArray( pos ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tbindSkeleton( skeletons, geometryMap, modelMap ) {\n\n\t\tconst bindMatrices = this.parsePoseNodes();\n\n\t\tfor ( const ID in skeletons ) {\n\n\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\tconst parents = connections.get( parseInt( skeleton.ID ) ).parents;\n\n\t\t\tparents.forEach( function ( parent ) {\n\n\t\t\t\tif ( geometryMap.has( parent.ID ) ) {\n\n\t\t\t\t\tconst geoID = parent.ID;\n\t\t\t\t\tconst geoRelationships = connections.get( geoID );\n\n\t\t\t\t\tgeoRelationships.parents.forEach( function ( geoConnParent ) {\n\n\t\t\t\t\t\tif ( modelMap.has( geoConnParent.ID ) ) {\n\n\t\t\t\t\t\t\tconst model = modelMap.get( geoConnParent.ID );\n\n\t\t\t\t\t\t\tmodel.bind( new Skeleton( skeleton.bones ), bindMatrices[ geoConnParent.ID ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tparsePoseNodes() {\n\n\t\tconst bindMatrices = {};\n\n\t\tif ( 'Pose' in fbxTree.Objects ) {\n\n\t\t\tconst BindPoseNode = fbxTree.Objects.Pose;\n\n\t\t\tfor ( const nodeID in BindPoseNode ) {\n\n\t\t\t\tif ( BindPoseNode[ nodeID ].attrType === 'BindPose' && BindPoseNode[ nodeID ].NbPoseNodes > 0 ) {\n\n\t\t\t\t\tconst poseNodes = BindPoseNode[ nodeID ].PoseNode;\n\n\t\t\t\t\tif ( Array.isArray( poseNodes ) ) {\n\n\t\t\t\t\t\tposeNodes.forEach( function ( poseNode ) {\n\n\t\t\t\t\t\t\tbindMatrices[ poseNode.Node ] = new Matrix4().fromArray( poseNode.Matrix.a );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbindMatrices[ poseNodes.Node ] = new Matrix4().fromArray( poseNodes.Matrix.a );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindMatrices;\n\n\t}\n\n\t// Parse ambient color in FBXTree.GlobalSettings - if it's not set to black (default), create an ambient light\n\tcreateAmbientLight() {\n\n\t\tif ( 'GlobalSettings' in fbxTree && 'AmbientColor' in fbxTree.GlobalSettings ) {\n\n\t\t\tconst ambientColor = fbxTree.GlobalSettings.AmbientColor.value;\n\t\t\tconst r = ambientColor[ 0 ];\n\t\t\tconst g = ambientColor[ 1 ];\n\t\t\tconst b = ambientColor[ 2 ];\n\n\t\t\tif ( r !== 0 || g !== 0 || b !== 0 ) {\n\n\t\t\t\tconst color = new Color( r, g, b );\n\t\t\t\tsceneGraph.add( new AmbientLight( color, 1 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse Geometry data from FBXTree and return map of BufferGeometries\nclass GeometryParser {\n\n\t// Parse nodes in FBXTree.Objects.Geometry\n\tparse( deformers ) {\n\n\t\tconst geometryMap = new Map();\n\n\t\tif ( 'Geometry' in fbxTree.Objects ) {\n\n\t\t\tconst geoNodes = fbxTree.Objects.Geometry;\n\n\t\t\tfor ( const nodeID in geoNodes ) {\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\t\t\t\tconst geo = this.parseGeometry( relationships, geoNodes[ nodeID ], deformers );\n\n\t\t\t\tgeometryMap.set( parseInt( nodeID ), geo );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometryMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Geometry\n\tparseGeometry( relationships, geoNode, deformers ) {\n\n\t\tswitch ( geoNode.attrType ) {\n\n\t\t\tcase 'Mesh':\n\t\t\t\treturn this.parseMeshGeometry( relationships, geoNode, deformers );\n\t\t\t\tbreak;\n\n\t\t\tcase 'NurbsCurve':\n\t\t\t\treturn this.parseNurbsGeometry( geoNode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\t// Parse single node mesh geometry in FBXTree.Objects.Geometry\n\tparseMeshGeometry( relationships, geoNode, deformers ) {\n\n\t\tconst skeletons = deformers.skeletons;\n\t\tconst morphTargets = [];\n\n\t\tconst modelNodes = relationships.parents.map( function ( parent ) {\n\n\t\t\treturn fbxTree.Objects.Model[ parent.ID ];\n\n\t\t} );\n\n\t\t// don't create geometry if it is not associated with any models\n\t\tif ( modelNodes.length === 0 ) return;\n\n\t\tconst skeleton = relationships.children.reduce( function ( skeleton, child ) {\n\n\t\t\tif ( skeletons[ child.ID ] !== undefined ) skeleton = skeletons[ child.ID ];\n\n\t\t\treturn skeleton;\n\n\t\t}, null );\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( deformers.morphTargets[ child.ID ] !== undefined ) {\n\n\t\t\t\tmorphTargets.push( deformers.morphTargets[ child.ID ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\t// Assume one model and get the preRotation from that\n\t\t// if there is more than one model associated with the geometry this may cause problems\n\t\tconst modelNode = modelNodes[ 0 ];\n\n\t\tconst transformData = {};\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'GeometricTranslation' in modelNode ) transformData.translation = modelNode.GeometricTranslation.value;\n\t\tif ( 'GeometricRotation' in modelNode ) transformData.rotation = modelNode.GeometricRotation.value;\n\t\tif ( 'GeometricScaling' in modelNode ) transformData.scale = modelNode.GeometricScaling.value;\n\n\t\tconst transform = generateTransform( transformData );\n\n\t\treturn this.genGeometry( geoNode, skeleton, morphTargets, transform );\n\n\t}\n\n\t// Generate a BufferGeometry from a node in FBXTree.Objects.Geometry\n\tgenGeometry( geoNode, skeleton, morphTargets, preTransform ) {\n\n\t\tconst geo = new BufferGeometry();\n\t\tif ( geoNode.attrName ) geo.name = geoNode.attrName;\n\n\t\tconst geoInfo = this.parseGeoNode( geoNode, skeleton );\n\t\tconst buffers = this.genBuffers( geoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( buffers.vertex, 3 );\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tgeo.setAttribute( 'position', positionAttribute );\n\n\t\tif ( buffers.colors.length > 0 ) {\n\n\t\t\tgeo.setAttribute( 'color', new Float32BufferAttribute( buffers.colors, 3 ) );\n\n\t\t}\n\n\t\tif ( skeleton ) {\n\n\t\t\tgeo.setAttribute( 'skinIndex', new Uint16BufferAttribute( buffers.weightsIndices, 4 ) );\n\n\t\t\tgeo.setAttribute( 'skinWeight', new Float32BufferAttribute( buffers.vertexWeights, 4 ) );\n\n\t\t\t// used later to bind the skeleton to the model\n\t\t\tgeo.FBX_Deformer = skeleton;\n\n\t\t}\n\n\t\tif ( buffers.normal.length > 0 ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( preTransform );\n\n\t\t\tconst normalAttribute = new Float32BufferAttribute( buffers.normal, 3 );\n\t\t\tnormalAttribute.applyNormalMatrix( normalMatrix );\n\n\t\t\tgeo.setAttribute( 'normal', normalAttribute );\n\n\t\t}\n\n\t\tbuffers.uvs.forEach( function ( uvBuffer, i ) {\n\n\t\t\t// subsequent uv buffers are called 'uv1', 'uv2', ...\n\t\t\tlet name = 'uv' + ( i + 1 ).toString();\n\n\t\t\t// the first uv buffer is just called 'uv'\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tname = 'uv';\n\n\t\t\t}\n\n\t\t\tgeo.setAttribute( name, new Float32BufferAttribute( buffers.uvs[ i ], 2 ) );\n\n\t\t} );\n\n\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t// Convert the material indices of each vertex into rendering groups on the geometry.\n\t\t\tlet prevMaterialIndex = buffers.materialIndex[ 0 ];\n\t\t\tlet startIndex = 0;\n\n\t\t\tbuffers.materialIndex.forEach( function ( currentIndex, i ) {\n\n\t\t\t\tif ( currentIndex !== prevMaterialIndex ) {\n\n\t\t\t\t\tgeo.addGroup( startIndex, i - startIndex, prevMaterialIndex );\n\n\t\t\t\t\tprevMaterialIndex = currentIndex;\n\t\t\t\t\tstartIndex = i;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t// the loop above doesn't add the last group, do that here.\n\t\t\tif ( geo.groups.length > 0 ) {\n\n\t\t\t\tconst lastGroup = geo.groups[ geo.groups.length - 1 ];\n\t\t\t\tconst lastIndex = lastGroup.start + lastGroup.count;\n\n\t\t\t\tif ( lastIndex !== buffers.materialIndex.length ) {\n\n\t\t\t\t\tgeo.addGroup( lastIndex, buffers.materialIndex.length - lastIndex, prevMaterialIndex );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// case where there are multiple materials but the whole geometry is only\n\t\t\t// using one of them\n\t\t\tif ( geo.groups.length === 0 ) {\n\n\t\t\t\tgeo.addGroup( 0, buffers.materialIndex.length, buffers.materialIndex[ 0 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.addMorphTargets( geo, geoNode, morphTargets, preTransform );\n\n\t\treturn geo;\n\n\t}\n\n\tparseGeoNode( geoNode, skeleton ) {\n\n\t\tconst geoInfo = {};\n\n\t\tgeoInfo.vertexPositions = ( geoNode.Vertices !== undefined ) ? geoNode.Vertices.a : [];\n\t\tgeoInfo.vertexIndices = ( geoNode.PolygonVertexIndex !== undefined ) ? geoNode.PolygonVertexIndex.a : [];\n\n\t\tif ( geoNode.LayerElementColor ) {\n\n\t\t\tgeoInfo.color = this.parseVertexColors( geoNode.LayerElementColor[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementMaterial ) {\n\n\t\t\tgeoInfo.material = this.parseMaterialIndices( geoNode.LayerElementMaterial[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementNormal ) {\n\n\t\t\tgeoInfo.normal = this.parseNormals( geoNode.LayerElementNormal[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementUV ) {\n\n\t\t\tgeoInfo.uv = [];\n\n\t\t\tlet i = 0;\n\t\t\twhile ( geoNode.LayerElementUV[ i ] ) {\n\n\t\t\t\tif ( geoNode.LayerElementUV[ i ].UV ) {\n\n\t\t\t\t\tgeoInfo.uv.push( this.parseUVs( geoNode.LayerElementUV[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeoInfo.weightTable = {};\n\n\t\tif ( skeleton !== null ) {\n\n\t\t\tgeoInfo.skeleton = skeleton;\n\n\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t// loop over the bone's vertex indices and weights\n\t\t\t\trawBone.indices.forEach( function ( index, j ) {\n\n\t\t\t\t\tif ( geoInfo.weightTable[ index ] === undefined ) geoInfo.weightTable[ index ] = [];\n\n\t\t\t\t\tgeoInfo.weightTable[ index ].push( {\n\n\t\t\t\t\t\tid: i,\n\t\t\t\t\t\tweight: rawBone.weights[ j ],\n\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn geoInfo;\n\n\t}\n\n\tgenBuffers( geoInfo ) {\n\n\t\tconst buffers = {\n\t\t\tvertex: [],\n\t\t\tnormal: [],\n\t\t\tcolors: [],\n\t\t\tuvs: [],\n\t\t\tmaterialIndex: [],\n\t\t\tvertexWeights: [],\n\t\t\tweightsIndices: [],\n\t\t};\n\n\t\tlet polygonIndex = 0;\n\t\tlet faceLength = 0;\n\t\tlet displayedWeightsWarning = false;\n\n\t\t// these will hold data for a single face\n\t\tlet facePositionIndexes = [];\n\t\tlet faceNormals = [];\n\t\tlet faceColors = [];\n\t\tlet faceUVs = [];\n\t\tlet faceWeights = [];\n\t\tlet faceWeightIndices = [];\n\n\t\tconst scope = this;\n\t\tgeoInfo.vertexIndices.forEach( function ( vertexIndex, polygonVertexIndex ) {\n\n\t\t\tlet materialIndex;\n\t\t\tlet endOfFace = false;\n\n\t\t\t// Face index and vertex index arrays are combined in a single array\n\t\t\t// A cube with quad faces looks like this:\n\t\t\t// PolygonVertexIndex: *24 {\n\t\t\t//  a: 0, 1, 3, -3, 2, 3, 5, -5, 4, 5, 7, -7, 6, 7, 1, -1, 1, 7, 5, -4, 6, 0, 2, -5\n\t\t\t//  }\n\t\t\t// Negative numbers mark the end of a face - first face here is 0, 1, 3, -3\n\t\t\t// to find index of last vertex bit shift the index: ^ - 1\n\t\t\tif ( vertexIndex < 0 ) {\n\n\t\t\t\tvertexIndex = vertexIndex ^ - 1; // equivalent to ( x * -1 ) - 1\n\t\t\t\tendOfFace = true;\n\n\t\t\t}\n\n\t\t\tlet weightIndices = [];\n\t\t\tlet weights = [];\n\n\t\t\tfacePositionIndexes.push( vertexIndex * 3, vertexIndex * 3 + 1, vertexIndex * 3 + 2 );\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.color );\n\n\t\t\t\tfaceColors.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tif ( geoInfo.weightTable[ vertexIndex ] !== undefined ) {\n\n\t\t\t\t\tgeoInfo.weightTable[ vertexIndex ].forEach( function ( wt ) {\n\n\t\t\t\t\t\tweights.push( wt.weight );\n\t\t\t\t\t\tweightIndices.push( wt.id );\n\n\t\t\t\t\t} );\n\n\n\t\t\t\t}\n\n\t\t\t\tif ( weights.length > 4 ) {\n\n\t\t\t\t\tif ( ! displayedWeightsWarning ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.' );\n\t\t\t\t\t\tdisplayedWeightsWarning = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst wIndex = [ 0, 0, 0, 0 ];\n\t\t\t\t\tconst Weight = [ 0, 0, 0, 0 ];\n\n\t\t\t\t\tweights.forEach( function ( weight, weightIndex ) {\n\n\t\t\t\t\t\tlet currentWeight = weight;\n\t\t\t\t\t\tlet currentIndex = weightIndices[ weightIndex ];\n\n\t\t\t\t\t\tWeight.forEach( function ( comparedWeight, comparedWeightIndex, comparedWeightArray ) {\n\n\t\t\t\t\t\t\tif ( currentWeight > comparedWeight ) {\n\n\t\t\t\t\t\t\t\tcomparedWeightArray[ comparedWeightIndex ] = currentWeight;\n\t\t\t\t\t\t\t\tcurrentWeight = comparedWeight;\n\n\t\t\t\t\t\t\t\tconst tmp = wIndex[ comparedWeightIndex ];\n\t\t\t\t\t\t\t\twIndex[ comparedWeightIndex ] = currentIndex;\n\t\t\t\t\t\t\t\tcurrentIndex = tmp;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tweightIndices = wIndex;\n\t\t\t\t\tweights = Weight;\n\n\t\t\t\t}\n\n\t\t\t\t// if the weight array is shorter than 4 pad with 0s\n\t\t\t\twhile ( weights.length < 4 ) {\n\n\t\t\t\t\tweights.push( 0 );\n\t\t\t\t\tweightIndices.push( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < 4; ++ i ) {\n\n\t\t\t\t\tfaceWeights.push( weights[ i ] );\n\t\t\t\t\tfaceWeightIndices.push( weightIndices[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.normal );\n\n\t\t\t\tfaceNormals.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tmaterialIndex = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.material )[ 0 ];\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, i ) {\n\n\t\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, uv );\n\n\t\t\t\t\tif ( faceUVs[ i ] === undefined ) {\n\n\t\t\t\t\t\tfaceUVs[ i ] = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfaceUVs[ i ].push( data[ 0 ] );\n\t\t\t\t\tfaceUVs[ i ].push( data[ 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfaceLength ++;\n\n\t\t\tif ( endOfFace ) {\n\n\t\t\t\tscope.genFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength );\n\n\t\t\t\tpolygonIndex ++;\n\t\t\t\tfaceLength = 0;\n\n\t\t\t\t// reset arrays for the next face\n\t\t\t\tfacePositionIndexes = [];\n\t\t\t\tfaceNormals = [];\n\t\t\t\tfaceColors = [];\n\t\t\t\tfaceUVs = [];\n\t\t\t\tfaceWeights = [];\n\t\t\t\tfaceWeightIndices = [];\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn buffers;\n\n\t}\n\n\t// Generate data for a single face in a geometry. If the face is a quad then split it into 2 tris\n\tgenFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength ) {\n\n\t\tfor ( let i = 2; i < faceLength; i ++ ) {\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 0 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 2 ] ] );\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 0 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 0 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 3 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tbuffers.colors.push( faceColors[ 0 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tbuffers.normal.push( faceNormals[ 0 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, j ) {\n\n\t\t\t\t\tif ( buffers.uvs[ j ] === undefined ) buffers.uvs[ j ] = [];\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 0 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 + 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 + 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\taddMorphTargets( parentGeo, parentGeoNode, morphTargets, preTransform ) {\n\n\t\tif ( morphTargets.length === 0 ) return;\n\n\t\tparentGeo.morphTargetsRelative = true;\n\n\t\tparentGeo.morphAttributes.position = [];\n\t\t// parentGeo.morphAttributes.normal = []; // not implemented\n\n\t\tconst scope = this;\n\t\tmorphTargets.forEach( function ( morphTarget ) {\n\n\t\t\tmorphTarget.rawTargets.forEach( function ( rawTarget ) {\n\n\t\t\t\tconst morphGeoNode = fbxTree.Objects.Geometry[ rawTarget.geoID ];\n\n\t\t\t\tif ( morphGeoNode !== undefined ) {\n\n\t\t\t\t\tscope.genMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, rawTarget.name );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t// a morph geometry node is similar to a standard  node, and the node is also contained\n\t// in FBXTree.Objects.Geometry, however it can only have attributes for position, normal\n\t// and a special attribute Index defining which vertices of the original geometry are affected\n\t// Normal and position attributes only have data for the vertices that are affected by the morph\n\tgenMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, name ) {\n\n\t\tconst vertexIndices = ( parentGeoNode.PolygonVertexIndex !== undefined ) ? parentGeoNode.PolygonVertexIndex.a : [];\n\n\t\tconst morphPositionsSparse = ( morphGeoNode.Vertices !== undefined ) ? morphGeoNode.Vertices.a : [];\n\t\tconst indices = ( morphGeoNode.Indexes !== undefined ) ? morphGeoNode.Indexes.a : [];\n\n\t\tconst length = parentGeo.attributes.position.count * 3;\n\t\tconst morphPositions = new Float32Array( length );\n\n\t\tfor ( let i = 0; i < indices.length; i ++ ) {\n\n\t\t\tconst morphIndex = indices[ i ] * 3;\n\n\t\t\tmorphPositions[ morphIndex ] = morphPositionsSparse[ i * 3 ];\n\t\t\tmorphPositions[ morphIndex + 1 ] = morphPositionsSparse[ i * 3 + 1 ];\n\t\t\tmorphPositions[ morphIndex + 2 ] = morphPositionsSparse[ i * 3 + 2 ];\n\n\t\t}\n\n\t\t// TODO: add morph normal support\n\t\tconst morphGeoInfo = {\n\t\t\tvertexIndices: vertexIndices,\n\t\t\tvertexPositions: morphPositions,\n\n\t\t};\n\n\t\tconst morphBuffers = this.genBuffers( morphGeoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( morphBuffers.vertex, 3 );\n\t\tpositionAttribute.name = name || morphGeoNode.attrName;\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tparentGeo.morphAttributes.position.push( positionAttribute );\n\n\t}\n\n\t// Parse normal from FBXTree.Objects.Geometry.LayerElementNormal if it exists\n\tparseNormals( NormalNode ) {\n\n\t\tconst mappingType = NormalNode.MappingInformationType;\n\t\tconst referenceType = NormalNode.ReferenceInformationType;\n\t\tconst buffer = NormalNode.Normals.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tif ( 'NormalIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalIndex.a;\n\n\t\t\t} else if ( 'NormalsIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalsIndex.a;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 3,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse UVs from FBXTree.Objects.Geometry.LayerElementUV if it exists\n\tparseUVs( UVNode ) {\n\n\t\tconst mappingType = UVNode.MappingInformationType;\n\t\tconst referenceType = UVNode.ReferenceInformationType;\n\t\tconst buffer = UVNode.UV.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = UVNode.UVIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 2,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse Vertex Colors from FBXTree.Objects.Geometry.LayerElementColor if it exists\n\tparseVertexColors( ColorNode ) {\n\n\t\tconst mappingType = ColorNode.MappingInformationType;\n\t\tconst referenceType = ColorNode.ReferenceInformationType;\n\t\tconst buffer = ColorNode.Colors.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = ColorNode.ColorIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 4,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse mapping and material data in FBXTree.Objects.Geometry.LayerElementMaterial if it exists\n\tparseMaterialIndices( MaterialNode ) {\n\n\t\tconst mappingType = MaterialNode.MappingInformationType;\n\t\tconst referenceType = MaterialNode.ReferenceInformationType;\n\n\t\tif ( mappingType === 'NoMappingInformation' ) {\n\n\t\t\treturn {\n\t\t\t\tdataSize: 1,\n\t\t\t\tbuffer: [ 0 ],\n\t\t\t\tindices: [ 0 ],\n\t\t\t\tmappingType: 'AllSame',\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t}\n\n\t\tconst materialIndexBuffer = MaterialNode.Materials.a;\n\n\t\t// Since materials are stored as indices, there's a bit of a mismatch between FBX and what\n\t\t// we expect.So we create an intermediate buffer that points to the index in the buffer,\n\t\t// for conforming with the other functions we've written for other data.\n\t\tconst materialIndices = [];\n\n\t\tfor ( let i = 0; i < materialIndexBuffer.length; ++ i ) {\n\n\t\t\tmaterialIndices.push( i );\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 1,\n\t\t\tbuffer: materialIndexBuffer,\n\t\t\tindices: materialIndices,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Generate a NurbGeometry from a node in FBXTree.Objects.Geometry\n\tparseNurbsGeometry( geoNode ) {\n\n\t\tif ( NURBSCurve === undefined ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry.' );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst order = parseInt( geoNode.Order );\n\n\t\tif ( isNaN( order ) ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: Invalid Order %s given for geometry ID: %s', geoNode.Order, geoNode.id );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst degree = order - 1;\n\n\t\tconst knots = geoNode.KnotVector.a;\n\t\tconst controlPoints = [];\n\t\tconst pointsValues = geoNode.Points.a;\n\n\t\tfor ( let i = 0, l = pointsValues.length; i < l; i += 4 ) {\n\n\t\t\tcontrolPoints.push( new Vector4().fromArray( pointsValues, i ) );\n\n\t\t}\n\n\t\tlet startKnot, endKnot;\n\n\t\tif ( geoNode.Form === 'Closed' ) {\n\n\t\t\tcontrolPoints.push( controlPoints[ 0 ] );\n\n\t\t} else if ( geoNode.Form === 'Periodic' ) {\n\n\t\t\tstartKnot = degree;\n\t\t\tendKnot = knots.length - 1 - startKnot;\n\n\t\t\tfor ( let i = 0; i < degree; ++ i ) {\n\n\t\t\t\tcontrolPoints.push( controlPoints[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst curve = new NURBSCurve( degree, knots, controlPoints, startKnot, endKnot );\n\t\tconst points = curve.getPoints( controlPoints.length * 12 );\n\n\t\treturn new BufferGeometry().setFromPoints( points );\n\n\t}\n\n}\n\n// parse animation data from FBXTree\nclass AnimationParser {\n\n\t// take raw animation clips and turn them into three.js animation clips\n\tparse() {\n\n\t\tconst animationClips = [];\n\n\t\tconst rawClips = this.parseClips();\n\n\t\tif ( rawClips !== undefined ) {\n\n\t\t\tfor ( const key in rawClips ) {\n\n\t\t\t\tconst rawClip = rawClips[ key ];\n\n\t\t\t\tconst clip = this.addClip( rawClip );\n\n\t\t\t\tanimationClips.push( clip );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animationClips;\n\n\t}\n\n\tparseClips() {\n\n\t\t// since the actual transformation data is stored in FBXTree.Objects.AnimationCurve,\n\t\t// if this is undefined we can safely assume there are no animations\n\t\tif ( fbxTree.Objects.AnimationCurve === undefined ) return undefined;\n\n\t\tconst curveNodesMap = this.parseAnimationCurveNodes();\n\n\t\tthis.parseAnimationCurves( curveNodesMap );\n\n\t\tconst layersMap = this.parseAnimationLayers( curveNodesMap );\n\t\tconst rawClips = this.parseAnimStacks( layersMap );\n\n\t\treturn rawClips;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurveNode\n\t// each AnimationCurveNode holds data for an animation transform for a model (e.g. left arm rotation )\n\t// and is referenced by an AnimationLayer\n\tparseAnimationCurveNodes() {\n\n\t\tconst rawCurveNodes = fbxTree.Objects.AnimationCurveNode;\n\n\t\tconst curveNodesMap = new Map();\n\n\t\tfor ( const nodeID in rawCurveNodes ) {\n\n\t\t\tconst rawCurveNode = rawCurveNodes[ nodeID ];\n\n\t\t\tif ( rawCurveNode.attrName.match( /S|R|T|DeformPercent/ ) !== null ) {\n\n\t\t\t\tconst curveNode = {\n\n\t\t\t\t\tid: rawCurveNode.id,\n\t\t\t\t\tattr: rawCurveNode.attrName,\n\t\t\t\t\tcurves: {},\n\n\t\t\t\t};\n\n\t\t\t\tcurveNodesMap.set( curveNode.id, curveNode );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn curveNodesMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurve and connect them up to\n\t// previously parsed AnimationCurveNodes. Each AnimationCurve holds data for a single animated\n\t// axis ( e.g. times and values of x rotation)\n\tparseAnimationCurves( curveNodesMap ) {\n\n\t\tconst rawCurves = fbxTree.Objects.AnimationCurve;\n\n\t\t// TODO: Many values are identical up to roundoff error, but won't be optimised\n\t\t// e.g. position times: [0, 0.4, 0. 8]\n\t\t// position values: [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.235384487103147e-7, 93.67520904541016, -0.9982695579528809]\n\t\t// clearly, this should be optimised to\n\t\t// times: [0], positions [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809]\n\t\t// this shows up in nearly every FBX file, and generally time array is length > 100\n\n\t\tfor ( const nodeID in rawCurves ) {\n\n\t\t\tconst animationCurve = {\n\n\t\t\t\tid: rawCurves[ nodeID ].id,\n\t\t\t\ttimes: rawCurves[ nodeID ].KeyTime.a.map( convertFBXTimeToSeconds ),\n\t\t\t\tvalues: rawCurves[ nodeID ].KeyValueFloat.a,\n\n\t\t\t};\n\n\t\t\tconst relationships = connections.get( animationCurve.id );\n\n\t\t\tif ( relationships !== undefined ) {\n\n\t\t\t\tconst animationCurveID = relationships.parents[ 0 ].ID;\n\t\t\t\tconst animationCurveRelationship = relationships.parents[ 0 ].relationship;\n\n\t\t\t\tif ( animationCurveRelationship.match( /X/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'x' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Y/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'y' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Z/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'z' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /d|DeformPercent/ ) && curveNodesMap.has( animationCurveID ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'morph' ] = animationCurve;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationLayer. Each layers holds references\n\t// to various AnimationCurveNodes and is referenced by an AnimationStack node\n\t// note: theoretically a stack can have multiple layers, however in practice there always seems to be one per stack\n\tparseAnimationLayers( curveNodesMap ) {\n\n\t\tconst rawLayers = fbxTree.Objects.AnimationLayer;\n\n\t\tconst layersMap = new Map();\n\n\t\tfor ( const nodeID in rawLayers ) {\n\n\t\t\tconst layerCurveNodes = [];\n\n\t\t\tconst connection = connections.get( parseInt( nodeID ) );\n\n\t\t\tif ( connection !== undefined ) {\n\n\t\t\t\t// all the animationCurveNodes used in the layer\n\t\t\t\tconst children = connection.children;\n\n\t\t\t\tchildren.forEach( function ( child, i ) {\n\n\t\t\t\t\tif ( curveNodesMap.has( child.ID ) ) {\n\n\t\t\t\t\t\tconst curveNode = curveNodesMap.get( child.ID );\n\n\t\t\t\t\t\t// check that the curves are defined for at least one axis, otherwise ignore the curveNode\n\t\t\t\t\t\tif ( curveNode.curves.x !== undefined || curveNode.curves.y !== undefined || curveNode.curves.z !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst modelID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tif ( modelID !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID.toString() ];\n\n\t\t\t\t\t\t\t\t\tif ( rawModel === undefined ) {\n\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered a unused curve.', child );\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\t\tID: rawModel.id,\n\t\t\t\t\t\t\t\t\t\tinitialPosition: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialRotation: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialScale: [ 1, 1, 1 ],\n\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( child.ID === rawModel.id ) {\n\n\t\t\t\t\t\t\t\t\t\t\tnode.transform = child.matrix;\n\n\t\t\t\t\t\t\t\t\t\t\tif ( child.userData.transformData ) node.eulerOrder = child.userData.transformData.eulerOrder;\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\tif ( ! node.transform ) node.transform = new Matrix4();\n\n\t\t\t\t\t\t\t\t\t// if the animated model is pre rotated, we'll have to apply the pre rotations to every\n\t\t\t\t\t\t\t\t\t// animation value as well\n\t\t\t\t\t\t\t\t\tif ( 'PreRotation' in rawModel ) node.preRotation = rawModel.PreRotation.value;\n\t\t\t\t\t\t\t\t\tif ( 'PostRotation' in rawModel ) node.postRotation = rawModel.PostRotation.value;\n\n\t\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] ) layerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t} else if ( curveNode.curves.morph !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst deformerID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst morpherID = connections.get( deformerID ).parents[ 0 ].ID;\n\t\t\t\t\t\t\t\tconst geoID = connections.get( morpherID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\t// assuming geometry is not used in more than one model\n\t\t\t\t\t\t\t\tconst modelID = connections.get( geoID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID ];\n\n\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\tmorphName: fbxTree.Objects.Deformer[ deformerID ].attrName,\n\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlayerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tlayersMap.set( parseInt( nodeID ), layerCurveNodes );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn layersMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationStack. These are the top level node in the animation\n\t// hierarchy. Each Stack node will be used to create a AnimationClip\n\tparseAnimStacks( layersMap ) {\n\n\t\tconst rawStacks = fbxTree.Objects.AnimationStack;\n\n\t\t// connect the stacks (clips) up to the layers\n\t\tconst rawClips = {};\n\n\t\tfor ( const nodeID in rawStacks ) {\n\n\t\t\tconst children = connections.get( parseInt( nodeID ) ).children;\n\n\t\t\tif ( children.length > 1 ) {\n\n\t\t\t\t// it seems like stacks will always be associated with a single layer. But just in case there are files\n\t\t\t\t// where there are multiple layers per stack, we'll display a warning\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.' );\n\n\t\t\t}\n\n\t\t\tconst layer = layersMap.get( children[ 0 ].ID );\n\n\t\t\trawClips[ nodeID ] = {\n\n\t\t\t\tname: rawStacks[ nodeID ].attrName,\n\t\t\t\tlayer: layer,\n\n\t\t\t};\n\n\t\t}\n\n\t\treturn rawClips;\n\n\t}\n\n\taddClip( rawClip ) {\n\n\t\tlet tracks = [];\n\n\t\tconst scope = this;\n\t\trawClip.layer.forEach( function ( rawTracks ) {\n\n\t\t\ttracks = tracks.concat( scope.generateTracks( rawTracks ) );\n\n\t\t} );\n\n\t\treturn new AnimationClip( rawClip.name, - 1, tracks );\n\n\t}\n\n\tgenerateTracks( rawTracks ) {\n\n\t\tconst tracks = [];\n\n\t\tlet initialPosition = new Vector3();\n\t\tlet initialRotation = new Quaternion();\n\t\tlet initialScale = new Vector3();\n\n\t\tif ( rawTracks.transform ) rawTracks.transform.decompose( initialPosition, initialRotation, initialScale );\n\n\t\tinitialPosition = initialPosition.toArray();\n\t\tinitialRotation = new Euler().setFromQuaternion( initialRotation, rawTracks.eulerOrder ).toArray();\n\t\tinitialScale = initialScale.toArray();\n\n\t\tif ( rawTracks.T !== undefined && Object.keys( rawTracks.T.curves ).length > 0 ) {\n\n\t\t\tconst positionTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.T.curves, initialPosition, 'position' );\n\t\t\tif ( positionTrack !== undefined ) tracks.push( positionTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.R !== undefined && Object.keys( rawTracks.R.curves ).length > 0 ) {\n\n\t\t\tconst rotationTrack = this.generateRotationTrack( rawTracks.modelName, rawTracks.R.curves, initialRotation, rawTracks.preRotation, rawTracks.postRotation, rawTracks.eulerOrder );\n\t\t\tif ( rotationTrack !== undefined ) tracks.push( rotationTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.S !== undefined && Object.keys( rawTracks.S.curves ).length > 0 ) {\n\n\t\t\tconst scaleTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.S.curves, initialScale, 'scale' );\n\t\t\tif ( scaleTrack !== undefined ) tracks.push( scaleTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.DeformPercent !== undefined ) {\n\n\t\t\tconst morphTrack = this.generateMorphTrack( rawTracks );\n\t\t\tif ( morphTrack !== undefined ) tracks.push( morphTrack );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\tgenerateVectorTrack( modelName, curves, initialValue, type ) {\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\treturn new VectorKeyframeTrack( modelName + '.' + type, times, values );\n\n\t}\n\n\tgenerateRotationTrack( modelName, curves, initialValue, preRotation, postRotation, eulerOrder ) {\n\n\t\tif ( curves.x !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.x );\n\t\t\tcurves.x.values = curves.x.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.y !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.y );\n\t\t\tcurves.y.values = curves.y.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.z !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.z );\n\t\t\tcurves.z.values = curves.z.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\tif ( preRotation !== undefined ) {\n\n\t\t\tpreRotation = preRotation.map( MathUtils.degToRad );\n\t\t\tpreRotation.push( eulerOrder );\n\n\t\t\tpreRotation = new Euler().fromArray( preRotation );\n\t\t\tpreRotation = new Quaternion().setFromEuler( preRotation );\n\n\t\t}\n\n\t\tif ( postRotation !== undefined ) {\n\n\t\t\tpostRotation = postRotation.map( MathUtils.degToRad );\n\t\t\tpostRotation.push( eulerOrder );\n\n\t\t\tpostRotation = new Euler().fromArray( postRotation );\n\t\t\tpostRotation = new Quaternion().setFromEuler( postRotation ).invert();\n\n\t\t}\n\n\t\tconst quaternion = new Quaternion();\n\t\tconst euler = new Euler();\n\n\t\tconst quaternionValues = [];\n\n\t\tfor ( let i = 0; i < values.length; i += 3 ) {\n\n\t\t\teuler.set( values[ i ], values[ i + 1 ], values[ i + 2 ], eulerOrder );\n\n\t\t\tquaternion.setFromEuler( euler );\n\n\t\t\tif ( preRotation !== undefined ) quaternion.premultiply( preRotation );\n\t\t\tif ( postRotation !== undefined ) quaternion.multiply( postRotation );\n\n\t\t\tquaternion.toArray( quaternionValues, ( i / 3 ) * 4 );\n\n\t\t}\n\n\t\treturn new QuaternionKeyframeTrack( modelName + '.quaternion', times, quaternionValues );\n\n\t}\n\n\tgenerateMorphTrack( rawTracks ) {\n\n\t\tconst curves = rawTracks.DeformPercent.curves.morph;\n\t\tconst values = curves.values.map( function ( val ) {\n\n\t\t\treturn val / 100;\n\n\t\t} );\n\n\t\tconst morphNum = sceneGraph.getObjectByName( rawTracks.modelName ).morphTargetDictionary[ rawTracks.morphName ];\n\n\t\treturn new NumberKeyframeTrack( rawTracks.modelName + '.morphTargetInfluences[' + morphNum + ']', curves.times, values );\n\n\t}\n\n\t// For all animated objects, times are defined separately for each axis\n\t// Here we'll combine the times into one sorted array without duplicates\n\tgetTimesForAllAxes( curves ) {\n\n\t\tlet times = [];\n\n\t\t// first join together the times for each axis, if defined\n\t\tif ( curves.x !== undefined ) times = times.concat( curves.x.times );\n\t\tif ( curves.y !== undefined ) times = times.concat( curves.y.times );\n\t\tif ( curves.z !== undefined ) times = times.concat( curves.z.times );\n\n\t\t// then sort them\n\t\ttimes = times.sort( function ( a, b ) {\n\n\t\t\treturn a - b;\n\n\t\t} );\n\n\t\t// and remove duplicates\n\t\tif ( times.length > 1 ) {\n\n\t\t\tlet targetIndex = 1;\n\t\t\tlet lastValue = times[ 0 ];\n\t\t\tfor ( let i = 1; i < times.length; i ++ ) {\n\n\t\t\t\tconst currentValue = times[ i ];\n\t\t\t\tif ( currentValue !== lastValue ) {\n\n\t\t\t\t\ttimes[ targetIndex ] = currentValue;\n\t\t\t\t\tlastValue = currentValue;\n\t\t\t\t\ttargetIndex ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttimes = times.slice( 0, targetIndex );\n\n\t\t}\n\n\t\treturn times;\n\n\t}\n\n\tgetKeyframeTrackValues( times, curves, initialValue ) {\n\n\t\tconst prevValue = initialValue;\n\n\t\tconst values = [];\n\n\t\tlet xIndex = - 1;\n\t\tlet yIndex = - 1;\n\t\tlet zIndex = - 1;\n\n\t\ttimes.forEach( function ( time ) {\n\n\t\t\tif ( curves.x ) xIndex = curves.x.times.indexOf( time );\n\t\t\tif ( curves.y ) yIndex = curves.y.times.indexOf( time );\n\t\t\tif ( curves.z ) zIndex = curves.z.times.indexOf( time );\n\n\t\t\t// if there is an x value defined for this frame, use that\n\t\t\tif ( xIndex !== - 1 ) {\n\n\t\t\t\tconst xValue = curves.x.values[ xIndex ];\n\t\t\t\tvalues.push( xValue );\n\t\t\t\tprevValue[ 0 ] = xValue;\n\n\t\t\t} else {\n\n\t\t\t\t// otherwise use the x value from the previous frame\n\t\t\t\tvalues.push( prevValue[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( yIndex !== - 1 ) {\n\n\t\t\t\tconst yValue = curves.y.values[ yIndex ];\n\t\t\t\tvalues.push( yValue );\n\t\t\t\tprevValue[ 1 ] = yValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 1 ] );\n\n\t\t\t}\n\n\t\t\tif ( zIndex !== - 1 ) {\n\n\t\t\t\tconst zValue = curves.z.values[ zIndex ];\n\t\t\t\tvalues.push( zValue );\n\t\t\t\tprevValue[ 2 ] = zValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 2 ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn values;\n\n\t}\n\n\t// Rotations are defined as Euler angles which can have values  of any size\n\t// These will be converted to quaternions which don't support values greater than\n\t// PI, so we'll interpolate large rotations\n\tinterpolateRotations( curve ) {\n\n\t\tfor ( let i = 1; i < curve.values.length; i ++ ) {\n\n\t\t\tconst initialValue = curve.values[ i - 1 ];\n\t\t\tconst valuesSpan = curve.values[ i ] - initialValue;\n\n\t\t\tconst absoluteSpan = Math.abs( valuesSpan );\n\n\t\t\tif ( absoluteSpan >= 180 ) {\n\n\t\t\t\tconst numSubIntervals = absoluteSpan / 180;\n\n\t\t\t\tconst step = valuesSpan / numSubIntervals;\n\t\t\t\tlet nextValue = initialValue + step;\n\n\t\t\t\tconst initialTime = curve.times[ i - 1 ];\n\t\t\t\tconst timeSpan = curve.times[ i ] - initialTime;\n\t\t\t\tconst interval = timeSpan / numSubIntervals;\n\t\t\t\tlet nextTime = initialTime + interval;\n\n\t\t\t\tconst interpolatedTimes = [];\n\t\t\t\tconst interpolatedValues = [];\n\n\t\t\t\twhile ( nextTime < curve.times[ i ] ) {\n\n\t\t\t\t\tinterpolatedTimes.push( nextTime );\n\t\t\t\t\tnextTime += interval;\n\n\t\t\t\t\tinterpolatedValues.push( nextValue );\n\t\t\t\t\tnextValue += step;\n\n\t\t\t\t}\n\n\t\t\t\tcurve.times = inject( curve.times, i, interpolatedTimes );\n\t\t\t\tcurve.values = inject( curve.values, i, interpolatedValues );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse an FBX file in ASCII format\nclass TextParser {\n\n\tgetPrevNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 2 ];\n\n\t}\n\n\tgetCurrentNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 1 ];\n\n\t}\n\n\tgetCurrentProp() {\n\n\t\treturn this.currentProp;\n\n\t}\n\n\tpushStack( node ) {\n\n\t\tthis.nodeStack.push( node );\n\t\tthis.currentIndent += 1;\n\n\t}\n\n\tpopStack() {\n\n\t\tthis.nodeStack.pop();\n\t\tthis.currentIndent -= 1;\n\n\t}\n\n\tsetCurrentProp( val, name ) {\n\n\t\tthis.currentProp = val;\n\t\tthis.currentPropName = name;\n\n\t}\n\n\tparse( text ) {\n\n\t\tthis.currentIndent = 0;\n\n\t\tthis.allNodes = new FBXTree();\n\t\tthis.nodeStack = [];\n\t\tthis.currentProp = [];\n\t\tthis.currentPropName = '';\n\n\t\tconst scope = this;\n\n\t\tconst split = text.split( /[\\r\\n]+/ );\n\n\t\tsplit.forEach( function ( line, i ) {\n\n\t\t\tconst matchComment = line.match( /^[\\s\\t]*;/ );\n\t\t\tconst matchEmpty = line.match( /^[\\s\\t]*$/ );\n\n\t\t\tif ( matchComment || matchEmpty ) return;\n\n\t\t\tconst matchBeginning = line.match( '^\\\\t{' + scope.currentIndent + '}(\\\\w+):(.*){', '' );\n\t\t\tconst matchProperty = line.match( '^\\\\t{' + ( scope.currentIndent ) + '}(\\\\w+):[\\\\s\\\\t\\\\r\\\\n](.*)' );\n\t\t\tconst matchEnd = line.match( '^\\\\t{' + ( scope.currentIndent - 1 ) + '}}' );\n\n\t\t\tif ( matchBeginning ) {\n\n\t\t\t\tscope.parseNodeBegin( line, matchBeginning );\n\n\t\t\t} else if ( matchProperty ) {\n\n\t\t\t\tscope.parseNodeProperty( line, matchProperty, split[ ++ i ] );\n\n\t\t\t} else if ( matchEnd ) {\n\n\t\t\t\tscope.popStack();\n\n\t\t\t} else if ( line.match( /^[^\\s\\t}]/ ) ) {\n\n\t\t\t\t// large arrays are split over multiple lines terminated with a ',' character\n\t\t\t\t// if this is encountered the line needs to be joined to the previous line\n\t\t\t\tscope.parseNodePropertyContinued( line );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn this.allNodes;\n\n\t}\n\n\tparseNodeBegin( line, property ) {\n\n\t\tconst nodeName = property[ 1 ].trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\tconst nodeAttrs = property[ 2 ].split( ',' ).map( function ( attr ) {\n\n\t\t\treturn attr.trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\t} );\n\n\t\tconst node = { name: nodeName };\n\t\tconst attrs = this.parseNodeAttr( nodeAttrs );\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\t// a top node\n\t\tif ( this.currentIndent === 0 ) {\n\n\t\t\tthis.allNodes.add( nodeName, node );\n\n\t\t} else { // a subnode\n\n\t\t\t// if the subnode already exists, append it\n\t\t\tif ( nodeName in currentNode ) {\n\n\t\t\t\t// special case Pose needs PoseNodes as an array\n\t\t\t\tif ( nodeName === 'PoseNode' ) {\n\n\t\t\t\t\tcurrentNode.PoseNode.push( node );\n\n\t\t\t\t} else if ( currentNode[ nodeName ].id !== undefined ) {\n\n\t\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\t\tcurrentNode[ nodeName ][ currentNode[ nodeName ].id ] = currentNode[ nodeName ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( attrs.id !== '' ) currentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( typeof attrs.id === 'number' ) {\n\n\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\tcurrentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( nodeName !== 'Properties70' ) {\n\n\t\t\t\tif ( nodeName === 'PoseNode' )\tcurrentNode[ nodeName ] = [ node ];\n\t\t\t\telse currentNode[ nodeName ] = node;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( typeof attrs.id === 'number' ) node.id = attrs.id;\n\t\tif ( attrs.name !== '' ) node.attrName = attrs.name;\n\t\tif ( attrs.type !== '' ) node.attrType = attrs.type;\n\n\t\tthis.pushStack( node );\n\n\t}\n\n\tparseNodeAttr( attrs ) {\n\n\t\tlet id = attrs[ 0 ];\n\n\t\tif ( attrs[ 0 ] !== '' ) {\n\n\t\t\tid = parseInt( attrs[ 0 ] );\n\n\t\t\tif ( isNaN( id ) ) {\n\n\t\t\t\tid = attrs[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet name = '', type = '';\n\n\t\tif ( attrs.length > 1 ) {\n\n\t\t\tname = attrs[ 1 ].replace( /^(\\w+)::/, '' );\n\t\t\ttype = attrs[ 2 ];\n\n\t\t}\n\n\t\treturn { id: id, name: name, type: type };\n\n\t}\n\n\tparseNodeProperty( line, property, contentLine ) {\n\n\t\tlet propName = property[ 1 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\t\tlet propValue = property[ 2 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\n\t\t// for special case: base64 image data follows \"Content: ,\" line\n\t\t//\tContent: ,\n\t\t//\t \"/9j/4RDaRXhpZgAATU0A...\"\n\t\tif ( propName === 'Content' && propValue === ',' ) {\n\n\t\t\tpropValue = contentLine.replace( /\"/g, '' ).replace( /,$/, '' ).trim();\n\n\t\t}\n\n\t\tconst currentNode = this.getCurrentNode();\n\t\tconst parentName = currentNode.name;\n\n\t\tif ( parentName === 'Properties70' ) {\n\n\t\t\tthis.parseNodeSpecialProperty( line, propName, propValue );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Connections\n\t\tif ( propName === 'C' ) {\n\n\t\t\tconst connProps = propValue.split( ',' ).slice( 1 );\n\t\t\tconst from = parseInt( connProps[ 0 ] );\n\t\t\tconst to = parseInt( connProps[ 1 ] );\n\n\t\t\tlet rest = propValue.split( ',' ).slice( 3 );\n\n\t\t\trest = rest.map( function ( elem ) {\n\n\t\t\t\treturn elem.trim().replace( /^\"/, '' );\n\n\t\t\t} );\n\n\t\t\tpropName = 'connections';\n\t\t\tpropValue = [ from, to ];\n\t\t\tappend( propValue, rest );\n\n\t\t\tif ( currentNode[ propName ] === undefined ) {\n\n\t\t\t\tcurrentNode[ propName ] = [];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Node\n\t\tif ( propName === 'Node' ) currentNode.id = propValue;\n\n\t\t// connections\n\t\tif ( propName in currentNode && Array.isArray( currentNode[ propName ] ) ) {\n\n\t\t\tcurrentNode[ propName ].push( propValue );\n\n\t\t} else {\n\n\t\t\tif ( propName !== 'a' ) currentNode[ propName ] = propValue;\n\t\t\telse currentNode.a = propValue;\n\n\t\t}\n\n\t\tthis.setCurrentProp( currentNode, propName );\n\n\t\t// convert string to array, unless it ends in ',' in which case more will be added to it\n\t\tif ( propName === 'a' && propValue.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( propValue );\n\n\t\t}\n\n\t}\n\n\tparseNodePropertyContinued( line ) {\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\tcurrentNode.a += line;\n\n\t\t// if the line doesn't end in ',' we have reached the end of the property value\n\t\t// so convert the string to an array\n\t\tif ( line.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( currentNode.a );\n\n\t\t}\n\n\t}\n\n\t// parse \"Property70\"\n\tparseNodeSpecialProperty( line, propName, propValue ) {\n\n\t\t// split this\n\t\t// P: \"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\",1,1,1\n\t\t// into array like below\n\t\t// [\"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\", \"1,1,1\" ]\n\t\tconst props = propValue.split( '\",' ).map( function ( prop ) {\n\n\t\t\treturn prop.trim().replace( /^\\\"/, '' ).replace( /\\s/, '_' );\n\n\t\t} );\n\n\t\tconst innerPropName = props[ 0 ];\n\t\tconst innerPropType1 = props[ 1 ];\n\t\tconst innerPropType2 = props[ 2 ];\n\t\tconst innerPropFlag = props[ 3 ];\n\t\tlet innerPropValue = props[ 4 ];\n\n\t\t// cast values where needed, otherwise leave as strings\n\t\tswitch ( innerPropType1 ) {\n\n\t\t\tcase 'int':\n\t\t\tcase 'enum':\n\t\t\tcase 'bool':\n\t\t\tcase 'ULongLong':\n\t\t\tcase 'double':\n\t\t\tcase 'Number':\n\t\t\tcase 'FieldOfView':\n\t\t\t\tinnerPropValue = parseFloat( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t\tcase 'Color':\n\t\t\tcase 'ColorRGB':\n\t\t\tcase 'Vector3D':\n\t\t\tcase 'Lcl_Translation':\n\t\t\tcase 'Lcl_Rotation':\n\t\t\tcase 'Lcl_Scaling':\n\t\t\t\tinnerPropValue = parseNumberArray( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t// CAUTION: these props must append to parent's parent\n\t\tthis.getPrevNode()[ innerPropName ] = {\n\n\t\t\t'type': innerPropType1,\n\t\t\t'type2': innerPropType2,\n\t\t\t'flag': innerPropFlag,\n\t\t\t'value': innerPropValue\n\n\t\t};\n\n\t\tthis.setCurrentProp( this.getPrevNode(), innerPropName );\n\n\t}\n\n}\n\n// Parse an FBX file in Binary format\nclass BinaryParser {\n\n\tparse( buffer ) {\n\n\t\tconst reader = new BinaryReader( buffer );\n\t\treader.skip( 23 ); // skip magic 23 bytes\n\n\t\tconst version = reader.getUint32();\n\n\t\tif ( version < 6400 ) {\n\n\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + version );\n\n\t\t}\n\n\t\tconst allNodes = new FBXTree();\n\n\t\twhile ( ! this.endOfContent( reader ) ) {\n\n\t\t\tconst node = this.parseNode( reader, version );\n\t\t\tif ( node !== null ) allNodes.add( node.name, node );\n\n\t\t}\n\n\t\treturn allNodes;\n\n\t}\n\n\t// Check if reader has reached the end of content.\n\tendOfContent( reader ) {\n\n\t\t// footer size: 160bytes + 16-byte alignment padding\n\t\t// - 16bytes: magic\n\t\t// - padding til 16-byte alignment (at least 1byte?)\n\t\t//\t(seems like some exporters embed fixed 15 or 16bytes?)\n\t\t// - 4bytes: magic\n\t\t// - 4bytes: version\n\t\t// - 120bytes: zero\n\t\t// - 16bytes: magic\n\t\tif ( reader.size() % 16 === 0 ) {\n\n\t\t\treturn ( ( reader.getOffset() + 160 + 16 ) & ~ 0xf ) >= reader.size();\n\n\t\t} else {\n\n\t\t\treturn reader.getOffset() + 160 + 16 >= reader.size();\n\n\t\t}\n\n\t}\n\n\t// recursively parse nodes until the end of the file is reached\n\tparseNode( reader, version ) {\n\n\t\tconst node = {};\n\n\t\t// The first three data sizes depends on version.\n\t\tconst endOffset = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\t\tconst numProperties = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\n\t\t( version >= 7500 ) ? reader.getUint64() : reader.getUint32(); // the returned propertyListLen is not used\n\n\t\tconst nameLen = reader.getUint8();\n\t\tconst name = reader.getString( nameLen );\n\n\t\t// Regards this node as NULL-record if endOffset is zero\n\t\tif ( endOffset === 0 ) return null;\n\n\t\tconst propertyList = [];\n\n\t\tfor ( let i = 0; i < numProperties; i ++ ) {\n\n\t\t\tpropertyList.push( this.parseProperty( reader ) );\n\n\t\t}\n\n\t\t// Regards the first three elements in propertyList as id, attrName, and attrType\n\t\tconst id = propertyList.length > 0 ? propertyList[ 0 ] : '';\n\t\tconst attrName = propertyList.length > 1 ? propertyList[ 1 ] : '';\n\t\tconst attrType = propertyList.length > 2 ? propertyList[ 2 ] : '';\n\n\t\t// check if this node represents just a single property\n\t\t// like (name, 0) set or (name2, [0, 1, 2]) set of {name: 0, name2: [0, 1, 2]}\n\t\tnode.singleProperty = ( numProperties === 1 && reader.getOffset() === endOffset ) ? true : false;\n\n\t\twhile ( endOffset > reader.getOffset() ) {\n\n\t\t\tconst subNode = this.parseNode( reader, version );\n\n\t\t\tif ( subNode !== null ) this.parseSubNode( name, node, subNode );\n\n\t\t}\n\n\t\tnode.propertyList = propertyList; // raw property list used by parent\n\n\t\tif ( typeof id === 'number' ) node.id = id;\n\t\tif ( attrName !== '' ) node.attrName = attrName;\n\t\tif ( attrType !== '' ) node.attrType = attrType;\n\t\tif ( name !== '' ) node.name = name;\n\n\t\treturn node;\n\n\t}\n\n\tparseSubNode( name, node, subNode ) {\n\n\t\t// special case: child node is single property\n\t\tif ( subNode.singleProperty === true ) {\n\n\t\t\tconst value = subNode.propertyList[ 0 ];\n\n\t\t\tif ( Array.isArray( value ) ) {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t\tsubNode.a = value;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = value;\n\n\t\t\t}\n\n\t\t} else if ( name === 'Connections' && subNode.name === 'C' ) {\n\n\t\t\tconst array = [];\n\n\t\t\tsubNode.propertyList.forEach( function ( property, i ) {\n\n\t\t\t\t// first Connection is FBX type (OO, OP, etc.). We'll discard these\n\t\t\t\tif ( i !== 0 ) array.push( property );\n\n\t\t\t} );\n\n\t\t\tif ( node.connections === undefined ) {\n\n\t\t\t\tnode.connections = [];\n\n\t\t\t}\n\n\t\t\tnode.connections.push( array );\n\n\t\t} else if ( subNode.name === 'Properties70' ) {\n\n\t\t\tconst keys = Object.keys( subNode );\n\n\t\t\tkeys.forEach( function ( key ) {\n\n\t\t\t\tnode[ key ] = subNode[ key ];\n\n\t\t\t} );\n\n\t\t} else if ( name === 'Properties70' && subNode.name === 'P' ) {\n\n\t\t\tlet innerPropName = subNode.propertyList[ 0 ];\n\t\t\tlet innerPropType1 = subNode.propertyList[ 1 ];\n\t\t\tconst innerPropType2 = subNode.propertyList[ 2 ];\n\t\t\tconst innerPropFlag = subNode.propertyList[ 3 ];\n\t\t\tlet innerPropValue;\n\n\t\t\tif ( innerPropName.indexOf( 'Lcl ' ) === 0 ) innerPropName = innerPropName.replace( 'Lcl ', 'Lcl_' );\n\t\t\tif ( innerPropType1.indexOf( 'Lcl ' ) === 0 ) innerPropType1 = innerPropType1.replace( 'Lcl ', 'Lcl_' );\n\n\t\t\tif ( innerPropType1 === 'Color' || innerPropType1 === 'ColorRGB' || innerPropType1 === 'Vector' || innerPropType1 === 'Vector3D' || innerPropType1.indexOf( 'Lcl_' ) === 0 ) {\n\n\t\t\t\tinnerPropValue = [\n\t\t\t\t\tsubNode.propertyList[ 4 ],\n\t\t\t\t\tsubNode.propertyList[ 5 ],\n\t\t\t\t\tsubNode.propertyList[ 6 ]\n\t\t\t\t];\n\n\t\t\t} else {\n\n\t\t\t\tinnerPropValue = subNode.propertyList[ 4 ];\n\n\t\t\t}\n\n\t\t\t// this will be copied to parent, see above\n\t\t\tnode[ innerPropName ] = {\n\n\t\t\t\t'type': innerPropType1,\n\t\t\t\t'type2': innerPropType2,\n\t\t\t\t'flag': innerPropFlag,\n\t\t\t\t'value': innerPropValue\n\n\t\t\t};\n\n\t\t} else if ( node[ subNode.name ] === undefined ) {\n\n\t\t\tif ( typeof subNode.id === 'number' ) {\n\n\t\t\t\tnode[ subNode.name ] = {};\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( subNode.name === 'PoseNode' ) {\n\n\t\t\t\tif ( ! Array.isArray( node[ subNode.name ] ) ) {\n\n\t\t\t\t\tnode[ subNode.name ] = [ node[ subNode.name ] ];\n\n\t\t\t\t}\n\n\t\t\t\tnode[ subNode.name ].push( subNode );\n\n\t\t\t} else if ( node[ subNode.name ][ subNode.id ] === undefined ) {\n\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tparseProperty( reader ) {\n\n\t\tconst type = reader.getString( 1 );\n\t\tlet length;\n\n\t\tswitch ( type ) {\n\n\t\t\tcase 'C':\n\t\t\t\treturn reader.getBoolean();\n\n\t\t\tcase 'D':\n\t\t\t\treturn reader.getFloat64();\n\n\t\t\tcase 'F':\n\t\t\t\treturn reader.getFloat32();\n\n\t\t\tcase 'I':\n\t\t\t\treturn reader.getInt32();\n\n\t\t\tcase 'L':\n\t\t\t\treturn reader.getInt64();\n\n\t\t\tcase 'R':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getArrayBuffer( length );\n\n\t\t\tcase 'S':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getString( length );\n\n\t\t\tcase 'Y':\n\t\t\t\treturn reader.getInt16();\n\n\t\t\tcase 'b':\n\t\t\tcase 'c':\n\t\t\tcase 'd':\n\t\t\tcase 'f':\n\t\t\tcase 'i':\n\t\t\tcase 'l':\n\n\t\t\t\tconst arrayLength = reader.getUint32();\n\t\t\t\tconst encoding = reader.getUint32(); // 0: non-compressed, 1: compressed\n\t\t\t\tconst compressedLength = reader.getUint32();\n\n\t\t\t\tif ( encoding === 0 ) {\n\n\t\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tcase 'c':\n\t\t\t\t\t\t\treturn reader.getBooleanArray( arrayLength );\n\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\treturn reader.getFloat64Array( arrayLength );\n\n\t\t\t\t\t\tcase 'f':\n\t\t\t\t\t\t\treturn reader.getFloat32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\treturn reader.getInt32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'l':\n\t\t\t\t\t\t\treturn reader.getInt64Array( arrayLength );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( typeof fflate === 'undefined' ) {\n\n\t\t\t\t\tconsole.error( 'THREE.FBXLoader: External library fflate.min.js required.' );\n\n\t\t\t\t}\n\n\t\t\t\tconst data = fflate.unzlibSync( new Uint8Array( reader.getArrayBuffer( compressedLength ) ) ); // eslint-disable-line no-undef\n\t\t\t\tconst reader2 = new BinaryReader( data.buffer );\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'b':\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\treturn reader2.getBooleanArray( arrayLength );\n\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\treturn reader2.getFloat64Array( arrayLength );\n\n\t\t\t\t\tcase 'f':\n\t\t\t\t\t\treturn reader2.getFloat32Array( arrayLength );\n\n\t\t\t\t\tcase 'i':\n\t\t\t\t\t\treturn reader2.getInt32Array( arrayLength );\n\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\treturn reader2.getInt64Array( arrayLength );\n\n\t\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown property type ' + type );\n\n\t\t}\n\n\t}\n\n}\n\nclass BinaryReader {\n\n\tconstructor( buffer, littleEndian ) {\n\n\t\tthis.dv = new DataView( buffer );\n\t\tthis.offset = 0;\n\t\tthis.littleEndian = ( littleEndian !== undefined ) ? littleEndian : true;\n\n\t}\n\n\tgetOffset() {\n\n\t\treturn this.offset;\n\n\t}\n\n\tsize() {\n\n\t\treturn this.dv.buffer.byteLength;\n\n\t}\n\n\tskip( length ) {\n\n\t\tthis.offset += length;\n\n\t}\n\n\t// seems like true/false representation depends on exporter.\n\t// true: 1 or 'Y'(=0x59), false: 0 or 'T'(=0x54)\n\t// then sees LSB.\n\tgetBoolean() {\n\n\t\treturn ( this.getUint8() & 1 ) === 1;\n\n\t}\n\n\tgetBooleanArray( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getBoolean() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint8() {\n\n\t\tconst value = this.dv.getUint8( this.offset );\n\t\tthis.offset += 1;\n\t\treturn value;\n\n\t}\n\n\tgetInt16() {\n\n\t\tconst value = this.dv.getInt16( this.offset, this.littleEndian );\n\t\tthis.offset += 2;\n\t\treturn value;\n\n\t}\n\n\tgetInt32() {\n\n\t\tconst value = this.dv.getInt32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetInt32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint32() {\n\n\t\tconst value = this.dv.getUint32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\t// JavaScript doesn't support 64-bit integer so calculate this here\n\t// 1 << 32 will return 1 so using multiply operation instead here.\n\t// There's a possibility that this method returns wrong value if the value\n\t// is out of the range between Number.MAX_SAFE_INTEGER and Number.MIN_SAFE_INTEGER.\n\t// TODO: safely handle 64-bit integer\n\tgetInt64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\t// calculate negative value\n\t\tif ( high & 0x80000000 ) {\n\n\t\t\thigh = ~ high & 0xFFFFFFFF;\n\t\t\tlow = ~ low & 0xFFFFFFFF;\n\n\t\t\tif ( low === 0xFFFFFFFF ) high = ( high + 1 ) & 0xFFFFFFFF;\n\n\t\t\tlow = ( low + 1 ) & 0xFFFFFFFF;\n\n\t\t\treturn - ( high * 0x100000000 + low );\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetInt64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\t// Note: see getInt64() comment\n\tgetUint64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetFloat32() {\n\n\t\tconst value = this.dv.getFloat32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetFloat32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetFloat64() {\n\n\t\tconst value = this.dv.getFloat64( this.offset, this.littleEndian );\n\t\tthis.offset += 8;\n\t\treturn value;\n\n\t}\n\n\tgetFloat64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetArrayBuffer( size ) {\n\n\t\tconst value = this.dv.buffer.slice( this.offset, this.offset + size );\n\t\tthis.offset += size;\n\t\treturn value;\n\n\t}\n\n\tgetString( size ) {\n\n\t\t// note: safari 9 doesn't support Uint8Array.indexOf; create intermediate array instead\n\t\tlet a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta[ i ] = this.getUint8();\n\n\t\t}\n\n\t\tconst nullByte = a.indexOf( 0 );\n\t\tif ( nullByte >= 0 ) a = a.slice( 0, nullByte );\n\n\t\treturn LoaderUtils.decodeText( new Uint8Array( a ) );\n\n\t}\n\n}\n\n// FBXTree holds a representation of the FBX data, returned by the TextParser ( FBX ASCII format)\n// and BinaryParser( FBX Binary format)\nclass FBXTree {\n\n\tadd( key, val ) {\n\n\t\tthis[ key ] = val;\n\n\t}\n\n}\n\n// ************** UTILITY FUNCTIONS **************\n\nfunction isFbxFormatBinary( buffer ) {\n\n\tconst CORRECT = 'Kaydara\\u0020FBX\\u0020Binary\\u0020\\u0020\\0';\n\n\treturn buffer.byteLength >= CORRECT.length && CORRECT === convertArrayBufferToString( buffer, 0, CORRECT.length );\n\n}\n\nfunction isFbxFormatASCII( text ) {\n\n\tconst CORRECT = [ 'K', 'a', 'y', 'd', 'a', 'r', 'a', '\\\\', 'F', 'B', 'X', '\\\\', 'B', 'i', 'n', 'a', 'r', 'y', '\\\\', '\\\\' ];\n\n\tlet cursor = 0;\n\n\tfunction read( offset ) {\n\n\t\tconst result = text[ offset - 1 ];\n\t\ttext = text.slice( cursor + offset );\n\t\tcursor ++;\n\t\treturn result;\n\n\t}\n\n\tfor ( let i = 0; i < CORRECT.length; ++ i ) {\n\n\t\tconst num = read( 1 );\n\t\tif ( num === CORRECT[ i ] ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nfunction getFbxVersion( text ) {\n\n\tconst versionRegExp = /FBXVersion: (\\d+)/;\n\tconst match = text.match( versionRegExp );\n\n\tif ( match ) {\n\n\t\tconst version = parseInt( match[ 1 ] );\n\t\treturn version;\n\n\t}\n\n\tthrow new Error( 'THREE.FBXLoader: Cannot find the version number for the file given.' );\n\n}\n\n// Converts FBX ticks into real time seconds.\nfunction convertFBXTimeToSeconds( time ) {\n\n\treturn time / 46186158000;\n\n}\n\nconst dataArray = [];\n\n// extracts the data from the correct position in the FBX array based on indexing type\nfunction getData( polygonVertexIndex, polygonIndex, vertexIndex, infoObject ) {\n\n\tlet index;\n\n\tswitch ( infoObject.mappingType ) {\n\n\t\tcase 'ByPolygonVertex' :\n\t\t\tindex = polygonVertexIndex;\n\t\t\tbreak;\n\t\tcase 'ByPolygon' :\n\t\t\tindex = polygonIndex;\n\t\t\tbreak;\n\t\tcase 'ByVertice' :\n\t\t\tindex = vertexIndex;\n\t\t\tbreak;\n\t\tcase 'AllSame' :\n\t\t\tindex = infoObject.indices[ 0 ];\n\t\t\tbreak;\n\t\tdefault :\n\t\t\tconsole.warn( 'THREE.FBXLoader: unknown attribute mapping type ' + infoObject.mappingType );\n\n\t}\n\n\tif ( infoObject.referenceType === 'IndexToDirect' ) index = infoObject.indices[ index ];\n\n\tconst from = index * infoObject.dataSize;\n\tconst to = from + infoObject.dataSize;\n\n\treturn slice( dataArray, infoObject.buffer, from, to );\n\n}\n\nconst tempEuler = new Euler();\nconst tempVec = new Vector3();\n\n// generate transformation from FBX transform data\n// ref: https://help.autodesk.com/view/FBX/2017/ENU/?guid=__files_GUID_10CDD63C_79C1_4F2D_BB28_AD2BE65A02ED_htm\n// ref: http://docs.autodesk.com/FBX/2014/ENU/FBX-SDK-Documentation/index.html?url=cpp_ref/_transformations_2main_8cxx-example.html,topicNumber=cpp_ref__transformations_2main_8cxx_example_htmlfc10a1e1-b18d-4e72-9dc0-70d0f1959f5e\nfunction generateTransform( transformData ) {\n\n\tconst lTranslationM = new Matrix4();\n\tconst lPreRotationM = new Matrix4();\n\tconst lRotationM = new Matrix4();\n\tconst lPostRotationM = new Matrix4();\n\n\tconst lScalingM = new Matrix4();\n\tconst lScalingPivotM = new Matrix4();\n\tconst lScalingOffsetM = new Matrix4();\n\tconst lRotationOffsetM = new Matrix4();\n\tconst lRotationPivotM = new Matrix4();\n\n\tconst lParentGX = new Matrix4();\n\tconst lParentLX = new Matrix4();\n\tconst lGlobalT = new Matrix4();\n\n\tconst inheritType = ( transformData.inheritType ) ? transformData.inheritType : 0;\n\n\tif ( transformData.translation ) lTranslationM.setPosition( tempVec.fromArray( transformData.translation ) );\n\n\tif ( transformData.preRotation ) {\n\n\t\tconst array = transformData.preRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPreRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.rotation ) {\n\n\t\tconst array = transformData.rotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.postRotation ) {\n\n\t\tconst array = transformData.postRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPostRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\t\tlPostRotationM.invert();\n\n\t}\n\n\tif ( transformData.scale ) lScalingM.scale( tempVec.fromArray( transformData.scale ) );\n\n\t// Pivots and offsets\n\tif ( transformData.scalingOffset ) lScalingOffsetM.setPosition( tempVec.fromArray( transformData.scalingOffset ) );\n\tif ( transformData.scalingPivot ) lScalingPivotM.setPosition( tempVec.fromArray( transformData.scalingPivot ) );\n\tif ( transformData.rotationOffset ) lRotationOffsetM.setPosition( tempVec.fromArray( transformData.rotationOffset ) );\n\tif ( transformData.rotationPivot ) lRotationPivotM.setPosition( tempVec.fromArray( transformData.rotationPivot ) );\n\n\t// parent transform\n\tif ( transformData.parentMatrixWorld ) {\n\n\t\tlParentLX.copy( transformData.parentMatrix );\n\t\tlParentGX.copy( transformData.parentMatrixWorld );\n\n\t}\n\n\tconst lLRM = lPreRotationM.clone().multiply( lRotationM ).multiply( lPostRotationM );\n\t// Global Rotation\n\tconst lParentGRM = new Matrix4();\n\tlParentGRM.extractRotation( lParentGX );\n\n\t// Global Shear*Scaling\n\tconst lParentTM = new Matrix4();\n\tlParentTM.copyPosition( lParentGX );\n\n\tconst lParentGRSM = lParentTM.clone().invert().multiply( lParentGX );\n\tconst lParentGSM = lParentGRM.clone().invert().multiply( lParentGRSM );\n\tconst lLSM = lScalingM;\n\n\tconst lGlobalRS = new Matrix4();\n\n\tif ( inheritType === 0 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM ).multiply( lLSM );\n\n\t} else if ( inheritType === 1 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lParentGSM ).multiply( lLRM ).multiply( lLSM );\n\n\t} else {\n\n\t\tconst lParentLSM = new Matrix4().scale( new Vector3().setFromMatrixScale( lParentLX ) );\n\t\tconst lParentLSM_inv = lParentLSM.clone().invert();\n\t\tconst lParentGSM_noLocal = lParentGSM.clone().multiply( lParentLSM_inv );\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM_noLocal ).multiply( lLSM );\n\n\t}\n\n\tconst lRotationPivotM_inv = lRotationPivotM.clone().invert();\n\tconst lScalingPivotM_inv = lScalingPivotM.clone().invert();\n\t// Calculate the local transform matrix\n\tlet lTransform = lTranslationM.clone().multiply( lRotationOffsetM ).multiply( lRotationPivotM ).multiply( lPreRotationM ).multiply( lRotationM ).multiply( lPostRotationM ).multiply( lRotationPivotM_inv ).multiply( lScalingOffsetM ).multiply( lScalingPivotM ).multiply( lScalingM ).multiply( lScalingPivotM_inv );\n\n\tconst lLocalTWithAllPivotAndOffsetInfo = new Matrix4().copyPosition( lTransform );\n\n\tconst lGlobalTranslation = lParentGX.clone().multiply( lLocalTWithAllPivotAndOffsetInfo );\n\tlGlobalT.copyPosition( lGlobalTranslation );\n\n\tlTransform = lGlobalT.clone().multiply( lGlobalRS );\n\n\t// from global to local\n\tlTransform.premultiply( lParentGX.invert() );\n\n\treturn lTransform;\n\n}\n\n// Returns the three.js intrinsic Euler order corresponding to FBX extrinsic Euler order\n// ref: http://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_class_fbx_euler_html\nfunction getEulerOrder( order ) {\n\n\torder = order || 0;\n\n\tconst enums = [\n\t\t'ZYX', // -> XYZ extrinsic\n\t\t'YZX', // -> XZY extrinsic\n\t\t'XZY', // -> YZX extrinsic\n\t\t'ZXY', // -> YXZ extrinsic\n\t\t'YXZ', // -> ZXY extrinsic\n\t\t'XYZ', // -> ZYX extrinsic\n\t\t//'SphericXYZ', // not possible to support\n\t];\n\n\tif ( order === 6 ) {\n\n\t\tconsole.warn( 'THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.' );\n\t\treturn enums[ 0 ];\n\n\t}\n\n\treturn enums[ order ];\n\n}\n\n// Parses comma separated list of numbers and returns them an array.\n// Used internally by the TextParser\nfunction parseNumberArray( value ) {\n\n\tconst array = value.split( ',' ).map( function ( val ) {\n\n\t\treturn parseFloat( val );\n\n\t} );\n\n\treturn array;\n\n}\n\nfunction convertArrayBufferToString( buffer, from, to ) {\n\n\tif ( from === undefined ) from = 0;\n\tif ( to === undefined ) to = buffer.byteLength;\n\n\treturn LoaderUtils.decodeText( new Uint8Array( buffer, from, to ) );\n\n}\n\nfunction append( a, b ) {\n\n\tfor ( let i = 0, j = a.length, l = b.length; i < l; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n}\n\nfunction slice( a, b, from, to ) {\n\n\tfor ( let i = from, j = 0; i < to; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n\treturn a;\n\n}\n\n// inject array a2 into array a1 at index\nfunction inject( a1, index, a2 ) {\n\n\treturn a1.slice( 0, index ).concat( a2 ).concat( a1.slice( index ) );\n\n}\n\nexport { FBXLoader };\n","import {\n\tGroup,\n\tMesh\n} from 'three';\n\n\n\nfunction createMeshesFromInstancedMesh( instancedMesh ) {\n\n\tconst group = new Group();\n\n\tconst count = instancedMesh.count;\n\tconst geometry = instancedMesh.geometry;\n\tconst material = instancedMesh.material;\n\n\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\tconst mesh = new Mesh( geometry, material );\n\n\t\tinstancedMesh.getMatrixAt( i, mesh.matrix );\n\t\tmesh.matrix.decompose( mesh.position, mesh.quaternion, mesh.scale );\n\n\t\tgroup.add( mesh );\n\n\t}\n\n\tgroup.copy( instancedMesh );\n\tgroup.updateMatrixWorld(); // ensure correct world matrices of meshes\n\n\treturn group;\n\n}\n\nfunction createMultiMaterialObject( geometry, materials ) {\n\n\tconst group = new Group();\n\n\tfor ( let i = 0, l = materials.length; i < l; i ++ ) {\n\n\t\tgroup.add( new Mesh( geometry, materials[ i ] ) );\n\n\t}\n\n\treturn group;\n\n}\n\nfunction detach( child, parent, scene ) {\n\n\tconsole.warn( 'THREE.SceneUtils: detach() has been deprecated. Use scene.attach( child ) instead.' );\n\n\tscene.attach( child );\n\n}\n\nfunction attach( child, scene, parent ) {\n\n\tconsole.warn( 'THREE.SceneUtils: attach() has been deprecated. Use parent.attach( child ) instead.' );\n\n\tparent.attach( child );\n\n}\n\n\n\nexport {\n\tcreateMeshesFromInstancedMesh,\n\tcreateMultiMaterialObject,\n\tdetach,\n\tattach,\n};\n","// inspired by https://github.com/stemkoski/stemkoski.github.com/blob/master/Three.js/js/ParticleEngine.js\r\n\r\nimport * as THREE from 'three'\r\n// import { loadShader } from '../Three/ShaderLoader'\r\nimport { controller } from '../AnimUtils/TweenUtils'\r\n\r\nexport class ParticleController {\r\n    birthTime: number\r\n    deathTime: number\r\n    position: THREE.Vector3\r\n    scale: number\r\n    rotation: THREE.Euler\r\n    // velocity: THREE.Vector3\r\n    // acceleration: THREE.Vector3\r\n    color: THREE.Color\r\n    instanceIndex: number\r\n    dummy: THREE.Object3D\r\n    constructor(position: THREE.Vector3, rotation: THREE.Euler, scale: number, color: THREE.Color, instanceIndex: number) {\r\n        this.birthTime = 0\r\n        this.deathTime = 1\r\n        this.position = position\r\n        this.rotation = rotation\r\n        this.scale = scale\r\n        this.dummy = new THREE.Object3D()\r\n        // this.velocity = new THREE.Vector3(0, 0, 0)\r\n        // this.acceleration = new THREE.Vector3(0, 0, 0)\r\n        this.color = color\r\n        this.instanceIndex = instanceIndex\r\n    }\r\n    resetGeom(mesh: THREE.InstancedMesh) {\r\n        this.dummy.position.copy(this.position)\r\n        this.dummy.rotation.copy(this.rotation)\r\n        this.dummy.scale.set(this.scale, this.scale, this.scale)\r\n        this.dummy.updateMatrix()\r\n        mesh.setMatrixAt(this.instanceIndex, this.dummy.matrix)\r\n        mesh.setColorAt(this.instanceIndex, this.color)\r\n    }\r\n}\r\n\r\nexport type ParticleAnimRuleIn = {\r\n    index: number,\r\n    interp: number,\r\n    originalPosition: THREE.Vector3,\r\n    originalRotation: THREE.Euler,\r\n    originalScale: number,\r\n    originalColor: THREE.Color,\r\n    mixColor: THREE.Color,\r\n    randomFactor: number\r\n}\r\n\r\nexport type ParticleAnimRuleOut = {\r\n    curPosition: THREE.Vector3,\r\n    curRotation: THREE.Euler,\r\n    curScale: number,\r\n    curColor: THREE.Color\r\n}\r\n\r\nexport class ParticleRuleController extends ParticleController {\r\n    direction: THREE.Vector3\r\n    mixColor: THREE.Color\r\n    randomFactor: number\r\n    constructor(position: THREE.Vector3, rotation: THREE.Euler, scale: number, color: THREE.Color, mixColor: THREE.Color, instanceIndex: number) {\r\n        super(position, rotation, scale, color, instanceIndex)\r\n        this.direction = new THREE.Vector3().copy(position)\r\n        this.birthTime = Math.random() * 0.2\r\n        this.deathTime = Math.random() * 0.2 + 0.8\r\n        this.mixColor = mixColor\r\n        this.randomFactor = Math.random()\r\n    }\r\n    updateGeomByRule(\r\n    mesh: THREE.InstancedMesh, interp: number,\r\n    animRuleFunc: (rule: ParticleAnimRuleIn) => ParticleAnimRuleOut) {\r\n        if (interp < this.birthTime) {\r\n            return\r\n        }\r\n        else if (interp >= this.deathTime) {\r\n            this.resetGeom(mesh)\r\n            return\r\n        }\r\n        else {\r\n            let ruleOut = animRuleFunc({\r\n                index: this.instanceIndex,\r\n                interp: (interp - this.birthTime) / (this.deathTime - this.birthTime),\r\n                originalPosition: this.position,\r\n                originalRotation: this.rotation,\r\n                originalColor: this.color,\r\n                originalScale: this.scale,\r\n                mixColor: this.mixColor,\r\n                randomFactor: this.randomFactor\r\n            })\r\n            this.dummy.position.copy(ruleOut.curPosition)\r\n            this.dummy.rotation.copy(ruleOut.curRotation)\r\n            this.dummy.scale.set(ruleOut.curScale, ruleOut.curScale, ruleOut.curScale)\r\n            this.dummy.updateMatrix()\r\n            mesh.setMatrixAt(this.instanceIndex, this.dummy.matrix)\r\n            mesh.setColorAt(this.instanceIndex, ruleOut.curColor)\r\n        }\r\n    }\r\n}\r\n\r\nexport class AbstractParticleEngine {\r\n    particleCount: number\r\n    mesh: THREE.InstancedMesh\r\n    constructor(particleCount: number = 100, geometry: THREE.BufferGeometry, material: THREE.Material, \r\n        // setInitPosition: (index: number) => THREE.Vector3,\r\n        // setInitRotation: (index: number) => THREE.Euler,\r\n        // setInitScale: (index: number) => number,\r\n        // setInitColor: (index: number) => THREE.Color,\r\n        ) {\r\n        this.particleCount = particleCount\r\n        this.mesh = new THREE.InstancedMesh(geometry, material, particleCount)\r\n        this.mesh.instanceMatrix.setUsage( THREE.DynamicDrawUsage )\r\n        // this.particleControllers = []\r\n        // for (let i = 0; i < particleCount; i++) {\r\n        //     let initPosition = setInitPosition(i)\r\n        //     let initRotation = setInitRotation(i)\r\n        //     let initScale = setInitScale(i)\r\n        //     let initColor = setInitColor(i)\r\n        //     let tempParticleController = new ParticleController(initPosition, initRotation, initScale, initColor)\r\n        //     this.particleControllers.push(\r\n        //         tempParticleController\r\n        //     )\r\n        //     tempParticleController.updateGeomForMesh(this.mesh, this.dummy, i)\r\n        // }\r\n    }\r\n}\r\n\r\n\r\nexport class ParticleStaticEngine extends AbstractParticleEngine {\r\n    particleControllers: Array<ParticleController>\r\n    constructor(particleCount: number = 100, geometry: THREE.BufferGeometry, material: THREE.Material, \r\n        setInitPosition: (index: number) => THREE.Vector3,\r\n        setInitRotation: (index: number) => THREE.Euler,\r\n        setInitScale: (index: number) => number,\r\n        setInitColor: (index: number) => THREE.Color,\r\n    ) {\r\n        super(particleCount, geometry, material)\r\n        this.particleControllers = []\r\n        for (let i = 0; i < particleCount; i++) {\r\n            let initPosition = setInitPosition(i)\r\n            let initRotation = setInitRotation(i)\r\n            let initScale = setInitScale(i)\r\n            let initColor = setInitColor(i)\r\n            let tempParticleController = new ParticleController(initPosition, initRotation, initScale, initColor, i)\r\n            this.particleControllers.push(\r\n                tempParticleController\r\n            )\r\n            tempParticleController.resetGeom(this.mesh)\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class ParticleRuleEngine extends AbstractParticleEngine {\r\n    isInTransition: boolean\r\n    particleControllers: Array<ParticleRuleController>\r\n    animRuleFunc: (rule: ParticleAnimRuleIn) => ParticleAnimRuleOut\r\n    constructor(particleCount: number = 100, geometry: THREE.BufferGeometry, material: THREE.Material, \r\n        setInitPosition: (index: number) => THREE.Vector3,\r\n        setInitRotation: (index: number) => THREE.Euler,\r\n        setInitScale: (index: number) => number,\r\n        setInitColor: (index: number) => THREE.Color,\r\n        setInitMixColor: (index: number) => THREE.Color,\r\n        animRuleFunc: (rule: ParticleAnimRuleIn) => ParticleAnimRuleOut\r\n    ) {\r\n        super(particleCount, geometry, material)\r\n        this.isInTransition = false\r\n        this.particleControllers = []\r\n        this.animRuleFunc = animRuleFunc\r\n        for (let i = 0; i < particleCount; i++) {\r\n            let initPosition = setInitPosition(i)\r\n            let initRotation = setInitRotation(i)\r\n            let initScale = setInitScale(i)\r\n            let initColor = setInitColor(i)\r\n            let initMixColor = setInitMixColor(i)\r\n            let tempParticleController = new ParticleRuleController(\r\n                initPosition, initRotation, initScale, initColor, initMixColor, i\r\n            )\r\n            this.particleControllers.push(\r\n                tempParticleController\r\n            )\r\n            tempParticleController.resetGeom(this.mesh)\r\n        }\r\n    }\r\n    transit(transitionTime: number = 1000) {\r\n        if (this.isInTransition) {\r\n            return\r\n        }\r\n        const self = this\r\n        controller.tweenNumber(0, 1, (interp) => {\r\n            self.particleControllers.forEach(pc => {\r\n                pc.updateGeomByRule(self.mesh, interp, self.animRuleFunc)\r\n            })\r\n            self.mesh.instanceMatrix.needsUpdate = true\r\n            if (self.mesh.instanceColor) {\r\n                self.mesh.instanceColor.needsUpdate = true\r\n            }\r\n        },\r\n        () => {\r\n            self.isInTransition = false\r\n            // self.particleControllers.forEach(pc => {\r\n            //     pc.resetGeom(self.mesh, self.dummy)\r\n            // })\r\n            self.mesh.instanceMatrix.needsUpdate = true\r\n            if (self.mesh.instanceColor) {\r\n                self.mesh.instanceColor.needsUpdate = true\r\n            }\r\n        }, transitionTime)\r\n    }\r\n}","import * as THREE from 'three'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass'\r\nimport { Stats } from 'three-stats'\r\n// import { TDSLoader } from 'three/examples/jsm/loaders/TDSLoader'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport { FBXLoader } from 'three/examples/jsm/loaders/FBXLoader'\r\nimport { createMultiMaterialObject } from 'three/examples/jsm/utils/SceneUtils'\r\nimport { CustomCSS3DObject, CustomCSS3DSprite, CustomCSS3DRenderer } from '../Three/CustomCSS3DRenderer'\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\r\nimport { DampingObjectController, DampingVector3Controller } from '../Three/Utils'\r\n// import { RefractionMesh, RefractionManager } from '../Three/Refraction2.0'\r\nimport { RefractionObject, RefractionManager } from '../ThreeRealisticRefraction/ThreeRealisticRefraction'\r\nimport { RoundedBoxGeometry } from 'three/examples/jsm/geometries/RoundedBoxGeometry'\r\nimport { controller } from '../AnimUtils/TweenUtils'\r\nimport * as PE from '../Three/ParticleEngine'\r\nimport { randn_bm } from '../Three/Utils'\r\n\r\nclass BackgroundManager {\r\n    container: HTMLElement\r\n    renderer: THREE.WebGLRenderer\r\n    scene: THREE.Scene\r\n    // composer: EffectComposer\r\n    stats: Stats\r\n    controls: OrbitControls\r\n\r\n    // cursor position\r\n    mousePosX: number\r\n    mousePosY: number\r\n    pointer: THREE.Vector2\r\n\r\n    // camera\r\n    camera: THREE.PerspectiveCamera\r\n    // cameraZPosition: number\r\n    // cameraLootAtController: DampingVector3Controller\r\n    // cameraTargetPosition: THREE.Vector3\r\n    // cameraWithMouseRotateFactor: number\r\n    // cameraWithMouseMoveFactor: number\r\n\r\n    // loading manager\r\n    loadingManager: THREE.LoadingManager\r\n\r\n    constructor(_container: HTMLElement,\r\n        onLoad?: () => void,\r\n        onProgress?: (url: string, loaded: number, total: number) => void,\r\n        onError?: (url: string) => void\r\n        ) {\r\n        const self = this\r\n\r\n        // *********** basic settings ***********\r\n        // this.cameraZPosition = 500\r\n        this.container = _container\r\n        this.camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 5000 )\r\n        this.renderer = new THREE.WebGLRenderer( {alpha: true} )\r\n        this.renderer.outputEncoding = THREE.sRGBEncoding\r\n        this.renderer.toneMappingExposure = THREE.ACESFilmicToneMapping\r\n        this.renderer.toneMappingExposure = 1.2\r\n        this.renderer.setClearColor( 0xffffff )\r\n        this.renderer.setPixelRatio( window.devicePixelRatio )\r\n        this.renderer.setSize(window.innerWidth, window.innerHeight)\r\n        this.renderer.domElement.style.position = 'absolute'\r\n        this.renderer.domElement.style.top = '0px'\r\n        this.renderer.domElement.style.left = '0px'\r\n        this.container.appendChild( this.renderer.domElement )\r\n        // TODO: (debug stats)\r\n        this.stats = new Stats()\r\n        this.stats.domElement.style.zIndex = '100'\r\n        this.container.appendChild( this.stats.domElement )\r\n        this.controls = new OrbitControls(this.camera, this.container)\r\n        this.camera.position.set(0, 200, 150)\r\n\r\n        this.scene = new THREE.Scene()\r\n\r\n        // \r\n        this.loadingManager = new THREE.LoadingManager(() => {\r\n            if (onLoad) {\r\n                onLoad()\r\n            }\r\n        }, (url: string, loaded: number, total: number) => {\r\n            if (onProgress) {\r\n                onProgress(url, loaded, total)\r\n            }\r\n        }, (url) => {\r\n            if (onError) {\r\n                onError(url)\r\n            }\r\n        })\r\n\r\n        // *********** background & env ***********\r\n        const png_urls = [\r\n            'px.png', 'nx.png',\r\n            'py.png', 'ny.png',\r\n            'pz.png', 'nz.png'\r\n        ]\r\n        const jpg_urls = [\r\n            'px.jpg', 'nx.jpg',\r\n            'py.jpg', 'ny.jpg',\r\n            'pz.jpg', 'nz.jpg'\r\n        ]\r\n        var urls = this.getCubemapUrls('./cube2/', png_urls)\r\n        const textureCube1 = new THREE.CubeTextureLoader(this.loadingManager).load( urls )\r\n        textureCube1.mapping = THREE.CubeRefractionMapping\r\n        // this.scene.background = textureCube\r\n        this.scene.environment = textureCube1\r\n\r\n        urls = this.getCubemapUrls('./bg/', png_urls)\r\n        const textureCube2 = new THREE.CubeTextureLoader(this.loadingManager).load( urls )\r\n        // textureCube2.mapping = THREE.CubeRefractionMapping\r\n        this.scene.background = textureCube2\r\n\r\n\r\n\r\n        const light = new THREE.DirectionalLight(0xffd060, 1)\r\n        light.position.set(10, 10, 0)\r\n        this.scene.add(light)\r\n        const light1 = new THREE.DirectionalLight(0x60d0ff, 1)\r\n        light1.position.set(-10, 10, 0)\r\n        this.scene.add(light1)\r\n        const light2 = new THREE.PointLight(0x60d0ff, 1)\r\n        light2.position.set(0, 100, 0)\r\n        this.scene.add(light2)\r\n\r\n\r\n        // generate sphere array\r\n        const sinPeriods = 3\r\n        const sinAmplitude = 10\r\n        const sinRadius1 = 120\r\n        const sinRadius2 = 80\r\n        const ps = []\r\n        for (let i = 0; i < sinPeriods; i++) {\r\n            ps.push(new THREE.Vector3(\r\n                sinAmplitude / 2,\r\n                Math.cos(Math.PI * 2 * i / sinPeriods) * sinRadius1,\r\n                Math.sin(Math.PI * 2 * i / sinPeriods) * sinRadius2\r\n            ))\r\n            ps.push(new THREE.Vector3(\r\n                -sinAmplitude / 2,\r\n                Math.cos(Math.PI * 2 * (i+0.5) / sinPeriods) * sinRadius1,\r\n                Math.sin(Math.PI * 2 * (i+0.5) / sinPeriods) * sinRadius2\r\n            ))\r\n        }\r\n\r\n        const spline = new THREE.CatmullRomCurve3(ps, true)\r\n        spline.type = 'centripetal'\r\n        const samples = spline.getPoints( ps.length * 10 )\r\n\r\n        console.log(spline.getLength())\r\n        const splineLength = spline.getLength()\r\n        const sphereRadius = 5\r\n        const sphereCount = Math.floor(splineLength / (sphereRadius * 2))\r\n        const spherePositions: Array<THREE.Vector3> = []\r\n        for ( let i = 0; i < sphereCount; i++ ) {\r\n            spherePositions.push(\r\n                spline.getPointAt(i / sphereCount)\r\n            )\r\n        }\r\n\r\n        const geometrySpline = new THREE.BufferGeometry().setFromPoints( samples )\r\n        const line = new THREE.Line( geometrySpline, new THREE.LineDashedMaterial( { color: 0xff0000, dashSize: 1, gapSize: 0.5 } ) )\r\n        this.scene.add( line )\r\n\r\n\r\n        var particleGeometry = new THREE.SphereBufferGeometry(sphereRadius)\r\n        var particleMaterial = new THREE.MeshPhysicalMaterial({\r\n            clearcoat: 2.0,\r\n            clearcoatRoughness: 0.1,\r\n            metalness: 0.8,\r\n            roughness: 0.2,\r\n            sheen: 2,\r\n            sheenColor: new THREE.Color(0xffa050)\r\n            // emissive: new THREE.Color(0xffff80),\r\n            // emissiveIntensity: 0.5\r\n        })\r\n        var particleEngine1 = new PE.ParticleStaticEngine(sphereCount, particleGeometry, particleMaterial,\r\n            (index) => {\r\n                return spherePositions[index]\r\n            },\r\n            (_) => {\r\n                return new THREE.Euler(0,0,0)\r\n            },\r\n            (_) => {\r\n                return 1\r\n            },\r\n            (_) => {\r\n                return new THREE.Color(0xffffe0)\r\n            }\r\n        )\r\n        this.scene.add(particleEngine1.mesh)\r\n\r\n        const loader = new FBXLoader(this.loadingManager)\r\n        var ao1Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/lotus/color.jpg' )\r\n        var texMap = new THREE.TextureLoader(this.loadingManager).load( './flower1/bump.jpg' )\r\n        var normMap = new THREE.TextureLoader(this.loadingManager).load( './flower1/normal.png' )\r\n        loader.load( './flower1/lotus/lotus.fbx', (obj) => {\r\n            if (obj instanceof THREE.Group && obj.children[0] instanceof THREE.Mesh) {\r\n                const mesh = obj.children[0]\r\n                mesh.material = new THREE.MeshPhysicalMaterial({\r\n                    color: 0xa0a080,\r\n                    map: ao1Map,\r\n                    // reflectivity: 0.5,\r\n                    normalMap: normMap,\r\n                    normalScale: new THREE.Vector2(0.6),\r\n                    metalness: 0.6,\r\n                    metalnessMap: texMap,\r\n                    // roughnessMap: texMap,\r\n                    clearcoat: 1.0,\r\n                    clearcoatRoughness: 0.4,\r\n                    clearcoatMap: texMap,\r\n                    side: THREE.DoubleSide\r\n                })\r\n                // mesh.rotation.x = Math.PI / 4\r\n                self.scene.add(mesh)\r\n            }\r\n        })\r\n\r\n        var kao1Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/kud/kud_1.jpg' )\r\n        var kao2Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/kud/kud_2.jpg' )\r\n        const loader2 = new FBXLoader(this.loadingManager)\r\n        loader2.load( './flower1/kud/kud.fbx', (obj) => {\r\n            if (obj instanceof THREE.Group && obj.children[0] instanceof THREE.Mesh) {\r\n                const mesh = obj.children[0]\r\n                const frontbackMaterials = [\r\n                    new THREE.MeshPhysicalMaterial({\r\n                        color: 0xff8000,\r\n                        map: kao1Map,\r\n                        reflectivity: 0.5,\r\n                        metalness: 0.5,\r\n                        metalnessMap: texMap,\r\n                        // bumpMap: lotusBumpMap,\r\n                        // bumpScale: 10,\r\n                        clearcoat: 1.0,\r\n                        // normalMapType: THREE.ObjectSpaceNormalMap,\r\n                        side: THREE.BackSide\r\n                    }),\r\n                    new THREE.MeshPhysicalMaterial({\r\n                        color: 0x8080ff,\r\n                        map: kao2Map,\r\n                        reflectivity: 0.5,\r\n                        metalness: 0.5,\r\n                        metalnessMap: texMap,\r\n                        // bumpMap: lotusBumpMap,\r\n                        // bumpScale: 10,\r\n                        clearcoat: 1.0,\r\n                        // normalMapType: THREE.ObjectSpaceNormalMap,\r\n                        side: THREE.FrontSide\r\n                    })\r\n                ]\r\n                var frontBackMesh = createMultiMaterialObject( mesh.geometry, frontbackMaterials );\r\n                frontBackMesh.position.x += 200\r\n                // mesh.rotation.x = Math.PI / 4\r\n                self.scene.add(frontBackMesh)\r\n            }\r\n        })\r\n\r\n        \r\n        var fao1Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/f3/ao_1.jpg' )\r\n        var fao2Map = new THREE.TextureLoader(this.loadingManager).load( './flower1/f3/ao_21.jpg' )\r\n        const loader3 = new FBXLoader(this.loadingManager)\r\n        loader3.load( './flower1/f3/f3.fbx', (obj) => {\r\n            if (obj instanceof THREE.Group && obj.children[0] instanceof THREE.Mesh) {\r\n                const mesh = obj.children[0]\r\n                const frontbackMaterials = [\r\n                    new THREE.MeshPhysicalMaterial({\r\n                        color: 0xffff20,\r\n                        map: fao1Map,\r\n                        reflectivity: 0.5,\r\n                        metalness: 0.5,\r\n                        metalnessMap: texMap,\r\n                        // bumpMap: lotusBumpMap,\r\n                        // bumpScale: 10,\r\n                        clearcoat: 1.0,\r\n                        // normalMapType: THREE.ObjectSpaceNormalMap,\r\n                        side: THREE.BackSide\r\n                    }),\r\n                    new THREE.MeshPhysicalMaterial({\r\n                        color: 0xff4040,\r\n                        map: fao2Map,\r\n                        reflectivity: 0.5,\r\n                        metalness: 0.5,\r\n                        metalnessMap: texMap,\r\n                        // bumpMap: lotusBumpMap,\r\n                        // bumpScale: 10,\r\n                        clearcoat: 1.0,\r\n                        // normalMapType: THREE.ObjectSpaceNormalMap,\r\n                        side: THREE.FrontSide\r\n                    })\r\n                ]\r\n                var frontBackMesh = createMultiMaterialObject( mesh.geometry, frontbackMaterials );\r\n                frontBackMesh.position.x -= 200\r\n                // mesh.rotation.x = Math.PI / 4\r\n                self.scene.add(frontBackMesh)\r\n            }\r\n        })\r\n\r\n\r\n        // logo cards\r\n        const logoColorMap = new THREE.TextureLoader(this.loadingManager).load( './logo/logo.jpg' )\r\n        const logoReflectMap = new THREE.TextureLoader(this.loadingManager).load( './logo/reflect.jpg' )\r\n        const logoMaterial = new THREE.MeshPhysicalMaterial({\r\n            map: logoColorMap,\r\n            reflectivity: 10,\r\n            metalnessMap: logoReflectMap,\r\n            // metalness: 0.5,\r\n            // lightMap: logoReflectMap,\r\n            metalness: 2,\r\n            // metalnessMap: logoReflectMap,\r\n            clearcoat: 1.0,\r\n            // specularIntensity: 5.0,\r\n            // clearcoatMap: logoReflectMap,\r\n            side: THREE.DoubleSide\r\n        })\r\n        const logoCardGeometry = new THREE.PlaneBufferGeometry(100, 100)\r\n        var logoCardEngine = new PE.ParticleStaticEngine(10, logoCardGeometry, logoMaterial,\r\n            (index) => {\r\n                return this.getRandomLogoPosition(index, 350)\r\n            },\r\n            (_) => {\r\n                return new THREE.Euler(\r\n                    Math.random() * 0.5 - 0.5,\r\n                    Math.random() * 0.5 - 0.25,\r\n                    Math.random() * 0.2 - 0.1)\r\n            },\r\n            (_) => {\r\n                return 1\r\n            },\r\n            (_) => {\r\n                return new THREE.Color(0xffffff)\r\n            }\r\n        )\r\n        this.scene.add(logoCardEngine.mesh)\r\n\r\n\r\n\r\n        // *********** events ***********\r\n        this.mousePosX = 0\r\n        this.mousePosY = 0\r\n        this.pointer = new THREE.Vector2()\r\n        window.addEventListener( 'resize', () => {\r\n            self.onWindowResize()\r\n        } )\r\n        window.addEventListener( 'click', (e) => {\r\n            self.onClick(e)\r\n        } )\r\n\r\n        // *********** final animate ***********\r\n        this.animate()\r\n    }\r\n\r\n    animate = () => {\r\n        requestAnimationFrame( this.animate )\r\n        // damping controllers\r\n        // this.updatecornerObject()\r\n        this.render()\r\n        this.stats.update()\r\n        this.controls.update()\r\n    }\r\n\r\n    render()\r\n    {\r\n        this.renderer.render(this.scene, this.camera)\r\n    }\r\n\r\n    onWindowResize() {\r\n        this.camera.aspect = window.innerWidth / window.innerHeight\r\n        this.camera.updateProjectionMatrix()\r\n        this.renderer.setSize( window.innerWidth, window.innerHeight )\r\n    }\r\n    \r\n    onClick(e: MouseEvent) {\r\n    }\r\n\r\n    getRandomLogoPosition(index: number, radius: number = 300): THREE.Vector3 {\r\n        let angle = randn_bm() * 0.8 - Math.PI / 2\r\n        let radiusNew = radius + randn_bm()\r\n        let randomOffset = new THREE.Vector3(randn_bm() * 60, randn_bm() * 5, randn_bm() * 60)\r\n        return new THREE.Vector3(Math.cos(angle), 0, Math.sin(angle)).multiplyScalar(radiusNew).add(randomOffset)\r\n    }\r\n\r\n    getCubemapUrls(dir: string, path: Array<string>): Array<string> {\r\n        var urls: Array<string> = []\r\n        path.forEach(p => {\r\n            urls.push(dir + p)\r\n        })\r\n        return urls\r\n    }\r\n\r\n}\r\n\r\n\r\nexport {\r\n    BackgroundManager\r\n}","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport * as THREE from 'three'\r\nimport Vue from 'vue'\r\nimport { BackgroundManager } from '../scripts/Background1.0'\r\n\r\ntype Data = {\r\n    fpm: BackgroundManager | null,\r\n    loadingStat: {\r\n        loaded: number,\r\n        total: number,\r\n        isLoaded: boolean,\r\n        noLoadingStat: boolean\r\n    }\r\n}\r\n\r\nexport default Vue.extend({\r\n    data(): Data {\r\n        return {\r\n            fpm: null,\r\n            loadingStat: {\r\n                loaded: 0,\r\n                total: 1,\r\n                isLoaded: false,\r\n                noLoadingStat: false\r\n            }\r\n        }\r\n    },\r\n    mounted() {\r\n        const self = this\r\n        if (this.$refs['canvas-container'] instanceof HTMLElement) {\r\n            this.fpm = new BackgroundManager(\r\n                this.$refs['canvas-container'],\r\n                () => {\r\n                    console.log('loaded')\r\n                    self.loadingStat.isLoaded = true\r\n                    setTimeout(() => {\r\n                        self.loadingStat.noLoadingStat = true\r\n                    }, 501)\r\n                },\r\n                (_, loaded, total) => {\r\n                    this.loadingStat.loaded = loaded\r\n                    this.loadingStat.total = total\r\n                },\r\n                (url) => {\r\n                    console.error('failed to load asset: ' + url)\r\n                    self.loadingStat.isLoaded = true\r\n                }\r\n            )\r\n        }\r\n    }\r\n})\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--15-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeBackgroundTest.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--15-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeBackgroundTest.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ThreeBackgroundTest.vue?vue&type=template&id=17a177c4&scoped=true&\"\nimport script from \"./ThreeBackgroundTest.vue?vue&type=script&lang=ts&\"\nexport * from \"./ThreeBackgroundTest.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ThreeBackgroundTest.vue?vue&type=style&index=0&id=17a177c4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"17a177c4\",\n  null\n  \n)\n\nexport default component.exports","var uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\n\nvar quot = /\"/g;\nvar replace = uncurryThis(''.replace);\n\n// `CreateHTML` abstract operation\n// https://tc39.es/ecma262/#sec-createhtml\nmodule.exports = function (string, tag, attribute, value) {\n  var S = toString(requireObjectCoercible(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + replace(toString(value), quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\n","var fails = require('../internals/fails');\n\n// check the existence of a method, lowercase\n// of a tag and escaping quotes in arguments\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    var test = ''[METHOD_NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  });\n};\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar setToStringTag = require('../internals/set-to-string-tag');\n\n$({ global: true }, { Reflect: {} });\n\n// Reflect[@@toStringTag] property\n// https://tc39.es/ecma262/#sec-reflect-@@tostringtag\nsetToStringTag(global.Reflect, 'Reflect', true);\n"],"sourceRoot":""}